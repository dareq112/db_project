{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.1", "generated_at": "2025-04-18T22:08:46.511461Z", "invocation_id": "a50c6b0b-8cc0-4580-8bcd-c46d22849e5b", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T22:08:22.112346Z", "completed_at": "2025-04-18T22:08:22.191873Z"}, {"name": "execute", "started_at": "2025-04-18T22:08:22.195144Z", "completed_at": "2025-04-18T22:08:24.393530Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.294973850250244, "adapter_response": {"_message": "CREATE TABLE (3.4k rows, 141.3 KiB processed)", "code": "CREATE TABLE", "rows_affected": 3376, "bytes_processed": 144733, "bytes_billed": 10485760, "location": "europe-central2", "project_id": "db-project-456518", "job_id": "6bd82bb2-b9c2-4869-81fc-62a6c93aecb3", "slot_ms": 1029}, "message": "CREATE TABLE (3.4k rows, 141.3 KiB processed)", "failures": null, "unique_id": "model.flights_project.dim_airports", "compiled": true, "compiled_code": "\n\nselect\n    iata as airport_code,\n    airport as airport_name,\n    city,\n    state,\n    country,\nfrom `db-project-456518`.`db_project_dataset`.`airports`", "relation_name": "`db-project-456518`.`db_project_dataset`.`dim_airports`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T22:08:24.419875Z", "completed_at": "2025-04-18T22:08:24.517650Z"}, {"name": "execute", "started_at": "2025-04-18T22:08:24.519153Z", "completed_at": "2025-04-18T22:08:25.437898Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0215961933135986, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "europe-central2", "project_id": "db-project-456518", "job_id": "a898f617-159f-45cb-84c7-61d14a82ebd2", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.flights_project.stg_flights", "compiled": true, "compiled_code": "\n\nwith raw_data as (\n    select * from `db-project-456518`.`db_project_dataset`.`flights_data`\n)\nselect\n    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,\n    cast(FlightDate as date) as flight_date,\n    cast(FlightMonth as date) as flight_month,\n    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted, ':00') as datetime) as dep_time,\n    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted, ':00') as datetime) as arr_time,\n    cast(FlightNum as integer) as flight_num,\n    cast(ActualElapsedTime as integer) as actual_elapsed_time,\n    cast(DepDelay as integer) as dep_delay,\n    cast(ArrDelay as integer) as arr_delay,\n    cast(Origin as String) as origin,\n    cast(Dest as String) as destination,\n    cast(CarrierCode as String) as carrier_code,\n    cast(CarrierDescription as String) as carrier_desc,\n    \n    case\n        when DepDelay > 0 and ArrDelay > 0 then 'ddad'\n        when DepDelay > 0 then 'dd'\n        when ArrDelay > 0 then 'ad'\n        else 'nd'\n    end\n as delay_status\nfrom raw_data\nwhere DepTimeFormatted is not null\n    and ArrTimeFormatted is not null\n    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24\n    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60\n    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24\n    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60", "relation_name": "`db-project-456518`.`db_project_dataset`.`stg_flights`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T22:08:25.460671Z", "completed_at": "2025-04-18T22:08:25.525161Z"}, {"name": "execute", "started_at": "2025-04-18T22:08:25.527555Z", "completed_at": "2025-04-18T22:08:30.810439Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.35383939743042, "adapter_response": {"_message": "CREATE TABLE (112.3m rows, 11.7 GiB processed)", "code": "CREATE TABLE", "rows_affected": 112329666, "bytes_processed": 12609517836, "bytes_billed": 12610174976, "location": "europe-central2", "project_id": "db-project-456518", "job_id": "0d3aeae3-5f86-42a6-b76c-ee231a6e9f1e", "slot_ms": 1548805}, "message": "CREATE TABLE (112.3m rows, 11.7 GiB processed)", "failures": null, "unique_id": "model.flights_project.core_flights", "compiled": true, "compiled_code": "\n\nwith flight_data as (\n    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`\n),\nairports_data as (\n    select * from `db-project-456518`.`db_project_dataset`.`airports`\n)\n\nselect \n    flight_data.id,\n    flight_data.flight_date,\n    flight_data.flight_month,\n    flight_data.dep_time,\n    flight_data.arr_time,\n    \n    case\n        when flight_data.arr_time >= flight_data.dep_time then \n            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE)\n        else \n            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE) + 1440\n    end\n as airtime,\n    flight_data.flight_num,\n    flight_data.actual_elapsed_time,\n    flight_data.dep_delay,\n    flight_data.arr_delay,\n    flight_data.origin,\n    departure_airport.airport as dep_airport,\n    departure_airport.city as dep_city,\n    departure_airport.state as dep_state,\n    departure_airport.country as dep_country,\n    flight_data.destination,\n    arrival_airport.airport as arr_airport,\n    arrival_airport.city as arr_city,\n    arrival_airport.state as arr_state,\n    arrival_airport.country as arr_country,\n    flight_data.carrier_code,\n    flight_data.carrier_desc,\n    flight_data.delay_status\nfrom flight_data\ninner join airports_data as departure_airport\non flight_data.origin = departure_airport.iata\ninner join airports_data as arrival_airport\non flight_data.destination = arrival_airport.iata", "relation_name": "`db-project-456518`.`db_project_dataset`.`core_flights`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T22:08:30.834639Z", "completed_at": "2025-04-18T22:08:30.869526Z"}, {"name": "execute", "started_at": "2025-04-18T22:08:30.872055Z", "completed_at": "2025-04-18T22:08:33.006015Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.1754510402679443, "adapter_response": {"_message": "CREATE TABLE (29.0 rows, 3.9 GiB processed)", "code": "CREATE TABLE", "rows_affected": 29, "bytes_processed": 4164620201, "bytes_billed": 4164943872, "location": "europe-central2", "project_id": "db-project-456518", "job_id": "9e83a677-7251-4917-b857-264833a61558", "slot_ms": 40127}, "message": "CREATE TABLE (29.0 rows, 3.9 GiB processed)", "failures": null, "unique_id": "model.flights_project.dim_carriers", "compiled": true, "compiled_code": "\n\nselect distinct \n    carrier_code,\n    carrier_desc\nfrom `db-project-456518`.`db_project_dataset`.`core_flights`", "relation_name": "`db-project-456518`.`db_project_dataset`.`dim_carriers`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T22:08:33.017411Z", "completed_at": "2025-04-18T22:08:33.033409Z"}, {"name": "execute", "started_at": "2025-04-18T22:08:33.035082Z", "completed_at": "2025-04-18T22:08:35.129774Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.1164286136627197, "adapter_response": {"_message": "CREATE TABLE (7.4k rows, 857.0 MiB processed)", "code": "CREATE TABLE", "rows_affected": 7397, "bytes_processed": 898637328, "bytes_billed": 899678208, "location": "europe-central2", "project_id": "db-project-456518", "job_id": "8dabd77a-7567-421f-a106-33d9ed6130d9", "slot_ms": 24729}, "message": "CREATE TABLE (7.4k rows, 857.0 MiB processed)", "failures": null, "unique_id": "model.flights_project.dim_dates", "compiled": true, "compiled_code": "\n\nwith flight_data as (\n    select distinct flight_date\n    from `db-project-456518`.`db_project_dataset`.`core_flights`\n)\n\nselect \n    flight_date,\n    extract(year from flight_date) as year,\n    extract(quarter from flight_date) as quarter,\n    extract(month from flight_date) as month,\n    extract(day from flight_date) as day,\n    extract(week from flight_date) as week,\n    extract(dayofweek from flight_date) as day_of_week,\n    case \n    when extract(dayofweek from flight_date) in (1, 7) then 'Weekend' \n    else 'Weekday' \n    end as day_type\nfrom flight_data", "relation_name": "`db-project-456518`.`db_project_dataset`.`dim_dates`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T22:08:35.138840Z", "completed_at": "2025-04-18T22:08:35.153718Z"}, {"name": "execute", "started_at": "2025-04-18T22:08:35.154961Z", "completed_at": "2025-04-18T22:08:37.153159Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.017488718032837, "adapter_response": {"_message": "CREATE TABLE (8.1k rows, 2.5 GiB processed)", "code": "CREATE TABLE", "rows_affected": 8105, "bytes_processed": 2695911976, "bytes_billed": 2696937472, "location": "europe-central2", "project_id": "db-project-456518", "job_id": "8f89237d-649e-47c4-905b-ca5b178b1d5b", "slot_ms": 53352}, "message": "CREATE TABLE (8.1k rows, 2.5 GiB processed)", "failures": null, "unique_id": "model.flights_project.fact_delays_by_flight_num", "compiled": true, "compiled_code": "\n\nwith flight_data as (\n    select *\n    from `db-project-456518`.`db_project_dataset`.`core_flights`\n    where arr_delay > 0 or dep_delay > 0\n)\n\nselect \n    flight_num,\n    count(*) as total_flights_with_delays,\n    sum(dep_delay) as total_dep_delay,\n    sum(arr_delay) as total_arr_delay,\n    avg(dep_delay) as avg_dep_delay,\n    avg(arr_delay) as avg_arr_delay,\n    min(dep_delay) as min_dep_delay,\n    min(arr_delay) as min_arr_delay,\n    max(dep_delay) as max_dep_delay,\n    max(arr_delay) as max_arr_delay\nfrom flight_data\ngroup by flight_num", "relation_name": "`db-project-456518`.`db_project_dataset`.`fact_delays_by_flight_num`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T22:08:37.168901Z", "completed_at": "2025-04-18T22:08:37.188971Z"}, {"name": "execute", "started_at": "2025-04-18T22:08:37.190555Z", "completed_at": "2025-04-18T22:08:39.196819Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.0311191082000732, "adapter_response": {"_message": "CREATE TABLE (343.0 rows, 4.4 GiB processed)", "code": "CREATE TABLE", "rows_affected": 343, "bytes_processed": 4747205296, "bytes_billed": 4747952128, "location": "europe-central2", "project_id": "db-project-456518", "job_id": "b420bf95-002d-490f-9215-56d910eee971", "slot_ms": 41146}, "message": "CREATE TABLE (343.0 rows, 4.4 GiB processed)", "failures": null, "unique_id": "model.flights_project.fact_departure_delays_by_airport", "compiled": true, "compiled_code": "\n\nwith delayed_departures as (\n    select \n        dep_airport, \n        dep_delay,\n        arr_delay\n    from `db-project-456518`.`db_project_dataset`.`core_flights`\n    where dep_delay is not null\n)\n\nselect \n    dep_airport,\n    AVG(dep_delay) as average_dep_delay,\n    AVG(arr_delay) as average_arr_delay,\n    count(*) AS delay_count\nfrom delayed_departures\ngroup by dep_airport\norder by delay_count desc", "relation_name": "`db-project-456518`.`db_project_dataset`.`fact_departure_delays_by_airport`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T22:08:39.214137Z", "completed_at": "2025-04-18T22:08:39.252550Z"}, {"name": "execute", "started_at": "2025-04-18T22:08:39.254880Z", "completed_at": "2025-04-18T22:08:41.509130Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.298753261566162, "adapter_response": {"_message": "CREATE TABLE (343.0 rows, 535.6 MiB processed)", "code": "CREATE TABLE", "rows_affected": 343, "bytes_processed": 561648330, "bytes_billed": 562036736, "location": "europe-central2", "project_id": "db-project-456518", "job_id": "72e0678f-0156-436a-980d-6cee8fcd17c2", "slot_ms": 32910}, "message": "CREATE TABLE (343.0 rows, 535.6 MiB processed)", "failures": null, "unique_id": "model.flights_project.fact_departures_by_airport_year", "compiled": true, "compiled_code": "\n\nwith flights_data as (\n    select *\n    from `db-project-456518`.`db_project_dataset`.`core_flights`\n)  \n\nselect \n    origin as airport_code,\n    count(*) as num_departures\nfrom flights_data\ngroup by origin", "relation_name": "`db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T22:08:42.122105Z", "completed_at": "2025-04-18T22:08:42.140302Z"}, {"name": "execute", "started_at": "2025-04-18T22:08:42.142114Z", "completed_at": "2025-04-18T22:08:44.586219Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.469135284423828, "adapter_response": {"_message": "CREATE TABLE (21.0 rows, 857.0 MiB processed)", "code": "CREATE TABLE", "rows_affected": 21, "bytes_processed": 898637328, "bytes_billed": 899678208, "location": "europe-central2", "project_id": "db-project-456518", "job_id": "8bbb7377-ab4d-4f51-a87a-e28d87ace231", "slot_ms": 42030}, "message": "CREATE TABLE (21.0 rows, 857.0 MiB processed)", "failures": null, "unique_id": "model.flights_project.fact_departures_yearly", "compiled": true, "compiled_code": "\n\nselect\n    extract(year from f.flight_date) as year,\n    count(*) as num_departures\nfrom `db-project-456518`.`db_project_dataset`.`core_flights` f\ngroup by year\norder by year", "relation_name": "`db-project-456518`.`db_project_dataset`.`fact_departures_yearly`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T22:08:44.596737Z", "completed_at": "2025-04-18T22:08:44.610816Z"}, {"name": "execute", "started_at": "2025-04-18T22:08:44.612334Z", "completed_at": "2025-04-18T22:08:46.500787Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.9069435596466064, "adapter_response": {"_message": "CREATE TABLE (352.0 rows, 2.7 GiB processed)", "code": "CREATE TABLE", "rows_affected": 352, "bytes_processed": 2950041521, "bytes_billed": 2950692864, "location": "europe-central2", "project_id": "db-project-456518", "job_id": "47764b82-86ad-430e-bf07-8abb87431d4d", "slot_ms": 45522}, "message": "CREATE TABLE (352.0 rows, 2.7 GiB processed)", "failures": null, "unique_id": "model.flights_project.fact_most_departures_airport", "compiled": true, "compiled_code": "\n\nselect\n    a.airport_name,\n    a.city,\n    a.state,\n    COUNT(*) as num_departures\nfrom `db-project-456518`.`db_project_dataset`.`core_flights` f\njoin `db-project-456518`.`db_project_dataset`.`dim_airports` a on f.dep_airport = a.airport_name\ngroup by airport_name, a.city, a.state\norder by num_departures desc", "relation_name": "`db-project-456518`.`db_project_dataset`.`fact_most_departures_airport`"}], "elapsed_time": 25.953829526901245, "args": {"vars": {}, "log_format": "default", "quiet": false, "write_json": true, "log_level": "info", "partial_parse_file_diff": true, "populate_cache": true, "show_resource_report": false, "which": "run", "source_freshness_run_project_hooks": false, "introspect": true, "send_anonymous_usage_stats": true, "log_path": "/opt/airflow/dbt/logs", "print": true, "select": [], "strict_mode": false, "static_parser": true, "use_colors": true, "profiles_dir": "/opt/airflow/dbt", "use_colors_file": true, "printer_width": 80, "require_resource_names_without_spaces": false, "require_explicit_package_overrides_for_builtin_materializations": true, "invocation_command": "dbt run", "enable_legacy_logger": false, "empty": false, "log_level_file": "debug", "cache_selected_only": false, "exclude": [], "version_check": true, "defer": false, "macro_debugging": false, "log_file_max_bytes": 10485760, "log_format_file": "debug", "partial_parse": true, "project_dir": "/opt/airflow/dbt", "warn_error_options": {"include": [], "exclude": []}, "favor_state": false, "indirect_selection": "eager"}}