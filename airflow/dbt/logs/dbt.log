[0m14:27:03.439261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1721a778f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f172131bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17257510a0>]}


============================== 14:27:03.448077 | e1aeab0f-3ed1-4b83-99c6-fff3377a045a ==============================
[0m14:27:03.448077 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:27:03.449669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_flights', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:27:03.471212 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Runtime Error
    Syntax error near line 9
    ------------------------------
    6  |       project: 'db-project-456518'
    7  |       dataset: 'db_project_dataset
    8  |       threads: 1
    9  |       keyfile: /opt/airflow/config/gcp-key.json
    
    Raw Error:
    ------------------------------
    while scanning a quoted scalar
      in "<unicode string>", line 7, column 16
    found unexpected end of stream
      in "<unicode string>", line 9, column 48
  
[0m14:27:03.479461 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.09913098, "process_user_time": 4.69919, "process_kernel_time": 0.228019, "process_mem_max_rss": "154580", "process_in_blocks": "41024", "process_out_blocks": "2648", "command_success": false}
[0m14:27:03.481955 [debug] [MainThread]: Command `dbt run` failed at 14:27:03.481123 after 0.10 seconds
[0m14:27:03.484212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17213d91c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f172147d040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17213de420>]}
[0m14:27:03.486148 [debug] [MainThread]: Flushing usage events
[0m14:28:20.007964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c4ae6690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c4ae6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c4ae66c0>]}


============================== 14:28:20.023799 | a5b7e24a-fca2-49c9-8019-a456ff730bca ==============================
[0m14:28:20.023799 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:28:20.025732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models stg_flights', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:28:20.039777 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Runtime Error
    Syntax error near line 9
    ------------------------------
    6  |       project: 'db-project-456518'
    7  |       dataset: 'db_project_dataset
    8  |       threads: 1
    9  |       keyfile: '/opt/airflow/config/gcp-key.json'
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 5, column 7
    did not find expected key
      in "<unicode string>", line 9, column 17
  
[0m14:28:20.042349 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.11970399, "process_user_time": 4.921313, "process_kernel_time": 0.199647, "process_mem_max_rss": "154560", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:28:20.043350 [debug] [MainThread]: Command `dbt run` failed at 14:28:20.043094 after 0.12 seconds
[0m14:28:20.044234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c91671a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c532e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c51c1880>]}
[0m14:28:20.045174 [debug] [MainThread]: Flushing usage events
[0m14:29:29.375928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf14f92600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf14e43860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf14e42bd0>]}


============================== 14:29:29.388971 | f454ea94-230d-4afb-a731-b4009811554e ==============================
[0m14:29:29.388971 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:29:29.391099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models stg_flights', 'send_anonymous_usage_stats': 'True'}
[0m14:29:31.346675 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "my_profile", target "dev" invalid: Runtime Error
    Must specify authentication method
[0m14:29:31.348637 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.0847673, "process_user_time": 6.93051, "process_kernel_time": 0.748055, "process_mem_max_rss": "243508", "process_in_blocks": "24216", "process_out_blocks": "2856", "command_success": false}
[0m14:29:31.350098 [debug] [MainThread]: Command `dbt run` failed at 14:29:31.349809 after 2.09 seconds
[0m14:29:31.351063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf14f92600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faef253b3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faef20edfa0>]}
[0m14:29:31.352053 [debug] [MainThread]: Flushing usage events
[0m14:30:45.091239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd78ae00a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd78aeae4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd78b07f680>]}


============================== 14:30:45.101204 | cdd4bdb6-35f0-47f6-a2a7-8b7fc8547bf1 ==============================
[0m14:30:45.101204 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:30:45.102883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_flights', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:30:46.934829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdd4bdb6-35f0-47f6-a2a7-8b7fc8547bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd78ae03980>]}
[0m14:30:47.262268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdd4bdb6-35f0-47f6-a2a7-8b7fc8547bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd767ea0680>]}
[0m14:30:47.264165 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m14:30:47.283188 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:30:47.293645 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:30:47.294765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cdd4bdb6-35f0-47f6-a2a7-8b7fc8547bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd78ae04fb0>]}
[0m14:30:49.579060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdd4bdb6-35f0-47f6-a2a7-8b7fc8547bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd767737020>]}
[0m14:30:49.614326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdd4bdb6-35f0-47f6-a2a7-8b7fc8547bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7675bb680>]}
[0m14:30:49.616434 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m14:30:49.618669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdd4bdb6-35f0-47f6-a2a7-8b7fc8547bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7675fede0>]}
[0m14:30:49.621055 [warn ] [MainThread]: The selection criterion 'stg_flights' does not match any nodes
[0m14:30:49.625267 [info ] [MainThread]: 
[0m14:30:49.627268 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:30:49.629407 [debug] [MainThread]: Command end result
[0m14:30:49.668921 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.703408, "process_user_time": 8.558564, "process_kernel_time": 0.658351, "process_mem_max_rss": "255024", "process_in_blocks": "10944", "process_out_blocks": "0"}
[0m14:30:49.670873 [debug] [MainThread]: Command `dbt run` succeeded at 14:30:49.670294 after 4.71 seconds
[0m14:30:49.672707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd78b9b0770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd78b5e0440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd76643caa0>]}
[0m14:30:49.674270 [debug] [MainThread]: Flushing usage events
[0m14:32:18.158919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7fb74e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7fb77b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7fb74770>]}


============================== 14:32:18.167566 | dc1bc2e4-bc49-432b-a073-3b8dfd929d53 ==============================
[0m14:32:18.167566 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:32:18.168909 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_flights', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:32:20.089726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc1bc2e4-bc49-432b-a073-3b8dfd929d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6070b740>]}
[0m14:32:20.286958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc1bc2e4-bc49-432b-a073-3b8dfd929d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6072fd70>]}
[0m14:32:20.288337 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m14:32:20.309613 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:32:20.472023 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m14:32:20.473472 [debug] [MainThread]: Partial parsing: added file: DB_project://models/stg_flights.sql
[0m14:32:20.474444 [debug] [MainThread]: Partial parsing: deleted file: DB_project://models/staging_model.sql
[0m14:32:20.964157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc1bc2e4-bc49-432b-a073-3b8dfd929d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae602436e0>]}
[0m14:32:21.075402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc1bc2e4-bc49-432b-a073-3b8dfd929d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6038c590>]}
[0m14:32:21.080253 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m14:32:21.082847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc1bc2e4-bc49-432b-a073-3b8dfd929d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae602dcc20>]}
[0m14:32:21.092505 [info ] [MainThread]: 
[0m14:32:21.096430 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:32:21.100317 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m14:32:21.108454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:21.658599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m14:32:21.659626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:32:22.020943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc1bc2e4-bc49-432b-a073-3b8dfd929d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae60326810>]}
[0m14:32:22.023251 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:32:22.024732 [info ] [MainThread]: 
[0m14:32:22.035894 [debug] [Thread-1 (]: Began running node model.DB_project.stg_flights
[0m14:32:22.037267 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m14:32:22.039038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.DB_project.stg_flights)
[0m14:32:22.040012 [debug] [Thread-1 (]: Began compiling node model.DB_project.stg_flights
[0m14:32:22.051017 [debug] [Thread-1 (]: Writing injected SQL for node "model.DB_project.stg_flights"
[0m14:32:22.068330 [debug] [Thread-1 (]: Timing info for model.DB_project.stg_flights (compile): 14:32:22.040811 => 14:32:22.067812
[0m14:32:22.069302 [debug] [Thread-1 (]: Began executing node model.DB_project.stg_flights
[0m14:32:22.114923 [debug] [Thread-1 (]: Writing runtime sql for node "model.DB_project.stg_flights"
[0m14:32:22.130998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:22.171531 [debug] [Thread-1 (]: On model.DB_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.DB_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    cast(FlightDate as date) as flight_date,
    extract(year from cast(FlightDate as date)) as flight_year,
    extract(month from cast(FlightDate as date)) as flight_month,
    extract(day from cast(FlightDate as date)) as flight_day,
    DepTimeFormatted as dep_time,
    ArrTimeFormatted as arr_time,
    FlightNumber as flight_num,
    ActualElapsedTime as actual_elapsed_time,

    case 
        when cast(floor(ArrTime / 100) * 60 + (ArrTime % 100) as int) < cast(floor(DepTime / 100) * 60 + (DepTime % 100) as int)
        then (cast(floor(ArrTime / 100) * 60 + (ArrTime % 100) as int) + 1440) - cast(floor(DepTime / 100) * 60 + (DepTime % 100) as int)
        else cast(floor(ArrTime / 100) * 60 + (ArrTime % 100) as int) - cast(floor(DepTime / 100) * 60 + (DepTime % 100) as int)
    end as airtime_minutes,

    ArrDelay as arr_delay,
    DepDelay as dep_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc
from raw_data;


[0m14:32:22.763226 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:a6abed24-adc8-4004-b400-0944b1b40215&page=queryresults
[0m14:32:22.764852 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "," but got "%" at [20:56]; reason: invalidQuery, location: query, message: Syntax error: Expected "," but got "%" at [20:56]')
[0m14:32:23.274880 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:e2b3b5cc-bd26-41bb-8dcf-2a0b754dda67&page=queryresults
[0m14:32:23.276750 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:e2b3b5cc-bd26-41bb-8dcf-2a0b754dda67&page=queryresults
[0m14:32:23.278542 [debug] [Thread-1 (]: Timing info for model.DB_project.stg_flights (execute): 14:32:22.070027 => 14:32:23.277914
[0m14:32:23.291837 [debug] [Thread-1 (]: Database Error in model stg_flights (models/stg_flights.sql)
  Syntax error: Expected "," but got "%" at [20:56]
  compiled Code at target/run/DB_project/models/stg_flights.sql
[0m14:32:23.293069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc1bc2e4-bc49-432b-a073-3b8dfd929d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6025f950>]}
[0m14:32:23.294410 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model db_project_dataset.stg_flights ............ [[31mERROR[0m in 1.25s]
[0m14:32:23.295977 [debug] [Thread-1 (]: Finished running node model.DB_project.stg_flights
[0m14:32:23.302673 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:23.305527 [debug] [MainThread]: Connection 'model.DB_project.stg_flights' was properly closed.
[0m14:32:23.308034 [info ] [MainThread]: 
[0m14:32:23.310942 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.21 seconds (2.21s).
[0m14:32:23.314230 [debug] [MainThread]: Command end result
[0m14:32:23.362834 [info ] [MainThread]: 
[0m14:32:23.364347 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:32:23.365515 [info ] [MainThread]: 
[0m14:32:23.366921 [error] [MainThread]:   Database Error in model stg_flights (models/stg_flights.sql)
  Syntax error: Expected "," but got "%" at [20:56]
  compiled Code at target/run/DB_project/models/stg_flights.sql
[0m14:32:23.368116 [info ] [MainThread]: 
[0m14:32:23.369423 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:32:23.372249 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.315644, "process_user_time": 8.290957, "process_kernel_time": 0.837067, "process_mem_max_rss": "260216", "process_in_blocks": "1184", "command_success": false, "process_out_blocks": "0"}
[0m14:32:23.373735 [debug] [MainThread]: Command `dbt run` failed at 14:32:23.373446 after 5.32 seconds
[0m14:32:23.374842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7fb31370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae841af1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae602a5970>]}
[0m14:32:23.376062 [debug] [MainThread]: Flushing usage events
[0m14:35:45.985609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc79d6e6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc79fd0770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc79e13f20>]}


============================== 14:35:45.994670 | 5926cfb5-4916-4055-bf73-e6deab2dc328 ==============================
[0m14:35:45.994670 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:35:45.996043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models stg_flights', 'send_anonymous_usage_stats': 'True'}
[0m14:35:47.473530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5926cfb5-4916-4055-bf73-e6deab2dc328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc571470b0>]}
[0m14:35:47.712662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5926cfb5-4916-4055-bf73-e6deab2dc328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc56b5f0e0>]}
[0m14:35:47.714507 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m14:35:47.741650 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:35:47.957343 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:35:47.958727 [debug] [MainThread]: Partial parsing: updated file: DB_project://models/stg_flights.sql
[0m14:35:48.354410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5926cfb5-4916-4055-bf73-e6deab2dc328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc56463320>]}
[0m14:35:48.423410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5926cfb5-4916-4055-bf73-e6deab2dc328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc567382c0>]}
[0m14:35:48.425746 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m14:35:48.431230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5926cfb5-4916-4055-bf73-e6deab2dc328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc564e5490>]}
[0m14:35:48.439537 [info ] [MainThread]: 
[0m14:35:48.444808 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:35:48.448686 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m14:35:48.450679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:48.909331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m14:35:48.910819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:49.259865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5926cfb5-4916-4055-bf73-e6deab2dc328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc56738e30>]}
[0m14:35:49.262744 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:35:49.264615 [info ] [MainThread]: 
[0m14:35:49.279964 [debug] [Thread-1 (]: Began running node model.DB_project.stg_flights
[0m14:35:49.281333 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m14:35:49.283073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.DB_project.stg_flights)
[0m14:35:49.285205 [debug] [Thread-1 (]: Began compiling node model.DB_project.stg_flights
[0m14:35:49.299766 [debug] [Thread-1 (]: Writing injected SQL for node "model.DB_project.stg_flights"
[0m14:35:49.314748 [debug] [Thread-1 (]: Timing info for model.DB_project.stg_flights (compile): 14:35:49.286719 => 14:35:49.314194
[0m14:35:49.315891 [debug] [Thread-1 (]: Began executing node model.DB_project.stg_flights
[0m14:35:49.406284 [debug] [Thread-1 (]: Writing runtime sql for node "model.DB_project.stg_flights"
[0m14:35:49.417546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:49.463875 [debug] [Thread-1 (]: On model.DB_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.DB_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    cast(FlightDate as date) as flight_date,
    extract(year from cast(FlightDate as date)) as flight_year,
    extract(month from cast(FlightDate as date)) as flight_month,
    extract(day from cast(FlightDate as date)) as flight_day,
    DepTimeFormatted as dep_time,
    ArrTimeFormatted as arr_time,
    FlightNumber as flight_num,
    ActualElapsedTime as actual_elapsed_time,

    case 
        when cast(floor(ArrTime / 100) * 60 + (ArrTime - floor(ArrTime / 100) * 100) as int)  < cast(floor(DepTime / 100) * 60 + (DepTime - floor(DepTime / 100) * 100) as int)
        then (cast(floor(ArrTime / 100) * 60 + (ArrTime - floor(ArrTime / 100) * 100) as int) + 1440) - cast(floor(DepTime / 100) * 60 + (DepTime - floor(DepTime / 100) * 100) as int)
        else cast(floor(ArrTime / 100) * 60 + (ArrTime - floor(ArrTime / 100) * 100) as int) - cast(floor(DepTime / 100) * 60 + (DepTime - floor(DepTime / 100) * 100) as int)
    end as airtime_minutes,

    ArrDelay as arr_delay,
    DepDelay as dep_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc
from raw_data;


[0m14:35:50.522587 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:4b4efef3-2a52-4456-865d-c7bcef68afbe&page=queryresults
[0m14:35:50.759837 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: FlightNumber; Did you mean FlightNum? at [16:5]; reason: invalidQuery, location: query, message: Unrecognized name: FlightNumber; Did you mean FlightNum? at [16:5]')
[0m14:35:52.486709 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:d044c4c0-4660-402a-8879-15903e65eab8&page=queryresults
[0m14:35:52.645840 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:d044c4c0-4660-402a-8879-15903e65eab8&page=queryresults
[0m14:35:52.647935 [debug] [Thread-1 (]: Timing info for model.DB_project.stg_flights (execute): 14:35:49.316906 => 14:35:52.647321
[0m14:35:52.657558 [debug] [Thread-1 (]: Database Error in model stg_flights (models/stg_flights.sql)
  Unrecognized name: FlightNumber; Did you mean FlightNum? at [16:5]
  compiled Code at target/run/DB_project/models/stg_flights.sql
[0m14:35:52.658668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5926cfb5-4916-4055-bf73-e6deab2dc328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc564a3ec0>]}
[0m14:35:52.659828 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model db_project_dataset.stg_flights ............ [[31mERROR[0m in 3.38s]
[0m14:35:52.661300 [debug] [Thread-1 (]: Finished running node model.DB_project.stg_flights
[0m14:35:52.665152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:52.666217 [debug] [MainThread]: Connection 'model.DB_project.stg_flights' was properly closed.
[0m14:35:52.667112 [info ] [MainThread]: 
[0m14:35:52.668236 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.22 seconds (4.22s).
[0m14:35:52.669727 [debug] [MainThread]: Command end result
[0m14:35:52.693878 [info ] [MainThread]: 
[0m14:35:52.695159 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:35:52.696212 [info ] [MainThread]: 
[0m14:35:52.697269 [error] [MainThread]:   Database Error in model stg_flights (models/stg_flights.sql)
  Unrecognized name: FlightNumber; Did you mean FlightNum? at [16:5]
  compiled Code at target/run/DB_project/models/stg_flights.sql
[0m14:35:52.698311 [info ] [MainThread]: 
[0m14:35:52.699608 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:35:52.701685 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.822738, "process_user_time": 6.947479, "process_kernel_time": 0.745092, "process_mem_max_rss": "260228", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:35:52.702913 [debug] [MainThread]: Command `dbt run` failed at 14:35:52.702659 after 6.82 seconds
[0m14:35:52.703887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc7a001fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc79db0e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc564bef90>]}
[0m14:35:52.704914 [debug] [MainThread]: Flushing usage events
[0m14:36:23.947698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4b5a68800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4b5bdc3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4b5a68bf0>]}


============================== 14:36:23.967242 | e7123257-7bea-4843-9b20-230ea9cc23cd ==============================
[0m14:36:23.967242 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:36:23.969241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_flights', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:36:25.907285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7123257-7bea-4843-9b20-230ea9cc23cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4930be840>]}
[0m14:36:26.108763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7123257-7bea-4843-9b20-230ea9cc23cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb498c0a2a0>]}
[0m14:36:26.110213 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m14:36:26.133163 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:36:26.296165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:36:26.297483 [debug] [MainThread]: Partial parsing: updated file: DB_project://models/stg_flights.sql
[0m14:36:26.761609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7123257-7bea-4843-9b20-230ea9cc23cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4923b7d40>]}
[0m14:36:26.805642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7123257-7bea-4843-9b20-230ea9cc23cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49228cbc0>]}
[0m14:36:26.807728 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m14:36:26.810301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7123257-7bea-4843-9b20-230ea9cc23cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb492204560>]}
[0m14:36:26.819135 [info ] [MainThread]: 
[0m14:36:26.824122 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:36:26.827414 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m14:36:26.828926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:27.231200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m14:36:27.232542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:27.586607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7123257-7bea-4843-9b20-230ea9cc23cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4920bd100>]}
[0m14:36:27.588519 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:36:27.589714 [info ] [MainThread]: 
[0m14:36:27.601182 [debug] [Thread-1 (]: Began running node model.DB_project.stg_flights
[0m14:36:27.602606 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m14:36:27.604377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.DB_project.stg_flights)
[0m14:36:27.605466 [debug] [Thread-1 (]: Began compiling node model.DB_project.stg_flights
[0m14:36:27.616188 [debug] [Thread-1 (]: Writing injected SQL for node "model.DB_project.stg_flights"
[0m14:36:27.625828 [debug] [Thread-1 (]: Timing info for model.DB_project.stg_flights (compile): 14:36:27.606209 => 14:36:27.625277
[0m14:36:27.626829 [debug] [Thread-1 (]: Began executing node model.DB_project.stg_flights
[0m14:36:27.671350 [debug] [Thread-1 (]: Writing runtime sql for node "model.DB_project.stg_flights"
[0m14:36:27.681236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:27.721866 [debug] [Thread-1 (]: On model.DB_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.DB_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    cast(FlightDate as date) as flight_date,
    extract(year from cast(FlightDate as date)) as flight_year,
    extract(month from cast(FlightDate as date)) as flight_month,
    extract(day from cast(FlightDate as date)) as flight_day,
    DepTimeFormatted as dep_time,
    ArrTimeFormatted as arr_time,
    FlightNum as flight_num,
    ActualElapsedTime as actual_elapsed_time,

    case 
        when cast(floor(ArrTime / 100) * 60 + (ArrTime - floor(ArrTime / 100) * 100) as int)  < cast(floor(DepTime / 100) * 60 + (DepTime - floor(DepTime / 100) * 100) as int)
        then (cast(floor(ArrTime / 100) * 60 + (ArrTime - floor(ArrTime / 100) * 100) as int) + 1440) - cast(floor(DepTime / 100) * 60 + (DepTime - floor(DepTime / 100) * 100) as int)
        else cast(floor(ArrTime / 100) * 60 + (ArrTime - floor(ArrTime / 100) * 100) as int) - cast(floor(DepTime / 100) * 60 + (DepTime - floor(DepTime / 100) * 100) as int)
    end as airtime_minutes,

    ArrDelay as arr_delay,
    DepDelay as dep_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc
from raw_data;


[0m14:36:28.734648 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:f6f496e0-45ec-4fcf-a958-48f384e299e3&page=queryresults
[0m14:36:28.865398 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator /\n  Argument types: STRING, INT64\n  Signature: FLOAT64 / FLOAT64\n    Argument 1: Unable to coerce type STRING to expected type FLOAT64\n  Signature: NUMERIC / NUMERIC\n    Argument 1: Unable to coerce type STRING to expected type NUMERIC\n  Signature: BIGNUMERIC / BIGNUMERIC\n    Argument 1: Unable to coerce type STRING to expected type BIGNUMERIC\n  Signature: INTERVAL / INT64\n    Argument 1: Unable to coerce type STRING to expected type INTERVAL at [20:25]; reason: invalidQuery, location: query, message: No matching signature for operator /\n  Argument types: STRING, INT64\n  Signature: FLOAT64 / FLOAT64\n    Argument 1: Unable to coerce type STRING to expected type FLOAT64\n  Signature: NUMERIC / NUMERIC\n    Argument 1: Unable to coerce type STRING to expected type NUMERIC\n  Signature: BIGNUMERIC / BIGNUMERIC\n    Argument 1: Unable to coerce type STRING to expected type BIGNUMERIC\n  Signature: INTERVAL / INT64\n    Argument 1: Unable to coerce type STRING to expected type INTERVAL at [20:25]')
[0m14:36:29.912534 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:d58fee04-3698-4282-aa06-d1c7ea1b1ae7&page=queryresults
[0m14:36:30.076192 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:d58fee04-3698-4282-aa06-d1c7ea1b1ae7&page=queryresults
[0m14:36:30.079622 [debug] [Thread-1 (]: Timing info for model.DB_project.stg_flights (execute): 14:36:27.627605 => 14:36:30.078437
[0m14:36:30.093901 [debug] [Thread-1 (]: Database Error in model stg_flights (models/stg_flights.sql)
  No matching signature for operator /
    Argument types: STRING, INT64
    Signature: FLOAT64 / FLOAT64
      Argument 1: Unable to coerce type STRING to expected type FLOAT64
    Signature: NUMERIC / NUMERIC
      Argument 1: Unable to coerce type STRING to expected type NUMERIC
    Signature: BIGNUMERIC / BIGNUMERIC
      Argument 1: Unable to coerce type STRING to expected type BIGNUMERIC
    Signature: INTERVAL / INT64
      Argument 1: Unable to coerce type STRING to expected type INTERVAL at [20:25]
  compiled Code at target/run/DB_project/models/stg_flights.sql
[0m14:36:30.097343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7123257-7bea-4843-9b20-230ea9cc23cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4921675c0>]}
[0m14:36:30.101049 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model db_project_dataset.stg_flights ............ [[31mERROR[0m in 2.49s]
[0m14:36:30.102717 [debug] [Thread-1 (]: Finished running node model.DB_project.stg_flights
[0m14:36:30.113203 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:36:30.115455 [debug] [MainThread]: Connection 'model.DB_project.stg_flights' was properly closed.
[0m14:36:30.117365 [info ] [MainThread]: 
[0m14:36:30.119421 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.30 seconds (3.30s).
[0m14:36:30.129521 [debug] [MainThread]: Command end result
[0m14:36:30.164980 [info ] [MainThread]: 
[0m14:36:30.166647 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:36:30.168195 [info ] [MainThread]: 
[0m14:36:30.169696 [error] [MainThread]:   Database Error in model stg_flights (models/stg_flights.sql)
  No matching signature for operator /
    Argument types: STRING, INT64
    Signature: FLOAT64 / FLOAT64
      Argument 1: Unable to coerce type STRING to expected type FLOAT64
    Signature: NUMERIC / NUMERIC
      Argument 1: Unable to coerce type STRING to expected type NUMERIC
    Signature: BIGNUMERIC / BIGNUMERIC
      Argument 1: Unable to coerce type STRING to expected type BIGNUMERIC
    Signature: INTERVAL / INT64
      Argument 1: Unable to coerce type STRING to expected type INTERVAL at [20:25]
  compiled Code at target/run/DB_project/models/stg_flights.sql
[0m14:36:30.171632 [info ] [MainThread]: 
[0m14:36:30.174988 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:36:30.179395 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.465526, "process_user_time": 8.787096, "process_kernel_time": 0.76235, "process_mem_max_rss": "259928", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:36:30.181103 [debug] [MainThread]: Command `dbt run` failed at 14:36:30.180712 after 6.47 seconds
[0m14:36:30.182278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4b5b73410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4b5b70ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4b5a68bf0>]}
[0m14:36:30.183274 [debug] [MainThread]: Flushing usage events
[0m14:37:01.675061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b8fc979b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b8fc96210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b8fc972c0>]}


============================== 14:37:01.728892 | 6dd23a5a-584f-407c-891b-323d48dd8ba8 ==============================
[0m14:37:01.728892 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:37:01.733561 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models stg_flights', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:37:03.789773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dd23a5a-584f-407c-891b-323d48dd8ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b706b5670>]}
[0m14:37:04.134215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dd23a5a-584f-407c-891b-323d48dd8ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b7096d8b0>]}
[0m14:37:04.136075 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m14:37:04.170343 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:37:04.512717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:37:04.514059 [debug] [MainThread]: Partial parsing: updated file: DB_project://models/stg_flights.sql
[0m14:37:05.213842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dd23a5a-584f-407c-891b-323d48dd8ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b70357230>]}
[0m14:37:05.255031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dd23a5a-584f-407c-891b-323d48dd8ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b7068cc50>]}
[0m14:37:05.257787 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m14:37:05.261947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dd23a5a-584f-407c-891b-323d48dd8ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b70434860>]}
[0m14:37:05.267300 [info ] [MainThread]: 
[0m14:37:05.270305 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:37:05.274622 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m14:37:05.279485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:05.679200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m14:37:05.680725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:37:06.088779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dd23a5a-584f-407c-891b-323d48dd8ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b70436d80>]}
[0m14:37:06.091944 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:37:06.095245 [info ] [MainThread]: 
[0m14:37:06.490870 [debug] [Thread-1 (]: Began running node model.DB_project.stg_flights
[0m14:37:06.492638 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m14:37:06.495314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.DB_project.stg_flights)
[0m14:37:06.496768 [debug] [Thread-1 (]: Began compiling node model.DB_project.stg_flights
[0m14:37:06.522807 [debug] [Thread-1 (]: Writing injected SQL for node "model.DB_project.stg_flights"
[0m14:37:06.535479 [debug] [Thread-1 (]: Timing info for model.DB_project.stg_flights (compile): 14:37:06.497836 => 14:37:06.534500
[0m14:37:06.537031 [debug] [Thread-1 (]: Began executing node model.DB_project.stg_flights
[0m14:37:06.688748 [debug] [Thread-1 (]: Writing runtime sql for node "model.DB_project.stg_flights"
[0m14:37:06.699831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:06.775619 [debug] [Thread-1 (]: On model.DB_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.DB_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    cast(FlightDate as date) as flight_date,
    extract(year from cast(FlightDate as date)) as flight_year,
    extract(month from cast(FlightDate as date)) as flight_month,
    extract(day from cast(FlightDate as date)) as flight_day,
    DepTimeFormatted as dep_time,
    ArrTimeFormatted as arr_time,
    FlightNum as flight_num,
    ActualElapsedTime as actual_elapsed_time,
    ArrDelay as arr_delay,
    DepDelay as dep_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc
from raw_data;


[0m14:37:07.518500 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:b17b3d21-ab6c-4f63-aac7-144b13baf497&page=queryresults
[0m14:37:07.698043 [debug] [Thread-1 (]: Timing info for model.DB_project.stg_flights (execute): 14:37:06.538060 => 14:37:07.697636
[0m14:37:07.699632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dd23a5a-584f-407c-891b-323d48dd8ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b70321f10>]}
[0m14:37:07.700810 [info ] [Thread-1 (]: 1 of 1 OK created sql view model db_project_dataset.stg_flights ................ [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m14:37:07.702059 [debug] [Thread-1 (]: Finished running node model.DB_project.stg_flights
[0m14:37:07.704925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:07.705996 [debug] [MainThread]: Connection 'model.DB_project.stg_flights' was properly closed.
[0m14:37:07.707540 [info ] [MainThread]: 
[0m14:37:07.708772 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.44 seconds (2.44s).
[0m14:37:07.710176 [debug] [MainThread]: Command end result
[0m14:37:07.732097 [info ] [MainThread]: 
[0m14:37:07.733306 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:37:07.734375 [info ] [MainThread]: 
[0m14:37:07.735608 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:37:07.738322 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.326928, "process_user_time": 9.675984, "process_kernel_time": 0.826644, "process_mem_max_rss": "259420", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:37:07.741195 [debug] [MainThread]: Command `dbt run` succeeded at 14:37:07.740639 after 6.33 seconds
[0m14:37:07.743180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b9425f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b90b36270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b70435c70>]}
[0m14:37:07.744267 [debug] [MainThread]: Flushing usage events
[0m15:18:59.684248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f109e1acce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f109e4d1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f109e1ad760>]}


============================== 15:18:59.694817 | 06c2595c-f9ea-4592-9ec2-c9496afc26d8 ==============================
[0m15:18:59.694817 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:18:59.696473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:18:59.894676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06c2595c-f9ea-4592-9ec2-c9496afc26d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f109e061700>]}
[0m15:18:59.899011 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7vfm0l2n'
[0m15:18:59.900059 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:19:00.195429 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:19:00.198426 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:19:00.295393 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:19:00.319516 [info ] [MainThread]: Updating lock file in file path: /opt/airflow/dbt/package-lock.yml
[0m15:19:00.359097 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qz9jz131'
[0m15:19:00.366905 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:19:07.214772 [info ] [MainThread]: Installed from version 1.3.0
[0m15:19:07.216725 [info ] [MainThread]: Up to date!
[0m15:19:07.219521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '06c2595c-f9ea-4592-9ec2-c9496afc26d8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f109e0b4dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f109e08d910>]}
[0m15:19:07.236682 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 7.698136, "process_user_time": 4.781647, "process_kernel_time": 0.431955, "process_mem_max_rss": "111696", "process_in_blocks": "48", "process_out_blocks": "176"}
[0m15:19:07.243247 [debug] [MainThread]: Command `dbt deps` succeeded at 15:19:07.242630 after 7.71 seconds
[0m15:19:07.245231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10a28071d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f109e1b3ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f109e320ef0>]}
[0m15:19:07.252403 [debug] [MainThread]: Flushing usage events
[0m15:19:13.723947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cfac4860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cfac7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cfac4830>]}


============================== 15:19:13.733935 | f325c220-5c71-44c6-b650-a9c44bdc1552 ==============================
[0m15:19:13.733935 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:19:13.735334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_flights', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:19:15.646603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f325c220-5c71-44c6-b650-a9c44bdc1552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47b091d0d0>]}
[0m15:19:15.907831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f325c220-5c71-44c6-b650-a9c44bdc1552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47b0fa1af0>]}
[0m15:19:15.910283 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m15:19:15.972082 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:19:16.020309 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:19:16.022542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f325c220-5c71-44c6-b650-a9c44bdc1552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47b03709e0>]}
[0m15:19:19.921827 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_flights (models/stg_flights.sql)
  
  Warning: `dbt_utils.surrogate_key` has been replaced by `dbt_utils.generate_surrogate_key`. The new macro treats null values differently to empty strings. To restore the behaviour of the original macro, add a global variable in dbt_project.yml called `surrogate_key_treat_nulls_as_empty_strings` to your dbt_project.yml file with a value of True. The DB_project.stg_flights model triggered this warning. 
  
  > in macro default__surrogate_key (macros/sql/surrogate_key.sql)
  > called by macro surrogate_key (macros/sql/surrogate_key.sql)
  > called by model stg_flights (models/stg_flights.sql)
[0m15:19:19.923899 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.308513, "process_user_time": 10.139698, "process_kernel_time": 0.818043, "process_mem_max_rss": "252312", "process_in_blocks": "3984", "process_out_blocks": "16", "command_success": false}
[0m15:19:19.925205 [debug] [MainThread]: Command `dbt run` failed at 15:19:19.924916 after 6.31 seconds
[0m15:19:19.926362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cfce4740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47b0361e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47b0387c80>]}
[0m15:19:19.927425 [debug] [MainThread]: Flushing usage events
[0m15:20:17.115850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa622067080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa621f7a900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa621fbe180>]}


============================== 15:20:17.125426 | a4adda03-cb30-43e9-8553-67084041f3a3 ==============================
[0m15:20:17.125426 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:20:17.126865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m15:20:17.325533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4adda03-cb30-43e9-8553-67084041f3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa622067080>]}
[0m15:20:17.714382 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-07rv2605'
[0m15:20:17.717412 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:20:17.837678 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:20:17.840541 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:20:17.957249 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:20:17.968696 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:20:24.249692 [info ] [MainThread]: Installed from version 1.3.0
[0m15:20:24.251174 [info ] [MainThread]: Up to date!
[0m15:20:24.252682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a4adda03-cb30-43e9-8553-67084041f3a3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa621d640e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa621d64080>]}
[0m15:20:24.255100 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 7.2435765, "process_user_time": 6.401634, "process_kernel_time": 0.473821, "process_mem_max_rss": "111512", "process_in_blocks": "16", "process_out_blocks": "176"}
[0m15:20:24.256596 [debug] [MainThread]: Command `dbt deps` succeeded at 15:20:24.256178 after 7.25 seconds
[0m15:20:24.258163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa62201eea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6265871d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa622e81070>]}
[0m15:20:24.260376 [debug] [MainThread]: Flushing usage events
[0m15:20:32.002631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd385daa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd38638170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd3a6e9070>]}


============================== 15:20:32.026020 | 3bf5f67f-faf9-4782-831c-8eab8df14a59 ==============================
[0m15:20:32.026020 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:20:32.027712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models stg_flights', 'send_anonymous_usage_stats': 'True'}
[0m15:20:35.440681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3bf5f67f-faf9-4782-831c-8eab8df14a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd1646dc70>]}
[0m15:20:35.814118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3bf5f67f-faf9-4782-831c-8eab8df14a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd1522d5b0>]}
[0m15:20:35.816447 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m15:20:35.917917 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:20:35.968591 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:20:35.969921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3bf5f67f-faf9-4782-831c-8eab8df14a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd14e70530>]}
[0m15:20:39.882467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bf5f67f-faf9-4782-831c-8eab8df14a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd14c58860>]}
[0m15:20:39.932199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bf5f67f-faf9-4782-831c-8eab8df14a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd14c5b1a0>]}
[0m15:20:39.934334 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m15:20:39.935859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bf5f67f-faf9-4782-831c-8eab8df14a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd14fc6ff0>]}
[0m15:20:39.941416 [info ] [MainThread]: 
[0m15:20:39.945851 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:20:39.949206 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m15:20:39.951079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:40.401857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m15:20:40.403768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:40.777069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bf5f67f-faf9-4782-831c-8eab8df14a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd14ebef60>]}
[0m15:20:40.779644 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:20:40.781591 [info ] [MainThread]: 
[0m15:20:40.795204 [debug] [Thread-1 (]: Began running node model.DB_project.stg_flights
[0m15:20:40.796749 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m15:20:40.798612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.DB_project.stg_flights)
[0m15:20:40.799771 [debug] [Thread-1 (]: Began compiling node model.DB_project.stg_flights
[0m15:20:40.814188 [debug] [Thread-1 (]: Timing info for model.DB_project.stg_flights (compile): 15:20:40.800599 => 15:20:40.813716
[0m15:20:40.820543 [debug] [Thread-1 (]: Compilation Error in model stg_flights (models/stg_flights.sql)
  'dict object' has no attribute 'generate'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:20:40.821908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bf5f67f-faf9-4782-831c-8eab8df14a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd07983800>]}
[0m15:20:40.823823 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model db_project_dataset.stg_flights ............ [[31mERROR[0m in 0.02s]
[0m15:20:40.826402 [debug] [Thread-1 (]: Finished running node model.DB_project.stg_flights
[0m15:20:40.830937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:40.832180 [debug] [MainThread]: Connection 'model.DB_project.stg_flights' was properly closed.
[0m15:20:40.833239 [info ] [MainThread]: 
[0m15:20:40.834336 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m15:20:40.835928 [debug] [MainThread]: Command end result
[0m15:20:40.876146 [info ] [MainThread]: 
[0m15:20:40.878301 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:20:40.879678 [info ] [MainThread]: 
[0m15:20:40.880939 [error] [MainThread]:   Compilation Error in model stg_flights (models/stg_flights.sql)
  'dict object' has no attribute 'generate'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:20:40.882653 [info ] [MainThread]: 
[0m15:20:40.884279 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:20:40.887232 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.133324, "process_user_time": 11.403333, "process_kernel_time": 0.994611, "process_mem_max_rss": "262592", "process_in_blocks": "8720", "command_success": false, "process_out_blocks": "0"}
[0m15:20:40.889225 [debug] [MainThread]: Command `dbt run` failed at 15:20:40.888704 after 9.14 seconds
[0m15:20:40.891276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd3cba3200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd38902ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd14cad520>]}
[0m15:20:40.892700 [debug] [MainThread]: Flushing usage events
[0m15:21:45.788581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39631c0e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39632087a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39631c0b30>]}


============================== 15:21:45.801711 | a732e39d-9993-4b25-8f76-e405bc14fdaf ==============================
[0m15:21:45.801711 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:21:45.804808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:21:46.148789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a732e39d-9993-4b25-8f76-e405bc14fdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39631c7b00>]}
[0m15:21:46.627198 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-x_46rijv'
[0m15:21:46.628104 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:21:46.722981 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:21:46.725757 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:21:46.816798 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:21:46.828739 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:21:51.890206 [info ] [MainThread]: Installed from version 1.3.0
[0m15:21:51.891249 [info ] [MainThread]: Up to date!
[0m15:21:51.892120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a732e39d-9993-4b25-8f76-e405bc14fdaf', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39630be090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39630bfb90>]}
[0m15:21:51.893793 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 6.2822366, "process_user_time": 4.838738, "process_kernel_time": 0.436196, "process_mem_max_rss": "111944", "process_in_blocks": "912", "process_out_blocks": "176"}
[0m15:21:51.894709 [debug] [MainThread]: Command `dbt deps` succeeded at 15:21:51.894484 after 6.28 seconds
[0m15:21:51.895477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396758f740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39637e29f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3963268ef0>]}
[0m15:21:51.896305 [debug] [MainThread]: Flushing usage events
[0m15:21:57.562227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18954471a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f189548c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1895445310>]}


============================== 15:21:57.574578 | d5290843-dcab-4a63-9100-22ad14745829 ==============================
[0m15:21:57.574578 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:21:57.576547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_flights', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:21:59.257530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5290843-dcab-4a63-9100-22ad14745829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1871ff0980>]}
[0m15:21:59.465703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5290843-dcab-4a63-9100-22ad14745829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18721b4cb0>]}
[0m15:21:59.467135 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m15:21:59.509350 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:22:00.724690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:22:00.727431 [debug] [MainThread]: Partial parsing: updated file: DB_project://models/stg_flights.sql
[0m15:22:01.326093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5290843-dcab-4a63-9100-22ad14745829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1871b2cfe0>]}
[0m15:22:01.388316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5290843-dcab-4a63-9100-22ad14745829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1871dd5370>]}
[0m15:22:01.390705 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m15:22:01.393419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5290843-dcab-4a63-9100-22ad14745829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1871a55be0>]}
[0m15:22:01.407000 [info ] [MainThread]: 
[0m15:22:01.410618 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:22:01.415770 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m15:22:01.417885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:01.828158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m15:22:01.829954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:02.160768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5290843-dcab-4a63-9100-22ad14745829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18726e4560>]}
[0m15:22:02.162833 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:22:02.164618 [info ] [MainThread]: 
[0m15:22:03.178739 [debug] [Thread-1 (]: Began running node model.DB_project.stg_flights
[0m15:22:03.180442 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m15:22:03.182625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.DB_project.stg_flights)
[0m15:22:03.183948 [debug] [Thread-1 (]: Began compiling node model.DB_project.stg_flights
[0m15:22:03.205263 [debug] [Thread-1 (]: Writing injected SQL for node "model.DB_project.stg_flights"
[0m15:22:03.219516 [debug] [Thread-1 (]: Timing info for model.DB_project.stg_flights (compile): 15:22:03.184893 => 15:22:03.218744
[0m15:22:03.221245 [debug] [Thread-1 (]: Began executing node model.DB_project.stg_flights
[0m15:22:03.294921 [debug] [Thread-1 (]: Writing runtime sql for node "model.DB_project.stg_flights"
[0m15:22:03.309541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:03.380246 [debug] [Thread-1 (]: On model.DB_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.DB_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    extract(year from cast(FlightDate as date)) as flight_year,
    extract(month from cast(FlightDate as date)) as flight_month,
    extract(day from cast(FlightDate as date)) as flight_day,
    DepTimeFormatted as dep_time,
    ArrTimeFormatted as arr_time,
    FlightNum as flight_num,
    ActualElapsedTime as actual_elapsed_time,
    ArrDelay as arr_delay,
    DepDelay as dep_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m15:22:03.816572 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:73aea34a-ef89-467d-9b48-5bc5780a6878&page=queryresults
[0m15:22:04.108302 [debug] [Thread-1 (]: Timing info for model.DB_project.stg_flights (execute): 15:22:03.222449 => 15:22:04.107897
[0m15:22:04.110484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5290843-dcab-4a63-9100-22ad14745829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1871dd7350>]}
[0m15:22:04.112322 [info ] [Thread-1 (]: 1 of 1 OK created sql view model db_project_dataset.stg_flights ................ [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m15:22:04.114449 [debug] [Thread-1 (]: Finished running node model.DB_project.stg_flights
[0m15:22:04.118949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:04.121284 [debug] [MainThread]: Connection 'model.DB_project.stg_flights' was properly closed.
[0m15:22:04.123511 [info ] [MainThread]: 
[0m15:22:04.124891 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.71 seconds (2.71s).
[0m15:22:04.126312 [debug] [MainThread]: Command end result
[0m15:22:04.166849 [info ] [MainThread]: 
[0m15:22:04.170886 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:04.173326 [info ] [MainThread]: 
[0m15:22:04.175023 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:22:04.177310 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.732887, "process_user_time": 8.345944, "process_kernel_time": 0.874978, "process_mem_max_rss": "261356", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:04.182054 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:04.180907 after 6.74 seconds
[0m15:22:04.183784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1899a0f200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1895403770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1895449bb0>]}
[0m15:22:04.189366 [debug] [MainThread]: Flushing usage events
[0m16:37:32.859752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e10bc0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e1015a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e10135f0>]}


============================== 16:37:32.870253 | f3f37c07-b523-42dd-badf-cccadce9ed4c ==============================
[0m16:37:32.870253 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:37:32.871655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:37:33.087799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3f37c07-b523-42dd-badf-cccadce9ed4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e1016030>]}
[0m16:37:33.538155 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-eukj1qri'
[0m16:37:33.539440 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:37:34.660689 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:37:34.663051 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:37:34.801793 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:37:34.811994 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:37:38.878752 [info ] [MainThread]: Installed from version 1.3.0
[0m16:37:38.880303 [info ] [MainThread]: Up to date!
[0m16:37:38.881664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f3f37c07-b523-42dd-badf-cccadce9ed4c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e0f0e4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e0f0f830>]}
[0m16:37:38.884380 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 6.1457167, "process_user_time": 4.483232, "process_kernel_time": 0.403983, "process_mem_max_rss": "111844", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m16:37:38.885695 [debug] [MainThread]: Command `dbt deps` succeeded at 16:37:38.885448 after 6.15 seconds
[0m16:37:38.886881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e1187290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e169a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e0ef3740>]}
[0m16:37:38.888065 [debug] [MainThread]: Flushing usage events
[0m16:37:45.950328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fc076f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fc0aa2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fc076d490>]}


============================== 16:37:45.958678 | 543f83b9-2b2b-43ee-aa4f-33d7c1f1d185 ==============================
[0m16:37:45.958678 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:37:45.959985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_flights', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:37:47.575495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '543f83b9-2b2b-43ee-aa4f-33d7c1f1d185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f9fe2ee10>]}
[0m16:37:47.796120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '543f83b9-2b2b-43ee-aa4f-33d7c1f1d185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f9d3f7e30>]}
[0m16:37:47.797714 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:37:47.838111 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:37:47.871574 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m16:37:47.872839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '543f83b9-2b2b-43ee-aa4f-33d7c1f1d185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f9d23a5a0>]}
[0m16:37:51.380243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '543f83b9-2b2b-43ee-aa4f-33d7c1f1d185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f87c658b0>]}
[0m16:37:51.443202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '543f83b9-2b2b-43ee-aa4f-33d7c1f1d185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f87c9dca0>]}
[0m16:37:51.446159 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:37:51.449665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '543f83b9-2b2b-43ee-aa4f-33d7c1f1d185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f9d238050>]}
[0m16:37:51.459592 [info ] [MainThread]: 
[0m16:37:51.465650 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:37:51.470347 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:37:51.471891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:51.937831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:37:51.939186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:52.272738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '543f83b9-2b2b-43ee-aa4f-33d7c1f1d185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f9d148fe0>]}
[0m16:37:52.274794 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:37:52.276269 [info ] [MainThread]: 
[0m16:37:52.294934 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m16:37:52.296372 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m16:37:52.298143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.stg_flights)
[0m16:37:52.299339 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m16:37:52.315641 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m16:37:52.329800 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (compile): 16:37:52.300250 => 16:37:52.329258
[0m16:37:52.330741 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m16:37:52.387597 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m16:37:52.404386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:52.461267 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    cast( concat(cast(FlightDate as string), ' ', DepTimeFormatted) as timestamp) as dep_time,
    cast( concat(cast(FlightDate as string), ' ', ArrTimeFormatted) as timestamp) as arr_time,
    FlightNum as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m16:37:53.672552 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:49b4c53c-a455-4151-afa8-822661d78e1a&page=queryresults
[0m16:37:53.929804 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (execute): 16:37:52.331744 => 16:37:53.929443
[0m16:37:53.931437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '543f83b9-2b2b-43ee-aa4f-33d7c1f1d185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f9cf62b70>]}
[0m16:37:53.932856 [info ] [Thread-1 (]: 1 of 1 OK created sql view model db_project_dataset.stg_flights ................ [[32mCREATE VIEW (0 processed)[0m in 1.63s]
[0m16:37:53.934638 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m16:37:53.938362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:53.939410 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m16:37:53.940395 [info ] [MainThread]: 
[0m16:37:53.941587 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.48 seconds (2.48s).
[0m16:37:53.943573 [debug] [MainThread]: Command end result
[0m16:37:53.978773 [info ] [MainThread]: 
[0m16:37:53.980006 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:37:53.981080 [info ] [MainThread]: 
[0m16:37:53.982254 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:37:53.984288 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.137541, "process_user_time": 9.469152, "process_kernel_time": 0.620599, "process_mem_max_rss": "264808", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:37:53.985885 [debug] [MainThread]: Command `dbt run` succeeded at 16:37:53.985541 after 8.14 seconds
[0m16:37:53.987087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fc0aa2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f87cc8f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fc4dab200>]}
[0m16:37:53.988277 [debug] [MainThread]: Flushing usage events
[0m16:38:00.454272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cab783e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ca9868c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ca95a2870>]}


============================== 16:38:00.462826 | c1fecc43-d4e0-4de5-9edf-cdf947e64d50 ==============================
[0m16:38:00.462826 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:38:00.464170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models core_flights', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:38:01.896088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1fecc43-d4e0-4de5-9edf-cdf947e64d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c861cbc80>]}
[0m16:38:02.089119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1fecc43-d4e0-4de5-9edf-cdf947e64d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c862c42c0>]}
[0m16:38:02.091280 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:38:02.136064 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:38:03.041111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:38:03.041925 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:38:03.050917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1fecc43-d4e0-4de5-9edf-cdf947e64d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c86036300>]}
[0m16:38:03.083863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1fecc43-d4e0-4de5-9edf-cdf947e64d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c85fd84d0>]}
[0m16:38:03.085200 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:38:03.086553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1fecc43-d4e0-4de5-9edf-cdf947e64d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c85ef2690>]}
[0m16:38:03.089233 [info ] [MainThread]: 
[0m16:38:03.092445 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:38:03.095140 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:38:03.096262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:03.494735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:38:03.496542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:03.793951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1fecc43-d4e0-4de5-9edf-cdf947e64d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c85ef3020>]}
[0m16:38:03.796187 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:38:03.797681 [info ] [MainThread]: 
[0m16:38:03.811018 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m16:38:03.812441 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m16:38:03.814072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m16:38:03.815127 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m16:38:03.826827 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m16:38:03.843838 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 16:38:03.815889 => 16:38:03.843327
[0m16:38:03.844886 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m16:38:03.904671 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m16:38:03.925239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:03.967022 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    dep_airport.airport,
    dep_airport.city,
    dep_airport.state,
    dep_airport.country,
    flight_data.dest,
    arr_airport.airport,
    arr_airport.city,
    arr_airport.state,
    arr_airport.country,
from flight_data
inner join airports_data as dep_airport
on flight_data.origin = dep_airport.iata
inner join airports_data as arr_airport
on flight_data.dest = arr_airport.iata
    );
  
[0m16:38:04.430169 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:f85ed76e-652c-4098-96a8-9b83bdaf456e&page=queryresults
[0m16:38:04.432996 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    dep_airport.airport,
    dep_airport.city,
    dep_airport.state,
    dep_airport.country,
    flight_data.dest,
    arr_airport.airport,
    arr_airport.city,
    arr_airport.state,
    arr_airport.country,
from flight_data
inner join airports_data as dep_airport
on flight_data.origin = dep_airport.iata
inner join airports_data as arr_airport
on flight_data.dest = arr_airport.iata
    );
  
[0m16:38:04.435117 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2; reason: notFound, message: Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2

Location: europe-central2
Job ID: f85ed76e-652c-4098-96a8-9b83bdaf456e

[0m16:38:04.437364 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 16:38:03.845677 => 16:38:04.436651
[0m16:38:04.445946 [debug] [Thread-1 (]: Runtime Error in model core_flights (models/core/core_flights.sql)
  404 Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2; reason: notFound, message: Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2
  
  Location: europe-central2
  Job ID: f85ed76e-652c-4098-96a8-9b83bdaf456e
  
[0m16:38:04.447139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1fecc43-d4e0-4de5-9edf-cdf947e64d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c85e2f7a0>]}
[0m16:38:04.448358 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.core_flights .......... [[31mERROR[0m in 0.63s]
[0m16:38:04.449900 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m16:38:04.454869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:04.456196 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m16:38:04.457409 [info ] [MainThread]: 
[0m16:38:04.458754 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.37 seconds (1.37s).
[0m16:38:04.460569 [debug] [MainThread]: Command end result
[0m16:38:04.491468 [info ] [MainThread]: 
[0m16:38:04.492668 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:38:04.493698 [info ] [MainThread]: 
[0m16:38:04.495050 [error] [MainThread]:   Runtime Error in model core_flights (models/core/core_flights.sql)
  404 Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2; reason: notFound, message: Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2
  
  Location: europe-central2
  Job ID: f85ed76e-652c-4098-96a8-9b83bdaf456e
  
[0m16:38:04.496630 [info ] [MainThread]: 
[0m16:38:04.498186 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:38:04.500204 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.148358, "process_user_time": 5.818985, "process_kernel_time": 0.671036, "process_mem_max_rss": "256832", "process_in_blocks": "24", "command_success": false, "process_out_blocks": "0"}
[0m16:38:04.501492 [debug] [MainThread]: Command `dbt run` failed at 16:38:04.501238 after 4.15 seconds
[0m16:38:04.502559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ca990e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c86a71640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c8619d4c0>]}
[0m16:38:04.503809 [debug] [MainThread]: Flushing usage events
[0m16:41:22.411444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f267d5e94c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f267d5e8770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f267d5e8dd0>]}


============================== 16:41:22.422083 | 801164ed-532d-4425-8602-7965aabeacb2 ==============================
[0m16:41:22.422083 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:41:22.423683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models core_flights', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:41:23.841267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '801164ed-532d-4425-8602-7965aabeacb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2660eff8c0>]}
[0m16:41:24.035910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '801164ed-532d-4425-8602-7965aabeacb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f267e8ab9b0>]}
[0m16:41:24.037277 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:41:24.096880 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:41:24.136109 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:41:24.137716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '801164ed-532d-4425-8602-7965aabeacb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f265a035c70>]}
[0m16:41:27.482198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '801164ed-532d-4425-8602-7965aabeacb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2659e3bb00>]}
[0m16:41:27.516333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '801164ed-532d-4425-8602-7965aabeacb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2658bb92e0>]}
[0m16:41:27.517969 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:41:27.519515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '801164ed-532d-4425-8602-7965aabeacb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2658a14f80>]}
[0m16:41:27.523288 [info ] [MainThread]: 
[0m16:41:27.525873 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:41:27.529100 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:41:27.530765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:27.935535 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:41:27.936997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:28.269674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '801164ed-532d-4425-8602-7965aabeacb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f265a00f9b0>]}
[0m16:41:28.271823 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:41:28.273082 [info ] [MainThread]: 
[0m16:41:28.283869 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m16:41:28.285156 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m16:41:28.286888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m16:41:28.287963 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m16:41:28.299507 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m16:41:28.312319 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 16:41:28.288766 => 16:41:28.311806
[0m16:41:28.313357 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m16:41:28.370821 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m16:41:28.383700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:28.424732 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    dep_airport.airport,
    dep_airport.city,
    dep_airport.state,
    dep_airport.country,
    flight_data.dest,
    arr_airport.airport,
    arr_airport.city,
    arr_airport.state,
    arr_airport.country,
from flight_data
inner join airports_data as dep_airport
on flight_data.origin = dep_airport.iata
inner join airports_data as arr_airport
on flight_data.dest = arr_airport.iata
    );
  
[0m16:41:28.877459 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:becbdaaf-36ee-4153-ad12-26fa176e49b5&page=queryresults
[0m16:41:28.879664 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    dep_airport.airport,
    dep_airport.city,
    dep_airport.state,
    dep_airport.country,
    flight_data.dest,
    arr_airport.airport,
    arr_airport.city,
    arr_airport.state,
    arr_airport.country,
from flight_data
inner join airports_data as dep_airport
on flight_data.origin = dep_airport.iata
inner join airports_data as arr_airport
on flight_data.dest = arr_airport.iata
    );
  
[0m16:41:28.881388 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2; reason: notFound, message: Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2

Location: europe-central2
Job ID: becbdaaf-36ee-4153-ad12-26fa176e49b5

[0m16:41:28.883364 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 16:41:28.314037 => 16:41:28.882828
[0m16:41:28.890842 [debug] [Thread-1 (]: Runtime Error in model core_flights (models/core/core_flights.sql)
  404 Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2; reason: notFound, message: Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2
  
  Location: europe-central2
  Job ID: becbdaaf-36ee-4153-ad12-26fa176e49b5
  
[0m16:41:28.892000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '801164ed-532d-4425-8602-7965aabeacb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2659ce4350>]}
[0m16:41:28.893225 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.core_flights .......... [[31mERROR[0m in 0.61s]
[0m16:41:28.894863 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m16:41:28.898795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:28.899683 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m16:41:28.900545 [info ] [MainThread]: 
[0m16:41:28.901670 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.38 seconds (1.38s).
[0m16:41:28.903214 [debug] [MainThread]: Command end result
[0m16:41:28.939792 [info ] [MainThread]: 
[0m16:41:28.941522 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:41:28.943146 [info ] [MainThread]: 
[0m16:41:28.944966 [error] [MainThread]:   Runtime Error in model core_flights (models/core/core_flights.sql)
  404 Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2; reason: notFound, message: Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2
  
  Location: europe-central2
  Job ID: becbdaaf-36ee-4153-ad12-26fa176e49b5
  
[0m16:41:28.946809 [info ] [MainThread]: 
[0m16:41:28.948443 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:41:28.950800 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.7626467, "process_user_time": 8.500776, "process_kernel_time": 0.617875, "process_mem_max_rss": "264012", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:41:28.952385 [debug] [MainThread]: Command `dbt run` failed at 16:41:28.951919 after 6.76 seconds
[0m16:41:28.954069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2681bc7200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2659ce4350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2659bfc2c0>]}
[0m16:41:28.955362 [debug] [MainThread]: Flushing usage events
[0m16:43:41.235797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7482f320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e726a52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e726a5010>]}


============================== 16:43:41.245881 | f28c1c7d-abf8-47e9-b750-e65286ed5e18 ==============================
[0m16:43:41.245881 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:43:41.247292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m16:43:42.822526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f28c1c7d-abf8-47e9-b750-e65286ed5e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4f208830>]}
[0m16:43:43.009188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f28c1c7d-abf8-47e9-b750-e65286ed5e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e729cc740>]}
[0m16:43:43.010440 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:43:43.049504 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:43:43.953238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:43:43.954023 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:43:43.962702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f28c1c7d-abf8-47e9-b750-e65286ed5e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4f022a50>]}
[0m16:43:43.992518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f28c1c7d-abf8-47e9-b750-e65286ed5e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4eeac890>]}
[0m16:43:43.993772 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:43:43.995080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f28c1c7d-abf8-47e9-b750-e65286ed5e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4ee1e300>]}
[0m16:43:43.998457 [info ] [MainThread]: 
[0m16:43:44.001026 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:43:44.003885 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:43:44.005141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:44.619033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:43:44.620793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:43:44.978880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f28c1c7d-abf8-47e9-b750-e65286ed5e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4f1815b0>]}
[0m16:43:44.981034 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:43:44.982432 [info ] [MainThread]: 
[0m16:43:44.993796 [debug] [Thread-1 (]: Began running node seed.flights_project.airports
[0m16:43:44.994973 [info ] [Thread-1 (]: 1 of 1 START seed file db_project_dataset.airports ............................. [RUN]
[0m16:43:44.996492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now seed.flights_project.airports)
[0m16:43:44.997417 [debug] [Thread-1 (]: Began compiling node seed.flights_project.airports
[0m16:43:44.998455 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (compile): 16:43:44.998094 => 16:43:44.998100
[0m16:43:44.999468 [debug] [Thread-1 (]: Began executing node seed.flights_project.airports
[0m16:43:45.160586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:47.551624 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
LOAD TABLE
[0m16:43:47.553310 [debug] [Thread-1 (]: BigQuery adapter: Runtime Error
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3375; errors: 1; max bad: 0; error percent: 0
  Error while reading data, error message: Data between close quote character (") and field separator.; line_number: 1253 byte_offset_to_start_of_line: 89937 column_index: 1 column_name: "airport" column_type: STRING value: "W. H. \\"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m16:43:47.555082 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (execute): 16:43:45.000231 => 16:43:47.554531
[0m16:43:47.562512 [debug] [Thread-1 (]: Runtime Error in seed airports (seeds/airports.csv)
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3375; errors: 1; max bad: 0; error percent: 0
  Error while reading data, error message: Data between close quote character (") and field separator.; line_number: 1253 byte_offset_to_start_of_line: 89937 column_index: 1 column_name: "airport" column_type: STRING value: "W. H. \\"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m16:43:47.563795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f28c1c7d-abf8-47e9-b750-e65286ed5e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e726a9310>]}
[0m16:43:47.565006 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file db_project_dataset.airports ..................... [[31mERROR[0m in 2.57s]
[0m16:43:47.566646 [debug] [Thread-1 (]: Finished running node seed.flights_project.airports
[0m16:43:47.570825 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:47.571758 [debug] [MainThread]: Connection 'seed.flights_project.airports' was properly closed.
[0m16:43:47.572811 [info ] [MainThread]: 
[0m16:43:47.574182 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.57 seconds (3.57s).
[0m16:43:47.576013 [debug] [MainThread]: Command end result
[0m16:43:47.601619 [info ] [MainThread]: 
[0m16:43:47.603028 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:43:47.604084 [info ] [MainThread]: 
[0m16:43:47.605282 [error] [MainThread]:   Runtime Error in seed airports (seeds/airports.csv)
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3375; errors: 1; max bad: 0; error percent: 0
  Error while reading data, error message: Data between close quote character (") and field separator.; line_number: 1253 byte_offset_to_start_of_line: 89937 column_index: 1 column_name: "airport" column_type: STRING value: "W. H. \\"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m16:43:47.606691 [info ] [MainThread]: 
[0m16:43:47.608295 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:43:47.610872 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 6.482304, "process_user_time": 6.543891, "process_kernel_time": 0.677297, "process_mem_max_rss": "260328", "process_in_blocks": "80", "command_success": false, "process_out_blocks": "0"}
[0m16:43:47.612173 [debug] [MainThread]: Command `dbt seed` failed at 16:43:47.611917 after 6.48 seconds
[0m16:43:47.613398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e5410cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e727af5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e727aeae0>]}
[0m16:43:47.614465 [debug] [MainThread]: Flushing usage events
[0m16:45:29.628000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688e9db050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688e9d5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688e9d6c30>]}


============================== 16:45:29.637001 | 4e8a8c7c-cb6c-40d9-aae3-fc9135133b23 ==============================
[0m16:45:29.637001 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:45:29.638504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:45:31.029345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e8a8c7c-cb6c-40d9-aae3-fc9135133b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688e9924e0>]}
[0m16:45:31.235915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e8a8c7c-cb6c-40d9-aae3-fc9135133b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f686b7b4fe0>]}
[0m16:45:31.237304 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:45:31.278501 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:45:31.310794 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:45:31.312173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4e8a8c7c-cb6c-40d9-aae3-fc9135133b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f686b2d1730>]}
[0m16:45:34.958119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e8a8c7c-cb6c-40d9-aae3-fc9135133b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6869fc02f0>]}
[0m16:45:34.992026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e8a8c7c-cb6c-40d9-aae3-fc9135133b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6869fb5a30>]}
[0m16:45:34.993349 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:45:34.994433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e8a8c7c-cb6c-40d9-aae3-fc9135133b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f686aff58b0>]}
[0m16:45:34.997735 [info ] [MainThread]: 
[0m16:45:34.999789 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:45:35.003019 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:45:35.004549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:35.387602 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:45:35.389106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:45:35.731564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e8a8c7c-cb6c-40d9-aae3-fc9135133b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f686b242630>]}
[0m16:45:35.733235 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:45:35.734297 [info ] [MainThread]: 
[0m16:45:35.745236 [debug] [Thread-1 (]: Began running node seed.flights_project.airports
[0m16:45:35.746463 [info ] [Thread-1 (]: 1 of 1 START seed file db_project_dataset.airports ............................. [RUN]
[0m16:45:35.748167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now seed.flights_project.airports)
[0m16:45:35.749172 [debug] [Thread-1 (]: Began compiling node seed.flights_project.airports
[0m16:45:35.750359 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (compile): 16:45:35.749914 => 16:45:35.749920
[0m16:45:35.751526 [debug] [Thread-1 (]: Began executing node seed.flights_project.airports
[0m16:45:35.915919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:38.178706 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
LOAD TABLE
[0m16:45:38.180569 [debug] [Thread-1 (]: BigQuery adapter: Runtime Error
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3375; errors: 1; max bad: 0; error percent: 0
  Error while reading data, error message: Data between close quote character (") and field separator.; line_number: 1253 byte_offset_to_start_of_line: 89937 column_index: 1 column_name: "airport" column_type: STRING value: "W. H. \\"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m16:45:38.182148 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (execute): 16:45:35.752344 => 16:45:38.181657
[0m16:45:38.189050 [debug] [Thread-1 (]: Runtime Error in seed airports (seeds/airports.csv)
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3375; errors: 1; max bad: 0; error percent: 0
  Error while reading data, error message: Data between close quote character (") and field separator.; line_number: 1253 byte_offset_to_start_of_line: 89937 column_index: 1 column_name: "airport" column_type: STRING value: "W. H. \\"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m16:45:38.190446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e8a8c7c-cb6c-40d9-aae3-fc9135133b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68694bf620>]}
[0m16:45:38.191933 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file db_project_dataset.airports ..................... [[31mERROR[0m in 2.44s]
[0m16:45:38.193891 [debug] [Thread-1 (]: Finished running node seed.flights_project.airports
[0m16:45:38.198233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:38.199255 [debug] [MainThread]: Connection 'seed.flights_project.airports' was properly closed.
[0m16:45:38.200353 [info ] [MainThread]: 
[0m16:45:38.201982 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m16:45:38.204289 [debug] [MainThread]: Command end result
[0m16:45:38.244139 [info ] [MainThread]: 
[0m16:45:38.245326 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:45:38.246521 [info ] [MainThread]: 
[0m16:45:38.247785 [error] [MainThread]:   Runtime Error in seed airports (seeds/airports.csv)
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3375; errors: 1; max bad: 0; error percent: 0
  Error while reading data, error message: Data between close quote character (") and field separator.; line_number: 1253 byte_offset_to_start_of_line: 89937 column_index: 1 column_name: "airport" column_type: STRING value: "W. H. \\"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m16:45:38.249342 [info ] [MainThread]: 
[0m16:45:38.251087 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:45:38.254241 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 8.813454, "process_user_time": 8.3038, "process_kernel_time": 0.691983, "process_mem_max_rss": "272380", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:45:38.255430 [debug] [MainThread]: Command `dbt seed` failed at 16:45:38.255184 after 8.81 seconds
[0m16:45:38.256575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688e9db050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f686b242630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688e993b60>]}
[0m16:45:38.257930 [debug] [MainThread]: Flushing usage events
[0m16:46:34.657736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc45135dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc43bbe3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc43544e30>]}


============================== 16:46:34.666641 | ed436a2b-b52b-4fba-86df-83fd44d44ae1 ==============================
[0m16:46:34.666641 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:46:34.668136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models core_flights', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:46:36.039432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed436a2b-b52b-4fba-86df-83fd44d44ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc248d2e70>]}
[0m16:46:36.230019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed436a2b-b52b-4fba-86df-83fd44d44ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc247012b0>]}
[0m16:46:36.231493 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:46:36.269428 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:46:37.198171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:46:37.198997 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:46:37.207889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed436a2b-b52b-4fba-86df-83fd44d44ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc249d1d00>]}
[0m16:46:37.238876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed436a2b-b52b-4fba-86df-83fd44d44ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1fed8bc0>]}
[0m16:46:37.240262 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:46:37.241868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed436a2b-b52b-4fba-86df-83fd44d44ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1fc49e20>]}
[0m16:46:37.244733 [info ] [MainThread]: 
[0m16:46:37.247251 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:46:37.251644 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:46:37.253122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:37.687568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:46:37.689125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:38.012756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed436a2b-b52b-4fba-86df-83fd44d44ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc478ba5a0>]}
[0m16:46:38.015240 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:46:38.016576 [info ] [MainThread]: 
[0m16:46:38.030754 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m16:46:38.032443 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m16:46:38.034303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m16:46:38.035669 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m16:46:38.050051 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m16:46:38.065181 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 16:46:38.036699 => 16:46:38.064542
[0m16:46:38.066830 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m16:46:38.156865 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m16:46:38.168592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:38.287043 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    dep_airport.airport,
    dep_airport.city,
    dep_airport.state,
    dep_airport.country,
    flight_data.dest,
    arr_airport.airport,
    arr_airport.city,
    arr_airport.state,
    arr_airport.country,
from flight_data
inner join airports_data as dep_airport
on flight_data.origin = dep_airport.iata
inner join airports_data as arr_airport
on flight_data.dest = arr_airport.iata
    );
  
[0m16:46:38.703587 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:bb97a94d-f4e1-4e0f-bf34-0447835da959&page=queryresults
[0m16:46:38.705610 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    dep_airport.airport,
    dep_airport.city,
    dep_airport.state,
    dep_airport.country,
    flight_data.dest,
    arr_airport.airport,
    arr_airport.city,
    arr_airport.state,
    arr_airport.country,
from flight_data
inner join airports_data as dep_airport
on flight_data.origin = dep_airport.iata
inner join airports_data as arr_airport
on flight_data.dest = arr_airport.iata
    );
  
[0m16:46:38.707249 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2; reason: notFound, message: Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2

Location: europe-central2
Job ID: bb97a94d-f4e1-4e0f-bf34-0447835da959

[0m16:46:38.709001 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 16:46:38.068221 => 16:46:38.708469
[0m16:46:38.717532 [debug] [Thread-1 (]: Runtime Error in model core_flights (models/core/core_flights.sql)
  404 Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2; reason: notFound, message: Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2
  
  Location: europe-central2
  Job ID: bb97a94d-f4e1-4e0f-bf34-0447835da959
  
[0m16:46:38.718762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed436a2b-b52b-4fba-86df-83fd44d44ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1fc87350>]}
[0m16:46:38.720261 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.core_flights .......... [[31mERROR[0m in 0.69s]
[0m16:46:38.722047 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m16:46:38.727637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:46:38.729189 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m16:46:38.730488 [info ] [MainThread]: 
[0m16:46:38.733200 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.48 seconds (1.48s).
[0m16:46:38.736244 [debug] [MainThread]: Command end result
[0m16:46:38.767347 [info ] [MainThread]: 
[0m16:46:38.769102 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:46:38.770832 [info ] [MainThread]: 
[0m16:46:38.772660 [error] [MainThread]:   Runtime Error in model core_flights (models/core/core_flights.sql)
  404 Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2; reason: notFound, message: Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2
  
  Location: europe-central2
  Job ID: bb97a94d-f4e1-4e0f-bf34-0447835da959
  
[0m16:46:38.774177 [info ] [MainThread]: 
[0m16:46:38.775662 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:46:38.778033 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.234969, "process_user_time": 5.820957, "process_kernel_time": 0.626872, "process_mem_max_rss": "254208", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:46:38.779387 [debug] [MainThread]: Command `dbt run` failed at 16:46:38.779063 after 4.24 seconds
[0m16:46:38.781095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4364b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1fe51460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc247012b0>]}
[0m16:46:38.782466 [debug] [MainThread]: Flushing usage events
[0m16:47:40.465085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea6ddf3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea6cd4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea6c8e4e0>]}


============================== 16:47:40.473651 | 6e40d04b-e6ee-4e16-b35b-b0ea74bc5d71 ==============================
[0m16:47:40.473651 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:47:40.474891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m16:47:42.166689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e40d04b-e6ee-4e16-b35b-b0ea74bc5d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e838516a0>]}
[0m16:47:42.514623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e40d04b-e6ee-4e16-b35b-b0ea74bc5d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e83a4b470>]}
[0m16:47:42.516430 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:47:42.567359 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:47:42.608959 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:47:42.610293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e40d04b-e6ee-4e16-b35b-b0ea74bc5d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e83591460>]}
[0m16:47:46.827311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e40d04b-e6ee-4e16-b35b-b0ea74bc5d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e82295820>]}
[0m16:47:46.890720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e40d04b-e6ee-4e16-b35b-b0ea74bc5d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8366a2a0>]}
[0m16:47:46.896838 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:47:46.899453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e40d04b-e6ee-4e16-b35b-b0ea74bc5d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e822c52b0>]}
[0m16:47:46.906009 [info ] [MainThread]: 
[0m16:47:46.913997 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:47:46.923283 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:47:46.925415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:47.290830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:47:47.292074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:47:47.613789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e40d04b-e6ee-4e16-b35b-b0ea74bc5d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e822c52b0>]}
[0m16:47:47.616080 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:47:47.617342 [info ] [MainThread]: 
[0m16:47:47.629172 [debug] [Thread-1 (]: Began running node seed.flights_project.airports
[0m16:47:47.630426 [info ] [Thread-1 (]: 1 of 1 START seed file db_project_dataset.airports ............................. [RUN]
[0m16:47:47.632191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now seed.flights_project.airports)
[0m16:47:47.633305 [debug] [Thread-1 (]: Began compiling node seed.flights_project.airports
[0m16:47:47.634517 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (compile): 16:47:47.634145 => 16:47:47.634152
[0m16:47:47.635579 [debug] [Thread-1 (]: Began executing node seed.flights_project.airports
[0m16:47:47.800583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:50.385565 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
LOAD TABLE
[0m16:47:50.387733 [debug] [Thread-1 (]: BigQuery adapter: Runtime Error
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3375; errors: 1; max bad: 0; error percent: 0
  Error while reading data, error message: Data between close quote character (") and field separator.; line_number: 1253 byte_offset_to_start_of_line: 89937 column_index: 1 column_name: "airport" column_type: STRING value: "W. H. \\"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m16:47:50.390123 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (execute): 16:47:47.636407 => 16:47:50.389407
[0m16:47:50.402077 [debug] [Thread-1 (]: Runtime Error in seed airports (seeds/airports.csv)
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3375; errors: 1; max bad: 0; error percent: 0
  Error while reading data, error message: Data between close quote character (") and field separator.; line_number: 1253 byte_offset_to_start_of_line: 89937 column_index: 1 column_name: "airport" column_type: STRING value: "W. H. \\"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m16:47:50.404579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e40d04b-e6ee-4e16-b35b-b0ea74bc5d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e82097b30>]}
[0m16:47:50.406736 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file db_project_dataset.airports ..................... [[31mERROR[0m in 2.77s]
[0m16:47:50.411567 [debug] [Thread-1 (]: Finished running node seed.flights_project.airports
[0m16:47:50.417674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:50.419387 [debug] [MainThread]: Connection 'seed.flights_project.airports' was properly closed.
[0m16:47:50.421167 [info ] [MainThread]: 
[0m16:47:50.429011 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.51 seconds (3.51s).
[0m16:47:50.431308 [debug] [MainThread]: Command end result
[0m16:47:50.483071 [info ] [MainThread]: 
[0m16:47:50.485159 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:47:50.486857 [info ] [MainThread]: 
[0m16:47:50.489032 [error] [MainThread]:   Runtime Error in seed airports (seeds/airports.csv)
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3375; errors: 1; max bad: 0; error percent: 0
  Error while reading data, error message: Data between close quote character (") and field separator.; line_number: 1253 byte_offset_to_start_of_line: 89937 column_index: 1 column_name: "airport" column_type: STRING value: "W. H. \\"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m16:47:50.491324 [info ] [MainThread]: 
[0m16:47:50.501114 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:47:50.504389 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 10.222936, "process_user_time": 10.305422, "process_kernel_time": 0.748382, "process_mem_max_rss": "270168", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:47:50.506211 [debug] [MainThread]: Command `dbt seed` failed at 16:47:50.505734 after 10.23 seconds
[0m16:47:50.508200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea7e29760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eab30f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e836fd5b0>]}
[0m16:47:50.511507 [debug] [MainThread]: Flushing usage events
[0m16:49:52.864043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc105d680b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc105c432c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc105c5d9d0>]}


============================== 16:49:52.878522 | 06ce1801-bdda-47e5-924d-33f8e5451b5a ==============================
[0m16:49:52.878522 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:49:52.880871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m16:49:55.520181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06ce1801-bdda-47e5-924d-33f8e5451b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e27e39e0>]}
[0m16:49:55.726174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06ce1801-bdda-47e5-924d-33f8e5451b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e2dd8080>]}
[0m16:49:55.727580 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:49:55.769822 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:49:55.803021 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:49:55.804368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '06ce1801-bdda-47e5-924d-33f8e5451b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e22f5250>]}
[0m16:50:00.257931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06ce1801-bdda-47e5-924d-33f8e5451b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e1029670>]}
[0m16:50:00.312724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06ce1801-bdda-47e5-924d-33f8e5451b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e11baa80>]}
[0m16:50:00.314768 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:50:00.318667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06ce1801-bdda-47e5-924d-33f8e5451b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e24b6f30>]}
[0m16:50:00.323377 [info ] [MainThread]: 
[0m16:50:00.326104 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:50:00.329703 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:50:00.332761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:00.810214 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:50:00.811794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:01.209194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06ce1801-bdda-47e5-924d-33f8e5451b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e24c0800>]}
[0m16:50:01.213512 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:50:01.221422 [info ] [MainThread]: 
[0m16:50:01.440680 [debug] [Thread-1 (]: Began running node seed.flights_project.airports
[0m16:50:01.874987 [info ] [Thread-1 (]: 1 of 1 START seed file db_project_dataset.airports ............................. [RUN]
[0m16:50:01.878473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now seed.flights_project.airports)
[0m16:50:01.880649 [debug] [Thread-1 (]: Began compiling node seed.flights_project.airports
[0m16:50:01.884666 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (compile): 16:50:01.883785 => 16:50:01.883802
[0m16:50:01.886380 [debug] [Thread-1 (]: Began executing node seed.flights_project.airports
[0m16:50:02.170938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:05.511373 [debug] [Thread-1 (]: On seed.flights_project.airports: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.flights_project.airports"} */

    alter table `db-project-456518`.`db_project_dataset`.`airports` set OPTIONS()
  
[0m16:50:05.770270 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:b1db81fe-0b11-40a7-8dac-e32f13d7d978&page=queryresults
[0m16:50:05.986755 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.flights_project.airports"
[0m16:50:06.071370 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (execute): 16:50:01.897659 => 16:50:06.070447
[0m16:50:06.074070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ce1801-bdda-47e5-924d-33f8e5451b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e05fb470>]}
[0m16:50:06.075598 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file db_project_dataset.airports ......................... [[32mINSERT 3376[0m in 4.20s]
[0m16:50:06.078284 [debug] [Thread-1 (]: Finished running node seed.flights_project.airports
[0m16:50:06.086372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:06.087603 [debug] [MainThread]: Connection 'seed.flights_project.airports' was properly closed.
[0m16:50:06.088777 [info ] [MainThread]: 
[0m16:50:06.090120 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.76 seconds (5.76s).
[0m16:50:06.095484 [debug] [MainThread]: Command end result
[0m16:50:06.137740 [info ] [MainThread]: 
[0m16:50:06.139821 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:50:06.141817 [info ] [MainThread]: 
[0m16:50:06.147744 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:50:06.150975 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 13.46952, "process_user_time": 11.432645, "process_kernel_time": 1.013838, "process_mem_max_rss": "273020", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:50:06.152680 [debug] [MainThread]: Command `dbt seed` succeeded at 16:50:06.152288 after 13.47 seconds
[0m16:50:06.154363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e2475c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc105e19be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc105e18830>]}
[0m16:50:06.156541 [debug] [MainThread]: Flushing usage events
[0m16:52:15.180925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8e7f3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8eb9da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8e578c80>]}


============================== 16:52:15.194512 | 5294a394-11e5-40aa-bf0d-4a4d6b46abf2 ==============================
[0m16:52:15.194512 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:52:15.195838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models core_flights', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:52:17.407318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5294a394-11e5-40aa-bf0d-4a4d6b46abf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b1395b0>]}
[0m16:52:17.603130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5294a394-11e5-40aa-bf0d-4a4d6b46abf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b0d7740>]}
[0m16:52:17.604554 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:52:17.654521 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:52:18.599660 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:52:18.600524 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:52:18.609503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5294a394-11e5-40aa-bf0d-4a4d6b46abf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6adc3710>]}
[0m16:52:18.644833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5294a394-11e5-40aa-bf0d-4a4d6b46abf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6af750d0>]}
[0m16:52:18.646480 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:52:18.648025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5294a394-11e5-40aa-bf0d-4a4d6b46abf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8e5769f0>]}
[0m16:52:18.651836 [info ] [MainThread]: 
[0m16:52:18.654088 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:52:18.656832 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:52:18.657842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:19.621997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:52:19.623804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:19.957502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5294a394-11e5-40aa-bf0d-4a4d6b46abf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b113260>]}
[0m16:52:19.960754 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:52:19.964686 [info ] [MainThread]: 
[0m16:52:20.471535 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m16:52:20.475187 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m16:52:20.488205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m16:52:20.491334 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m16:52:20.541249 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m16:52:20.564013 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 16:52:20.512217 => 16:52:20.563239
[0m16:52:20.565575 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m16:52:20.699189 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m16:52:20.715502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:21.047343 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    dep_airport.airport,
    dep_airport.city,
    dep_airport.state,
    dep_airport.country,
    flight_data.dest,
    arr_airport.airport,
    arr_airport.city,
    arr_airport.state,
    arr_airport.country,
from flight_data
inner join airports_data as dep_airport
on flight_data.origin = dep_airport.iata
inner join airports_data as arr_airport
on flight_data.dest = arr_airport.iata
    );
  
[0m16:52:22.077481 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:5eef3928-85dd-465b-8103-1af9e30b69a5&page=queryresults
[0m16:52:22.225533 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name dest not found inside flight_data at [45:16]; reason: invalidQuery, location: query, message: Name dest not found inside flight_data at [45:16]')
[0m16:52:23.242937 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:79592745-2310-4c82-aac6-580f658e9332&page=queryresults
[0m16:52:23.357905 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:79592745-2310-4c82-aac6-580f658e9332&page=queryresults
[0m16:52:23.363052 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 16:52:20.568053 => 16:52:23.361912
[0m16:52:23.393071 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  Name dest not found inside flight_data at [45:16]
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m16:52:23.395067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5294a394-11e5-40aa-bf0d-4a4d6b46abf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6ad324b0>]}
[0m16:52:23.397560 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.core_flights .......... [[31mERROR[0m in 2.91s]
[0m16:52:23.405639 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m16:52:23.411552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:23.412775 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m16:52:23.413914 [info ] [MainThread]: 
[0m16:52:23.415459 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.76 seconds (4.76s).
[0m16:52:23.423695 [debug] [MainThread]: Command end result
[0m16:52:23.528569 [info ] [MainThread]: 
[0m16:52:23.532544 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:52:23.538122 [info ] [MainThread]: 
[0m16:52:23.541896 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  Name dest not found inside flight_data at [45:16]
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m16:52:23.545086 [info ] [MainThread]: 
[0m16:52:23.550158 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:52:23.555652 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.532283, "process_user_time": 7.901645, "process_kernel_time": 0.769787, "process_mem_max_rss": "252812", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:52:23.557678 [debug] [MainThread]: Command `dbt run` failed at 16:52:23.557170 after 8.53 seconds
[0m16:52:23.559497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8f28eb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b08a840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6afd22d0>]}
[0m16:52:23.561509 [debug] [MainThread]: Flushing usage events
[0m16:53:16.744485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3302344230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33033ba840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3302302720>]}


============================== 16:53:16.772762 | 7d58b488-c838-49c0-8253-926526876429 ==============================
[0m16:53:16.772762 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:53:16.783925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models core_flights', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:53:19.290430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d58b488-c838-49c0-8253-926526876429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32df54b170>]}
[0m16:53:19.530661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d58b488-c838-49c0-8253-926526876429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32df3afef0>]}
[0m16:53:19.532381 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:53:19.571886 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:53:20.809834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:53:20.810981 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/core/core_flights.sql
[0m16:53:21.304532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d58b488-c838-49c0-8253-926526876429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32deb19190>]}
[0m16:53:21.347529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d58b488-c838-49c0-8253-926526876429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ded304a0>]}
[0m16:53:21.349082 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:53:21.350993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d58b488-c838-49c0-8253-926526876429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32dec49be0>]}
[0m16:53:21.353908 [info ] [MainThread]: 
[0m16:53:21.355783 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:53:21.358213 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:53:21.359449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:21.736759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:53:21.738182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:53:22.048629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d58b488-c838-49c0-8253-926526876429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32deeca7e0>]}
[0m16:53:22.051192 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:53:22.052535 [info ] [MainThread]: 
[0m16:53:22.071150 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m16:53:22.073678 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m16:53:22.077363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m16:53:22.079279 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m16:53:22.104107 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m16:53:22.122004 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 16:53:22.081206 => 16:53:22.120889
[0m16:53:22.123764 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m16:53:22.382666 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m16:53:22.408963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:53:22.534852 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    dep_airport.airport,
    dep_airport.city,
    dep_airport.state,
    dep_airport.country,
    flight_data.destination,
    arr_airport.airport,
    arr_airport.city,
    arr_airport.state,
    arr_airport.country,
    flight_data.carrier_code,
    flight_data.carrier_desc
from flight_data
inner join airports_data as dep_airport
on flight_data.origin = dep_airport.iata
inner join airports_data as arr_airport
on flight_data.dest = arr_airport.iata
    );
  
[0m16:53:23.953816 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:6178932f-4e6d-4045-a246-cc825f6bee96&page=queryresults
[0m16:53:24.077475 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name dest not found inside flight_data at [47:16]; reason: invalidQuery, location: query, message: Name dest not found inside flight_data at [47:16]')
[0m16:53:24.536974 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c32c5b6b-cba0-42b3-a93f-ef044b33c6e5&page=queryresults
[0m16:53:24.771334 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c32c5b6b-cba0-42b3-a93f-ef044b33c6e5&page=queryresults
[0m16:53:24.773356 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 16:53:22.124966 => 16:53:24.772753
[0m16:53:24.784943 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  Name dest not found inside flight_data at [47:16]
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m16:53:24.786318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d58b488-c838-49c0-8253-926526876429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32dec0c560>]}
[0m16:53:24.787646 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.core_flights .......... [[31mERROR[0m in 2.71s]
[0m16:53:24.789147 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m16:53:24.793468 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:24.794438 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m16:53:24.795425 [info ] [MainThread]: 
[0m16:53:24.796487 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.44 seconds (3.44s).
[0m16:53:24.798396 [debug] [MainThread]: Command end result
[0m16:53:24.825039 [info ] [MainThread]: 
[0m16:53:24.826491 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:53:24.827639 [info ] [MainThread]: 
[0m16:53:24.829138 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  Name dest not found inside flight_data at [47:16]
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m16:53:24.830259 [info ] [MainThread]: 
[0m16:53:24.831397 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:53:24.833500 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.194453, "process_user_time": 11.639703, "process_kernel_time": 1.073506, "process_mem_max_rss": "241828", "process_in_blocks": "14856", "command_success": false, "process_out_blocks": "0"}
[0m16:53:24.835358 [debug] [MainThread]: Command `dbt run` failed at 16:53:24.834828 after 9.20 seconds
[0m16:53:24.836634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3302344230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3302302ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32deaae030>]}
[0m16:53:24.837922 [debug] [MainThread]: Flushing usage events
[0m16:53:56.424802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab059a5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab05fce270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab059a4bf0>]}


============================== 16:53:56.434814 | ac677628-5722-4b5b-a6ce-70f3c15c8fd4 ==============================
[0m16:53:56.434814 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:53:56.436279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models core_flights', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:53:57.914270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac677628-5722-4b5b-a6ce-70f3c15c8fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab059a48f0>]}
[0m16:53:58.119223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac677628-5722-4b5b-a6ce-70f3c15c8fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae262fad0>]}
[0m16:53:58.120799 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:53:58.164410 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:53:59.280582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:53:59.281807 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/core/core_flights.sql
[0m16:53:59.702195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac677628-5722-4b5b-a6ce-70f3c15c8fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae2094c20>]}
[0m16:53:59.736557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac677628-5722-4b5b-a6ce-70f3c15c8fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae23982c0>]}
[0m16:53:59.738486 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:53:59.740261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac677628-5722-4b5b-a6ce-70f3c15c8fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae201a600>]}
[0m16:53:59.743503 [info ] [MainThread]: 
[0m16:53:59.746044 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:53:59.748955 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:53:59.750830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:00.433801 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:54:00.435366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:00.757713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac677628-5722-4b5b-a6ce-70f3c15c8fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae2473920>]}
[0m16:54:00.759995 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:54:00.761308 [info ] [MainThread]: 
[0m16:54:00.772964 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m16:54:00.774734 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m16:54:00.776992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m16:54:00.778229 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m16:54:00.791258 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m16:54:00.803122 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 16:54:00.779036 => 16:54:00.802367
[0m16:54:00.804353 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m16:54:00.875455 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m16:54:00.890239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:00.933636 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    dep_airport.airport,
    dep_airport.city,
    dep_airport.state,
    dep_airport.country,
    flight_data.destination,
    arr_airport.airport,
    arr_airport.city,
    arr_airport.state,
    arr_airport.country,
    flight_data.carrier_code,
    flight_data.carrier_desc
from flight_data
inner join airports_data as dep_airport
on flight_data.origin = dep_airport.iata
inner join airports_data as arr_airport
on flight_data.destination = arr_airport.iata
    );
  
[0m16:54:01.557463 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c6c9c605-735e-4fd9-b67d-686ea4ce45fa&page=queryresults
[0m16:54:01.706374 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE has columns with duplicate name airport at [15:1]; reason: invalidQuery, location: query, message: CREATE TABLE has columns with duplicate name airport at [15:1]')
[0m16:54:02.951846 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:0cc8f967-ce7d-40f8-95c4-c6f2112f0585&page=queryresults
[0m16:54:03.071447 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:0cc8f967-ce7d-40f8-95c4-c6f2112f0585&page=queryresults
[0m16:54:03.073499 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 16:54:00.805260 => 16:54:03.072873
[0m16:54:03.082904 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  CREATE TABLE has columns with duplicate name airport at [15:1]
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m16:54:03.084273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac677628-5722-4b5b-a6ce-70f3c15c8fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae24ba4e0>]}
[0m16:54:03.085601 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.core_flights .......... [[31mERROR[0m in 2.31s]
[0m16:54:03.087414 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m16:54:03.092884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:03.094212 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m16:54:03.095499 [info ] [MainThread]: 
[0m16:54:03.096902 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.35 seconds (3.35s).
[0m16:54:03.098953 [debug] [MainThread]: Command end result
[0m16:54:03.129519 [info ] [MainThread]: 
[0m16:54:03.130701 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:54:03.132364 [info ] [MainThread]: 
[0m16:54:03.134416 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  CREATE TABLE has columns with duplicate name airport at [15:1]
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m16:54:03.136275 [info ] [MainThread]: 
[0m16:54:03.137627 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:54:03.140146 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.8213134, "process_user_time": 6.478055, "process_kernel_time": 0.723131, "process_mem_max_rss": "259496", "process_in_blocks": "760", "command_success": false, "process_out_blocks": "0"}
[0m16:54:03.141535 [debug] [MainThread]: Command `dbt run` failed at 16:54:03.141274 after 6.82 seconds
[0m16:54:03.142772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab09f77200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae24ba4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab093f1100>]}
[0m16:54:03.143962 [debug] [MainThread]: Flushing usage events
[0m16:54:58.363582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0587b3bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0587d5b830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0587b394c0>]}


============================== 16:54:58.378247 | 97ab7780-32b4-4932-90dd-8ae5dcaf7f59 ==============================
[0m16:54:58.378247 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:54:58.380348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models core_flights', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:55:00.173792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97ab7780-32b4-4932-90dd-8ae5dcaf7f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05686ff6b0>]}
[0m16:55:00.402737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97ab7780-32b4-4932-90dd-8ae5dcaf7f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0568d4c500>]}
[0m16:55:00.404155 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:55:00.450878 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:55:01.367646 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:55:01.369238 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/core/core_flights.sql
[0m16:55:01.836319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97ab7780-32b4-4932-90dd-8ae5dcaf7f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0568482f00>]}
[0m16:55:01.884332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97ab7780-32b4-4932-90dd-8ae5dcaf7f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0568538740>]}
[0m16:55:01.886422 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:55:01.888061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97ab7780-32b4-4932-90dd-8ae5dcaf7f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05681878f0>]}
[0m16:55:01.891776 [info ] [MainThread]: 
[0m16:55:01.895327 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:55:01.899285 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:55:01.900871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:02.367329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:55:02.368930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:02.726104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97ab7780-32b4-4932-90dd-8ae5dcaf7f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05681660c0>]}
[0m16:55:02.728432 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:55:02.731146 [info ] [MainThread]: 
[0m16:55:02.747281 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m16:55:02.748609 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m16:55:02.750371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m16:55:02.751581 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m16:55:02.767151 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m16:55:02.784304 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 16:55:02.752780 => 16:55:02.783767
[0m16:55:02.785484 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m16:55:02.905716 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m16:55:02.919763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:02.968118 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    dep_airport.arr_airport,
    dep_airport.arr_city,
    dep_airport.arr_state,
    dep_airport.arr_country,
    flight_data.destination,
    arr_airport.arr_airport,
    arr_airport.arr_city,
    arr_airport.arr_state,
    arr_airport.arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc
from flight_data
inner join airports_data as dep_airport
on flight_data.origin = dep_airport.iata
inner join airports_data as arr_airport
on flight_data.destination = arr_airport.iata
    );
  
[0m16:55:03.590517 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:1ffe68ec-6656-4f3a-a73a-4b2c69e59488&page=queryresults
[0m16:55:03.708711 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name arr_airport not found inside dep_airport at [32:17]; reason: invalidQuery, location: query, message: Name arr_airport not found inside dep_airport at [32:17]')
[0m16:55:04.938210 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:403022e0-f12d-4749-b585-5ee0ec9f79dc&page=queryresults
[0m16:55:05.054055 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:403022e0-f12d-4749-b585-5ee0ec9f79dc&page=queryresults
[0m16:55:05.056346 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 16:55:02.786877 => 16:55:05.055682
[0m16:55:05.065181 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  Name arr_airport not found inside dep_airport at [32:17]
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m16:55:05.066403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97ab7780-32b4-4932-90dd-8ae5dcaf7f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0568596270>]}
[0m16:55:05.067681 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.core_flights .......... [[31mERROR[0m in 2.32s]
[0m16:55:05.069311 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m16:55:05.073659 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:05.074633 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m16:55:05.075586 [info ] [MainThread]: 
[0m16:55:05.076675 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.18 seconds (3.18s).
[0m16:55:05.078943 [debug] [MainThread]: Command end result
[0m16:55:05.108406 [info ] [MainThread]: 
[0m16:55:05.109759 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:55:05.111757 [info ] [MainThread]: 
[0m16:55:05.112941 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  Name arr_airport not found inside dep_airport at [32:17]
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m16:55:05.114329 [info ] [MainThread]: 
[0m16:55:05.116034 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:55:05.118320 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.8658, "process_user_time": 7.16501, "process_kernel_time": 0.840587, "process_mem_max_rss": "257992", "process_in_blocks": "1944", "command_success": false, "process_out_blocks": "0"}
[0m16:55:05.119508 [debug] [MainThread]: Command `dbt run` failed at 16:55:05.119272 after 6.87 seconds
[0m16:55:05.120630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0587d5b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0587d5b830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f058b80c3e0>]}
[0m16:55:05.121649 [debug] [MainThread]: Flushing usage events
[0m16:57:25.925652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fcc96b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fcc83d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fcc877830>]}


============================== 16:57:25.941280 | 29fbd271-b8ed-4fce-b2bc-e801a95d2b03 ==============================
[0m16:57:25.941280 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:57:25.942826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models core_flights', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:57:27.539252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29fbd271-b8ed-4fce-b2bc-e801a95d2b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fad6ccce0>]}
[0m16:57:27.770694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29fbd271-b8ed-4fce-b2bc-e801a95d2b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8faf21dc70>]}
[0m16:57:27.772105 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:57:27.818637 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:57:28.736546 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:57:28.737711 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/core/core_flights.sql
[0m16:57:29.141719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29fbd271-b8ed-4fce-b2bc-e801a95d2b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fac87d220>]}
[0m16:57:29.201652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29fbd271-b8ed-4fce-b2bc-e801a95d2b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8facb30d70>]}
[0m16:57:29.203706 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:57:29.206172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29fbd271-b8ed-4fce-b2bc-e801a95d2b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fac9161b0>]}
[0m16:57:29.210719 [info ] [MainThread]: 
[0m16:57:29.216812 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:57:29.220238 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:57:29.222092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:29.641368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:57:29.682492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:57:30.073810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29fbd271-b8ed-4fce-b2bc-e801a95d2b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8facb32120>]}
[0m16:57:30.076412 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:57:30.077809 [info ] [MainThread]: 
[0m16:57:30.088396 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m16:57:30.089662 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m16:57:30.091336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m16:57:30.092359 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m16:57:30.103649 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m16:57:30.114301 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 16:57:30.093109 => 16:57:30.113752
[0m16:57:30.115447 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m16:57:30.192289 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m16:57:30.201917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:30.244189 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_airport,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m16:57:30.924860 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:2c0617a8-d439-40c1-ad2a-a97e539d55a4&page=queryresults
[0m16:57:31.086909 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE has columns with duplicate name dep_airport at [15:1]; reason: invalidQuery, location: query, message: CREATE TABLE has columns with duplicate name dep_airport at [15:1]')
[0m16:57:31.867631 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:ad01a8d0-2a4b-4d55-948f-9fdd88e68a48&page=queryresults
[0m16:57:32.009001 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:ad01a8d0-2a4b-4d55-948f-9fdd88e68a48&page=queryresults
[0m16:57:32.012522 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 16:57:30.116210 => 16:57:32.010728
[0m16:57:32.031426 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  CREATE TABLE has columns with duplicate name dep_airport at [15:1]
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m16:57:32.033672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29fbd271-b8ed-4fce-b2bc-e801a95d2b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fac865220>]}
[0m16:57:32.035873 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.core_flights .......... [[31mERROR[0m in 1.94s]
[0m16:57:32.038610 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m16:57:32.046947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:57:32.050879 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m16:57:32.052876 [info ] [MainThread]: 
[0m16:57:32.055342 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m16:57:32.061457 [debug] [MainThread]: Command end result
[0m16:57:32.119677 [info ] [MainThread]: 
[0m16:57:32.122030 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:57:32.123942 [info ] [MainThread]: 
[0m16:57:32.128152 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  CREATE TABLE has columns with duplicate name dep_airport at [15:1]
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m16:57:32.133582 [info ] [MainThread]: 
[0m16:57:32.135738 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:57:32.139275 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.3726435, "process_user_time": 7.40134, "process_kernel_time": 0.826852, "process_mem_max_rss": "260620", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:57:32.141741 [debug] [MainThread]: Command `dbt run` failed at 16:57:32.140944 after 6.38 seconds
[0m16:57:32.144527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fcc7d23c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8facbd2420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8facd27c50>]}
[0m16:57:32.152840 [debug] [MainThread]: Flushing usage events
[0m16:58:02.968594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f742c9f8fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f742d0ece60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f742c9fcc50>]}


============================== 16:58:02.977889 | 49889678-9d93-4401-b94d-f5ac535a21a1 ==============================
[0m16:58:02.977889 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:58:02.979761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models core_flights', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:58:04.674676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49889678-9d93-4401-b94d-f5ac535a21a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f740975b4a0>]}
[0m16:58:04.913896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49889678-9d93-4401-b94d-f5ac535a21a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7409d8e9f0>]}
[0m16:58:04.915630 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:58:04.957360 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:58:05.945178 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:58:05.946278 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/core/core_flights.sql
[0m16:58:06.326577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49889678-9d93-4401-b94d-f5ac535a21a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74093914c0>]}
[0m16:58:06.358585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49889678-9d93-4401-b94d-f5ac535a21a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74093e8710>]}
[0m16:58:06.360076 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:58:06.361358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49889678-9d93-4401-b94d-f5ac535a21a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74091838f0>]}
[0m16:58:06.364244 [info ] [MainThread]: 
[0m16:58:06.366791 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:58:06.370406 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:58:06.372862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:06.923863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:58:06.925350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:58:07.244930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49889678-9d93-4401-b94d-f5ac535a21a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74090fd010>]}
[0m16:58:07.246986 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:58:07.248412 [info ] [MainThread]: 
[0m16:58:07.260406 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m16:58:07.261855 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m16:58:07.263337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m16:58:07.264543 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m16:58:07.276533 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m16:58:07.288063 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 16:58:07.265298 => 16:58:07.287476
[0m16:58:07.289068 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m16:58:07.411669 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m16:58:07.419601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:07.464598 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m16:58:08.170242 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:6fbbcdb8-482e-47c5-a624-16cb97f674b9&page=queryresults
[0m16:58:08.647721 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid timestamp: '1988-09-16 19:55'; reason: invalidQuery, location: query, message: Invalid timestamp: '1988-09-16 19:55'; reason: invalidQuery, location: query, message: Invalid timestamp: '1988-11-12 19:48'; reason: invalidQuery, location: query, message: Invalid timestamp: '1992-09-02 19:53'; reason: invalidQuery, location: query, message: Invalid timestamp: '1990-06-28 14:12'; reason: invalidQuery, location: query, message: Invalid timestamp: '1991-01-03 10:21'; reason: invalidQuery, location: query, message: Invalid timestamp: '1988-06-18 19:52'; reason: invalidQuery, location: query, message: Invalid timestamp: '1987-10-21 19:45'; reason: invalidQuery, location: query, message: Invalid timestamp: '1990-04-02 14:12'; reason: invalidQuery, location: query, message: Invalid timestamp: '1988-01-08 92:1.'; reason: invalidQuery, location: query, message: Invalid timestamp: '1992-06-22 90:6.'; reason: invalidQuery, location: query, message: Invalid timestamp: '1987-10-07 19:37'; reason: invalidQuery, location: query, message: Invalid timestamp: '1987-11-25 19:37'; reason: invalidQuery, location: query, message: Invalid timestamp: '1990-10-31 16:05'; reason: invalidQuery, location: query, message: Invalid timestamp: '1990-12-02 16:05'; reason: invalidQuery, location: query, message: Invalid timestamp: '1991-12-17 90:4.'; reason: invalidQuery, location: query, message: Invalid timestamp: '1992-08-24 19:30'; reason: invalidQuery, location: query, message: Invalid timestamp: '1991-05-23 21:07'; reason: invalidQuery, location: query, message: Invalid timestamp: '1989-01-21 19:45'; reason: invalidQuery, location: query, message: Invalid timestamp: '1990-12-31 16:05'; reason: invalidQuery, location: query, message: Invalid timestamp: '1988-05-02 19:52'; reason: invalidQuery, location: query, message: Invalid timestamp: '1991-01-04 10:20'; reason: invalidQuery, location: query, message: Invalid timestamp: '1992-02-27 17:20'")
[0m16:58:09.354500 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:61893623-db26-47ee-ad32-17d016731f51&page=queryresults
[0m16:58:10.039169 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:61893623-db26-47ee-ad32-17d016731f51&page=queryresults
[0m16:58:10.041231 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 16:58:07.289814 => 16:58:10.040665
[0m16:58:10.052354 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  Invalid timestamp: '1988-11-21 19:48'
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m16:58:10.053677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49889678-9d93-4401-b94d-f5ac535a21a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7409239a60>]}
[0m16:58:10.055075 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.core_flights .......... [[31mERROR[0m in 2.79s]
[0m16:58:10.056577 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m16:58:10.060761 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:58:10.061817 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m16:58:10.062786 [info ] [MainThread]: 
[0m16:58:10.063842 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.70 seconds (3.70s).
[0m16:58:10.066323 [debug] [MainThread]: Command end result
[0m16:58:10.096938 [info ] [MainThread]: 
[0m16:58:10.099117 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:58:10.100374 [info ] [MainThread]: 
[0m16:58:10.101439 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  Invalid timestamp: '1988-11-21 19:48'
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m16:58:10.102649 [info ] [MainThread]: 
[0m16:58:10.103810 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:58:10.105672 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.266441, "process_user_time": 7.82847, "process_kernel_time": 0.858339, "process_mem_max_rss": "262424", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:58:10.107181 [debug] [MainThread]: Command `dbt run` failed at 16:58:10.106842 after 7.27 seconds
[0m16:58:10.108416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f742c9b68d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74094fc470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74091838f0>]}
[0m16:58:10.109590 [debug] [MainThread]: Flushing usage events
[0m16:58:53.863423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738e6f8e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738f6d1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738e6f9490>]}


============================== 16:58:53.876331 | 299094d6-92bd-414c-9808-075d07b68add ==============================
[0m16:58:53.876331 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:58:53.877798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:58:54.109864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '299094d6-92bd-414c-9808-075d07b68add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738e5fd7f0>]}
[0m16:58:54.711413 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jfa4v4zs'
[0m16:58:54.712678 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:58:56.386453 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:58:56.389035 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:58:56.481100 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:58:56.494710 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:59:01.208374 [info ] [MainThread]: Installed from version 1.3.0
[0m16:59:01.209392 [info ] [MainThread]: Up to date!
[0m16:59:01.210627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '299094d6-92bd-414c-9808-075d07b68add', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738e5f2ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738e5f3770>]}
[0m16:59:01.212471 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 7.484122, "process_user_time": 4.44555, "process_kernel_time": 0.508062, "process_mem_max_rss": "112016", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m16:59:01.213555 [debug] [MainThread]: Command `dbt deps` succeeded at 16:59:01.213298 after 7.49 seconds
[0m16:59:01.214998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738edfc8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738e6b67e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738e6b7c80>]}
[0m16:59:01.217714 [debug] [MainThread]: Flushing usage events
[0m16:59:06.458978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cea59cda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cea59c080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cec7395e0>]}


============================== 16:59:06.467946 | 696df9b7-5822-4310-876c-407f2db22ca7 ==============================
[0m16:59:06.467946 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:59:06.469497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_flights', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:59:08.181088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '696df9b7-5822-4310-876c-407f2db22ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ceba709b0>]}
[0m16:59:08.395639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '696df9b7-5822-4310-876c-407f2db22ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cea648e60>]}
[0m16:59:08.397476 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:59:08.440615 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:59:09.729577 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m16:59:09.730585 [debug] [MainThread]: Partial parsing: added file: flights_project://macros/flag_flight_delay_status.sql
[0m16:59:09.731454 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/core/core_flights.sql
[0m16:59:09.732390 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m16:59:10.255558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '696df9b7-5822-4310-876c-407f2db22ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cc6ca9be0>]}
[0m16:59:10.298591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '696df9b7-5822-4310-876c-407f2db22ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cc6f94230>]}
[0m16:59:10.300405 [info ] [MainThread]: Found 1 seed, 2 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m16:59:10.301894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '696df9b7-5822-4310-876c-407f2db22ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cc6c0fe90>]}
[0m16:59:10.304827 [info ] [MainThread]: 
[0m16:59:10.306821 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:59:10.310286 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:59:10.312788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:10.731033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:59:10.732922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:59:11.083316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '696df9b7-5822-4310-876c-407f2db22ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cc6c0f050>]}
[0m16:59:11.090515 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:59:11.099583 [info ] [MainThread]: 
[0m16:59:11.130740 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m16:59:11.132888 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m16:59:11.135595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.stg_flights)
[0m16:59:11.137127 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m16:59:11.162126 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m16:59:11.168956 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (compile): 16:59:11.138644 => 16:59:11.168243
[0m16:59:11.170038 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m16:59:11.230328 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m16:59:11.237891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:11.289772 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    cast( concat(cast(FlightDate as string), ' ', DepTimeFormatted) as timestamp) as dep_time,
    cast( concat(cast(FlightDate as string), ' ', ArrTimeFormatted) as timestamp) as arr_time,
    FlightNum as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc
    
    case
        when dep_delay > 0 and arr_delay > 0 then 'ddad'
        when dep_delay > 0 then 'dd'
        when arr_delay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m16:59:11.731616 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:5871718c-a8bf-4086-9de0-d10647d7f234&page=queryresults
[0m16:59:11.732984 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got keyword CASE at [25:5]; reason: invalidQuery, location: query, message: Syntax error: Expected end of input but got keyword CASE at [25:5]')
[0m16:59:12.232093 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:5c74ecc4-1432-442e-bb5b-256405bffe8b&page=queryresults
[0m16:59:12.234471 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:5c74ecc4-1432-442e-bb5b-256405bffe8b&page=queryresults
[0m16:59:12.238497 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (execute): 16:59:11.170737 => 16:59:12.237519
[0m16:59:12.259199 [debug] [Thread-1 (]: Database Error in model stg_flights (models/stg_flights.sql)
  Syntax error: Expected end of input but got keyword CASE at [25:5]
  compiled Code at target/run/flights_project/models/stg_flights.sql
[0m16:59:12.262672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '696df9b7-5822-4310-876c-407f2db22ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cc5b12570>]}
[0m16:59:12.267327 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model db_project_dataset.stg_flights ............ [[31mERROR[0m in 1.13s]
[0m16:59:12.270032 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m16:59:12.275564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:12.279356 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m16:59:12.282555 [info ] [MainThread]: 
[0m16:59:12.284590 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.98 seconds (1.98s).
[0m16:59:12.286990 [debug] [MainThread]: Command end result
[0m16:59:12.337850 [info ] [MainThread]: 
[0m16:59:12.339964 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:59:12.341828 [info ] [MainThread]: 
[0m16:59:12.346071 [error] [MainThread]:   Database Error in model stg_flights (models/stg_flights.sql)
  Syntax error: Expected end of input but got keyword CASE at [25:5]
  compiled Code at target/run/flights_project/models/stg_flights.sql
[0m16:59:12.350721 [info ] [MainThread]: 
[0m16:59:12.353046 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:59:12.356378 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.006463, "process_user_time": 7.304019, "process_kernel_time": 0.733416, "process_mem_max_rss": "260656", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:59:12.359101 [debug] [MainThread]: Command `dbt run` failed at 16:59:12.357542 after 6.01 seconds
[0m16:59:12.362708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cea7e0ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cee079130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cc6c80ce0>]}
[0m16:59:12.366395 [debug] [MainThread]: Flushing usage events
[0m16:59:21.915504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c219bb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c23dcd2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c219bb230>]}


============================== 16:59:21.924980 | 291e8876-dcef-4d36-86e2-447203797cb5 ==============================
[0m16:59:21.924980 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:59:21.926528 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:59:22.141023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '291e8876-dcef-4d36-86e2-447203797cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c219fcb30>]}
[0m16:59:22.647146 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fti_11zl'
[0m16:59:22.648115 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:59:22.730483 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:59:22.732392 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:59:22.841415 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:59:22.850072 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:59:26.827738 [info ] [MainThread]: Installed from version 1.3.0
[0m16:59:26.828951 [info ] [MainThread]: Up to date!
[0m16:59:26.830392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '291e8876-dcef-4d36-86e2-447203797cb5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c219070b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c218b3440>]}
[0m16:59:26.832210 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 5.0220056, "process_user_time": 4.485079, "process_kernel_time": 0.454435, "process_mem_max_rss": "111728", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m16:59:26.833525 [debug] [MainThread]: Command `dbt deps` succeeded at 16:59:26.833235 after 5.02 seconds
[0m16:59:26.834495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c25fcf1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c22a70bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c21a61ac0>]}
[0m16:59:26.835454 [debug] [MainThread]: Flushing usage events
[0m16:59:33.070731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadf5e71490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadf611f830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadf61a6720>]}


============================== 16:59:33.080039 | 3a878aba-4b16-4e60-9e42-749b9024965f ==============================
[0m16:59:33.080039 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:59:33.081330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_flights', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:59:35.117073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a878aba-4b16-4e60-9e42-749b9024965f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd2b3f500>]}
[0m16:59:35.332025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a878aba-4b16-4e60-9e42-749b9024965f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd2c03740>]}
[0m16:59:35.333497 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:59:35.374851 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:59:36.648409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:59:36.649472 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:59:36.665581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a878aba-4b16-4e60-9e42-749b9024965f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd292a6c0>]}
[0m16:59:36.735010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a878aba-4b16-4e60-9e42-749b9024965f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd2848860>]}
[0m16:59:36.738639 [info ] [MainThread]: Found 1 seed, 2 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m16:59:36.741304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a878aba-4b16-4e60-9e42-749b9024965f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd29eec30>]}
[0m16:59:36.746301 [info ] [MainThread]: 
[0m16:59:36.756310 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:59:36.761997 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:59:36.764400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:37.250978 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:59:37.252636 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:59:37.539198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a878aba-4b16-4e60-9e42-749b9024965f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd2a162d0>]}
[0m16:59:37.541330 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:59:37.542324 [info ] [MainThread]: 
[0m16:59:37.556218 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m16:59:37.557796 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m16:59:37.559783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.stg_flights)
[0m16:59:37.561071 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m16:59:37.596040 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m16:59:37.605920 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (compile): 16:59:37.561912 => 16:59:37.605335
[0m16:59:37.606961 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m16:59:37.657354 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m16:59:37.666261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:37.712781 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    cast( concat(cast(FlightDate as string), ' ', DepTimeFormatted) as timestamp) as dep_time,
    cast( concat(cast(FlightDate as string), ' ', ArrTimeFormatted) as timestamp) as arr_time,
    FlightNum as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc
    
    case
        when dep_delay > 0 and arr_delay > 0 then 'ddad'
        when dep_delay > 0 then 'dd'
        when arr_delay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m16:59:38.252824 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:0845ad43-f718-454f-862e-73fef59ca96c&page=queryresults
[0m16:59:38.254667 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got keyword CASE at [25:5]; reason: invalidQuery, location: query, message: Syntax error: Expected end of input but got keyword CASE at [25:5]')
[0m16:59:39.210054 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:abbae7cd-3594-4819-ab0d-ec1fd48f1aca&page=queryresults
[0m16:59:39.212390 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:abbae7cd-3594-4819-ab0d-ec1fd48f1aca&page=queryresults
[0m16:59:39.214684 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (execute): 16:59:37.607615 => 16:59:39.213908
[0m16:59:39.230356 [debug] [Thread-1 (]: Database Error in model stg_flights (models/stg_flights.sql)
  Syntax error: Expected end of input but got keyword CASE at [25:5]
  compiled Code at target/run/flights_project/models/stg_flights.sql
[0m16:59:39.232141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a878aba-4b16-4e60-9e42-749b9024965f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd2e2c140>]}
[0m16:59:39.234496 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model db_project_dataset.stg_flights ............ [[31mERROR[0m in 1.67s]
[0m16:59:39.238011 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m16:59:39.243470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:39.244840 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m16:59:39.246008 [info ] [MainThread]: 
[0m16:59:39.247132 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m16:59:39.248793 [debug] [MainThread]: Command end result
[0m16:59:39.280119 [info ] [MainThread]: 
[0m16:59:39.281883 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:59:39.283579 [info ] [MainThread]: 
[0m16:59:39.286125 [error] [MainThread]:   Database Error in model stg_flights (models/stg_flights.sql)
  Syntax error: Expected end of input but got keyword CASE at [25:5]
  compiled Code at target/run/flights_project/models/stg_flights.sql
[0m16:59:39.288258 [info ] [MainThread]: 
[0m16:59:39.289970 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:59:39.292166 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.363078, "process_user_time": 7.951277, "process_kernel_time": 0.813198, "process_mem_max_rss": "253140", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:59:39.293801 [debug] [MainThread]: Command `dbt run` failed at 16:59:39.293250 after 6.36 seconds
[0m16:59:39.295486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadf5f7d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadf5f7dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd28f2a80>]}
[0m16:59:39.296949 [debug] [MainThread]: Flushing usage events
[0m17:00:41.491238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0da20d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0fb31520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0f8bf530>]}


============================== 17:00:41.501566 | fdb5dc81-a97b-42d4-98d2-a48423a14955 ==============================
[0m17:00:41.501566 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:00:41.503232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:00:41.719989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdb5dc81-a97b-42d4-98d2-a48423a14955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0da863c0>]}
[0m17:00:42.131364 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kk2pf2uf'
[0m17:00:42.132935 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:00:42.203590 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:00:42.207053 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:00:42.315189 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:00:42.323762 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:00:46.882315 [info ] [MainThread]: Installed from version 1.3.0
[0m17:00:46.883482 [info ] [MainThread]: Up to date!
[0m17:00:46.884514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fdb5dc81-a97b-42d4-98d2-a48423a14955', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0d7c0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0d7c0440>]}
[0m17:00:46.886051 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 5.5167227, "process_user_time": 4.63785, "process_kernel_time": 0.457813, "process_mem_max_rss": "111920", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m17:00:46.886944 [debug] [MainThread]: Command `dbt deps` succeeded at 17:00:46.886713 after 5.52 seconds
[0m17:00:46.887760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee11feb1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0d8ade20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0f8bf530>]}
[0m17:00:46.888653 [debug] [MainThread]: Flushing usage events
[0m17:00:52.988130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e691d31d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e6a18da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e6954d100>]}


============================== 17:00:52.997113 | e167567d-c5ee-4bfe-8f34-c71c6d4c1966 ==============================
[0m17:00:52.997113 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:00:52.998547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models stg_flights', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:00:54.463798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e167567d-c5ee-4bfe-8f34-c71c6d4c1966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e468529f0>]}
[0m17:00:54.768467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e167567d-c5ee-4bfe-8f34-c71c6d4c1966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e45d032c0>]}
[0m17:00:54.770369 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:00:54.818148 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:00:56.002190 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:00:56.003488 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m17:00:56.552413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e167567d-c5ee-4bfe-8f34-c71c6d4c1966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e4592da30>]}
[0m17:00:56.584372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e167567d-c5ee-4bfe-8f34-c71c6d4c1966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e45bb8e60>]}
[0m17:00:56.585858 [info ] [MainThread]: Found 1 seed, 2 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:00:56.587407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e167567d-c5ee-4bfe-8f34-c71c6d4c1966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e459dc1a0>]}
[0m17:00:56.591600 [info ] [MainThread]: 
[0m17:00:56.594295 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:00:56.596788 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:00:56.597922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:57.064772 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:00:57.066613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:57.390773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e167567d-c5ee-4bfe-8f34-c71c6d4c1966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e47675970>]}
[0m17:00:57.393345 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:00:57.394985 [info ] [MainThread]: 
[0m17:00:57.409541 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m17:00:57.411364 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m17:00:57.413288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.stg_flights)
[0m17:00:57.414663 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m17:00:57.433778 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m17:00:57.443713 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (compile): 17:00:57.416212 => 17:00:57.443019
[0m17:00:57.444824 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m17:00:57.494082 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m17:00:57.506624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:57.551823 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    cast( concat(cast(FlightDate as string), ' ', DepTimeFormatted) as timestamp) as dep_time,
    cast( concat(cast(FlightDate as string), ' ', ArrTimeFormatted) as timestamp) as arr_time,
    FlightNum as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc,
    
    case
        when dep_delay > 0 and arr_delay > 0 then 'ddad'
        when dep_delay > 0 then 'dd'
        when arr_delay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m17:00:58.004062 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c8f75e3f-a743-4856-ac46-76d43dd18ed8&page=queryresults
[0m17:00:58.186924 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: dep_delay; Did you mean DepDelay? at [26:14]; reason: invalidQuery, location: query, message: Unrecognized name: dep_delay; Did you mean DepDelay? at [26:14]')
[0m17:00:58.729504 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:518fa834-0734-4b76-acdc-f4a13831e791&page=queryresults
[0m17:00:58.835887 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:518fa834-0734-4b76-acdc-f4a13831e791&page=queryresults
[0m17:00:58.838545 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (execute): 17:00:57.445763 => 17:00:58.837816
[0m17:00:58.849999 [debug] [Thread-1 (]: Database Error in model stg_flights (models/stg_flights.sql)
  Unrecognized name: dep_delay; Did you mean DepDelay? at [26:14]
  compiled Code at target/run/flights_project/models/stg_flights.sql
[0m17:00:58.851265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e167567d-c5ee-4bfe-8f34-c71c6d4c1966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e458f5130>]}
[0m17:00:58.852891 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model db_project_dataset.stg_flights ............ [[31mERROR[0m in 1.44s]
[0m17:00:58.854923 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m17:00:58.860587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:00:58.862056 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m17:00:58.863453 [info ] [MainThread]: 
[0m17:00:58.864901 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.27 seconds (2.27s).
[0m17:00:58.867043 [debug] [MainThread]: Command end result
[0m17:00:58.903074 [info ] [MainThread]: 
[0m17:00:58.904520 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:00:58.906021 [info ] [MainThread]: 
[0m17:00:58.908218 [error] [MainThread]:   Database Error in model stg_flights (models/stg_flights.sql)
  Unrecognized name: dep_delay; Did you mean DepDelay? at [26:14]
  compiled Code at target/run/flights_project/models/stg_flights.sql
[0m17:00:58.910624 [info ] [MainThread]: 
[0m17:00:58.912351 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:00:58.916531 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.035162, "process_user_time": 7.693341, "process_kernel_time": 0.707666, "process_mem_max_rss": "262408", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:00:58.918299 [debug] [MainThread]: Command `dbt run` failed at 17:00:58.917965 after 6.04 seconds
[0m17:00:58.919727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e69a02b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e459f9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e6d80f200>]}
[0m17:00:58.921108 [debug] [MainThread]: Flushing usage events
[0m17:02:20.764519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27aeb97fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27aebf6e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27aeb94ef0>]}


============================== 17:02:20.774041 | 689c692f-e419-4779-8fb6-f2f98566be51 ==============================
[0m17:02:20.774041 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:02:20.775595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:02:20.997213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '689c692f-e419-4779-8fb6-f2f98566be51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27aee1fe00>]}
[0m17:02:21.464110 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zfyhg7dh'
[0m17:02:21.465329 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:02:21.561667 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:02:21.564145 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:02:21.666017 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:02:21.686311 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:02:27.000546 [info ] [MainThread]: Installed from version 1.3.0
[0m17:02:27.001613 [info ] [MainThread]: Up to date!
[0m17:02:27.002801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '689c692f-e419-4779-8fb6-f2f98566be51', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27ae93c1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27ae93c0b0>]}
[0m17:02:27.004753 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 6.371576, "process_user_time": 4.86061, "process_kernel_time": 0.493964, "process_mem_max_rss": "111704", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m17:02:27.005961 [debug] [MainThread]: Command `dbt deps` succeeded at 17:02:27.005636 after 6.37 seconds
[0m17:02:27.006970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27b0cb0e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27aee1fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27aec431d0>]}
[0m17:02:27.007993 [debug] [MainThread]: Flushing usage events
[0m17:02:32.800116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729474e7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7294a74b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729474d190>]}


============================== 17:02:32.808384 | 46be10c9-20a0-43a4-9151-5f198192016b ==============================
[0m17:02:32.808384 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:02:32.809814 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_flights', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:02:34.180116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46be10c9-20a0-43a4-9151-5f198192016b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72945d9af0>]}
[0m17:02:34.373093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46be10c9-20a0-43a4-9151-5f198192016b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72734e7a70>]}
[0m17:02:34.374500 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:02:34.409815 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:02:35.341083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:02:35.342388 [debug] [MainThread]: Partial parsing: updated file: flights_project://macros/flag_flight_delay_status.sql
[0m17:02:35.736847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46be10c9-20a0-43a4-9151-5f198192016b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7270d9f2f0>]}
[0m17:02:35.767196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46be10c9-20a0-43a4-9151-5f198192016b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7271140590>]}
[0m17:02:35.768803 [info ] [MainThread]: Found 1 seed, 2 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:02:35.770195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46be10c9-20a0-43a4-9151-5f198192016b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7270ec24e0>]}
[0m17:02:35.773563 [info ] [MainThread]: 
[0m17:02:35.776013 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:02:35.779428 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:02:35.780879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:36.133099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:02:36.134794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:02:36.438215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46be10c9-20a0-43a4-9151-5f198192016b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72700c6090>]}
[0m17:02:36.440317 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:02:36.441685 [info ] [MainThread]: 
[0m17:02:36.452140 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m17:02:36.453447 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m17:02:36.455147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.stg_flights)
[0m17:02:36.456361 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m17:02:36.471238 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m17:02:36.481120 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (compile): 17:02:36.457139 => 17:02:36.480606
[0m17:02:36.482173 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m17:02:36.532210 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m17:02:36.542225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:36.584624 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    cast( concat(cast(FlightDate as string), ' ', DepTimeFormatted) as timestamp) as dep_time,
    cast( concat(cast(FlightDate as string), ' ', ArrTimeFormatted) as timestamp) as arr_time,
    FlightNum as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc,
    
    case
        when dep_delay > 0 and  > 0 then 'ddad'
        when dep_delay > 0 then 'dd'
        when dep_delay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m17:02:37.038713 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:d270b2bc-a0fe-4712-9e41-262d786ff4d6&page=queryresults
[0m17:02:37.040555 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ">" at [26:33]; reason: invalidQuery, location: query, message: Syntax error: Unexpected ">" at [26:33]')
[0m17:02:37.917028 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:45725240-a790-43b0-9dca-497cc0473e3a&page=queryresults
[0m17:02:37.919069 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:45725240-a790-43b0-9dca-497cc0473e3a&page=queryresults
[0m17:02:37.921152 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (execute): 17:02:36.482931 => 17:02:37.920541
[0m17:02:37.929565 [debug] [Thread-1 (]: Database Error in model stg_flights (models/stg_flights.sql)
  Syntax error: Unexpected ">" at [26:33]
  compiled Code at target/run/flights_project/models/stg_flights.sql
[0m17:02:37.930702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46be10c9-20a0-43a4-9151-5f198192016b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72715cc530>]}
[0m17:02:37.931977 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model db_project_dataset.stg_flights ............ [[31mERROR[0m in 1.48s]
[0m17:02:37.933500 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m17:02:37.937604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:02:37.938589 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m17:02:37.939544 [info ] [MainThread]: 
[0m17:02:37.940713 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m17:02:37.942395 [debug] [MainThread]: Command end result
[0m17:02:37.967349 [info ] [MainThread]: 
[0m17:02:37.968480 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:02:37.969471 [info ] [MainThread]: 
[0m17:02:37.970701 [error] [MainThread]:   Database Error in model stg_flights (models/stg_flights.sql)
  Syntax error: Unexpected ">" at [26:33]
  compiled Code at target/run/flights_project/models/stg_flights.sql
[0m17:02:37.972097 [info ] [MainThread]: 
[0m17:02:37.973700 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:02:37.975965 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.273562, "process_user_time": 7.17404, "process_kernel_time": 0.717404, "process_mem_max_rss": "261356", "process_in_blocks": "8", "command_success": false, "process_out_blocks": "0"}
[0m17:02:37.977235 [debug] [MainThread]: Command `dbt run` failed at 17:02:37.976986 after 5.28 seconds
[0m17:02:37.978297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7298d17200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7270dc8620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72712a4590>]}
[0m17:02:37.979367 [debug] [MainThread]: Flushing usage events
[0m17:04:37.468796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54bb862e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54bbae4c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54bb863920>]}


============================== 17:04:37.478092 | 5ccd9262-7428-4e59-9e1c-1359be44c2a9 ==============================
[0m17:04:37.478092 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:04:37.479550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m17:04:37.725160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ccd9262-7428-4e59-9e1c-1359be44c2a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54bb96bb00>]}
[0m17:04:38.147629 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-py60gjzs'
[0m17:04:38.148657 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:04:39.942827 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:04:39.944612 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:04:40.072209 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:04:40.081757 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:04:44.221239 [info ] [MainThread]: Installed from version 1.3.0
[0m17:04:44.222364 [info ] [MainThread]: Up to date!
[0m17:04:44.223503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5ccd9262-7428-4e59-9e1c-1359be44c2a9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54bb715a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54bb7171a0>]}
[0m17:04:44.225498 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 6.8769464, "process_user_time": 4.255585, "process_kernel_time": 0.412479, "process_mem_max_rss": "111820", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m17:04:44.226735 [debug] [MainThread]: Command `dbt deps` succeeded at 17:04:44.226444 after 6.88 seconds
[0m17:04:44.227842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54bfe331d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54bb81ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54bb81e810>]}
[0m17:04:44.228995 [debug] [MainThread]: Flushing usage events
[0m17:04:50.426460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae4880710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae4880740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae4f4e270>]}


============================== 17:04:50.434959 | 00505a9f-f1ff-4ed2-ae96-4bbe51b99d42 ==============================
[0m17:04:50.434959 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:04:50.436350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models stg_flights', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:04:52.501290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00505a9f-f1ff-4ed2-ae96-4bbe51b99d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac2b2bda0>]}
[0m17:04:52.841120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00505a9f-f1ff-4ed2-ae96-4bbe51b99d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac13c5ac0>]}
[0m17:04:52.842624 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:04:52.885014 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:04:54.209201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:04:54.210871 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m17:04:54.212234 [debug] [MainThread]: Partial parsing: updated file: flights_project://macros/flag_flight_delay_status.sql
[0m17:04:54.727889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00505a9f-f1ff-4ed2-ae96-4bbe51b99d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac0eb5640>]}
[0m17:04:54.765397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00505a9f-f1ff-4ed2-ae96-4bbe51b99d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac12644a0>]}
[0m17:04:54.767249 [info ] [MainThread]: Found 1 seed, 2 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:04:54.769146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00505a9f-f1ff-4ed2-ae96-4bbe51b99d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac0fe27b0>]}
[0m17:04:54.773413 [info ] [MainThread]: 
[0m17:04:54.779845 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:04:54.789791 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:04:54.791429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:55.225012 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:04:55.226501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:55.548060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00505a9f-f1ff-4ed2-ae96-4bbe51b99d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac0fe2600>]}
[0m17:04:55.549946 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:04:55.551250 [info ] [MainThread]: 
[0m17:04:55.562503 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m17:04:55.563830 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m17:04:55.565623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.stg_flights)
[0m17:04:55.566698 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m17:04:55.581476 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m17:04:55.591400 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (compile): 17:04:55.567495 => 17:04:55.590893
[0m17:04:55.592442 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m17:04:55.651745 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m17:04:55.664615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:55.731529 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    PARSE_TIMESTAMP('%Y-%m-%d %H:%M', CONCAT(CAST(FlightDate AS STRING), ' ', DepTimeFormatted)) AS dep_time,
    PARSE_TIMESTAMP('%Y-%m-%d %H:%M', CONCAT(CAST(FlightDate AS STRING), ' ', ArrTimeFormatted)) AS arr_time,
    FlightNum as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc,
    
    case
        when dep_delay > 0 and arr_delay > 0 then 'ddad'
        when dep_delay > 0 then 'dd'
        when arr_delay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m17:04:56.137019 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:6fd318d1-2b72-4d9b-b1e3-5782bc205bfa&page=queryresults
[0m17:04:56.276020 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: dep_delay; Did you mean DepDelay? at [26:14]; reason: invalidQuery, location: query, message: Unrecognized name: dep_delay; Did you mean DepDelay? at [26:14]')
[0m17:04:56.577874 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:2ce52999-90ca-4e4d-8cc5-c518ec5ee89c&page=queryresults
[0m17:04:56.711643 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:2ce52999-90ca-4e4d-8cc5-c518ec5ee89c&page=queryresults
[0m17:04:56.713682 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (execute): 17:04:55.593144 => 17:04:56.713058
[0m17:04:56.723246 [debug] [Thread-1 (]: Database Error in model stg_flights (models/stg_flights.sql)
  Unrecognized name: dep_delay; Did you mean DepDelay? at [26:14]
  compiled Code at target/run/flights_project/models/stg_flights.sql
[0m17:04:56.724424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00505a9f-f1ff-4ed2-ae96-4bbe51b99d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac0d98ef0>]}
[0m17:04:56.725741 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model db_project_dataset.stg_flights ............ [[31mERROR[0m in 1.16s]
[0m17:04:56.727228 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m17:04:56.731608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:04:56.732607 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m17:04:56.733837 [info ] [MainThread]: 
[0m17:04:56.734997 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.96 seconds (1.96s).
[0m17:04:56.736584 [debug] [MainThread]: Command end result
[0m17:04:56.762797 [info ] [MainThread]: 
[0m17:04:56.764070 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:04:56.765065 [info ] [MainThread]: 
[0m17:04:56.766047 [error] [MainThread]:   Database Error in model stg_flights (models/stg_flights.sql)
  Unrecognized name: dep_delay; Did you mean DepDelay? at [26:14]
  compiled Code at target/run/flights_project/models/stg_flights.sql
[0m17:04:56.767131 [info ] [MainThread]: 
[0m17:04:56.768494 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:04:56.770553 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.4383273, "process_user_time": 8.541316, "process_kernel_time": 0.817255, "process_mem_max_rss": "260552", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:04:56.771828 [debug] [MainThread]: Command `dbt run` failed at 17:04:56.771532 after 6.44 seconds
[0m17:04:56.773029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae4884cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac0f31310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae65e3c50>]}
[0m17:04:56.774141 [debug] [MainThread]: Flushing usage events
[0m17:05:09.958844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb139134e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1392419a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb139136030>]}


============================== 17:05:09.967846 | 4133eb1d-dec6-42ed-a38a-14aea644f993 ==============================
[0m17:05:09.967846 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:05:09.969311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:05:10.190012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4133eb1d-dec6-42ed-a38a-14aea644f993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1391347d0>]}
[0m17:05:10.617943 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-r2ukrrzb'
[0m17:05:10.618804 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:05:10.792425 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:05:10.795515 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:05:10.914517 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:05:10.929137 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:05:16.484004 [info ] [MainThread]: Installed from version 1.3.0
[0m17:05:16.485004 [info ] [MainThread]: Up to date!
[0m17:05:16.486083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4133eb1d-dec6-42ed-a38a-14aea644f993', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb13902df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb13902f740>]}
[0m17:05:16.490360 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 6.6525946, "process_user_time": 5.178168, "process_kernel_time": 0.512789, "process_mem_max_rss": "111952", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m17:05:16.491835 [debug] [MainThread]: Command `dbt deps` succeeded at 17:05:16.491477 after 6.65 seconds
[0m17:05:16.493005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb139ed3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1393e3c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb13902e780>]}
[0m17:05:16.494085 [debug] [MainThread]: Flushing usage events
[0m17:05:22.981020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4416b1e3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4416d802f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4416d85a30>]}


============================== 17:05:22.990298 | 67cf299e-db6b-4c24-99e1-6905197a6435 ==============================
[0m17:05:22.990298 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:05:22.991517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models stg_flights', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:05:24.864847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67cf299e-db6b-4c24-99e1-6905197a6435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fb9699a0>]}
[0m17:05:25.223734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67cf299e-db6b-4c24-99e1-6905197a6435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43f8239b80>]}
[0m17:05:25.225230 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:05:25.265190 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:05:26.517201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:05:26.518136 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:05:26.526664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67cf299e-db6b-4c24-99e1-6905197a6435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43f35b4a10>]}
[0m17:05:26.558643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67cf299e-db6b-4c24-99e1-6905197a6435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43f34dcdd0>]}
[0m17:05:26.560155 [info ] [MainThread]: Found 1 seed, 2 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:05:26.561424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67cf299e-db6b-4c24-99e1-6905197a6435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43f358b740>]}
[0m17:05:26.564024 [info ] [MainThread]: 
[0m17:05:26.566064 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:05:26.568643 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:05:26.569943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:27.024739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:05:27.026466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:05:27.351865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67cf299e-db6b-4c24-99e1-6905197a6435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43f358bd70>]}
[0m17:05:27.354406 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:05:27.357157 [info ] [MainThread]: 
[0m17:05:27.388588 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m17:05:27.390265 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m17:05:27.392688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.stg_flights)
[0m17:05:27.394231 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m17:05:27.477444 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m17:05:27.493664 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (compile): 17:05:27.395454 => 17:05:27.492532
[0m17:05:27.496090 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m17:05:27.594829 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m17:05:27.606302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:27.656040 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    PARSE_TIMESTAMP('%Y-%m-%d %H:%M', CONCAT(CAST(FlightDate AS STRING), ' ', DepTimeFormatted)) AS dep_time,
    PARSE_TIMESTAMP('%Y-%m-%d %H:%M', CONCAT(CAST(FlightDate AS STRING), ' ', ArrTimeFormatted)) AS arr_time,
    FlightNum as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc,
    
    case
        when dep_delay > 0 and arr_delay > 0 then 'ddad'
        when dep_delay > 0 then 'dd'
        when arr_delay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m17:05:28.060247 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:7b3ebab1-0d24-4f30-be3a-77ec0c5c0dd8&page=queryresults
[0m17:05:28.457401 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: dep_delay; Did you mean DepDelay? at [26:14]; reason: invalidQuery, location: query, message: Unrecognized name: dep_delay; Did you mean DepDelay? at [26:14]')
[0m17:05:29.509082 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:50698a88-06f8-4ac4-90cc-4f1abbc58426&page=queryresults
[0m17:05:29.650501 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:50698a88-06f8-4ac4-90cc-4f1abbc58426&page=queryresults
[0m17:05:29.652600 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (execute): 17:05:27.497703 => 17:05:29.652020
[0m17:05:29.662030 [debug] [Thread-1 (]: Database Error in model stg_flights (models/stg_flights.sql)
  Unrecognized name: dep_delay; Did you mean DepDelay? at [26:14]
  compiled Code at target/run/flights_project/models/stg_flights.sql
[0m17:05:29.663551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67cf299e-db6b-4c24-99e1-6905197a6435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43f328fa70>]}
[0m17:05:29.664951 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model db_project_dataset.stg_flights ............ [[31mERROR[0m in 2.27s]
[0m17:05:29.666744 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m17:05:29.670849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:05:29.671822 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m17:05:29.672802 [info ] [MainThread]: 
[0m17:05:29.673896 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.11 seconds (3.11s).
[0m17:05:29.675608 [debug] [MainThread]: Command end result
[0m17:05:29.702465 [info ] [MainThread]: 
[0m17:05:29.703606 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:05:29.704603 [info ] [MainThread]: 
[0m17:05:29.705673 [error] [MainThread]:   Database Error in model stg_flights (models/stg_flights.sql)
  Unrecognized name: dep_delay; Did you mean DepDelay? at [26:14]
  compiled Code at target/run/flights_project/models/stg_flights.sql
[0m17:05:29.706778 [info ] [MainThread]: 
[0m17:05:29.708334 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:05:29.710761 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.857787, "process_user_time": 8.277327, "process_kernel_time": 0.797814, "process_mem_max_rss": "256416", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:05:29.712263 [debug] [MainThread]: Command `dbt run` failed at 17:05:29.711902 after 6.86 seconds
[0m17:05:29.713412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4416e08380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43f326f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43f35b5b80>]}
[0m17:05:29.714380 [debug] [MainThread]: Flushing usage events
[0m17:06:44.360113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f571fee03b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5721c36930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f571fee0470>]}


============================== 17:06:44.371768 | c0d86295-5e5a-45f8-a4bc-b23edc5e02dd ==============================
[0m17:06:44.371768 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:06:44.373164 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m17:06:44.855625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0d86295-5e5a-45f8-a4bc-b23edc5e02dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f571fd95e80>]}
[0m17:06:45.216585 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xjr_g4bw'
[0m17:06:45.217739 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:06:45.328653 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:06:45.331168 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:06:45.457357 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:06:45.466212 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:06:50.167137 [info ] [MainThread]: Installed from version 1.3.0
[0m17:06:50.168201 [info ] [MainThread]: Up to date!
[0m17:06:50.169170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c0d86295-5e5a-45f8-a4bc-b23edc5e02dd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f571fd6f830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f571fd94d70>]}
[0m17:06:50.171570 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 5.988319, "process_user_time": 5.218606, "process_kernel_time": 0.357847, "process_mem_max_rss": "111880", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m17:06:50.173104 [debug] [MainThread]: Command `dbt deps` succeeded at 17:06:50.172680 after 5.99 seconds
[0m17:06:50.174371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5720a849e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f571ff28b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f571ff46210>]}
[0m17:06:50.176034 [debug] [MainThread]: Flushing usage events
[0m17:06:56.615433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db7d21880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db8abd1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db7f85a30>]}


============================== 17:06:56.625244 | af6f0c38-70a3-405b-9c39-52f69b82d2d4 ==============================
[0m17:06:56.625244 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:06:56.626817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_flights', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:07:04.275306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af6f0c38-70a3-405b-9c39-52f69b82d2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d99d295b0>]}
[0m17:07:04.541829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af6f0c38-70a3-405b-9c39-52f69b82d2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db7f8a1b0>]}
[0m17:07:04.543268 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:07:04.592079 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:07:06.186308 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:07:06.187495 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m17:07:06.608241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af6f0c38-70a3-405b-9c39-52f69b82d2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d9847d820>]}
[0m17:07:06.649390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af6f0c38-70a3-405b-9c39-52f69b82d2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d98708ad0>]}
[0m17:07:06.651155 [info ] [MainThread]: Found 1 seed, 2 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:07:06.652780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af6f0c38-70a3-405b-9c39-52f69b82d2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d983b8290>]}
[0m17:07:06.656619 [info ] [MainThread]: 
[0m17:07:06.659154 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:07:06.663089 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:07:06.664684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:07.014974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:07:07.017618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:07.340472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af6f0c38-70a3-405b-9c39-52f69b82d2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d983ba990>]}
[0m17:07:07.342771 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:07:07.357271 [info ] [MainThread]: 
[0m17:07:07.375557 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m17:07:07.377148 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m17:07:07.379853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.stg_flights)
[0m17:07:07.381137 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m17:07:07.417832 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m17:07:07.428893 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (compile): 17:07:07.386348 => 17:07:07.427867
[0m17:07:07.431449 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m17:07:07.543583 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m17:07:07.559524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:07.655072 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    PARSE_TIMESTAMP('%Y-%m-%d %H:%M', CONCAT(CAST(FlightDate AS STRING), ' ', DepTimeFormatted)) AS dep_time,
    PARSE_TIMESTAMP('%Y-%m-%d %H:%M', CONCAT(CAST(FlightDate AS STRING), ' ', ArrTimeFormatted)) AS arr_time,
    FlightNum as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m17:07:08.026094 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:1e556f4b-140e-448e-ad47-1bcea7b4974a&page=queryresults
[0m17:07:08.221400 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (execute): 17:07:07.435301 => 17:07:08.220948
[0m17:07:08.223300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af6f0c38-70a3-405b-9c39-52f69b82d2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d9870bda0>]}
[0m17:07:08.224889 [info ] [Thread-1 (]: 1 of 1 OK created sql view model db_project_dataset.stg_flights ................ [[32mCREATE VIEW (0 processed)[0m in 0.84s]
[0m17:07:08.226758 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m17:07:08.230639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:08.231800 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m17:07:08.232970 [info ] [MainThread]: 
[0m17:07:08.234216 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.57 seconds (1.57s).
[0m17:07:08.236199 [debug] [MainThread]: Command end result
[0m17:07:08.262946 [info ] [MainThread]: 
[0m17:07:08.264345 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:07:08.265662 [info ] [MainThread]: 
[0m17:07:08.267411 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:07:08.270052 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.77872, "process_user_time": 13.78058, "process_kernel_time": 1.336025, "process_mem_max_rss": "257836", "process_in_blocks": "16", "process_out_blocks": "0"}
[0m17:07:08.272238 [debug] [MainThread]: Command `dbt run` succeeded at 17:07:08.271605 after 11.78 seconds
[0m17:07:08.274042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db8056720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d986757f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db7fcfe30>]}
[0m17:07:08.276123 [debug] [MainThread]: Flushing usage events
[0m17:07:16.034167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2f8e4fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2f8e4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2f8e5010>]}


============================== 17:07:16.045652 | f50f13aa-dded-467e-b855-8cb6db5a7118 ==============================
[0m17:07:16.045652 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:07:16.049177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models core_flights', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:07:17.809980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f50f13aa-dded-467e-b855-8cb6db5a7118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d10b96840>]}
[0m17:07:18.014097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f50f13aa-dded-467e-b855-8cb6db5a7118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d10734830>]}
[0m17:07:18.015627 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:07:18.057489 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:07:19.419245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:07:19.420122 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:07:19.429723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f50f13aa-dded-467e-b855-8cb6db5a7118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d103420c0>]}
[0m17:07:19.461158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f50f13aa-dded-467e-b855-8cb6db5a7118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d102e08f0>]}
[0m17:07:19.463072 [info ] [MainThread]: Found 1 seed, 2 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:07:19.464936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f50f13aa-dded-467e-b855-8cb6db5a7118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d0bf7a5d0>]}
[0m17:07:19.467798 [info ] [MainThread]: 
[0m17:07:19.469941 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:07:19.472440 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:07:19.473600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:19.884164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:07:19.885956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:20.232430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f50f13aa-dded-467e-b855-8cb6db5a7118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d1057b9e0>]}
[0m17:07:20.238995 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:07:20.240548 [info ] [MainThread]: 
[0m17:07:20.260898 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m17:07:20.269510 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m17:07:20.272526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m17:07:20.274366 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m17:07:20.304716 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m17:07:20.325711 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 17:07:20.276410 => 17:07:20.324709
[0m17:07:20.327743 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m17:07:20.494474 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m17:07:20.509478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:20.575664 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m17:07:21.301454 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c580e4fe-297c-4c9d-9309-64de44be4202&page=queryresults
[0m17:07:21.937933 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Failed to parse input string "1992-02-24 90:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-02-24 90:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-09-15 "; reason: invalidQuery, location: query, message: Failed to parse input string "1992-02-18 90:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-03-13 90:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-07-12 90:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-12 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-01-31 90:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-19 90:4."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-20 90:2."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-05-19 91:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-03-22 "; reason: invalidQuery, location: query, message: Failed to parse input string "1989-08-20 64:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-02-16 71:2."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-25 80:2."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-08-19 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-09-27 90:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-06-17 34:.0"; reason: invalidQuery, location: query, message: Failed to parse input string "1992-01-29 90:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-08-09 75:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-09-21 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-12-14 64:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-11-10 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-01-01 61:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-02-11 90:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-01-20 "; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-17 90:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-04-28 84:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-08-20 80:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-07-05 63:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-06-20 26:.0"; reason: invalidQuery, location: query, message: Failed to parse input string "1987-10-02 64:1."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-10 "; reason: invalidQuery, location: query, message: Failed to parse input string "1992-10-10 90:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-05-04 72:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-07-29 90:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-05-24 80:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-09-03 "; reason: invalidQuery, location: query, message: Failed to parse input string "1992-07-22 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-10-22 90:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-06-28 65:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-01-30 71:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-06-29 64:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-09-24 82:4."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-10-30 71:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-07-26 75:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-04-22 85:4."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-10-26 "; reason: invalidQuery, location: query, message: Failed to parse input string "1988-07-22 63:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-11-02 64:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-04-26 61:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-03-13 "; reason: invalidQuery, location: query, message: Failed to parse input string "1989-11-28 63:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-01-16 63:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-02-11 85:4."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-06-04 64:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-03-09 "; reason: invalidQuery, location: query, message: Failed to parse input string "1989-06-30 65:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-10-29 85:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-09-23 64:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-01-24 61:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-02-17 62:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-08-15 71:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-16 90:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-12-08 "; reason: invalidQuery, location: query, message: Failed to parse input string "1988-07-02 62:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-02-14 63:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-02-04 85:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-05-17 63:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-02-19 62:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-12-13 71:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-12-31 71:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-04-10 71:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-10-11 65:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1987-12-27 "; reason: invalidQuery, location: query, message: Failed to parse input string "1990-07-26 64:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-02-10 62:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-02 90:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-10-06 71:4."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-12-28 72:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-04-27 71:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-09-04 "; reason: invalidQuery, location: query, message: Failed to parse input string "1990-11-15 70:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-03-20 61:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-10-10 71:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-21 90:2."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-11-06 63:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-06-21 90:4."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-08-26 62:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-05-28 72:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-07-17 64:4."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-05-16 65:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-12-27 63:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-06-05 85:2."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-10-11 90:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-07-07 62:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-04-27 85:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1987-10-29 64:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-12-12 65:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-02-27 62:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-08-23 63:8."')
[0m17:07:23.157192 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:09993472-040a-4b55-9e4e-82714eb32faf&page=queryresults
[0m17:07:23.526213 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:09993472-040a-4b55-9e4e-82714eb32faf&page=queryresults
[0m17:07:23.528966 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 17:07:20.331057 => 17:07:23.527751
[0m17:07:23.537197 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  Failed to parse input string "1991-12-09 90:4."
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m17:07:23.538487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f50f13aa-dded-467e-b855-8cb6db5a7118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d10134ef0>]}
[0m17:07:23.539833 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.core_flights .......... [[31mERROR[0m in 3.27s]
[0m17:07:23.541450 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m17:07:23.546525 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:23.547928 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m17:07:23.549007 [info ] [MainThread]: 
[0m17:07:23.549996 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.08 seconds (4.08s).
[0m17:07:23.551425 [debug] [MainThread]: Command end result
[0m17:07:23.579676 [info ] [MainThread]: 
[0m17:07:23.581850 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:07:23.583140 [info ] [MainThread]: 
[0m17:07:23.584226 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  Failed to parse input string "1991-12-09 90:4."
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m17:07:23.585467 [info ] [MainThread]: 
[0m17:07:23.586643 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:07:23.588617 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.722349, "process_user_time": 8.260402, "process_kernel_time": 0.785745, "process_mem_max_rss": "253000", "process_in_blocks": "144", "command_success": false, "process_out_blocks": "0"}
[0m17:07:23.590146 [debug] [MainThread]: Command `dbt run` failed at 17:07:23.589757 after 7.72 seconds
[0m17:07:23.591556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2f993260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d30488740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d1022ee10>]}
[0m17:07:23.592741 [debug] [MainThread]: Flushing usage events
[0m17:09:29.819588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e144c9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e168996a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e144c9040>]}


============================== 17:09:29.828081 | 605272bf-b436-4333-b334-1f3404095169 ==============================
[0m17:09:29.828081 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:09:29.829323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:09:30.031327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '605272bf-b436-4333-b334-1f3404095169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1437e4b0>]}
[0m17:09:30.375212 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-uaa95wpg'
[0m17:09:30.376206 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:09:30.490782 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:09:30.492581 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:09:30.603255 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:09:30.612770 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:09:35.246594 [info ] [MainThread]: Installed from version 1.3.0
[0m17:09:35.247962 [info ] [MainThread]: Up to date!
[0m17:09:35.249939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '605272bf-b436-4333-b334-1f3404095169', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1437ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1474f950>]}
[0m17:09:35.253106 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 5.5334115, "process_user_time": 3.88278, "process_kernel_time": 0.328542, "process_mem_max_rss": "112020", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m17:09:35.256519 [debug] [MainThread]: Command `dbt deps` succeeded at 17:09:35.256017 after 5.54 seconds
[0m17:09:35.257904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1470ccb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e14af09b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e14486510>]}
[0m17:09:35.258852 [debug] [MainThread]: Flushing usage events
[0m17:09:41.486873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd45d106420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd45d10b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd45d106810>]}


============================== 17:09:41.495103 | 69466946-82ac-465f-9e6a-f8f65c91369d ==============================
[0m17:09:41.495103 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:09:41.496721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models stg_flights', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:09:43.605194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69466946-82ac-465f-9e6a-f8f65c91369d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd439c93680>]}
[0m17:09:44.067003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69466946-82ac-465f-9e6a-f8f65c91369d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd45e620860>]}
[0m17:09:44.069222 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:09:44.112115 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:09:45.538221 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:09:45.539383 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m17:09:45.944814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69466946-82ac-465f-9e6a-f8f65c91369d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd439865a90>]}
[0m17:09:45.988290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69466946-82ac-465f-9e6a-f8f65c91369d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd439af05f0>]}
[0m17:09:45.990123 [info ] [MainThread]: Found 1 seed, 2 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:09:45.991793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69466946-82ac-465f-9e6a-f8f65c91369d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4397abbc0>]}
[0m17:09:45.995902 [info ] [MainThread]: 
[0m17:09:45.998592 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:09:46.001884 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:09:46.003278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:46.482400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:09:46.484079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:09:46.831230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69466946-82ac-465f-9e6a-f8f65c91369d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4397abf80>]}
[0m17:09:46.852496 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:09:46.867038 [info ] [MainThread]: 
[0m17:09:46.894935 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m17:09:46.904012 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m17:09:46.907328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.stg_flights)
[0m17:09:46.909631 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m17:09:46.945646 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m17:09:46.967262 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (compile): 17:09:46.910697 => 17:09:46.966191
[0m17:09:46.970117 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m17:09:47.066186 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m17:09:47.076370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:47.119559 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    CONCAT(CAST(FlightDate AS STRING), ' ', DepTimeFormatted) AS dep_time,
    CONCAT(CAST(FlightDate AS STRING), ' ', ArrTimeFormatted) AS arr_time,
    FlightNum as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m17:09:47.490875 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:9bd200f1-b143-4ebd-b5d3-558dedd4f199&page=queryresults
[0m17:09:47.667013 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (execute): 17:09:46.971296 => 17:09:47.666559
[0m17:09:47.669060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69466946-82ac-465f-9e6a-f8f65c91369d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd439af12b0>]}
[0m17:09:47.670652 [info ] [Thread-1 (]: 1 of 1 OK created sql view model db_project_dataset.stg_flights ................ [[32mCREATE VIEW (0 processed)[0m in 0.76s]
[0m17:09:47.672317 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m17:09:47.676243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:47.677456 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m17:09:47.678849 [info ] [MainThread]: 
[0m17:09:47.680627 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m17:09:47.684196 [debug] [MainThread]: Command end result
[0m17:09:47.723393 [info ] [MainThread]: 
[0m17:09:47.725352 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:09:47.727345 [info ] [MainThread]: 
[0m17:09:47.729274 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:09:47.732041 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.3426337, "process_user_time": 8.441458, "process_kernel_time": 0.908005, "process_mem_max_rss": "260024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:09:47.733931 [debug] [MainThread]: Command `dbt run` succeeded at 17:09:47.733519 after 6.34 seconds
[0m17:09:47.735288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd45f539160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd43985fc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd43989a9f0>]}
[0m17:09:47.736589 [debug] [MainThread]: Flushing usage events
[0m17:09:54.438507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f1ab6780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f1c03020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f1ab6ff0>]}


============================== 17:09:54.451735 | c794e50e-09a3-4fc7-871a-c59e44233a55 ==============================
[0m17:09:54.451735 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:09:54.453205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models core_flights', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:09:56.737286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c794e50e-09a3-4fc7-871a-c59e44233a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ce656ae0>]}
[0m17:09:57.112271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c794e50e-09a3-4fc7-871a-c59e44233a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9cee8cfb0>]}
[0m17:09:57.115322 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:09:57.193136 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:09:58.382909 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:09:58.383806 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:09:58.393440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c794e50e-09a3-4fc7-871a-c59e44233a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ce43d8b0>]}
[0m17:09:58.424371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c794e50e-09a3-4fc7-871a-c59e44233a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ce4f81a0>]}
[0m17:09:58.426327 [info ] [MainThread]: Found 1 seed, 2 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:09:58.428643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c794e50e-09a3-4fc7-871a-c59e44233a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ce271d60>]}
[0m17:09:58.432683 [info ] [MainThread]: 
[0m17:09:58.435169 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:09:58.438823 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:09:58.440357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:58.903014 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:09:58.904254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:09:59.238067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c794e50e-09a3-4fc7-871a-c59e44233a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ce9e0b90>]}
[0m17:09:59.240932 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:09:59.242545 [info ] [MainThread]: 
[0m17:09:59.908546 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m17:09:59.910632 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m17:09:59.912447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m17:09:59.913484 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m17:09:59.929032 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m17:09:59.940617 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 17:09:59.914182 => 17:09:59.940066
[0m17:09:59.942098 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m17:10:00.018016 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m17:10:00.794027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:00.857595 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m17:10:01.516428 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:4935efa9-c4e9-4290-a4a2-7480710e8492&page=queryresults
[0m17:10:04.570228 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 17:09:59.943128 => 17:10:04.569578
[0m17:10:04.572876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c794e50e-09a3-4fc7-871a-c59e44233a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ce5c99a0>]}
[0m17:10:04.576055 [info ] [Thread-1 (]: 1 of 1 OK created sql table model db_project_dataset.core_flights .............. [[32mCREATE TABLE (27.0m rows, 2.6 GiB processed)[0m in 4.66s]
[0m17:10:04.578628 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m17:10:04.584262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:04.585665 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m17:10:04.587045 [info ] [MainThread]: 
[0m17:10:04.588337 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.15 seconds (6.15s).
[0m17:10:04.591300 [debug] [MainThread]: Command end result
[0m17:10:04.632770 [info ] [MainThread]: 
[0m17:10:04.634878 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:10:04.636508 [info ] [MainThread]: 
[0m17:10:04.637836 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:10:04.640989 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.329141, "process_user_time": 8.278624, "process_kernel_time": 0.863022, "process_mem_max_rss": "253624", "process_in_blocks": "1040", "process_out_blocks": "0"}
[0m17:10:04.645029 [debug] [MainThread]: Command `dbt run` succeeded at 17:10:04.644582 after 10.33 seconds
[0m17:10:04.646715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ce49d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ce6e8bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f1afdaf0>]}
[0m17:10:04.648642 [debug] [MainThread]: Flushing usage events
[0m17:20:51.374084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ba2301ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ba2307800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ba2303aa0>]}


============================== 17:20:51.383943 | 54e13c57-e365-49c0-ba10-7f1b179ce2c5 ==============================
[0m17:20:51.383943 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:20:51.385336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models fact_departures_by_airport_year', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:20:51.419773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1bfc00560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1c0af51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1c19b7cb0>]}


============================== 17:20:51.428591 | 6b10733c-3bef-41ac-afbb-41d22b839ab2 ==============================
[0m17:20:51.428591 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:20:51.430175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models core_flights', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:20:55.150011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54e13c57-e365-49c0-ba10-7f1b179ce2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b7f2d7c20>]}
[0m17:20:55.171153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b10733c-3bef-41ac-afbb-41d22b839ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a07aa480>]}
[0m17:20:55.432794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54e13c57-e365-49c0-ba10-7f1b179ce2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b7f761a60>]}
[0m17:20:55.435053 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:20:55.461057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b10733c-3bef-41ac-afbb-41d22b839ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1c02e21b0>]}
[0m17:20:55.462673 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:20:55.482069 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:20:55.512307 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:20:56.294846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:20:56.296120 [debug] [MainThread]: Partial parsing: added file: flights_project://models/marts/fact_departures_by_airport_year.sql
[0m17:20:56.351295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:20:56.353195 [debug] [MainThread]: Partial parsing: added file: flights_project://models/marts/fact_departures_by_airport_year.sql
[0m17:20:56.850480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54e13c57-e365-49c0-ba10-7f1b179ce2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b7edd92b0>]}
[0m17:20:56.899845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54e13c57-e365-49c0-ba10-7f1b179ce2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b7ecc4230>]}
[0m17:20:56.901968 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:20:56.903822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54e13c57-e365-49c0-ba10-7f1b179ce2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b7ea42000>]}
[0m17:20:56.907050 [info ] [MainThread]: 
[0m17:20:56.909311 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:20:56.912099 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:20:56.913360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:56.938075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b10733c-3bef-41ac-afbb-41d22b839ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a03e9580>]}
[0m17:20:56.976655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b10733c-3bef-41ac-afbb-41d22b839ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a058ef90>]}
[0m17:20:56.978707 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:20:56.980197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b10733c-3bef-41ac-afbb-41d22b839ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a05622d0>]}
[0m17:20:56.984852 [info ] [MainThread]: 
[0m17:20:56.988194 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:20:56.992573 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:20:56.994074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:57.378308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:20:57.379452 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:20:57.482308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:20:57.484776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:20:57.741495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54e13c57-e365-49c0-ba10-7f1b179ce2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b7ea42030>]}
[0m17:20:57.744924 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:20:57.747146 [info ] [MainThread]: 
[0m17:20:57.770015 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m17:20:57.771786 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m17:20:57.774688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.fact_departures_by_airport_year)
[0m17:20:57.776055 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m17:20:57.796863 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m17:20:57.819736 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (compile): 17:20:57.777088 => 17:20:57.818533
[0m17:20:57.822143 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m17:20:57.849558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b10733c-3bef-41ac-afbb-41d22b839ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a09058e0>]}
[0m17:20:57.854269 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:20:57.856879 [info ] [MainThread]: 
[0m17:20:57.882642 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m17:20:57.887201 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m17:20:57.890458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m17:20:57.892312 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m17:20:57.913406 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m17:20:57.927681 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 17:20:57.893533 => 17:20:57.926471
[0m17:20:57.930376 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m17:20:57.978091 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m17:20:58.003104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:58.025182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:58.096585 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    EXTRACT(YEAR FROM dep_time) AS flight_year,
    count(*) as num_departures
from flights_data
group by origin, flight_year
    );
  
[0m17:20:58.484364 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m17:20:58.497655 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m17:20:58.573489 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:cfe6c016-5437-417d-94c6-6c6ce236245f&page=queryresults
[0m17:20:58.746576 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM STRING\n  Signature: EXTRACT(DATE_TIME_PART FROM DATE)\n    Argument 1: Unable to coerce type STRING to expected type DATE\n  Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])\n    Argument 1: Unable to coerce type STRING to expected type TIMESTAMP\n  Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)\n    Argument 1: Unable to coerce type STRING to expected type DATETIME\n  Signature: EXTRACT(DATE_TIME_PART FROM TIME)\n    Argument 1: Unable to coerce type STRING to expected type TIME\n  Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)\n    Argument 1: Unable to coerce type STRING to expected type INTERVAL at [22:5]; reason: invalidQuery, location: query, message: No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM STRING\n  Signature: EXTRACT(DATE_TIME_PART FROM DATE)\n    Argument 1: Unable to coerce type STRING to expected type DATE\n  Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])\n    Argument 1: Unable to coerce type STRING to expected type TIMESTAMP\n  Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)\n    Argument 1: Unable to coerce type STRING to expected type DATETIME\n  Signature: EXTRACT(DATE_TIME_PART FROM TIME)\n    Argument 1: Unable to coerce type STRING to expected type TIME\n  Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)\n    Argument 1: Unable to coerce type STRING to expected type INTERVAL at [22:5]')
[0m17:20:59.078330 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:131fe5da-d525-43d9-ab58-c068115489f4&page=queryresults
[0m17:20:59.632614 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:4424eeb9-59f4-4c42-aff6-7788129ee6b9&page=queryresults
[0m17:20:59.812844 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:4424eeb9-59f4-4c42-aff6-7788129ee6b9&page=queryresults
[0m17:20:59.815600 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (execute): 17:20:57.823870 => 17:20:59.814491
[0m17:20:59.829814 [debug] [Thread-1 (]: Database Error in model fact_departures_by_airport_year (models/marts/fact_departures_by_airport_year.sql)
  No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM STRING
    Signature: EXTRACT(DATE_TIME_PART FROM DATE)
      Argument 1: Unable to coerce type STRING to expected type DATE
    Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])
      Argument 1: Unable to coerce type STRING to expected type TIMESTAMP
    Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)
      Argument 1: Unable to coerce type STRING to expected type DATETIME
    Signature: EXTRACT(DATE_TIME_PART FROM TIME)
      Argument 1: Unable to coerce type STRING to expected type TIME
    Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)
      Argument 1: Unable to coerce type STRING to expected type INTERVAL at [22:5]
  compiled Code at target/run/flights_project/models/marts/fact_departures_by_airport_year.sql
[0m17:20:59.831613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54e13c57-e365-49c0-ba10-7f1b179ce2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b7eb1be30>]}
[0m17:20:59.835749 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.fact_departures_by_airport_year  [[31mERROR[0m in 2.06s]
[0m17:20:59.837771 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m17:20:59.842234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:59.843449 [debug] [MainThread]: Connection 'model.flights_project.fact_departures_by_airport_year' was properly closed.
[0m17:20:59.844444 [info ] [MainThread]: 
[0m17:20:59.845535 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.94 seconds (2.94s).
[0m17:20:59.847686 [debug] [MainThread]: Command end result
[0m17:20:59.884699 [info ] [MainThread]: 
[0m17:20:59.886530 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:20:59.887949 [info ] [MainThread]: 
[0m17:20:59.889338 [error] [MainThread]:   Database Error in model fact_departures_by_airport_year (models/marts/fact_departures_by_airport_year.sql)
  No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM STRING
    Signature: EXTRACT(DATE_TIME_PART FROM DATE)
      Argument 1: Unable to coerce type STRING to expected type DATE
    Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])
      Argument 1: Unable to coerce type STRING to expected type TIMESTAMP
    Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)
      Argument 1: Unable to coerce type STRING to expected type DATETIME
    Signature: EXTRACT(DATE_TIME_PART FROM TIME)
      Argument 1: Unable to coerce type STRING to expected type TIME
    Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)
      Argument 1: Unable to coerce type STRING to expected type INTERVAL at [22:5]
  compiled Code at target/run/flights_project/models/marts/fact_departures_by_airport_year.sql
[0m17:20:59.890774 [info ] [MainThread]: 
[0m17:20:59.892010 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:20:59.894433 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.633548, "process_user_time": 10.599586, "process_kernel_time": 0.785576, "process_mem_max_rss": "257772", "process_in_blocks": "400", "command_success": false, "process_out_blocks": "0"}
[0m17:20:59.896135 [debug] [MainThread]: Command `dbt run` failed at 17:20:59.895714 after 8.64 seconds
[0m17:20:59.897708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ba68cb200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b7edd8bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b7f64d670>]}
[0m17:20:59.899989 [debug] [MainThread]: Flushing usage events
[0m17:21:02.170124 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 17:20:57.931560 => 17:21:02.169670
[0m17:21:02.171782 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b10733c-3bef-41ac-afbb-41d22b839ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a058eb70>]}
[0m17:21:02.173143 [info ] [Thread-1 (]: 1 of 1 OK created sql table model db_project_dataset.core_flights .............. [[32mCREATE TABLE (27.0m rows, 2.6 GiB processed)[0m in 4.28s]
[0m17:21:02.174938 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m17:21:02.179381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:02.181293 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m17:21:02.182376 [info ] [MainThread]: 
[0m17:21:02.183619 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.20 seconds (5.20s).
[0m17:21:02.185449 [debug] [MainThread]: Command end result
[0m17:21:02.225890 [info ] [MainThread]: 
[0m17:21:02.227712 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:21:02.232691 [info ] [MainThread]: 
[0m17:21:02.234640 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:21:02.237503 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.939325, "process_user_time": 10.417612, "process_kernel_time": 0.970655, "process_mem_max_rss": "257596", "process_in_blocks": "208", "process_out_blocks": "0"}
[0m17:21:02.239345 [debug] [MainThread]: Command `dbt run` succeeded at 17:21:02.238897 after 10.94 seconds
[0m17:21:02.240631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1c0af51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a083faa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a39ee000>]}
[0m17:21:02.241662 [debug] [MainThread]: Flushing usage events
[0m17:21:49.363563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e6c49ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e6c48b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e6c49490>]}


============================== 17:21:49.379053 | 9b8103aa-61c5-4be5-ab8a-f58227f9cee6 ==============================
[0m17:21:49.379053 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:21:49.380573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_departures_by_airport_year', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:21:54.567727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b8103aa-61c5-4be5-ab8a-f58227f9cee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c38c7b60>]}
[0m17:21:55.035331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b8103aa-61c5-4be5-ab8a-f58227f9cee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c3549dc0>]}
[0m17:21:55.037015 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:21:55.074379 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:21:56.316541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:21:56.317536 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:21:56.331523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b8103aa-61c5-4be5-ab8a-f58227f9cee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c357a450>]}
[0m17:21:56.367110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b8103aa-61c5-4be5-ab8a-f58227f9cee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c3624800>]}
[0m17:21:56.368562 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:21:56.369789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b8103aa-61c5-4be5-ab8a-f58227f9cee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c33aeba0>]}
[0m17:21:56.372446 [info ] [MainThread]: 
[0m17:21:56.374572 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:21:56.377614 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:21:56.378977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:56.901938 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:21:56.903039 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:57.261603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b8103aa-61c5-4be5-ab8a-f58227f9cee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c34abec0>]}
[0m17:21:57.263650 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:21:57.264897 [info ] [MainThread]: 
[0m17:21:57.276528 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m17:21:57.277918 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m17:21:57.279622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.fact_departures_by_airport_year)
[0m17:21:57.281259 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m17:21:57.295674 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m17:21:57.307979 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (compile): 17:21:57.282485 => 17:21:57.307271
[0m17:21:57.309818 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m17:21:57.410551 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m17:21:57.426470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:57.495740 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    EXTRACT(YEAR FROM dep_time) AS flight_year,
    count(*) as num_departures
from flights_data
group by origin, flight_year
    );
  
[0m17:21:57.897975 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:23fcf038-afdc-45d2-a0e3-f0e72d5a6624&page=queryresults
[0m17:21:58.036511 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM STRING\n  Signature: EXTRACT(DATE_TIME_PART FROM DATE)\n    Argument 1: Unable to coerce type STRING to expected type DATE\n  Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])\n    Argument 1: Unable to coerce type STRING to expected type TIMESTAMP\n  Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)\n    Argument 1: Unable to coerce type STRING to expected type DATETIME\n  Signature: EXTRACT(DATE_TIME_PART FROM TIME)\n    Argument 1: Unable to coerce type STRING to expected type TIME\n  Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)\n    Argument 1: Unable to coerce type STRING to expected type INTERVAL at [22:5]; reason: invalidQuery, location: query, message: No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM STRING\n  Signature: EXTRACT(DATE_TIME_PART FROM DATE)\n    Argument 1: Unable to coerce type STRING to expected type DATE\n  Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])\n    Argument 1: Unable to coerce type STRING to expected type TIMESTAMP\n  Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)\n    Argument 1: Unable to coerce type STRING to expected type DATETIME\n  Signature: EXTRACT(DATE_TIME_PART FROM TIME)\n    Argument 1: Unable to coerce type STRING to expected type TIME\n  Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)\n    Argument 1: Unable to coerce type STRING to expected type INTERVAL at [22:5]')
[0m17:21:59.084694 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:87120f91-9070-4006-b85c-3f692e5953da&page=queryresults
[0m17:21:59.225909 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:87120f91-9070-4006-b85c-3f692e5953da&page=queryresults
[0m17:21:59.230663 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (execute): 17:21:57.311018 => 17:21:59.229494
[0m17:21:59.240178 [debug] [Thread-1 (]: Database Error in model fact_departures_by_airport_year (models/marts/fact_departures_by_airport_year.sql)
  No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM STRING
    Signature: EXTRACT(DATE_TIME_PART FROM DATE)
      Argument 1: Unable to coerce type STRING to expected type DATE
    Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])
      Argument 1: Unable to coerce type STRING to expected type TIMESTAMP
    Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)
      Argument 1: Unable to coerce type STRING to expected type DATETIME
    Signature: EXTRACT(DATE_TIME_PART FROM TIME)
      Argument 1: Unable to coerce type STRING to expected type TIME
    Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)
      Argument 1: Unable to coerce type STRING to expected type INTERVAL at [22:5]
  compiled Code at target/run/flights_project/models/marts/fact_departures_by_airport_year.sql
[0m17:21:59.241595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b8103aa-61c5-4be5-ab8a-f58227f9cee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c347d730>]}
[0m17:21:59.242949 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.fact_departures_by_airport_year  [[31mERROR[0m in 1.96s]
[0m17:21:59.244628 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m17:21:59.252108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:59.253222 [debug] [MainThread]: Connection 'model.flights_project.fact_departures_by_airport_year' was properly closed.
[0m17:21:59.254222 [info ] [MainThread]: 
[0m17:21:59.255466 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m17:21:59.259219 [debug] [MainThread]: Command end result
[0m17:21:59.306287 [info ] [MainThread]: 
[0m17:21:59.308141 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:21:59.309956 [info ] [MainThread]: 
[0m17:21:59.312535 [error] [MainThread]:   Database Error in model fact_departures_by_airport_year (models/marts/fact_departures_by_airport_year.sql)
  No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM STRING
    Signature: EXTRACT(DATE_TIME_PART FROM DATE)
      Argument 1: Unable to coerce type STRING to expected type DATE
    Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])
      Argument 1: Unable to coerce type STRING to expected type TIMESTAMP
    Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)
      Argument 1: Unable to coerce type STRING to expected type DATETIME
    Signature: EXTRACT(DATE_TIME_PART FROM TIME)
      Argument 1: Unable to coerce type STRING to expected type TIME
    Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)
      Argument 1: Unable to coerce type STRING to expected type INTERVAL at [22:5]
  compiled Code at target/run/flights_project/models/marts/fact_departures_by_airport_year.sql
[0m17:21:59.318756 [info ] [MainThread]: 
[0m17:21:59.320790 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:21:59.324175 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.213258, "process_user_time": 12.747184, "process_kernel_time": 1.270222, "process_mem_max_rss": "257220", "process_in_blocks": "432", "command_success": false, "process_out_blocks": "0"}
[0m17:21:59.326306 [debug] [MainThread]: Command `dbt run` failed at 17:21:59.325609 after 10.22 seconds
[0m17:21:59.328924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e6f724b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e6c49490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ca6cd790>]}
[0m17:21:59.333659 [debug] [MainThread]: Flushing usage events
[0m17:22:49.395275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cfed24e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cfed1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cfed1070>]}


============================== 17:22:49.404053 | fbc2fbd0-84d6-4203-b943-7a1cc364a227 ==============================
[0m17:22:49.404053 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:22:49.405491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_departures_by_airport_year', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:22:50.741333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbc2fbd0-84d6-4203-b943-7a1cc364a227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cfe8f380>]}
[0m17:22:50.931320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbc2fbd0-84d6-4203-b943-7a1cc364a227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b3a3f950>]}
[0m17:22:50.932804 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:22:50.973504 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:22:51.790736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:22:51.791777 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/marts/fact_departures_by_airport_year.sql
[0m17:22:52.146572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbc2fbd0-84d6-4203-b943-7a1cc364a227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b05188f0>]}
[0m17:22:52.184267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbc2fbd0-84d6-4203-b943-7a1cc364a227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b08c8cb0>]}
[0m17:22:52.185981 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:22:52.187492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbc2fbd0-84d6-4203-b943-7a1cc364a227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b04f83b0>]}
[0m17:22:52.190663 [info ] [MainThread]: 
[0m17:22:52.192451 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:22:52.195330 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:22:52.196422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:52.582622 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:22:52.584040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:22:52.885214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbc2fbd0-84d6-4203-b943-7a1cc364a227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b066f0e0>]}
[0m17:22:52.887237 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:22:52.888418 [info ] [MainThread]: 
[0m17:22:52.899198 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m17:22:52.900482 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m17:22:52.902071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.fact_departures_by_airport_year)
[0m17:22:52.903057 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m17:22:52.914207 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m17:22:52.926317 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (compile): 17:22:52.903758 => 17:22:52.925799
[0m17:22:52.927435 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m17:22:52.995017 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m17:22:53.007871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:53.050857 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    EXTRACT(YEAR FROM CAST(dep_time AS TIMESTAMP)) AS flight_year,
    count(*) as num_departures
from flights_data
group by origin, flight_year
    );
  
[0m17:22:53.495609 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:b7ad021e-8b34-42e4-b5bb-cede7f86c8f6&page=queryresults
[0m17:22:53.906848 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid timestamp: '1989-11-05 15:10'; reason: invalidQuery, location: query, message: Invalid timestamp: '1989-11-05 15:10'; reason: invalidQuery, location: query, message: Invalid timestamp: '1992-12-22 16:31'")
[0m17:22:54.775093 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e106ccc3-d23c-4d78-b629-f6658cc1ce1f&page=queryresults
[0m17:22:55.198530 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e106ccc3-d23c-4d78-b629-f6658cc1ce1f&page=queryresults
[0m17:22:55.200690 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (execute): 17:22:52.928085 => 17:22:55.200035
[0m17:22:55.213387 [debug] [Thread-1 (]: Database Error in model fact_departures_by_airport_year (models/marts/fact_departures_by_airport_year.sql)
  Invalid timestamp: '1989-10-14 19:50'
  compiled Code at target/run/flights_project/models/marts/fact_departures_by_airport_year.sql
[0m17:22:55.215337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbc2fbd0-84d6-4203-b943-7a1cc364a227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b0670fe0>]}
[0m17:22:55.216875 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.fact_departures_by_airport_year  [[31mERROR[0m in 2.31s]
[0m17:22:55.218917 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m17:22:55.225482 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:55.226906 [debug] [MainThread]: Connection 'model.flights_project.fact_departures_by_airport_year' was properly closed.
[0m17:22:55.228012 [info ] [MainThread]: 
[0m17:22:55.229303 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.04 seconds (3.04s).
[0m17:22:55.231251 [debug] [MainThread]: Command end result
[0m17:22:55.258671 [info ] [MainThread]: 
[0m17:22:55.260105 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:22:55.261520 [info ] [MainThread]: 
[0m17:22:55.263177 [error] [MainThread]:   Database Error in model fact_departures_by_airport_year (models/marts/fact_departures_by_airport_year.sql)
  Invalid timestamp: '1989-10-14 19:50'
  compiled Code at target/run/flights_project/models/marts/fact_departures_by_airport_year.sql
[0m17:22:55.264851 [info ] [MainThread]: 
[0m17:22:55.266090 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:22:55.268585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.972994, "process_user_time": 6.591654, "process_kernel_time": 0.61108, "process_mem_max_rss": "261860", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:22:55.270312 [debug] [MainThread]: Command `dbt run` failed at 17:22:55.269976 after 5.97 seconds
[0m17:22:55.271829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d0cd4380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d00eef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cfed3380>]}
[0m17:22:55.273144 [debug] [MainThread]: Flushing usage events
[0m17:23:59.598034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6985b9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6985bbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6985b8a40>]}


============================== 17:23:59.607450 | f288d012-c0b6-4b35-bae4-9b7194f86c52 ==============================
[0m17:23:59.607450 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:23:59.609768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models fact_departures_by_airport_year', 'send_anonymous_usage_stats': 'True'}
[0m17:24:01.512044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f288d012-c0b6-4b35-bae4-9b7194f86c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe675303a10>]}
[0m17:24:01.955022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f288d012-c0b6-4b35-bae4-9b7194f86c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe67567f620>]}
[0m17:24:01.961873 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:24:02.020895 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:24:03.325718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:24:03.328138 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/marts/fact_departures_by_airport_year.sql
[0m17:24:03.869637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f288d012-c0b6-4b35-bae4-9b7194f86c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe674ca9790>]}
[0m17:24:03.922014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f288d012-c0b6-4b35-bae4-9b7194f86c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe674f8c770>]}
[0m17:24:03.923625 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:24:03.925119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f288d012-c0b6-4b35-bae4-9b7194f86c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe674bc7830>]}
[0m17:24:03.928886 [info ] [MainThread]: 
[0m17:24:03.931444 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:24:03.935263 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:24:03.938547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:04.475979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:24:04.529297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:04.897031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f288d012-c0b6-4b35-bae4-9b7194f86c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe674bc4590>]}
[0m17:24:04.899288 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:24:04.900892 [info ] [MainThread]: 
[0m17:24:04.911816 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m17:24:04.913119 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.fact_departures_by_airport_year . [RUN]
[0m17:24:04.914828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.fact_departures_by_airport_year)
[0m17:24:04.915917 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m17:24:04.928222 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m17:24:04.939591 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (compile): 17:24:04.916723 => 17:24:04.938812
[0m17:24:04.940821 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m17:24:05.004467 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m17:24:05.017674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:05.064895 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
  OPTIONS()
  as with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)

select 
    origin as airport_code,
    EXTRACT(YEAR FROM TRY_CAST(dep_time AS TIMESTAMP)) AS flight_year,  -- Try to cast dep_time to TIMESTAMP
    count(*) as num_departures
from flights_data
where TRY_CAST(dep_time AS TIMESTAMP) IS NOT NULL  -- Filter out rows where dep_time is not a valid timestamp
group by origin, flight_year;


[0m17:24:05.392571 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:5549c860-00eb-4197-9bca-9e1cad5a148c&page=queryresults
[0m17:24:05.518757 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Function not found: TRY_CAST at [16:7]; reason: invalidQuery, location: query, message: Function not found: TRY_CAST at [16:7]')
[0m17:24:05.706040 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c2ccc0d0-e969-43eb-83ee-d017e3d44b53&page=queryresults
[0m17:24:05.814661 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c2ccc0d0-e969-43eb-83ee-d017e3d44b53&page=queryresults
[0m17:24:05.819719 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (execute): 17:24:04.941551 => 17:24:05.818389
[0m17:24:05.830089 [debug] [Thread-1 (]: Database Error in model fact_departures_by_airport_year (models/marts/fact_departures_by_airport_year.sql)
  Function not found: TRY_CAST at [16:7]
  compiled Code at target/run/flights_project/models/marts/fact_departures_by_airport_year.sql
[0m17:24:05.832441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f288d012-c0b6-4b35-bae4-9b7194f86c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe674f8f5f0>]}
[0m17:24:05.835844 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model db_project_dataset.fact_departures_by_airport_year  [[31mERROR[0m in 0.92s]
[0m17:24:05.839400 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m17:24:05.846486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:05.857167 [debug] [MainThread]: Connection 'model.flights_project.fact_departures_by_airport_year' was properly closed.
[0m17:24:05.858685 [info ] [MainThread]: 
[0m17:24:05.859772 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.93 seconds (1.93s).
[0m17:24:05.863120 [debug] [MainThread]: Command end result
[0m17:24:05.911636 [info ] [MainThread]: 
[0m17:24:05.915259 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:24:05.922755 [info ] [MainThread]: 
[0m17:24:05.925316 [error] [MainThread]:   Database Error in model fact_departures_by_airport_year (models/marts/fact_departures_by_airport_year.sql)
  Function not found: TRY_CAST at [16:7]
  compiled Code at target/run/flights_project/models/marts/fact_departures_by_airport_year.sql
[0m17:24:05.927917 [info ] [MainThread]: 
[0m17:24:05.929884 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:24:05.935333 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.443678, "process_user_time": 9.020599, "process_kernel_time": 0.806477, "process_mem_max_rss": "261932", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:24:05.938716 [debug] [MainThread]: Command `dbt run` failed at 17:24:05.937903 after 6.45 seconds
[0m17:24:05.941060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe69cb83200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6985be1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe674c039e0>]}
[0m17:24:05.942923 [debug] [MainThread]: Flushing usage events
[0m17:25:27.767710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe18881c7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe18881c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe188a3c770>]}


============================== 17:25:27.776404 | a2123085-295c-4d06-9a0c-bc36dca53733 ==============================
[0m17:25:27.776404 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:25:27.777847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:25:27.966455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2123085-295c-4d06-9a0c-bc36dca53733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1886d2c90>]}
[0m17:25:28.371557 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-x1xe8ehs'
[0m17:25:28.372572 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:25:28.613036 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:25:28.615176 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:25:28.716327 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:25:28.725758 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:25:32.493930 [info ] [MainThread]: Installed from version 1.3.0
[0m17:25:32.494941 [info ] [MainThread]: Up to date!
[0m17:25:32.495915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a2123085-295c-4d06-9a0c-bc36dca53733', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1888c4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1888c4da0>]}
[0m17:25:32.497534 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.831253, "process_user_time": 3.693803, "process_kernel_time": 0.244893, "process_mem_max_rss": "112024", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m17:25:32.498479 [debug] [MainThread]: Command `dbt deps` succeeded at 17:25:32.498261 after 4.83 seconds
[0m17:25:32.499270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe18881c7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe188a3c770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1885bc1a0>]}
[0m17:25:32.500139 [debug] [MainThread]: Flushing usage events
[0m17:25:37.097506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a197f06b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a1b5c8620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a1a3949e0>]}


============================== 17:25:37.106336 | a1aa6b8a-ef3a-48ce-b466-c9146ba6c5ec ==============================
[0m17:25:37.106336 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:25:37.107840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_flights', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:25:38.410458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1aa6b8a-ef3a-48ce-b466-c9146ba6c5ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f63a5f10>]}
[0m17:25:38.622706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1aa6b8a-ef3a-48ce-b466-c9146ba6c5ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fd385760>]}
[0m17:25:38.624104 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:25:38.664853 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:25:39.711497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:25:39.713262 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/marts/fact_departures_by_airport_year.sql
[0m17:25:39.714527 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m17:25:40.130119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1aa6b8a-ef3a-48ce-b466-c9146ba6c5ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f5eb9c40>]}
[0m17:25:40.166070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1aa6b8a-ef3a-48ce-b466-c9146ba6c5ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f61d8740>]}
[0m17:25:40.167426 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:25:40.168859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1aa6b8a-ef3a-48ce-b466-c9146ba6c5ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f5df4e90>]}
[0m17:25:40.171915 [info ] [MainThread]: 
[0m17:25:40.174385 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:25:40.177351 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:25:40.178514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:40.577270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:25:40.579125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:40.904544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1aa6b8a-ef3a-48ce-b466-c9146ba6c5ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f5df5010>]}
[0m17:25:40.906977 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:25:40.908634 [info ] [MainThread]: 
[0m17:25:40.919288 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m17:25:40.920591 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m17:25:40.922280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.stg_flights)
[0m17:25:40.923269 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m17:25:40.937604 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m17:25:40.950123 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (compile): 17:25:40.924194 => 17:25:40.949582
[0m17:25:40.951058 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m17:25:40.994405 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m17:25:41.006916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:41.045571 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    PARSE_TIMESTAMP('%Y-%m-%d %H:%M', CONCAT(CAST(FlightDate AS STRING), ' ', DepTimeFormatted)) AS dep_time,
    PARSE_TIMESTAMP('%Y-%m-%d %H:%M', CONCAT(CAST(FlightDate AS STRING), ' ', ArrTimeFormatted)) AS arr_time,
    FlightNum as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m17:25:41.421081 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:2bdf3949-5596-4c91-84a4-b054e5de2e53&page=queryresults
[0m17:25:41.596887 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (execute): 17:25:40.951673 => 17:25:41.596521
[0m17:25:41.598450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1aa6b8a-ef3a-48ce-b466-c9146ba6c5ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f602bfb0>]}
[0m17:25:41.599684 [info ] [Thread-1 (]: 1 of 1 OK created sql view model db_project_dataset.stg_flights ................ [[32mCREATE VIEW (0 processed)[0m in 0.68s]
[0m17:25:41.601139 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m17:25:41.604619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:41.605634 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m17:25:41.606623 [info ] [MainThread]: 
[0m17:25:41.607870 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m17:25:41.609395 [debug] [MainThread]: Command end result
[0m17:25:41.633152 [info ] [MainThread]: 
[0m17:25:41.634591 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:25:41.635757 [info ] [MainThread]: 
[0m17:25:41.636946 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:25:41.638955 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.6365137, "process_user_time": 5.999399, "process_kernel_time": 0.743727, "process_mem_max_rss": "259632", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:25:41.640535 [debug] [MainThread]: Command `dbt run` succeeded at 17:25:41.640277 after 4.64 seconds
[0m17:25:41.641631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a1a5629c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a19854740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f5e4be60>]}
[0m17:25:41.642916 [debug] [MainThread]: Flushing usage events
[0m17:25:47.332779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dd3cd4e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dd3cd47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dd3cd79e0>]}


============================== 17:25:47.341386 | b1fd67c4-b53d-4190-98e8-19e18f4d3210 ==============================
[0m17:25:47.341386 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:25:47.342847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:25:48.653776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1fd67c4-b53d-4190-98e8-19e18f4d3210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db4d2cbc0>]}
[0m17:25:48.846885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1fd67c4-b53d-4190-98e8-19e18f4d3210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db4b69b80>]}
[0m17:25:48.848461 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:25:48.888574 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:25:49.811346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:25:49.812182 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:25:49.821366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1fd67c4-b53d-4190-98e8-19e18f4d3210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db47c64b0>]}
[0m17:25:49.854093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1fd67c4-b53d-4190-98e8-19e18f4d3210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db46ac7d0>]}
[0m17:25:49.855428 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:25:49.856658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1fd67c4-b53d-4190-98e8-19e18f4d3210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db46267e0>]}
[0m17:25:49.859574 [info ] [MainThread]: 
[0m17:25:49.861573 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:25:49.864091 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:25:49.865491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:50.282756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:25:50.284372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:50.573668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1fd67c4-b53d-4190-98e8-19e18f4d3210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db516aa80>]}
[0m17:25:50.576046 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:25:50.577589 [info ] [MainThread]: 
[0m17:25:50.588033 [debug] [Thread-1 (]: Began running node seed.flights_project.airports
[0m17:25:50.589265 [info ] [Thread-1 (]: 1 of 1 START seed file db_project_dataset.airports ............................. [RUN]
[0m17:25:50.590894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now seed.flights_project.airports)
[0m17:25:50.591929 [debug] [Thread-1 (]: Began compiling node seed.flights_project.airports
[0m17:25:50.593026 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (compile): 17:25:50.592660 => 17:25:50.592667
[0m17:25:50.594148 [debug] [Thread-1 (]: Began executing node seed.flights_project.airports
[0m17:25:50.726103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:54.233815 [debug] [Thread-1 (]: On seed.flights_project.airports: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.flights_project.airports"} */

    alter table `db-project-456518`.`db_project_dataset`.`airports` set OPTIONS()
  
[0m17:25:54.362044 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:df410881-1657-463a-bb43-039b75b73909&page=queryresults
[0m17:25:54.540399 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.flights_project.airports"
[0m17:25:54.573459 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (execute): 17:25:50.594871 => 17:25:54.572935
[0m17:25:54.575116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1fd67c4-b53d-4190-98e8-19e18f4d3210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db48277a0>]}
[0m17:25:54.576369 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file db_project_dataset.airports ......................... [[32mINSERT 3376[0m in 3.98s]
[0m17:25:54.578222 [debug] [Thread-1 (]: Finished running node seed.flights_project.airports
[0m17:25:54.582210 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:54.583292 [debug] [MainThread]: Connection 'seed.flights_project.airports' was properly closed.
[0m17:25:54.584400 [info ] [MainThread]: 
[0m17:25:54.585533 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 4.72 seconds (4.72s).
[0m17:25:54.587136 [debug] [MainThread]: Command end result
[0m17:25:54.612904 [info ] [MainThread]: 
[0m17:25:54.614218 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:25:54.615509 [info ] [MainThread]: 
[0m17:25:54.616918 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:25:54.619117 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 7.388494, "process_user_time": 5.630888, "process_kernel_time": 0.546206, "process_mem_max_rss": "262216", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:25:54.620440 [debug] [MainThread]: Command `dbt seed` succeeded at 17:25:54.620132 after 7.39 seconds
[0m17:25:54.621612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dd43dd760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db490d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db445f6e0>]}
[0m17:25:54.622828 [debug] [MainThread]: Flushing usage events
[0m17:26:00.240119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4310c0b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4311b8230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4310c19d0>]}


============================== 17:26:00.248846 | bfe1bde8-200a-4359-b2b1-5d3a607b267c ==============================
[0m17:26:00.248846 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:26:00.250166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models core_flights', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:26:01.619460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfe1bde8-200a-4359-b2b1-5d3a607b267c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc40e031520>]}
[0m17:26:01.817404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfe1bde8-200a-4359-b2b1-5d3a607b267c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc43107efc0>]}
[0m17:26:01.818785 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:26:01.858982 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:26:02.779425 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:26:02.780240 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:26:02.789097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfe1bde8-200a-4359-b2b1-5d3a607b267c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc40da595e0>]}
[0m17:26:02.823798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfe1bde8-200a-4359-b2b1-5d3a607b267c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc40dab0050>]}
[0m17:26:02.825147 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:26:02.826460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfe1bde8-200a-4359-b2b1-5d3a607b267c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc40dc4b4a0>]}
[0m17:26:02.829061 [info ] [MainThread]: 
[0m17:26:02.831127 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:26:02.833244 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:26:02.834226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:03.244429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:26:03.246051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:26:03.566285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfe1bde8-200a-4359-b2b1-5d3a607b267c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc40dc4b4a0>]}
[0m17:26:03.568885 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:26:03.570388 [info ] [MainThread]: 
[0m17:26:03.602373 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m17:26:03.604434 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m17:26:03.606856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m17:26:03.608506 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m17:26:03.632831 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m17:26:03.641795 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 17:26:03.609559 => 17:26:03.640880
[0m17:26:03.642920 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m17:26:03.670829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:04.040961 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m17:26:04.053020 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m17:26:04.561796 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:25e65d3a-d990-46dd-a89d-4ffbd2720971&page=queryresults
[0m17:26:05.293459 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Failed to parse input string "1992-10-24 90:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-10-24 90:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-07-21 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-07-28 90:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-01-11 74:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-12-11 90:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-11-02 90:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-10-12 65:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-07-19 90:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-11-06 90:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-03-14 "; reason: invalidQuery, location: query, message: Failed to parse input string "1992-10-19 90:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-09-29 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-11-14 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-09-22 90:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-10-28 90:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-09-10 12:1."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-01-25 "; reason: invalidQuery, location: query, message: Failed to parse input string "1990-08-13 23:1."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-01-10 71:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-05-08 28:.0"; reason: invalidQuery, location: query, message: Failed to parse input string "1988-07-30 29:.0"; reason: invalidQuery, location: query, message: Failed to parse input string "1992-07-13 75:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-06-06 65:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-07-03 "; reason: invalidQuery, location: query, message: Failed to parse input string "1987-11-13 65:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-05-28 85:2."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-12-26 71:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-03-05 "; reason: invalidQuery, location: query, message: Failed to parse input string "1990-09-09 64:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-06-30 63:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-31 90:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-02-05 71:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-04-22 "; reason: invalidQuery, location: query, message: Failed to parse input string "1991-12-06 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-07-15 62:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-04-23 "; reason: invalidQuery, location: query, message: Failed to parse input string "1992-06-20 73:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-08-30 62:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-07-20 71:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-04-10 62:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-12-02 64:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-10-27 71:4."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-05-15 65:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-11-30 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-05-29 65:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-05-07 80:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-10-04 64:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-06-16 85:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-05-05 63:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-08-18 64:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-05-04 03:.0"; reason: invalidQuery, location: query, message: Failed to parse input string "1987-10-18 64:2."; reason: invalidQuery, location: query, message: Failed to parse input string "1987-12-28 95:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-05-15 63:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-04-17 72:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-08-01 64:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-01-23 62:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-06-05 71:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-06-19 71:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-10-09 80:4."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-04-19 62:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-05-03 61:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-12-18 71:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-10-03 90:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-12-30 63:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-01-24 63:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-09-14 61:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-11-16 "; reason: invalidQuery, location: query, message: Failed to parse input string "1992-08-29 75:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-06-23 71:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-05-26 70:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-12-22 20:.0"; reason: invalidQuery, location: query, message: Failed to parse input string "1990-11-24 62:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-02-26 61:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-04-25 71:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-03-21 61:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-12-24 63:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-18 90:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1987-12-12 65:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-02-03 61:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-11-14 71:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1987-12-22 64:2."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-11-23 63:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-07-19 20:.0"; reason: invalidQuery, location: query, message: Failed to parse input string "1989-06-24 65:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-11-10 75:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1987-10-28 64:4."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-05-14 65:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-01-17 71:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-02-09 75:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1987-11-11 24:00"; reason: invalidQuery, location: query, message: Failed to parse input string "1991-06-17 72:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-03-25 71:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-11-05 71:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-05-18 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-01-29 63:2."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-01-12 80:1."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-09-24 63:4."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-09-29 75:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-01-15 61:8."')
[0m17:26:06.217614 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:de89dfa1-6434-4c46-aed4-0a1caf8b2c37&page=queryresults
[0m17:26:06.707050 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:de89dfa1-6434-4c46-aed4-0a1caf8b2c37&page=queryresults
[0m17:26:06.709291 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 17:26:03.643669 => 17:26:06.708597
[0m17:26:06.720540 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  Failed to parse input string "1991-08-09 90:2."
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m17:26:06.721989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfe1bde8-200a-4359-b2b1-5d3a607b267c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc40dc11d60>]}
[0m17:26:06.723656 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.core_flights .......... [[31mERROR[0m in 3.12s]
[0m17:26:06.725568 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m17:26:06.730251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:26:06.731451 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m17:26:06.732509 [info ] [MainThread]: 
[0m17:26:06.733706 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.90 seconds (3.90s).
[0m17:26:06.735484 [debug] [MainThread]: Command end result
[0m17:26:06.760818 [info ] [MainThread]: 
[0m17:26:06.762038 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:26:06.763012 [info ] [MainThread]: 
[0m17:26:06.764011 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  Failed to parse input string "1991-08-09 90:2."
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m17:26:06.765051 [info ] [MainThread]: 
[0m17:26:06.766186 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:26:06.768567 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.623964, "process_user_time": 5.633407, "process_kernel_time": 0.63475, "process_mem_max_rss": "256752", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:26:06.770070 [debug] [MainThread]: Command `dbt run` failed at 17:26:06.769814 after 6.63 seconds
[0m17:26:06.771162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc43107ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc40db0f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4311cb560>]}
[0m17:26:06.772407 [debug] [MainThread]: Flushing usage events
[0m17:29:11.129891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b2aafd7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b2aafca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b2aafd010>]}


============================== 17:29:11.139521 | b25117a1-8d82-463f-8de7-513a6d6da6d8 ==============================
[0m17:29:11.139521 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:29:11.141077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models fact_departures_by_airport_year', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:29:12.610705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b25117a1-8d82-463f-8de7-513a6d6da6d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b2a9864e0>]}
[0m17:29:12.876859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b25117a1-8d82-463f-8de7-513a6d6da6d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b2adf30b0>]}
[0m17:29:12.878503 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:29:12.914983 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:29:13.879452 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:29:13.880512 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:29:13.890652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b25117a1-8d82-463f-8de7-513a6d6da6d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b075baae0>]}
[0m17:29:13.922889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b25117a1-8d82-463f-8de7-513a6d6da6d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b074d8230>]}
[0m17:29:13.924519 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:29:13.926164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b25117a1-8d82-463f-8de7-513a6d6da6d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b072569f0>]}
[0m17:29:13.928985 [info ] [MainThread]: 
[0m17:29:13.930992 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:29:13.933466 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:29:13.934762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:14.416893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:29:14.418648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:29:14.716395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b25117a1-8d82-463f-8de7-513a6d6da6d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0753df10>]}
[0m17:29:14.718737 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:29:14.720247 [info ] [MainThread]: 
[0m17:29:14.731330 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m17:29:14.732610 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m17:29:14.734374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.fact_departures_by_airport_year)
[0m17:29:14.735440 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m17:29:14.747602 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m17:29:14.760648 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (compile): 17:29:14.736205 => 17:29:14.759922
[0m17:29:14.761710 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m17:29:14.826868 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m17:29:14.839720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:14.884941 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    EXTRACT(YEAR FROM dep_time) AS flight_year,
    count(*) as num_departures
from flights_data
group by origin, flight_year
    );
  
[0m17:29:15.300739 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:11ec8852-f50a-4480-b8e6-eb0241fb3a7a&page=queryresults
[0m17:29:15.449322 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM STRING\n  Signature: EXTRACT(DATE_TIME_PART FROM DATE)\n    Argument 1: Unable to coerce type STRING to expected type DATE\n  Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])\n    Argument 1: Unable to coerce type STRING to expected type TIMESTAMP\n  Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)\n    Argument 1: Unable to coerce type STRING to expected type DATETIME\n  Signature: EXTRACT(DATE_TIME_PART FROM TIME)\n    Argument 1: Unable to coerce type STRING to expected type TIME\n  Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)\n    Argument 1: Unable to coerce type STRING to expected type INTERVAL at [22:5]; reason: invalidQuery, location: query, message: No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM STRING\n  Signature: EXTRACT(DATE_TIME_PART FROM DATE)\n    Argument 1: Unable to coerce type STRING to expected type DATE\n  Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])\n    Argument 1: Unable to coerce type STRING to expected type TIMESTAMP\n  Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)\n    Argument 1: Unable to coerce type STRING to expected type DATETIME\n  Signature: EXTRACT(DATE_TIME_PART FROM TIME)\n    Argument 1: Unable to coerce type STRING to expected type TIME\n  Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)\n    Argument 1: Unable to coerce type STRING to expected type INTERVAL at [22:5]')
[0m17:29:15.869069 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:57f194f3-185f-4ab3-b73c-e01f863b113c&page=queryresults
[0m17:29:15.991420 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:57f194f3-185f-4ab3-b73c-e01f863b113c&page=queryresults
[0m17:29:15.993593 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (execute): 17:29:14.762433 => 17:29:15.992947
[0m17:29:16.002984 [debug] [Thread-1 (]: Database Error in model fact_departures_by_airport_year (models/marts/fact_departures_by_airport_year.sql)
  No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM STRING
    Signature: EXTRACT(DATE_TIME_PART FROM DATE)
      Argument 1: Unable to coerce type STRING to expected type DATE
    Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])
      Argument 1: Unable to coerce type STRING to expected type TIMESTAMP
    Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)
      Argument 1: Unable to coerce type STRING to expected type DATETIME
    Signature: EXTRACT(DATE_TIME_PART FROM TIME)
      Argument 1: Unable to coerce type STRING to expected type TIME
    Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)
      Argument 1: Unable to coerce type STRING to expected type INTERVAL at [22:5]
  compiled Code at target/run/flights_project/models/marts/fact_departures_by_airport_year.sql
[0m17:29:16.004212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b25117a1-8d82-463f-8de7-513a6d6da6d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0728fe60>]}
[0m17:29:16.005481 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.fact_departures_by_airport_year  [[31mERROR[0m in 1.27s]
[0m17:29:16.006988 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m17:29:16.011011 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:29:16.011967 [debug] [MainThread]: Connection 'model.flights_project.fact_departures_by_airport_year' was properly closed.
[0m17:29:16.012902 [info ] [MainThread]: 
[0m17:29:16.014009 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m17:29:16.015702 [debug] [MainThread]: Command end result
[0m17:29:16.039754 [info ] [MainThread]: 
[0m17:29:16.041058 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:29:16.042137 [info ] [MainThread]: 
[0m17:29:16.043373 [error] [MainThread]:   Database Error in model fact_departures_by_airport_year (models/marts/fact_departures_by_airport_year.sql)
  No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM STRING
    Signature: EXTRACT(DATE_TIME_PART FROM DATE)
      Argument 1: Unable to coerce type STRING to expected type DATE
    Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])
      Argument 1: Unable to coerce type STRING to expected type TIMESTAMP
    Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)
      Argument 1: Unable to coerce type STRING to expected type DATETIME
    Signature: EXTRACT(DATE_TIME_PART FROM TIME)
      Argument 1: Unable to coerce type STRING to expected type TIME
    Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)
      Argument 1: Unable to coerce type STRING to expected type INTERVAL at [22:5]
  compiled Code at target/run/flights_project/models/marts/fact_departures_by_airport_year.sql
[0m17:29:16.044607 [info ] [MainThread]: 
[0m17:29:16.045934 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:29:16.048360 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.0381656, "process_user_time": 5.74006, "process_kernel_time": 0.510005, "process_mem_max_rss": "254468", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:29:16.050032 [debug] [MainThread]: Command `dbt run` failed at 17:29:16.049592 after 5.04 seconds
[0m17:29:16.051766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b2aafd0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b075f5be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b2e54bda0>]}
[0m17:29:16.053338 [debug] [MainThread]: Flushing usage events
[0m17:31:12.765529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0de6e29b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0de714c3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0de6e28980>]}


============================== 17:31:12.775000 | b436b87b-889b-4961-8521-62d0a76f924f ==============================
[0m17:31:12.775000 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:31:12.776523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models core_flights', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:31:14.176939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b436b87b-889b-4961-8521-62d0a76f924f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dc81acda0>]}
[0m17:31:14.365570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b436b87b-889b-4961-8521-62d0a76f924f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0de714dbe0>]}
[0m17:31:14.366956 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:31:14.407485 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:31:15.313783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:31:15.314585 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:31:15.323061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b436b87b-889b-4961-8521-62d0a76f924f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0de6de75c0>]}
[0m17:31:15.354546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b436b87b-889b-4961-8521-62d0a76f924f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dc38148f0>]}
[0m17:31:15.356111 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:31:15.357280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b436b87b-889b-4961-8521-62d0a76f924f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dc35965a0>]}
[0m17:31:15.359714 [info ] [MainThread]: 
[0m17:31:15.361537 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:31:15.363916 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:31:15.364998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:15.838431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:31:15.840064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:31:16.171701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b436b87b-889b-4961-8521-62d0a76f924f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0de6e28380>]}
[0m17:31:16.174050 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:31:16.175491 [info ] [MainThread]: 
[0m17:31:16.185862 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m17:31:16.187065 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m17:31:16.188723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m17:31:16.189818 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m17:31:16.201483 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m17:31:16.213070 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 17:31:16.190564 => 17:31:16.212355
[0m17:31:16.214243 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m17:31:16.237512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:16.580452 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m17:31:16.594378 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m17:31:17.191952 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:6dea19e8-e71e-4b7e-9bb0-427a21ee51a8&page=queryresults
[0m17:31:17.612257 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Failed to parse input string "1992-12-23 90:2."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-23 90:2."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-06 91:1."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-04 90:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-10-03 90:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-09-05 90:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-06-02 90:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-10-13 90:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-11-08 90:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-02-07 90:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-11-14 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-11-19 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-09-29 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-10-25 "; reason: invalidQuery, location: query, message: Failed to parse input string "1992-09-24 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-12-06 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-07-16 90:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-08-28 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-03-26 91:1."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-10-15 90:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-10-06 "; reason: invalidQuery, location: query, message: Failed to parse input string "1991-08-20 93:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-11-05 93:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-09-22 90:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-11-08 91:1."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-03-14 "')
[0m17:31:18.211334 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:55ba0656-23ca-404a-a182-7e841b61a636&page=queryresults
[0m17:31:18.892135 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:55ba0656-23ca-404a-a182-7e841b61a636&page=queryresults
[0m17:31:18.895481 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 17:31:16.214984 => 17:31:18.894477
[0m17:31:18.909038 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  Failed to parse input string "1992-01-13 "
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m17:31:18.912738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b436b87b-889b-4961-8521-62d0a76f924f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dc35d29f0>]}
[0m17:31:18.914869 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.core_flights .......... [[31mERROR[0m in 2.72s]
[0m17:31:18.917240 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m17:31:18.924255 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:18.926305 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m17:31:18.927637 [info ] [MainThread]: 
[0m17:31:18.929103 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.57 seconds (3.57s).
[0m17:31:18.931507 [debug] [MainThread]: Command end result
[0m17:31:18.965685 [info ] [MainThread]: 
[0m17:31:18.967501 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:31:18.969720 [info ] [MainThread]: 
[0m17:31:18.973091 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  Failed to parse input string "1992-01-13 "
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m17:31:18.976188 [info ] [MainThread]: 
[0m17:31:18.978354 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:31:18.980657 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.31511, "process_user_time": 5.552238, "process_kernel_time": 0.672694, "process_mem_max_rss": "257356", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:31:18.983033 [debug] [MainThread]: Command `dbt run` failed at 17:31:18.982569 after 6.32 seconds
[0m17:31:18.984794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0de6de7b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0de7450c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dc35d29f0>]}
[0m17:31:18.986556 [debug] [MainThread]: Flushing usage events
[0m17:40:21.935381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b48f8f560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b4a030fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b49282f00>]}


============================== 17:40:21.945782 | 6737720d-e239-4e45-b7f7-571e4ea8dfad ==============================
[0m17:40:21.945782 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:40:21.947150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:40:22.152469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6737720d-e239-4e45-b7f7-571e4ea8dfad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b48e425d0>]}
[0m17:40:22.628261 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wiz8p863'
[0m17:40:22.629373 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:40:25.859352 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:40:25.861717 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:40:25.963519 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:40:25.974179 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:40:30.621442 [info ] [MainThread]: Installed from version 1.3.0
[0m17:40:30.622689 [info ] [MainThread]: Up to date!
[0m17:40:30.624208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6737720d-e239-4e45-b7f7-571e4ea8dfad', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b48e6fcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b48e8bbc0>]}
[0m17:40:30.626909 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 8.809817, "process_user_time": 5.257687, "process_kernel_time": 0.411383, "process_mem_max_rss": "111664", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m17:40:30.628492 [debug] [MainThread]: Command `dbt deps` succeeded at 17:40:30.628059 after 8.81 seconds
[0m17:40:30.629943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b49282f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b48f90b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b48e6fcb0>]}
[0m17:40:30.631332 [debug] [MainThread]: Flushing usage events
[0m17:40:35.960440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4504bb21e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45030b8260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4502fc0680>]}


============================== 17:40:35.969450 | 52eb16ef-dc16-4ece-ba8e-0dc9521069cc ==============================
[0m17:40:35.969450 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:40:35.970691 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models stg_flights', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:40:37.393592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52eb16ef-dc16-4ece-ba8e-0dc9521069cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e6a36930>]}
[0m17:40:37.621702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52eb16ef-dc16-4ece-ba8e-0dc9521069cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4502f7b2c0>]}
[0m17:40:37.623173 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:40:37.666371 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:40:38.723079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:40:38.724158 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m17:40:38.725065 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/marts/fact_departures_by_airport_year.sql
[0m17:40:39.245103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52eb16ef-dc16-4ece-ba8e-0dc9521069cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44df684cb0>]}
[0m17:40:39.290284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52eb16ef-dc16-4ece-ba8e-0dc9521069cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44df99c7d0>]}
[0m17:40:39.292203 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:40:39.293972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52eb16ef-dc16-4ece-ba8e-0dc9521069cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44df5d3b60>]}
[0m17:40:39.299493 [info ] [MainThread]: 
[0m17:40:39.303112 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:40:39.306122 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:40:39.307275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:39.756433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:40:39.757610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:40.165486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52eb16ef-dc16-4ece-ba8e-0dc9521069cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44df99ea50>]}
[0m17:40:40.168071 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:40:40.169739 [info ] [MainThread]: 
[0m17:40:40.188018 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m17:40:40.189993 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m17:40:40.192545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.stg_flights)
[0m17:40:40.193790 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m17:40:40.217635 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m17:40:40.230691 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (compile): 17:40:40.194545 => 17:40:40.229938
[0m17:40:40.232602 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m17:40:40.311746 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m17:40:40.321140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:40.366095 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    CONCAT(CAST(FlightDate AS STRING), ' ', DepTimeFormatted) AS dep_time,
    CONCAT(CAST(FlightDate AS STRING), ' ', ArrTimeFormatted) AS arr_time,
    FlightNum as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m17:40:41.095797 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:4faf251c-de12-4d87-aa4b-9dd1a104d14a&page=queryresults
[0m17:40:41.843731 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (execute): 17:40:40.234048 => 17:40:41.843197
[0m17:40:41.845482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52eb16ef-dc16-4ece-ba8e-0dc9521069cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44df99e8d0>]}
[0m17:40:41.846798 [info ] [Thread-1 (]: 1 of 1 OK created sql view model db_project_dataset.stg_flights ................ [[32mCREATE VIEW (0 processed)[0m in 1.65s]
[0m17:40:41.848418 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m17:40:41.851593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:41.852463 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m17:40:41.853245 [info ] [MainThread]: 
[0m17:40:41.854084 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.55 seconds (2.55s).
[0m17:40:41.855394 [debug] [MainThread]: Command end result
[0m17:40:41.880713 [info ] [MainThread]: 
[0m17:40:41.882217 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:40:41.883352 [info ] [MainThread]: 
[0m17:40:41.884596 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:40:41.886936 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0290728, "process_user_time": 7.489914, "process_kernel_time": 0.595788, "process_mem_max_rss": "258492", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:40:41.888749 [debug] [MainThread]: Command `dbt run` succeeded at 17:40:41.888314 after 6.03 seconds
[0m17:40:41.890205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4503de4e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4503979640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44df71e660>]}
[0m17:40:41.891232 [debug] [MainThread]: Flushing usage events
[0m17:40:50.148824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f181d1b7fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f181f8d5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f181d1b5160>]}


============================== 17:40:50.163672 | 45bb5d1a-983d-42a9-9bbb-c06c0cf7e6cd ==============================
[0m17:40:50.163672 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:40:50.171386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:40:52.771636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45bb5d1a-983d-42a9-9bbb-c06c0cf7e6cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f9d33740>]}
[0m17:40:53.072889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45bb5d1a-983d-42a9-9bbb-c06c0cf7e6cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f9cfb2f0>]}
[0m17:40:53.074727 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:40:53.131235 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:40:54.504642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:40:54.505725 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:40:54.520697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45bb5d1a-983d-42a9-9bbb-c06c0cf7e6cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f9cbcd40>]}
[0m17:40:54.558870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45bb5d1a-983d-42a9-9bbb-c06c0cf7e6cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f9b946b0>]}
[0m17:40:54.560522 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:40:54.562983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45bb5d1a-983d-42a9-9bbb-c06c0cf7e6cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17fa526fc0>]}
[0m17:40:54.568204 [info ] [MainThread]: 
[0m17:40:54.570972 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:40:54.574298 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:40:54.575814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:55.451136 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:40:55.453407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:55.886883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45bb5d1a-983d-42a9-9bbb-c06c0cf7e6cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17fa53f3e0>]}
[0m17:40:55.889477 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:40:55.890813 [info ] [MainThread]: 
[0m17:40:55.903847 [debug] [Thread-1 (]: Began running node seed.flights_project.airports
[0m17:40:55.905108 [info ] [Thread-1 (]: 1 of 1 START seed file db_project_dataset.airports ............................. [RUN]
[0m17:40:55.907451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now seed.flights_project.airports)
[0m17:40:55.908894 [debug] [Thread-1 (]: Began compiling node seed.flights_project.airports
[0m17:40:55.910348 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (compile): 17:40:55.909838 => 17:40:55.909847
[0m17:40:55.912158 [debug] [Thread-1 (]: Began executing node seed.flights_project.airports
[0m17:40:56.092302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:59.619294 [debug] [Thread-1 (]: On seed.flights_project.airports: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.flights_project.airports"} */

    alter table `db-project-456518`.`db_project_dataset`.`airports` set OPTIONS()
  
[0m17:40:59.800653 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:44300b44-854e-4da6-944e-8c4595ec2b01&page=queryresults
[0m17:41:00.029209 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.flights_project.airports"
[0m17:41:00.069278 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (execute): 17:40:55.913389 => 17:41:00.068858
[0m17:41:00.070938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45bb5d1a-983d-42a9-9bbb-c06c0cf7e6cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f99e9400>]}
[0m17:41:00.072298 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file db_project_dataset.airports ......................... [[32mINSERT 3376[0m in 4.16s]
[0m17:41:00.074849 [debug] [Thread-1 (]: Finished running node seed.flights_project.airports
[0m17:41:00.078743 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:00.079852 [debug] [MainThread]: Connection 'seed.flights_project.airports' was properly closed.
[0m17:41:00.080843 [info ] [MainThread]: 
[0m17:41:00.081823 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.51 seconds (5.51s).
[0m17:41:00.083288 [debug] [MainThread]: Command end result
[0m17:41:00.112966 [info ] [MainThread]: 
[0m17:41:00.114709 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:41:00.116232 [info ] [MainThread]: 
[0m17:41:00.118210 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:41:00.120577 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 10.119638, "process_user_time": 8.719998, "process_kernel_time": 0.864341, "process_mem_max_rss": "264152", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:41:00.122064 [debug] [MainThread]: Command `dbt seed` succeeded at 17:41:00.121690 after 10.12 seconds
[0m17:41:00.123243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182177f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f181d219ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f9ae7350>]}
[0m17:41:00.124560 [debug] [MainThread]: Flushing usage events
[0m17:41:06.717465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c77486120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c777acd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c77484fe0>]}


============================== 17:41:06.730113 | e16a50c6-feaa-4ffa-a61f-3d85f8bac5ff ==============================
[0m17:41:06.730113 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:41:06.731772 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models core_flights', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:41:08.541902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e16a50c6-feaa-4ffa-a61f-3d85f8bac5ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c53f41160>]}
[0m17:41:08.755776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e16a50c6-feaa-4ffa-a61f-3d85f8bac5ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c58819d30>]}
[0m17:41:08.757355 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:41:08.795923 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:41:09.867303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:41:09.868310 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:41:09.880244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e16a50c6-feaa-4ffa-a61f-3d85f8bac5ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c53d5ab10>]}
[0m17:41:09.924729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e16a50c6-feaa-4ffa-a61f-3d85f8bac5ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c53de07d0>]}
[0m17:41:09.927207 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:41:09.929151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e16a50c6-feaa-4ffa-a61f-3d85f8bac5ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c774437a0>]}
[0m17:41:09.933199 [info ] [MainThread]: 
[0m17:41:09.935965 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:41:09.939285 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:41:09.940667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:10.381904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:41:10.383627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:41:10.783167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e16a50c6-feaa-4ffa-a61f-3d85f8bac5ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c53c5be30>]}
[0m17:41:10.785032 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:41:10.786325 [info ] [MainThread]: 
[0m17:41:10.799537 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m17:41:10.800821 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m17:41:10.802545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m17:41:10.803539 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m17:41:10.817562 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m17:41:10.831949 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 17:41:10.804399 => 17:41:10.831424
[0m17:41:10.833081 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m17:41:10.862852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:41:11.295155 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m17:41:11.306432 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m17:41:11.699041 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:38ff6ba8-7dbe-4178-8e20-d30cd3f2db6b&page=queryresults
[0m17:41:15.057179 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 17:41:10.834161 => 17:41:15.056382
[0m17:41:15.058712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e16a50c6-feaa-4ffa-a61f-3d85f8bac5ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c53c31550>]}
[0m17:41:15.059919 [info ] [Thread-1 (]: 1 of 1 OK created sql table model db_project_dataset.core_flights .............. [[32mCREATE TABLE (27.0m rows, 2.6 GiB processed)[0m in 4.26s]
[0m17:41:15.061456 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m17:41:15.064681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:15.065689 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m17:41:15.066609 [info ] [MainThread]: 
[0m17:41:15.067749 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.13 seconds (5.13s).
[0m17:41:15.069378 [debug] [MainThread]: Command end result
[0m17:41:15.095351 [info ] [MainThread]: 
[0m17:41:15.096746 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:41:15.097833 [info ] [MainThread]: 
[0m17:41:15.099004 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:41:15.101196 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.501723, "process_user_time": 7.183541, "process_kernel_time": 0.758824, "process_mem_max_rss": "253644", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:41:15.102901 [debug] [MainThread]: Command `dbt run` succeeded at 17:41:15.102572 after 8.50 seconds
[0m17:41:15.104025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c777644d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c77580080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c58288ad0>]}
[0m17:41:15.105058 [debug] [MainThread]: Flushing usage events
[0m17:42:21.172294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6bca73860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6bf1d5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6bd13d8e0>]}


============================== 17:42:21.182594 | b9b4b246-1b26-4b85-8286-c77bccb40578 ==============================
[0m17:42:21.182594 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:42:21.184416 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models fact_departures_by_airport_year', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:42:23.077976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9b4b246-1b26-4b85-8286-c77bccb40578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6a055cc80>]}
[0m17:42:23.408951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9b4b246-1b26-4b85-8286-c77bccb40578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6a0533cb0>]}
[0m17:42:23.410952 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:42:23.466366 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:42:24.614018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:42:24.615208 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:42:24.626580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9b4b246-1b26-4b85-8286-c77bccb40578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6993dbce0>]}
[0m17:42:24.671910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9b4b246-1b26-4b85-8286-c77bccb40578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6994904d0>]}
[0m17:42:24.673566 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:42:24.675573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9b4b246-1b26-4b85-8286-c77bccb40578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd699803620>]}
[0m17:42:24.679547 [info ] [MainThread]: 
[0m17:42:24.683968 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:42:24.688115 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:42:24.689780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:25.265728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:42:25.267583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:42:25.589525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9b4b246-1b26-4b85-8286-c77bccb40578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd69965e7b0>]}
[0m17:42:25.592149 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:42:25.593647 [info ] [MainThread]: 
[0m17:42:25.609958 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m17:42:25.611555 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m17:42:25.613640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.fact_departures_by_airport_year)
[0m17:42:25.615050 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m17:42:25.628594 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m17:42:25.641655 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (compile): 17:42:25.615918 => 17:42:25.640932
[0m17:42:25.642929 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m17:42:25.741243 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m17:42:25.753181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:25.799040 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    count(*) as num_departures
from flights_data
group by origin
    );
  
[0m17:42:26.185571 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:0708acbe-7905-4c2e-969b-8e5d53391435&page=queryresults
[0m17:42:27.770479 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (execute): 17:42:25.643965 => 17:42:27.769917
[0m17:42:27.772402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9b4b246-1b26-4b85-8286-c77bccb40578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6992e4620>]}
[0m17:42:27.773724 [info ] [Thread-1 (]: 1 of 1 OK created sql table model db_project_dataset.fact_departures_by_airport_year  [[32mCREATE TABLE (262.0 rows, 128.7 MiB processed)[0m in 2.16s]
[0m17:42:27.775326 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m17:42:27.779182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:42:27.780314 [debug] [MainThread]: Connection 'model.flights_project.fact_departures_by_airport_year' was properly closed.
[0m17:42:27.781328 [info ] [MainThread]: 
[0m17:42:27.782561 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.10 seconds (3.10s).
[0m17:42:27.784263 [debug] [MainThread]: Command end result
[0m17:42:27.818275 [info ] [MainThread]: 
[0m17:42:27.819476 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:42:27.820725 [info ] [MainThread]: 
[0m17:42:27.822742 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:42:27.826020 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.770243, "process_user_time": 8.250456, "process_kernel_time": 0.802964, "process_mem_max_rss": "256564", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:42:27.828147 [debug] [MainThread]: Command `dbt run` succeeded at 17:42:27.827709 after 6.77 seconds
[0m17:42:27.829922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6bcbbf8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd699408080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6c0504fe0>]}
[0m17:42:27.831736 [debug] [MainThread]: Flushing usage events
[0m17:44:27.081656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc98f26c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc9b13140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc98f2480>]}


============================== 17:44:27.099560 | f203269f-f3a5-43cc-b8b1-532796a4ffb6 ==============================
[0m17:44:27.099560 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:44:27.101251 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:44:27.775729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f203269f-f3a5-43cc-b8b1-532796a4ffb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc97a64b0>]}
[0m17:44:28.209792 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ahfm09lz'
[0m17:44:28.210909 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:44:28.501701 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:44:28.503825 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:44:28.594412 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:44:28.602764 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:44:33.354515 [info ] [MainThread]: Installed from version 1.3.0
[0m17:44:33.356569 [info ] [MainThread]: Up to date!
[0m17:44:33.358388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f203269f-f3a5-43cc-b8b1-532796a4ffb6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc9f75ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cca6cdd00>]}
[0m17:44:33.361701 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 6.4655547, "process_user_time": 6.443722, "process_kernel_time": 0.46412, "process_mem_max_rss": "111696", "process_in_blocks": "152", "process_out_blocks": "176"}
[0m17:44:33.363887 [debug] [MainThread]: Command `dbt deps` succeeded at 17:44:33.363364 after 6.47 seconds
[0m17:44:33.365665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc9b74ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc97fb050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ccabafaa0>]}
[0m17:44:33.367460 [debug] [MainThread]: Flushing usage events
[0m17:44:39.990932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d8e6c4f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d8edf9d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d904807a0>]}


============================== 17:44:40.000375 | 14241f9d-8f44-425d-84f5-22880072ac74 ==============================
[0m17:44:40.000375 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:44:40.002031 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models stg_flights', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:44:41.431853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14241f9d-8f44-425d-84f5-22880072ac74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d8fbe0b90>]}
[0m17:44:41.639106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14241f9d-8f44-425d-84f5-22880072ac74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d7354faa0>]}
[0m17:44:41.641693 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:44:41.686330 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:44:42.629561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:44:42.630553 [debug] [MainThread]: Partial parsing: added file: flights_project://models/marts/fact_delays_by_flight_num.sql
[0m17:44:43.021102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14241f9d-8f44-425d-84f5-22880072ac74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d6b1f6e40>]}
[0m17:44:43.063848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14241f9d-8f44-425d-84f5-22880072ac74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d6b0a4590>]}
[0m17:44:43.065582 [info ] [MainThread]: Found 1 seed, 4 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:44:43.067001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14241f9d-8f44-425d-84f5-22880072ac74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d6aef4d70>]}
[0m17:44:43.070426 [info ] [MainThread]: 
[0m17:44:43.073005 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:44:43.076416 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:44:43.078078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:43.473868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:44:43.475453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:44:43.762155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14241f9d-8f44-425d-84f5-22880072ac74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d6ae8e240>]}
[0m17:44:43.764544 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:44:43.765982 [info ] [MainThread]: 
[0m17:44:43.777860 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m17:44:43.779119 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m17:44:43.780639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.stg_flights)
[0m17:44:43.781744 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m17:44:43.824498 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m17:44:43.834757 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (compile): 17:44:43.782555 => 17:44:43.834242
[0m17:44:43.835822 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m17:44:43.884864 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m17:44:43.897084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:43.938059 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    CONCAT(CAST(FlightDate AS STRING), ' ', DepTimeFormatted) AS dep_time,
    CONCAT(CAST(FlightDate AS STRING), ' ', ArrTimeFormatted) AS arr_time,
    FlightNum as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m17:44:44.322804 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c78686e7-127f-49b3-8c6c-d94fde43c78b&page=queryresults
[0m17:44:44.505350 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (execute): 17:44:43.836518 => 17:44:44.505013
[0m17:44:44.506897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14241f9d-8f44-425d-84f5-22880072ac74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d8f338bc0>]}
[0m17:44:44.508166 [info ] [Thread-1 (]: 1 of 1 OK created sql view model db_project_dataset.stg_flights ................ [[32mCREATE VIEW (0 processed)[0m in 0.73s]
[0m17:44:44.509744 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m17:44:44.513820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:44.514870 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m17:44:44.515950 [info ] [MainThread]: 
[0m17:44:44.517240 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.44 seconds (1.44s).
[0m17:44:44.519137 [debug] [MainThread]: Command end result
[0m17:44:44.548636 [info ] [MainThread]: 
[0m17:44:44.550108 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:44:44.551665 [info ] [MainThread]: 
[0m17:44:44.553050 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:44:44.555021 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.66146, "process_user_time": 7.899664, "process_kernel_time": 0.711771, "process_mem_max_rss": "259592", "process_in_blocks": "2952", "process_out_blocks": "0"}
[0m17:44:44.556472 [debug] [MainThread]: Command `dbt run` succeeded at 17:44:44.556060 after 4.66 seconds
[0m17:44:44.557910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d8e9120c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d6b51dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d92d03200>]}
[0m17:44:44.559190 [debug] [MainThread]: Flushing usage events
[0m17:44:50.019379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d47ef9d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d480032c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d48b74c20>]}


============================== 17:44:50.028719 | 01ed9148-45ad-457f-9372-7176bf8874bd ==============================
[0m17:44:50.028719 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:44:50.029979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m17:45:00.932502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01ed9148-45ad-457f-9372-7176bf8874bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d47ef82c0>]}
[0m17:45:01.153336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01ed9148-45ad-457f-9372-7176bf8874bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d290f3530>]}
[0m17:45:01.154807 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:45:01.197568 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:45:02.448414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:02.449224 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:02.458882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01ed9148-45ad-457f-9372-7176bf8874bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d286fffb0>]}
[0m17:45:02.502611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01ed9148-45ad-457f-9372-7176bf8874bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d288d4680>]}
[0m17:45:02.504618 [info ] [MainThread]: Found 1 seed, 4 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:45:02.506606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01ed9148-45ad-457f-9372-7176bf8874bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2935aea0>]}
[0m17:45:02.512017 [info ] [MainThread]: 
[0m17:45:02.514612 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:45:02.517601 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:45:02.518904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:02.998838 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:45:03.000323 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:03.348162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01ed9148-45ad-457f-9372-7176bf8874bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d28d2af90>]}
[0m17:45:03.350560 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:03.353543 [info ] [MainThread]: 
[0m17:45:03.366679 [debug] [Thread-1 (]: Began running node seed.flights_project.airports
[0m17:45:03.368079 [info ] [Thread-1 (]: 1 of 1 START seed file db_project_dataset.airports ............................. [RUN]
[0m17:45:03.369751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now seed.flights_project.airports)
[0m17:45:03.370930 [debug] [Thread-1 (]: Began compiling node seed.flights_project.airports
[0m17:45:03.372241 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (compile): 17:45:03.371777 => 17:45:03.371785
[0m17:45:03.373301 [debug] [Thread-1 (]: Began executing node seed.flights_project.airports
[0m17:45:03.545120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:06.975580 [debug] [Thread-1 (]: On seed.flights_project.airports: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.flights_project.airports"} */

    alter table `db-project-456518`.`db_project_dataset`.`airports` set OPTIONS()
  
[0m17:45:07.123695 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:ea106354-46d3-4032-bfdc-2eeea948f237&page=queryresults
[0m17:45:07.579474 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.flights_project.airports"
[0m17:45:07.609282 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (execute): 17:45:03.374075 => 17:45:07.608919
[0m17:45:07.610942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01ed9148-45ad-457f-9372-7176bf8874bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d28a38950>]}
[0m17:45:07.612166 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file db_project_dataset.airports ......................... [[32mINSERT 3376[0m in 4.24s]
[0m17:45:07.614641 [debug] [Thread-1 (]: Finished running node seed.flights_project.airports
[0m17:45:07.618515 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:07.619426 [debug] [MainThread]: Connection 'seed.flights_project.airports' was properly closed.
[0m17:45:07.620312 [info ] [MainThread]: 
[0m17:45:07.621532 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.11 seconds (5.11s).
[0m17:45:07.623015 [debug] [MainThread]: Command end result
[0m17:45:07.654400 [info ] [MainThread]: 
[0m17:45:07.655920 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:45:07.657131 [info ] [MainThread]: 
[0m17:45:07.659110 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:45:07.666249 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 17.759521, "process_user_time": 14.434587, "process_kernel_time": 1.874042, "process_mem_max_rss": "258208", "process_in_blocks": "736", "process_out_blocks": "0"}
[0m17:45:07.667812 [debug] [MainThread]: Command `dbt seed` succeeded at 17:45:07.667333 after 17.76 seconds
[0m17:45:07.669153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d47ef9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4806d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2a31db80>]}
[0m17:45:07.670326 [debug] [MainThread]: Flushing usage events
[0m17:45:13.618281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea258b24e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea25f17830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea269c5a00>]}


============================== 17:45:13.627730 | d09fda38-10e8-4c08-b7a6-3cc17f1d9e12 ==============================
[0m17:45:13.627730 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:45:13.629211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models core_flights', 'send_anonymous_usage_stats': 'True'}
[0m17:45:15.244236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd09fda38-10e8-4c08-b7a6-3cc17f1d9e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea027bd220>]}
[0m17:45:15.459232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd09fda38-10e8-4c08-b7a6-3cc17f1d9e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea26dc83e0>]}
[0m17:45:15.460880 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:45:15.498367 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:45:16.356531 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:16.357344 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:16.366183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd09fda38-10e8-4c08-b7a6-3cc17f1d9e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea0213ffb0>]}
[0m17:45:16.398671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd09fda38-10e8-4c08-b7a6-3cc17f1d9e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea02304830>]}
[0m17:45:16.400271 [info ] [MainThread]: Found 1 seed, 4 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:45:16.401902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd09fda38-10e8-4c08-b7a6-3cc17f1d9e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea02086b40>]}
[0m17:45:16.404686 [info ] [MainThread]: 
[0m17:45:16.407144 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:45:16.409826 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:45:16.411095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:16.871695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:45:16.873710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:17.163812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd09fda38-10e8-4c08-b7a6-3cc17f1d9e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea024a3170>]}
[0m17:45:17.165673 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:17.166817 [info ] [MainThread]: 
[0m17:45:17.178336 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m17:45:17.179613 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m17:45:17.181435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m17:45:17.182588 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m17:45:17.195712 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m17:45:17.209591 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 17:45:17.183410 => 17:45:17.209016
[0m17:45:17.210788 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m17:45:17.235212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:17.580548 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m17:45:17.595712 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m17:45:18.034939 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:ab83ab39-f4c8-44d6-8193-58fc8a017fbe&page=queryresults
[0m17:45:21.139438 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 17:45:17.211514 => 17:45:21.139092
[0m17:45:21.141108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd09fda38-10e8-4c08-b7a6-3cc17f1d9e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea021590a0>]}
[0m17:45:21.142411 [info ] [Thread-1 (]: 1 of 1 OK created sql table model db_project_dataset.core_flights .............. [[32mCREATE TABLE (27.0m rows, 2.6 GiB processed)[0m in 3.96s]
[0m17:45:21.143982 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m17:45:21.147520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:21.148536 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m17:45:21.149569 [info ] [MainThread]: 
[0m17:45:21.150771 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.74 seconds (4.74s).
[0m17:45:21.152372 [debug] [MainThread]: Command end result
[0m17:45:21.178186 [info ] [MainThread]: 
[0m17:45:21.179334 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:45:21.180491 [info ] [MainThread]: 
[0m17:45:21.181982 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:45:21.184111 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.6744328, "process_user_time": 6.045754, "process_kernel_time": 0.56427, "process_mem_max_rss": "253676", "process_in_blocks": "7744", "process_out_blocks": "0"}
[0m17:45:21.185629 [debug] [MainThread]: Command `dbt run` succeeded at 17:45:21.185333 after 7.68 seconds
[0m17:45:21.186923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea258f6360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea024cade0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea293d9760>]}
[0m17:45:21.188400 [debug] [MainThread]: Flushing usage events
[0m17:45:26.888275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96256f5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96256f4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96256f4ad0>]}


============================== 17:45:26.897638 | c081c390-a2fb-4fb3-a718-594c7d8426f8 ==============================
[0m17:45:26.897638 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:45:26.899263 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --models fact_departures_by_airport_year', 'send_anonymous_usage_stats': 'True'}
[0m17:45:31.548540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c081c390-a2fb-4fb3-a718-594c7d8426f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9602276d80>]}
[0m17:45:31.781207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c081c390-a2fb-4fb3-a718-594c7d8426f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9602a829c0>]}
[0m17:45:31.784091 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:45:31.842485 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:45:33.421031 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:33.422875 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:33.460953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c081c390-a2fb-4fb3-a718-594c7d8426f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960204f440>]}
[0m17:45:33.529733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c081c390-a2fb-4fb3-a718-594c7d8426f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96020d4c20>]}
[0m17:45:33.531756 [info ] [MainThread]: Found 1 seed, 4 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:45:33.534790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c081c390-a2fb-4fb3-a718-594c7d8426f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9601e5eb70>]}
[0m17:45:33.539959 [info ] [MainThread]: 
[0m17:45:33.543668 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:45:33.547874 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:45:33.550154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:34.327504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:45:34.329004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:34.651947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c081c390-a2fb-4fb3-a718-594c7d8426f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9601e5eb10>]}
[0m17:45:34.653764 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:34.654908 [info ] [MainThread]: 
[0m17:45:34.669044 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m17:45:34.670587 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m17:45:34.673069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.fact_departures_by_airport_year)
[0m17:45:34.675385 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m17:45:34.695154 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m17:45:34.707754 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (compile): 17:45:34.676339 => 17:45:34.706772
[0m17:45:34.709187 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m17:45:34.755899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:35.224793 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m17:45:35.241733 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    count(*) as num_departures
from flights_data
group by origin
    );
  
[0m17:45:35.439274 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:a948f1bb-c1bd-46ec-9557-7f0d0557bbb5&page=queryresults
[0m17:45:37.093221 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (execute): 17:45:34.710075 => 17:45:37.092417
[0m17:45:37.103800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c081c390-a2fb-4fb3-a718-594c7d8426f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9601f2d610>]}
[0m17:45:37.112399 [info ] [Thread-1 (]: 1 of 1 OK created sql table model db_project_dataset.fact_departures_by_airport_year  [[32mCREATE TABLE (262.0 rows, 128.7 MiB processed)[0m in 2.43s]
[0m17:45:37.114560 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m17:45:37.120509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:37.130278 [debug] [MainThread]: Connection 'model.flights_project.fact_departures_by_airport_year' was properly closed.
[0m17:45:37.136277 [info ] [MainThread]: 
[0m17:45:37.142616 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.59 seconds (3.59s).
[0m17:45:37.149600 [debug] [MainThread]: Command end result
[0m17:45:37.213061 [info ] [MainThread]: 
[0m17:45:37.214960 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:45:37.217289 [info ] [MainThread]: 
[0m17:45:37.218512 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:45:37.220588 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.441768, "process_user_time": 9.63899, "process_kernel_time": 1.119038, "process_mem_max_rss": "256880", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:45:37.222238 [debug] [MainThread]: Command `dbt run` succeeded at 17:45:37.221783 after 10.44 seconds
[0m17:45:37.223797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9625d766c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96257fcb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96021819d0>]}
[0m17:45:37.225555 [debug] [MainThread]: Flushing usage events
[0m17:45:46.244670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed09fe1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed09fe0080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed09fe1760>]}


============================== 17:45:46.253939 | 6dd87cd5-a04b-4af0-8d3f-61950c628c6a ==============================
[0m17:45:46.253939 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:45:46.255402 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models fact_delays_by_flight_num', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:45:48.814321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dd87cd5-a04b-4af0-8d3f-61950c628c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece70abb90>]}
[0m17:45:49.145504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dd87cd5-a04b-4af0-8d3f-61950c628c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed0b4fc9b0>]}
[0m17:45:49.147951 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:45:49.191727 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:45:50.325224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:50.326087 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:50.336204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dd87cd5-a04b-4af0-8d3f-61950c628c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece69fa780>]}
[0m17:45:50.374176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dd87cd5-a04b-4af0-8d3f-61950c628c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece68e47d0>]}
[0m17:45:50.375280 [info ] [MainThread]: Found 1 seed, 4 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:45:50.376220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dd87cd5-a04b-4af0-8d3f-61950c628c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece67d2c30>]}
[0m17:45:50.378728 [info ] [MainThread]: 
[0m17:45:50.380551 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:45:50.382736 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:45:50.383681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:50.862876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:45:50.865059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:51.175414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dd87cd5-a04b-4af0-8d3f-61950c628c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece7d12060>]}
[0m17:45:51.178518 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:51.181008 [info ] [MainThread]: 
[0m17:45:51.198673 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m17:45:51.200348 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.fact_delays_by_flight_num ....... [RUN]
[0m17:45:51.214572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.fact_delays_by_flight_num)
[0m17:45:51.216042 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_by_flight_num
[0m17:45:51.230536 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_by_flight_num"
[0m17:45:51.246792 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_delays_by_flight_num (compile): 17:45:51.217219 => 17:45:51.245771
[0m17:45:51.248078 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_by_flight_num
[0m17:45:51.306876 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_by_flight_num"
[0m17:45:51.317848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:51.373787 [debug] [Thread-1 (]: On model.flights_project.fact_delays_by_flight_num: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_by_flight_num"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`fact_delays_by_flight_num`
  OPTIONS()
  as with flight_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where arr_delay > 0 or dep_delay > 0
)

select 
    flight_num,
    count(*) as total_flights_with_delays,
    sum(dep_delay) as total_dep_delay,
    sum(arr_delay) as total_arr_delay,
    avg(dep_delay) as avg_dep_delay,
    avg(arr_delay) as avg_arr_delay,
    min(dep_delay) as min_dep_delay,
    min(arr_delay) as min_arr_delay,
    max(dep_delay) as max_dep_delay,
    max(arr_delay) as max_arr_delay
from flight_data
group by flight_num;


[0m17:45:51.775206 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:54058722-c0d8-43ed-8908-82c6acc27840&page=queryresults
[0m17:45:51.940837 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_delays_by_flight_num (execute): 17:45:51.248917 => 17:45:51.940343
[0m17:45:51.943215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dd87cd5-a04b-4af0-8d3f-61950c628c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece6935100>]}
[0m17:45:51.945112 [info ] [Thread-1 (]: 1 of 1 OK created sql view model db_project_dataset.fact_delays_by_flight_num .. [[32mCREATE VIEW (0 processed)[0m in 0.73s]
[0m17:45:51.947053 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m17:45:51.951195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:51.952437 [debug] [MainThread]: Connection 'model.flights_project.fact_delays_by_flight_num' was properly closed.
[0m17:45:51.953618 [info ] [MainThread]: 
[0m17:45:51.954944 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.57 seconds (1.57s).
[0m17:45:51.956737 [debug] [MainThread]: Command end result
[0m17:45:51.989510 [info ] [MainThread]: 
[0m17:45:51.991373 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:45:51.992930 [info ] [MainThread]: 
[0m17:45:51.994901 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:45:52.000003 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.8643336, "process_user_time": 7.913031, "process_kernel_time": 0.678544, "process_mem_max_rss": "247940", "process_in_blocks": "608", "process_out_blocks": "0"}
[0m17:45:52.001680 [debug] [MainThread]: Command `dbt run` succeeded at 17:45:52.001235 after 5.87 seconds
[0m17:45:52.003259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed0a7e6780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed0e5df200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece69f9f10>]}
[0m17:45:52.004554 [debug] [MainThread]: Flushing usage events
[0m19:57:02.637085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1372f78a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13736c2d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13737561b0>]}


============================== 19:57:02.645582 | f2259903-ecac-4b61-8c96-623c15ae7327 ==============================
[0m19:57:02.645582 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:57:02.646983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m19:57:02.887939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2259903-ecac-4b61-8c96-623c15ae7327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13735f4830>]}
[0m19:57:03.293548 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-p48j2nrm'
[0m19:57:03.294438 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:57:04.292281 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:57:04.294843 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:57:04.412857 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:57:04.423696 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:57:08.538582 [info ] [MainThread]: Installed from version 1.3.0
[0m19:57:08.539606 [info ] [MainThread]: Up to date!
[0m19:57:08.540814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f2259903-ecac-4b61-8c96-623c15ae7327', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1373e90410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1373e90440>]}
[0m19:57:08.542597 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 6.0956864, "process_user_time": 3.028957, "process_kernel_time": 0.465993, "process_mem_max_rss": "106720", "process_in_blocks": "47504", "process_out_blocks": "3280"}
[0m19:57:08.543530 [debug] [MainThread]: Command `dbt deps` succeeded at 19:57:08.543394 after 6.10 seconds
[0m19:57:08.544367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f137332f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13735f4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1373719fa0>]}
[0m19:57:08.545234 [debug] [MainThread]: Flushing usage events
[0m19:57:15.247185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c0be60f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c051fef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c081d1f0>]}


============================== 19:57:15.256155 | 7c8fbfcb-813c-4017-8133-be8a62169b64 ==============================
[0m19:57:15.256155 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:57:15.257566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:57:16.908061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c8fbfcb-813c-4017-8133-be8a62169b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c067dfd0>]}
[0m19:57:16.985492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c8fbfcb-813c-4017-8133-be8a62169b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a0b535c0>]}
[0m19:57:16.986796 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:57:17.208805 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m19:57:17.367698 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:57:17.368896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7c8fbfcb-813c-4017-8133-be8a62169b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c0be56a0>]}
[0m19:57:20.384632 [error] [MainThread]: Encountered an error:
Compilation Error in model fact_delays_departure_by_airport (models/marts/fact_delays_departure_by_airport.sql)
  The name argument to ref() must be a string, got <class 'dbt_common.clients.jinja.create_undefined.<locals>.Undefined'>
[0m19:57:20.386777 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 5.238211, "process_user_time": 6.891993, "process_kernel_time": 0.841464, "process_mem_max_rss": "253512", "process_in_blocks": "40936", "process_out_blocks": "2872", "command_success": false}
[0m19:57:20.388127 [debug] [MainThread]: Command `dbt seed` failed at 19:57:20.387962 after 5.24 seconds
[0m19:57:20.389140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c07df3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a0b17560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33a0518f80>]}
[0m19:57:20.390100 [debug] [MainThread]: Flushing usage events
[0m19:59:24.159696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071ce86420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071ca9d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071ce86660>]}


============================== 19:59:24.168249 | ee19ce2b-241d-4474-92c0-dfc2f02b9481 ==============================
[0m19:59:24.168249 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:59:24.169608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m19:59:24.321611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee19ce2b-241d-4474-92c0-dfc2f02b9481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071c053e30>]}
[0m19:59:24.637080 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-om97l45q'
[0m19:59:24.638008 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:59:24.840193 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:59:24.841892 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:59:24.941446 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:59:24.950328 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:59:28.751339 [info ] [MainThread]: Installed from version 1.3.0
[0m19:59:28.752191 [info ] [MainThread]: Up to date!
[0m19:59:28.753015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ee19ce2b-241d-4474-92c0-dfc2f02b9481', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071c1aacf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071c09e030>]}
[0m19:59:28.754550 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.6788635, "process_user_time": 2.557635, "process_kernel_time": 0.339686, "process_mem_max_rss": "104388", "process_in_blocks": "16", "process_out_blocks": "176"}
[0m19:59:28.755530 [debug] [MainThread]: Command `dbt deps` succeeded at 19:59:28.755392 after 4.68 seconds
[0m19:59:28.756416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071c5561b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071c1f7bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071c705760>]}
[0m19:59:28.757309 [debug] [MainThread]: Flushing usage events
[0m19:59:32.953314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e8e353a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e8fd5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e8deea20>]}


============================== 19:59:32.961776 | 4c1ceb43-1186-4f4e-bee9-7d32b41c8790 ==============================
[0m19:59:32.961776 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:59:32.962998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:59:34.212922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c1ceb43-1186-4f4e-bee9-7d32b41c8790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1c5398380>]}
[0m19:59:34.281313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c1ceb43-1186-4f4e-bee9-7d32b41c8790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1c55892e0>]}
[0m19:59:34.282483 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:59:34.490995 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m19:59:34.637720 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:59:34.638900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4c1ceb43-1186-4f4e-bee9-7d32b41c8790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1c4fc2900>]}
[0m19:59:38.132737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c1ceb43-1186-4f4e-bee9-7d32b41c8790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1c50b2360>]}
[0m19:59:38.323710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c1ceb43-1186-4f4e-bee9-7d32b41c8790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1afc0b410>]}
[0m19:59:38.324969 [info ] [MainThread]: Found 10 models, 1 seed, 1 source, 602 macros
[0m19:59:38.326142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c1ceb43-1186-4f4e-bee9-7d32b41c8790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1afc1b260>]}
[0m19:59:38.329342 [info ] [MainThread]: 
[0m19:59:38.331148 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:59:38.333342 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m19:59:38.334770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:38.840557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m19:59:38.841627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:59:39.342357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c1ceb43-1186-4f4e-bee9-7d32b41c8790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1afc19610>]}
[0m19:59:39.344117 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:59:39.345194 [info ] [MainThread]: 
[0m19:59:39.356996 [debug] [Thread-1 (]: Began running node seed.flights_project.airports
[0m19:59:39.358631 [info ] [Thread-1 (]: 1 of 1 START seed file db_project_dataset.airports ............................. [RUN]
[0m19:59:39.359951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now seed.flights_project.airports)
[0m19:59:39.360925 [debug] [Thread-1 (]: Began compiling node seed.flights_project.airports
[0m19:59:39.361907 [debug] [Thread-1 (]: Began executing node seed.flights_project.airports
[0m19:59:39.500179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:59:43.300221 [debug] [Thread-1 (]: On seed.flights_project.airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.flights_project.airports"} */

    alter table `db-project-456518`.`db_project_dataset`.`airports` set OPTIONS()
  
[0m19:59:44.112656 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e3d3c09f-b22d-4296-bc2a-de70ef65ad75&page=queryresults
[0m19:59:44.359638 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.flights_project.airports"
[0m19:59:44.392087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c1ceb43-1186-4f4e-bee9-7d32b41c8790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1ea2f94c0>]}
[0m19:59:44.393368 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file db_project_dataset.airports ......................... [[32mINSERT 3376[0m in 5.03s]
[0m19:59:44.394873 [debug] [Thread-1 (]: Finished running node seed.flights_project.airports
[0m19:59:44.397873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:59:44.398878 [debug] [MainThread]: Connection 'seed.flights_project.airports' was properly closed.
[0m19:59:44.399744 [info ] [MainThread]: 
[0m19:59:44.400778 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 6.07 seconds (6.07s).
[0m19:59:44.402461 [debug] [MainThread]: Command end result
[0m19:59:44.497662 [info ] [MainThread]: 
[0m19:59:44.498958 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:59:44.500166 [info ] [MainThread]: 
[0m19:59:44.501236 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:59:44.502977 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 11.632405, "process_user_time": 7.4111, "process_kernel_time": 0.686397, "process_mem_max_rss": "270312", "process_in_blocks": "216", "process_out_blocks": "0"}
[0m19:59:44.504034 [debug] [MainThread]: Command `dbt seed` succeeded at 19:59:44.503882 after 11.63 seconds
[0m19:59:44.504937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e8deea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e8dedfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1ad924ad0>]}
[0m19:59:44.505819 [debug] [MainThread]: Flushing usage events
[0m19:59:48.967607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc802c980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc9a64200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc855da60>]}


============================== 19:59:48.975723 | 6ad64186-c85e-4b15-a5ca-f0518178eab1 ==============================
[0m19:59:48.975723 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:59:48.976975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:59:50.183059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ad64186-c85e-4b15-a5ca-f0518178eab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc802c980>]}
[0m19:59:50.252032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ad64186-c85e-4b15-a5ca-f0518178eab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc8c2d7c0>]}
[0m19:59:50.253257 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:59:50.468883 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m19:59:51.590225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:59:51.590982 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:59:51.651592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ad64186-c85e-4b15-a5ca-f0518178eab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca8331070>]}
[0m19:59:51.838199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ad64186-c85e-4b15-a5ca-f0518178eab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca3e665a0>]}
[0m19:59:51.839474 [info ] [MainThread]: Found 10 models, 1 seed, 1 source, 602 macros
[0m19:59:51.841021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ad64186-c85e-4b15-a5ca-f0518178eab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca81b4b00>]}
[0m19:59:51.844752 [info ] [MainThread]: 
[0m19:59:51.846279 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:59:51.853356 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m19:59:51.854383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:52.298775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m19:59:52.300250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:59:52.721552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ad64186-c85e-4b15-a5ca-f0518178eab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca82ba6f0>]}
[0m19:59:52.723952 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:59:52.725391 [info ] [MainThread]: 
[0m19:59:52.735909 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m19:59:52.737211 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m19:59:52.738281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m19:59:52.739250 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m19:59:52.755911 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m19:59:52.768080 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m19:59:52.829329 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m19:59:52.843586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:59:52.883444 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    airport_code,
    airport_name,
    city,
    state,
    country,
    iata,
    icao
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m19:59:53.976817 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:cacf837d-c0f6-468e-91bf-a6da1cf9216e&page=queryresults
[0m19:59:54.143379 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: airport_code at [16:5]; reason: invalidQuery, location: query, message: Unrecognized name: airport_code at [16:5]')
[0m19:59:55.327805 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:46f09bfb-8450-4065-b34d-dcf348ae145c&page=queryresults
[0m19:59:55.562252 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:46f09bfb-8450-4065-b34d-dcf348ae145c&page=queryresults
[0m19:59:55.575812 [debug] [Thread-1 (]: Database Error in model dim_airports (models/marts/dim_airports.sql)
  Unrecognized name: airport_code at [16:5]
  compiled code at target/run/flights_project/models/marts/dim_airports.sql
[0m19:59:55.577927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ad64186-c85e-4b15-a5ca-f0518178eab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca8377ec0>]}
[0m19:59:55.579728 [error] [Thread-1 (]: 1 of 10 ERROR creating sql table model db_project_dataset.dim_airports ......... [[31mERROR[0m in 2.84s]
[0m19:59:55.581321 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m19:59:55.582367 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m19:59:55.584116 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m19:59:55.585224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m19:59:55.586106 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m19:59:55.618237 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m19:59:55.629538 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m19:59:55.670852 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m19:59:55.680300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:59:55.722452 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as varchar), ' ', DepTimeFormatted) as timestamp) as dep_time,
    cast(concat(cast(FlightDate as varchar), ' ', ArrTimeFormatted) as timestamp) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as varchar) ar origin,
    cast(Dest as varchar) as destination,
    cast(CarrierCode as varchar) as carrier_code,
    cast(CarrierDescription as varchar) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m19:59:56.787928 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:4ead4a65-5ce9-4faa-bc24-8475ff85d771&page=queryresults
[0m19:59:56.789703 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got identifier "origin" at [21:32]; reason: invalidQuery, location: query, message: Syntax error: Expected end of input but got identifier "origin" at [21:32]')
[0m19:59:57.615595 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:3efd0e52-c856-4c6a-b105-50ba0656eff5&page=queryresults
[0m19:59:57.617292 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:3efd0e52-c856-4c6a-b105-50ba0656eff5&page=queryresults
[0m19:59:57.624475 [debug] [Thread-1 (]: Database Error in model stg_flights (models/stg_flights.sql)
  Syntax error: Expected end of input but got identifier "origin" at [21:32]
  compiled code at target/run/flights_project/models/stg_flights.sql
[0m19:59:57.625844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ad64186-c85e-4b15-a5ca-f0518178eab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca3f91850>]}
[0m19:59:57.627391 [error] [Thread-1 (]: 2 of 10 ERROR creating sql view model db_project_dataset.stg_flights ........... [[31mERROR[0m in 2.04s]
[0m19:59:57.629094 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m19:59:57.631545 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m19:59:57.632714 [info ] [Thread-1 (]: 3 of 10 SKIP relation db_project_dataset.core_flights .......................... [[33mSKIP[0m]
[0m19:59:57.633991 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m19:59:57.636193 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m19:59:57.637331 [info ] [Thread-1 (]: 4 of 10 SKIP relation db_project_dataset.dim_carriers .......................... [[33mSKIP[0m]
[0m19:59:57.638771 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m19:59:57.640539 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m19:59:57.641732 [info ] [Thread-1 (]: 5 of 10 SKIP relation db_project_dataset.dim_dates ............................. [[33mSKIP[0m]
[0m19:59:57.642993 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m19:59:57.644131 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m19:59:57.645176 [info ] [Thread-1 (]: 6 of 10 SKIP relation db_project_dataset.fact_delays_by_flight_num ............. [[33mSKIP[0m]
[0m19:59:57.646547 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m19:59:57.647777 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m19:59:57.648931 [info ] [Thread-1 (]: 7 of 10 SKIP relation db_project_dataset.fact_delays_departure_by_airport ...... [[33mSKIP[0m]
[0m19:59:57.650508 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m19:59:57.651579 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m19:59:57.652720 [info ] [Thread-1 (]: 8 of 10 SKIP relation db_project_dataset.fact_departures.by_year ............... [[33mSKIP[0m]
[0m19:59:57.654072 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m19:59:57.655306 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m19:59:57.656988 [info ] [Thread-1 (]: 9 of 10 SKIP relation db_project_dataset.fact_departures_by_airport_year ....... [[33mSKIP[0m]
[0m19:59:57.658535 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m19:59:57.659798 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m19:59:57.661255 [info ] [Thread-1 (]: 10 of 10 SKIP relation db_project_dataset.fact_most_departures_airport ......... [[33mSKIP[0m]
[0m19:59:57.663039 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m19:59:57.665897 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:59:57.666884 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m19:59:57.667845 [info ] [MainThread]: 
[0m19:59:57.668710 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 5.82 seconds (5.82s).
[0m19:59:57.671011 [debug] [MainThread]: Command end result
[0m19:59:57.773477 [info ] [MainThread]: 
[0m19:59:57.774817 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:59:57.775965 [info ] [MainThread]: 
[0m19:59:57.777560 [error] [MainThread]:   Database Error in model dim_airports (models/marts/dim_airports.sql)
  Unrecognized name: airport_code at [16:5]
  compiled code at target/run/flights_project/models/marts/dim_airports.sql
[0m19:59:57.778900 [info ] [MainThread]: 
[0m19:59:57.780425 [error] [MainThread]:   Database Error in model stg_flights (models/stg_flights.sql)
  Syntax error: Expected end of input but got identifier "origin" at [21:32]
  compiled code at target/run/flights_project/models/stg_flights.sql
[0m19:59:57.781721 [info ] [MainThread]: 
[0m19:59:57.783028 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=8 TOTAL=10
[0m19:59:57.785052 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.901437, "process_user_time": 4.803524, "process_kernel_time": 0.797265, "process_mem_max_rss": "254156", "process_in_blocks": "400", "command_success": false, "process_out_blocks": "0"}
[0m19:59:57.786262 [debug] [MainThread]: Command `dbt run` failed at 19:59:57.786079 after 8.90 seconds
[0m19:59:57.787314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc8b8cc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cca6a4e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca3d6f230>]}
[0m19:59:57.788505 [debug] [MainThread]: Flushing usage events
[0m20:05:01.994350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ebdce2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87eb942c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87eb940b60>]}


============================== 20:05:02.003822 | 76aa8ac1-8247-4a4b-b296-fe0c2ff23042 ==============================
[0m20:05:02.003822 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:05:02.005305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:05:03.249401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76aa8ac1-8247-4a4b-b296-fe0c2ff23042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ec52c5f0>]}
[0m20:05:03.317106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76aa8ac1-8247-4a4b-b296-fe0c2ff23042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87cc3d5ac0>]}
[0m20:05:03.318571 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:05:03.527409 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:05:04.653334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:05:04.654215 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:05:04.716389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76aa8ac1-8247-4a4b-b296-fe0c2ff23042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87cdda36b0>]}
[0m20:05:04.897336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76aa8ac1-8247-4a4b-b296-fe0c2ff23042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87c783e810>]}
[0m20:05:04.898583 [info ] [MainThread]: Found 10 models, 1 seed, 1 source, 602 macros
[0m20:05:04.899772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76aa8ac1-8247-4a4b-b296-fe0c2ff23042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87c76a0230>]}
[0m20:05:04.904903 [info ] [MainThread]: 
[0m20:05:04.906858 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:05:04.914816 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m20:05:04.915869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:05.377644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m20:05:05.378867 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:05.707088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76aa8ac1-8247-4a4b-b296-fe0c2ff23042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87c7c82030>]}
[0m20:05:05.708759 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:05:05.710076 [info ] [MainThread]: 
[0m20:05:05.721510 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m20:05:05.722729 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m20:05:05.724028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m20:05:05.724959 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m20:05:05.739104 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m20:05:05.750877 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m20:05:05.812362 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m20:05:05.825785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:05.867438 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    airport_code,
    airport_name,
    city,
    state,
    country,
    iata,
    icao
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m20:05:06.437339 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:2fee621b-bbb6-4436-89e8-565b71648801&page=queryresults
[0m20:05:06.662265 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: airport_code at [16:5]; reason: invalidQuery, location: query, message: Unrecognized name: airport_code at [16:5]')
[0m20:05:07.646363 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:6464b87c-1c4e-4a74-a76e-f42292df23ad&page=queryresults
[0m20:05:07.793500 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:6464b87c-1c4e-4a74-a76e-f42292df23ad&page=queryresults
[0m20:05:07.803941 [debug] [Thread-1 (]: Database Error in model dim_airports (models/marts/dim_airports.sql)
  Unrecognized name: airport_code at [16:5]
  compiled code at target/run/flights_project/models/marts/dim_airports.sql
[0m20:05:07.806204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76aa8ac1-8247-4a4b-b296-fe0c2ff23042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87c783d6a0>]}
[0m20:05:07.807642 [error] [Thread-1 (]: 1 of 10 ERROR creating sql table model db_project_dataset.dim_airports ......... [[31mERROR[0m in 2.08s]
[0m20:05:07.809151 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m20:05:07.810094 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m20:05:07.811889 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m20:05:07.813163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m20:05:07.814035 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m20:05:07.845722 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m20:05:07.855620 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m20:05:07.890716 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m20:05:07.903354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:07.943890 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as varchar), ' ', DepTimeFormatted) as timestamp) as dep_time,
    cast(concat(cast(FlightDate as varchar), ' ', ArrTimeFormatted) as timestamp) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as varchar) ar origin,
    cast(Dest as varchar) as destination,
    cast(CarrierCode as varchar) as carrier_code,
    cast(CarrierDescription as varchar) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m20:05:08.501702 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:273bb8ef-431c-4964-af75-dc966bfe80af&page=queryresults
[0m20:05:08.503566 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got identifier "origin" at [21:32]; reason: invalidQuery, location: query, message: Syntax error: Expected end of input but got identifier "origin" at [21:32]')
[0m20:05:09.374557 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:1a1e2caa-864c-48a7-b5af-6beb8aff53e0&page=queryresults
[0m20:05:09.376322 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:1a1e2caa-864c-48a7-b5af-6beb8aff53e0&page=queryresults
[0m20:05:09.383899 [debug] [Thread-1 (]: Database Error in model stg_flights (models/stg_flights.sql)
  Syntax error: Expected end of input but got identifier "origin" at [21:32]
  compiled code at target/run/flights_project/models/stg_flights.sql
[0m20:05:09.384948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76aa8ac1-8247-4a4b-b296-fe0c2ff23042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87c777bce0>]}
[0m20:05:09.386065 [error] [Thread-1 (]: 2 of 10 ERROR creating sql view model db_project_dataset.stg_flights ........... [[31mERROR[0m in 1.57s]
[0m20:05:09.387664 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m20:05:09.389441 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m20:05:09.390367 [info ] [Thread-1 (]: 3 of 10 SKIP relation db_project_dataset.core_flights .......................... [[33mSKIP[0m]
[0m20:05:09.391430 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m20:05:09.393140 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m20:05:09.394066 [info ] [Thread-1 (]: 4 of 10 SKIP relation db_project_dataset.dim_carriers .......................... [[33mSKIP[0m]
[0m20:05:09.395199 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m20:05:09.396126 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m20:05:09.397045 [info ] [Thread-1 (]: 5 of 10 SKIP relation db_project_dataset.dim_dates ............................. [[33mSKIP[0m]
[0m20:05:09.398161 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m20:05:09.399113 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m20:05:09.399982 [info ] [Thread-1 (]: 6 of 10 SKIP relation db_project_dataset.fact_delays_by_flight_num ............. [[33mSKIP[0m]
[0m20:05:09.401091 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m20:05:09.402150 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m20:05:09.403020 [info ] [Thread-1 (]: 7 of 10 SKIP relation db_project_dataset.fact_delays_departure_by_airport ...... [[33mSKIP[0m]
[0m20:05:09.404176 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m20:05:09.405155 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m20:05:09.406075 [info ] [Thread-1 (]: 8 of 10 SKIP relation db_project_dataset.fact_departures.by_year ............... [[33mSKIP[0m]
[0m20:05:09.407226 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m20:05:09.408366 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m20:05:09.409301 [info ] [Thread-1 (]: 9 of 10 SKIP relation db_project_dataset.fact_departures_by_airport_year ....... [[33mSKIP[0m]
[0m20:05:09.410633 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m20:05:09.411793 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m20:05:09.412775 [info ] [Thread-1 (]: 10 of 10 SKIP relation db_project_dataset.fact_most_departures_airport ......... [[33mSKIP[0m]
[0m20:05:09.413931 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m20:05:09.416561 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:09.417290 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m20:05:09.418129 [info ] [MainThread]: 
[0m20:05:09.419167 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m20:05:09.421689 [debug] [MainThread]: Command end result
[0m20:05:09.507621 [info ] [MainThread]: 
[0m20:05:09.508823 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:05:09.509932 [info ] [MainThread]: 
[0m20:05:09.511330 [error] [MainThread]:   Database Error in model dim_airports (models/marts/dim_airports.sql)
  Unrecognized name: airport_code at [16:5]
  compiled code at target/run/flights_project/models/marts/dim_airports.sql
[0m20:05:09.512577 [info ] [MainThread]: 
[0m20:05:09.513817 [error] [MainThread]:   Database Error in model stg_flights (models/stg_flights.sql)
  Syntax error: Expected end of input but got identifier "origin" at [21:32]
  compiled code at target/run/flights_project/models/stg_flights.sql
[0m20:05:09.515133 [info ] [MainThread]: 
[0m20:05:09.516388 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=8 TOTAL=10
[0m20:05:09.518579 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.6052537, "process_user_time": 5.076715, "process_kernel_time": 0.67557, "process_mem_max_rss": "255188", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:05:09.519727 [debug] [MainThread]: Command `dbt run` failed at 20:05:09.519567 after 7.61 seconds
[0m20:05:09.520682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ef1f3200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87eb95f8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87eb95f9b0>]}
[0m20:05:09.521597 [debug] [MainThread]: Flushing usage events
[0m20:19:53.539269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dc8e02600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dc93e57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dc8e03ec0>]}


============================== 20:19:53.549271 | f57812cb-3b3f-4564-a385-729037c6593d ==============================
[0m20:19:53.549271 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:19:53.550717 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:19:53.700409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f57812cb-3b3f-4564-a385-729037c6593d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dc80376e0>]}
[0m20:19:54.034177 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-j_2eoi57'
[0m20:19:54.035168 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:19:56.541907 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:19:56.544047 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:19:56.641551 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:19:56.650433 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:20:00.211234 [info ] [MainThread]: Installed from version 1.3.0
[0m20:20:00.212151 [info ] [MainThread]: Up to date!
[0m20:20:00.213006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f57812cb-3b3f-4564-a385-729037c6593d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dc81061e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dc8106ab0>]}
[0m20:20:00.215620 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 6.76049, "process_user_time": 2.584994, "process_kernel_time": 0.315724, "process_mem_max_rss": "104428", "process_in_blocks": "16", "process_out_blocks": "176"}
[0m20:20:00.216951 [debug] [MainThread]: Command `dbt deps` succeeded at 20:20:00.216739 after 6.76 seconds
[0m20:20:00.218150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dc8ea27e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dc8ea3aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dc82043e0>]}
[0m20:20:00.219248 [debug] [MainThread]: Flushing usage events
[0m20:20:05.374283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbae447e630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbae275c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbae2ee5940>]}


============================== 20:20:05.382678 | 5daba2b8-3389-47bf-acbb-afe418931125 ==============================
[0m20:20:05.382678 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:20:05.383922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:20:06.657361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5daba2b8-3389-47bf-acbb-afe418931125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabe687bc0>]}
[0m20:20:06.731553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5daba2b8-3389-47bf-acbb-afe418931125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabe80c620>]}
[0m20:20:06.732807 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:20:06.951769 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:20:08.098416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:20:08.099569 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m20:20:08.100464 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/marts/dim_airports.sql
[0m20:20:08.453405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5daba2b8-3389-47bf-acbb-afe418931125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabde94050>]}
[0m20:20:08.706749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5daba2b8-3389-47bf-acbb-afe418931125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabde97770>]}
[0m20:20:08.708059 [info ] [MainThread]: Found 10 models, 1 seed, 1 source, 602 macros
[0m20:20:08.709111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5daba2b8-3389-47bf-acbb-afe418931125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabe0b4380>]}
[0m20:20:08.712404 [info ] [MainThread]: 
[0m20:20:08.714244 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:20:08.716274 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m20:20:08.718229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:09.241986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m20:20:09.243214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:20:09.557283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5daba2b8-3389-47bf-acbb-afe418931125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabdf34830>]}
[0m20:20:09.559127 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:20:09.560297 [info ] [MainThread]: 
[0m20:20:09.571911 [debug] [Thread-1 (]: Began running node seed.flights_project.airports
[0m20:20:09.573092 [info ] [Thread-1 (]: 1 of 1 START seed file db_project_dataset.airports ............................. [RUN]
[0m20:20:09.574334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now seed.flights_project.airports)
[0m20:20:09.575250 [debug] [Thread-1 (]: Began compiling node seed.flights_project.airports
[0m20:20:09.576144 [debug] [Thread-1 (]: Began executing node seed.flights_project.airports
[0m20:20:09.708810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:13.329884 [debug] [Thread-1 (]: On seed.flights_project.airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.flights_project.airports"} */

    alter table `db-project-456518`.`db_project_dataset`.`airports` set OPTIONS()
  
[0m20:20:14.098527 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:3e421d66-a458-45b3-9824-b83e8313d0a4&page=queryresults
[0m20:20:14.325445 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.flights_project.airports"
[0m20:20:14.355756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5daba2b8-3389-47bf-acbb-afe418931125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbae279e8a0>]}
[0m20:20:14.357117 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file db_project_dataset.airports ......................... [[32mINSERT 3376[0m in 4.78s]
[0m20:20:14.358653 [debug] [Thread-1 (]: Finished running node seed.flights_project.airports
[0m20:20:14.361452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:20:14.362464 [debug] [MainThread]: Connection 'seed.flights_project.airports' was properly closed.
[0m20:20:14.363467 [info ] [MainThread]: 
[0m20:20:14.364445 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.65 seconds (5.65s).
[0m20:20:14.366051 [debug] [MainThread]: Command end result
[0m20:20:14.462500 [info ] [MainThread]: 
[0m20:20:14.463651 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:20:14.464569 [info ] [MainThread]: 
[0m20:20:14.465599 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:20:14.467154 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 9.181728, "process_user_time": 5.297698, "process_kernel_time": 0.650772, "process_mem_max_rss": "265036", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:20:14.468148 [debug] [MainThread]: Command `dbt seed` succeeded at 20:20:14.468005 after 9.18 seconds
[0m20:20:14.469022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbae447e630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabdf4f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbae5bc3260>]}
[0m20:20:14.469954 [debug] [MainThread]: Flushing usage events
[0m20:20:18.632724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b481a1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b4312d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b4407ef0>]}


============================== 20:20:18.641389 | 0d7937ad-0e6c-4b43-bf64-b34e7825031c ==============================
[0m20:20:18.641389 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:20:18.642806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:20:20.028478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d7937ad-0e6c-4b43-bf64-b34e7825031c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb39472e120>]}
[0m20:20:20.109708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d7937ad-0e6c-4b43-bf64-b34e7825031c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b481a600>]}
[0m20:20:20.110969 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:20:20.324311 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:20:21.578316 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:20:21.579208 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:20:21.642472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d7937ad-0e6c-4b43-bf64-b34e7825031c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb394904e90>]}
[0m20:20:21.881802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d7937ad-0e6c-4b43-bf64-b34e7825031c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3940b5c40>]}
[0m20:20:21.882943 [info ] [MainThread]: Found 10 models, 1 seed, 1 source, 602 macros
[0m20:20:21.884069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d7937ad-0e6c-4b43-bf64-b34e7825031c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb39446fad0>]}
[0m20:20:21.888355 [info ] [MainThread]: 
[0m20:20:21.889966 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:20:21.899055 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m20:20:21.900114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:22.273751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m20:20:22.275241 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:20:22.591593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d7937ad-0e6c-4b43-bf64-b34e7825031c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3941ca750>]}
[0m20:20:22.593464 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:20:22.594743 [info ] [MainThread]: 
[0m20:20:22.605377 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m20:20:22.606535 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m20:20:22.607764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m20:20:22.608713 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m20:20:22.622223 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m20:20:22.631471 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m20:20:22.691871 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m20:20:22.704242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:22.745993 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m20:20:23.718063 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:f323a85e-3945-4d9e-91cf-5222aa715b2c&page=queryresults
[0m20:20:25.305124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d7937ad-0e6c-4b43-bf64-b34e7825031c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3950984a0>]}
[0m20:20:25.306806 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.69s]
[0m20:20:25.308562 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m20:20:25.309839 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m20:20:25.311072 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m20:20:25.312280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m20:20:25.313363 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m20:20:25.336954 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m20:20:25.349618 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m20:20:25.459458 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m20:20:25.472772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:25.513170 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as varchar), ' ', DepTimeFormatted) as timestamp) as dep_time,
    cast(concat(cast(FlightDate as varchar), ' ', ArrTimeFormatted) as timestamp) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as varchar) as origin,
    cast(Dest as varchar) as destination,
    cast(CarrierCode as varchar) as carrier_code,
    cast(CarrierDescription as varchar) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m20:20:26.509362 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:5ba1cfd7-d0cf-4017-b5e4-c86596a512f6&page=queryresults
[0m20:20:26.694029 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Type not found: varchar at [15:36]; reason: invalidQuery, location: query, message: Type not found: varchar at [15:36]')
[0m20:20:27.911750 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:3f235664-4603-4ef4-9365-a5b592494238&page=queryresults
[0m20:20:28.040180 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:3f235664-4603-4ef4-9365-a5b592494238&page=queryresults
[0m20:20:28.049694 [debug] [Thread-1 (]: Database Error in model stg_flights (models/stg_flights.sql)
  Type not found: varchar at [15:36]
  compiled code at target/run/flights_project/models/stg_flights.sql
[0m20:20:28.050791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d7937ad-0e6c-4b43-bf64-b34e7825031c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb38ff9bf80>]}
[0m20:20:28.052015 [error] [Thread-1 (]: 2 of 10 ERROR creating sql view model db_project_dataset.stg_flights ........... [[31mERROR[0m in 2.74s]
[0m20:20:28.053546 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m20:20:28.057130 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m20:20:28.058512 [info ] [Thread-1 (]: 3 of 10 SKIP relation db_project_dataset.core_flights .......................... [[33mSKIP[0m]
[0m20:20:28.059733 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m20:20:28.061583 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m20:20:28.062542 [info ] [Thread-1 (]: 4 of 10 SKIP relation db_project_dataset.dim_carriers .......................... [[33mSKIP[0m]
[0m20:20:28.063659 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m20:20:28.064664 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m20:20:28.065719 [info ] [Thread-1 (]: 5 of 10 SKIP relation db_project_dataset.dim_dates ............................. [[33mSKIP[0m]
[0m20:20:28.066777 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m20:20:28.067794 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m20:20:28.068773 [info ] [Thread-1 (]: 6 of 10 SKIP relation db_project_dataset.fact_delays_by_flight_num ............. [[33mSKIP[0m]
[0m20:20:28.069963 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m20:20:28.071059 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m20:20:28.072046 [info ] [Thread-1 (]: 7 of 10 SKIP relation db_project_dataset.fact_delays_departure_by_airport ...... [[33mSKIP[0m]
[0m20:20:28.073205 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m20:20:28.074354 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m20:20:28.075332 [info ] [Thread-1 (]: 8 of 10 SKIP relation db_project_dataset.fact_departures.by_year ............... [[33mSKIP[0m]
[0m20:20:28.076648 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m20:20:28.077613 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m20:20:28.078582 [info ] [Thread-1 (]: 9 of 10 SKIP relation db_project_dataset.fact_departures_by_airport_year ....... [[33mSKIP[0m]
[0m20:20:28.079695 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m20:20:28.080699 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m20:20:28.081600 [info ] [Thread-1 (]: 10 of 10 SKIP relation db_project_dataset.fact_most_departures_airport ......... [[33mSKIP[0m]
[0m20:20:28.082780 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m20:20:28.085457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:20:28.086276 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m20:20:28.087118 [info ] [MainThread]: 
[0m20:20:28.088119 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 6.20 seconds (6.20s).
[0m20:20:28.090410 [debug] [MainThread]: Command end result
[0m20:20:28.182509 [info ] [MainThread]: 
[0m20:20:28.183707 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:20:28.184792 [info ] [MainThread]: 
[0m20:20:28.186041 [error] [MainThread]:   Database Error in model stg_flights (models/stg_flights.sql)
  Type not found: varchar at [15:36]
  compiled code at target/run/flights_project/models/stg_flights.sql
[0m20:20:28.187016 [info ] [MainThread]: 
[0m20:20:28.188248 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=8 TOTAL=10
[0m20:20:28.190164 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.641654, "process_user_time": 5.21859, "process_kernel_time": 0.683745, "process_mem_max_rss": "257184", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:20:28.191591 [debug] [MainThread]: Command `dbt run` failed at 20:20:28.191378 after 9.64 seconds
[0m20:20:28.192639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b67b3b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb39446c260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb39446e480>]}
[0m20:20:28.193619 [debug] [MainThread]: Flushing usage events
[0m20:22:28.224215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab7fa05ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab7fa051f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab834ad4f0>]}


============================== 20:22:28.233579 | d3bfd3e3-fc07-4dc7-b5c1-32044f2acf70 ==============================
[0m20:22:28.233579 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:22:28.235166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:22:28.389834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3bfd3e3-fc07-4dc7-b5c1-32044f2acf70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab80697230>]}
[0m20:22:28.702749 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-slhf_86_'
[0m20:22:28.703613 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:22:28.882025 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:22:28.883713 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:22:29.036484 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:22:29.045819 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:22:32.736254 [info ] [MainThread]: Installed from version 1.3.0
[0m20:22:32.737086 [info ] [MainThread]: Up to date!
[0m20:22:32.738115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd3bfd3e3-fc07-4dc7-b5c1-32044f2acf70', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab7f6ee480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab7f6ed130>]}
[0m20:22:32.739634 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.5970793, "process_user_time": 2.621371, "process_kernel_time": 0.297883, "process_mem_max_rss": "104572", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m20:22:32.740504 [debug] [MainThread]: Command `dbt deps` succeeded at 20:22:32.740375 after 4.60 seconds
[0m20:22:32.741294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab80262570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab7f6ae5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab80bd53d0>]}
[0m20:22:32.742183 [debug] [MainThread]: Flushing usage events
[0m20:22:37.657632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4765733cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47643b7d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47643b7440>]}


============================== 20:22:37.666821 | d3f90afd-6f27-4d1c-856d-287f7216ce21 ==============================
[0m20:22:37.666821 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:22:37.668360 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:22:38.867937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3f90afd-6f27-4d1c-856d-287f7216ce21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4763aa3dd0>]}
[0m20:22:38.938225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3f90afd-6f27-4d1c-856d-287f7216ce21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47636da300>]}
[0m20:22:38.939784 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:22:39.150690 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:22:40.264346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:22:40.265425 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m20:22:40.624229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3f90afd-6f27-4d1c-856d-287f7216ce21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f473fa57e00>]}
[0m20:22:40.882285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3f90afd-6f27-4d1c-856d-287f7216ce21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f473fe3cef0>]}
[0m20:22:40.884004 [info ] [MainThread]: Found 10 models, 1 seed, 1 source, 602 macros
[0m20:22:40.885120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3f90afd-6f27-4d1c-856d-287f7216ce21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4744a71c40>]}
[0m20:22:40.888714 [info ] [MainThread]: 
[0m20:22:40.890340 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:22:40.892164 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m20:22:40.893843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:41.309550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m20:22:41.310624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:22:41.649008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3f90afd-6f27-4d1c-856d-287f7216ce21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f473fa0b800>]}
[0m20:22:41.650677 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:22:41.652392 [info ] [MainThread]: 
[0m20:22:41.662877 [debug] [Thread-1 (]: Began running node seed.flights_project.airports
[0m20:22:41.664163 [info ] [Thread-1 (]: 1 of 1 START seed file db_project_dataset.airports ............................. [RUN]
[0m20:22:41.665423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now seed.flights_project.airports)
[0m20:22:41.666377 [debug] [Thread-1 (]: Began compiling node seed.flights_project.airports
[0m20:22:41.667379 [debug] [Thread-1 (]: Began executing node seed.flights_project.airports
[0m20:22:41.804418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:45.394491 [debug] [Thread-1 (]: On seed.flights_project.airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.flights_project.airports"} */

    alter table `db-project-456518`.`db_project_dataset`.`airports` set OPTIONS()
  
[0m20:22:45.530894 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:8ff5eb7d-cdcf-4d79-a557-8ec14b87cb18&page=queryresults
[0m20:22:45.722548 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.flights_project.airports"
[0m20:22:45.754473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3f90afd-6f27-4d1c-856d-287f7216ce21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47643b6d80>]}
[0m20:22:45.755744 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file db_project_dataset.airports ......................... [[32mINSERT 3376[0m in 4.09s]
[0m20:22:45.757316 [debug] [Thread-1 (]: Finished running node seed.flights_project.airports
[0m20:22:45.760222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:22:45.761151 [debug] [MainThread]: Connection 'seed.flights_project.airports' was properly closed.
[0m20:22:45.762050 [info ] [MainThread]: 
[0m20:22:45.763001 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 4.87 seconds (4.87s).
[0m20:22:45.764613 [debug] [MainThread]: Command end result
[0m20:22:45.857203 [info ] [MainThread]: 
[0m20:22:45.858382 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:22:45.859364 [info ] [MainThread]: 
[0m20:22:45.860365 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:22:45.861918 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 8.295838, "process_user_time": 5.403952, "process_kernel_time": 0.763494, "process_mem_max_rss": "262256", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:22:45.863013 [debug] [MainThread]: Command `dbt seed` succeeded at 20:22:45.862828 after 8.30 seconds
[0m20:22:45.863978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4763d81ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47463af590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4764273920>]}
[0m20:22:45.865251 [debug] [MainThread]: Flushing usage events
[0m20:22:50.174625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaaf9d4e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaafa4e000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaaf573140>]}


============================== 20:22:50.183247 | 20d0a1a5-905c-4fcd-83cf-7ee1e25bd922 ==============================
[0m20:22:50.183247 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:22:50.184599 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:22:51.409487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20d0a1a5-905c-4fcd-83cf-7ee1e25bd922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda8b73bc50>]}
[0m20:22:51.481711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20d0a1a5-905c-4fcd-83cf-7ee1e25bd922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda8ba1f380>]}
[0m20:22:51.482873 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:22:51.696346 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:22:52.815115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:22:52.815855 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:22:52.871951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20d0a1a5-905c-4fcd-83cf-7ee1e25bd922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda93b4e690>]}
[0m20:22:53.045501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20d0a1a5-905c-4fcd-83cf-7ee1e25bd922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda8b485f10>]}
[0m20:22:53.046933 [info ] [MainThread]: Found 10 models, 1 seed, 1 source, 602 macros
[0m20:22:53.048027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20d0a1a5-905c-4fcd-83cf-7ee1e25bd922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda8b309c70>]}
[0m20:22:53.051386 [info ] [MainThread]: 
[0m20:22:53.053077 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:22:53.060356 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m20:22:53.061635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:53.418121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m20:22:53.419684 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:22:53.738350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20d0a1a5-905c-4fcd-83cf-7ee1e25bd922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda8b6fabd0>]}
[0m20:22:53.740151 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:22:53.741325 [info ] [MainThread]: 
[0m20:22:53.751717 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m20:22:53.752958 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m20:22:53.754106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m20:22:53.755120 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m20:22:53.768820 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m20:22:53.778769 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m20:22:53.801737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:54.142993 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m20:22:54.155109 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m20:22:54.343338 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:0eaa5ec2-062d-4b98-9432-53f037db109c&page=queryresults
[0m20:22:55.913877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20d0a1a5-905c-4fcd-83cf-7ee1e25bd922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda901e0890>]}
[0m20:22:55.915264 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.16s]
[0m20:22:55.916874 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m20:22:55.917940 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m20:22:55.919115 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m20:22:55.920264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m20:22:55.921230 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m20:22:55.947104 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m20:22:55.958381 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m20:22:56.076874 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m20:22:56.087587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:56.128585 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted) as timestamp) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted) as timestamp) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m20:22:56.487879 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:646e1c39-c640-43dd-bc79-8c29bebe3f58&page=queryresults
[0m20:22:56.687488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20d0a1a5-905c-4fcd-83cf-7ee1e25bd922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda8be02210>]}
[0m20:22:56.689438 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 0.77s]
[0m20:22:56.691273 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m20:22:56.694061 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m20:22:56.695363 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m20:22:56.696992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m20:22:56.698108 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m20:22:56.710675 [debug] [Thread-1 (]: Compilation Error in model core_flights (models/core/core_flights.sql)
  'flight_data' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:22:56.711769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20d0a1a5-905c-4fcd-83cf-7ee1e25bd922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda8a916db0>]}
[0m20:22:56.712951 [error] [Thread-1 (]: 3 of 10 ERROR creating sql table model db_project_dataset.core_flights ......... [[31mERROR[0m in 0.02s]
[0m20:22:56.714284 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m20:22:56.716827 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m20:22:56.717840 [info ] [Thread-1 (]: 4 of 10 SKIP relation db_project_dataset.dim_carriers .......................... [[33mSKIP[0m]
[0m20:22:56.719004 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m20:22:56.720021 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m20:22:56.721009 [info ] [Thread-1 (]: 5 of 10 SKIP relation db_project_dataset.dim_dates ............................. [[33mSKIP[0m]
[0m20:22:56.722171 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m20:22:56.723176 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m20:22:56.724169 [info ] [Thread-1 (]: 6 of 10 SKIP relation db_project_dataset.fact_delays_by_flight_num ............. [[33mSKIP[0m]
[0m20:22:56.725452 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m20:22:56.726474 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m20:22:56.727434 [info ] [Thread-1 (]: 7 of 10 SKIP relation db_project_dataset.fact_delays_departure_by_airport ...... [[33mSKIP[0m]
[0m20:22:56.728624 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m20:22:56.730038 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m20:22:56.731047 [info ] [Thread-1 (]: 8 of 10 SKIP relation db_project_dataset.fact_departures.by_year ............... [[33mSKIP[0m]
[0m20:22:56.732234 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m20:22:56.733240 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m20:22:56.734237 [info ] [Thread-1 (]: 9 of 10 SKIP relation db_project_dataset.fact_departures_by_airport_year ....... [[33mSKIP[0m]
[0m20:22:56.735409 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m20:22:56.736444 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m20:22:56.737434 [info ] [Thread-1 (]: 10 of 10 SKIP relation db_project_dataset.fact_most_departures_airport ......... [[33mSKIP[0m]
[0m20:22:56.738720 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m20:22:56.741325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:22:56.742141 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m20:22:56.743013 [info ] [MainThread]: 
[0m20:22:56.744024 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 3.69 seconds (3.69s).
[0m20:22:56.746687 [debug] [MainThread]: Command end result
[0m20:22:56.832918 [info ] [MainThread]: 
[0m20:22:56.833987 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:22:56.835137 [info ] [MainThread]: 
[0m20:22:56.836639 [error] [MainThread]:   Compilation Error in model core_flights (models/core/core_flights.sql)
  'flight_data' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:22:56.837711 [info ] [MainThread]: 
[0m20:22:56.838812 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=7 TOTAL=10
[0m20:22:56.840541 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.7558312, "process_user_time": 4.837323, "process_kernel_time": 0.73959, "process_mem_max_rss": "254424", "process_in_blocks": "192", "command_success": false, "process_out_blocks": "0"}
[0m20:22:56.841684 [debug] [MainThread]: Command `dbt run` failed at 20:22:56.841538 after 6.76 seconds
[0m20:22:56.842658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaafe1ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaaf8647a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaaf8651f0>]}
[0m20:22:56.843668 [debug] [MainThread]: Flushing usage events
[0m20:24:48.043281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd71c7ae900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd71a754e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd71a756780>]}


============================== 20:24:48.062675 | 52506eed-11f9-4c7b-9318-a259f28658c4 ==============================
[0m20:24:48.062675 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:24:48.064576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:24:48.241616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52506eed-11f9-4c7b-9318-a259f28658c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd71e398b90>]}
[0m20:24:48.650912 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2cpd4diq'
[0m20:24:48.652921 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:24:48.805538 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:24:48.807194 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:24:48.892751 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:24:48.899762 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:24:52.501786 [info ] [MainThread]: Installed from version 1.3.0
[0m20:24:52.502628 [info ] [MainThread]: Up to date!
[0m20:24:52.503431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '52506eed-11f9-4c7b-9318-a259f28658c4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd71a6d1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd71a6d2840>]}
[0m20:24:52.505026 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.554777, "process_user_time": 2.633066, "process_kernel_time": 0.332803, "process_mem_max_rss": "104392", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m20:24:52.505911 [debug] [MainThread]: Command `dbt deps` succeeded at 20:24:52.505766 after 4.56 seconds
[0m20:24:52.506622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd71ab1b3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd71e398b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd71e398b30>]}
[0m20:24:52.507427 [debug] [MainThread]: Flushing usage events
[0m20:24:56.739482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68c9cf68a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ca043e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68c9d599d0>]}


============================== 20:24:56.747983 | 11b4ae3a-31fc-4919-84da-5295576ac11a ==============================
[0m20:24:56.747983 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:24:56.749344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:24:58.020796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11b4ae3a-31fc-4919-84da-5295576ac11a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a6347f80>]}
[0m20:24:58.102091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11b4ae3a-31fc-4919-84da-5295576ac11a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68b3431670>]}
[0m20:24:58.103356 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:24:58.365985 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:24:59.575868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:24:59.576947 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/core/core_flights.sql
[0m20:24:59.958300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11b4ae3a-31fc-4919-84da-5295576ac11a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a5d0d010>]}
[0m20:25:00.240127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11b4ae3a-31fc-4919-84da-5295576ac11a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a5ffc4a0>]}
[0m20:25:00.241381 [info ] [MainThread]: Found 10 models, 1 seed, 1 source, 602 macros
[0m20:25:00.242389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11b4ae3a-31fc-4919-84da-5295576ac11a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a6ba9430>]}
[0m20:25:00.245646 [info ] [MainThread]: 
[0m20:25:00.247170 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:25:00.249428 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m20:25:00.250747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:00.686627 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m20:25:00.687725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:00.995442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11b4ae3a-31fc-4919-84da-5295576ac11a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a5d0c260>]}
[0m20:25:00.997217 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:25:00.998542 [info ] [MainThread]: 
[0m20:25:01.010010 [debug] [Thread-1 (]: Began running node seed.flights_project.airports
[0m20:25:01.011314 [info ] [Thread-1 (]: 1 of 1 START seed file db_project_dataset.airports ............................. [RUN]
[0m20:25:01.012703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now seed.flights_project.airports)
[0m20:25:01.014058 [debug] [Thread-1 (]: Began compiling node seed.flights_project.airports
[0m20:25:01.015104 [debug] [Thread-1 (]: Began executing node seed.flights_project.airports
[0m20:25:01.152515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:04.639346 [debug] [Thread-1 (]: On seed.flights_project.airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.flights_project.airports"} */

    alter table `db-project-456518`.`db_project_dataset`.`airports` set OPTIONS()
  
[0m20:25:04.769053 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:099387b8-cd9a-4b99-b236-54fc1a872dd8&page=queryresults
[0m20:25:04.954500 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.flights_project.airports"
[0m20:25:05.037691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11b4ae3a-31fc-4919-84da-5295576ac11a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a5cfa960>]}
[0m20:25:05.043476 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file db_project_dataset.airports ......................... [[32mINSERT 3376[0m in 4.02s]
[0m20:25:05.045604 [debug] [Thread-1 (]: Finished running node seed.flights_project.airports
[0m20:25:05.052929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:05.054366 [debug] [MainThread]: Connection 'seed.flights_project.airports' was properly closed.
[0m20:25:05.055258 [info ] [MainThread]: 
[0m20:25:05.057836 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 4.81 seconds (4.81s).
[0m20:25:05.065627 [debug] [MainThread]: Command end result
[0m20:25:05.160994 [info ] [MainThread]: 
[0m20:25:05.162147 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:25:05.162999 [info ] [MainThread]: 
[0m20:25:05.163899 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:25:05.165856 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 8.508027, "process_user_time": 5.389049, "process_kernel_time": 0.732589, "process_mem_max_rss": "264456", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:25:05.167183 [debug] [MainThread]: Command `dbt seed` succeeded at 20:25:05.167025 after 8.51 seconds
[0m20:25:05.168150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68cb4be2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68cad2df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ca02aab0>]}
[0m20:25:05.169274 [debug] [MainThread]: Flushing usage events
[0m20:25:09.826086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20025f770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20025cb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd204018530>]}


============================== 20:25:09.835521 | a1ad8292-54c7-477c-bc33-a1b5864426a0 ==============================
[0m20:25:09.835521 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:25:09.836854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:25:11.061287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1ad8292-54c7-477c-bc33-a1b5864426a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd200043380>]}
[0m20:25:11.134075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1ad8292-54c7-477c-bc33-a1b5864426a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd200066390>]}
[0m20:25:11.135256 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:25:11.354425 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:25:12.472566 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:25:12.473302 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:25:12.539181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1ad8292-54c7-477c-bc33-a1b5864426a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e0966e40>]}
[0m20:25:12.727251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1ad8292-54c7-477c-bc33-a1b5864426a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e083d2e0>]}
[0m20:25:12.728597 [info ] [MainThread]: Found 10 models, 1 seed, 1 source, 602 macros
[0m20:25:12.729770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1ad8292-54c7-477c-bc33-a1b5864426a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e9b432f0>]}
[0m20:25:12.733168 [info ] [MainThread]: 
[0m20:25:12.734727 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:25:12.745325 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m20:25:12.746412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:13.429048 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m20:25:13.430541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:13.739727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1ad8292-54c7-477c-bc33-a1b5864426a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e2df6870>]}
[0m20:25:13.741592 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:25:13.742986 [info ] [MainThread]: 
[0m20:25:13.753503 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m20:25:13.754697 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m20:25:13.756008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m20:25:13.757227 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m20:25:13.770948 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m20:25:13.782317 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m20:25:13.808525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:14.167915 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m20:25:14.181454 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m20:25:14.549934 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:87e9ea28-9c41-42c7-9855-6ca47c6bf8de&page=queryresults
[0m20:25:16.163585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1ad8292-54c7-477c-bc33-a1b5864426a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e15602f0>]}
[0m20:25:16.164939 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.41s]
[0m20:25:16.166502 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m20:25:16.167658 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m20:25:16.169296 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m20:25:16.170736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m20:25:16.171807 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m20:25:16.194292 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m20:25:16.205491 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m20:25:16.310530 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m20:25:16.323799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:16.364048 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted) as timestamp) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted) as timestamp) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m20:25:16.775475 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:b9122cb6-b679-4467-9cd8-8604553ead00&page=queryresults
[0m20:25:16.960390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1ad8292-54c7-477c-bc33-a1b5864426a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e0587230>]}
[0m20:25:16.962153 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 0.79s]
[0m20:25:16.963979 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m20:25:16.965893 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m20:25:16.966996 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m20:25:16.968378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m20:25:16.969421 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m20:25:16.978708 [debug] [Thread-1 (]: Compilation Error in model core_flights (models/core/core_flights.sql)
  'flight_data' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:25:16.979839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1ad8292-54c7-477c-bc33-a1b5864426a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e0981bb0>]}
[0m20:25:16.981021 [error] [Thread-1 (]: 3 of 10 ERROR creating sql table model db_project_dataset.core_flights ......... [[31mERROR[0m in 0.01s]
[0m20:25:16.982424 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m20:25:16.984847 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m20:25:16.985819 [info ] [Thread-1 (]: 4 of 10 SKIP relation db_project_dataset.dim_carriers .......................... [[33mSKIP[0m]
[0m20:25:16.987060 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m20:25:16.988049 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m20:25:16.989040 [info ] [Thread-1 (]: 5 of 10 SKIP relation db_project_dataset.dim_dates ............................. [[33mSKIP[0m]
[0m20:25:16.990207 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m20:25:16.991626 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m20:25:16.992665 [info ] [Thread-1 (]: 6 of 10 SKIP relation db_project_dataset.fact_delays_by_flight_num ............. [[33mSKIP[0m]
[0m20:25:16.993895 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m20:25:16.994963 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m20:25:16.995934 [info ] [Thread-1 (]: 7 of 10 SKIP relation db_project_dataset.fact_delays_departure_by_airport ...... [[33mSKIP[0m]
[0m20:25:16.997130 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m20:25:16.998137 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m20:25:16.999107 [info ] [Thread-1 (]: 8 of 10 SKIP relation db_project_dataset.fact_departures.by_year ............... [[33mSKIP[0m]
[0m20:25:17.000317 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m20:25:17.001287 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m20:25:17.002231 [info ] [Thread-1 (]: 9 of 10 SKIP relation db_project_dataset.fact_departures_by_airport_year ....... [[33mSKIP[0m]
[0m20:25:17.003398 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m20:25:17.004394 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m20:25:17.005350 [info ] [Thread-1 (]: 10 of 10 SKIP relation db_project_dataset.fact_most_departures_airport ......... [[33mSKIP[0m]
[0m20:25:17.006508 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m20:25:17.008885 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:17.009988 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m20:25:17.011028 [info ] [MainThread]: 
[0m20:25:17.012123 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 4.28 seconds (4.28s).
[0m20:25:17.014323 [debug] [MainThread]: Command end result
[0m20:25:17.108117 [info ] [MainThread]: 
[0m20:25:17.109254 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:25:17.110205 [info ] [MainThread]: 
[0m20:25:17.112070 [error] [MainThread]:   Compilation Error in model core_flights (models/core/core_flights.sql)
  'flight_data' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:25:17.113597 [info ] [MainThread]: 
[0m20:25:17.114733 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=7 TOTAL=10
[0m20:25:17.116294 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.3769026, "process_user_time": 5.195156, "process_kernel_time": 0.555207, "process_mem_max_rss": "254292", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:25:17.117528 [debug] [MainThread]: Command `dbt run` failed at 20:25:17.117357 after 7.38 seconds
[0m20:25:17.118533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd200900d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd200902cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e0801760>]}
[0m20:25:17.119563 [debug] [MainThread]: Flushing usage events
[0m20:29:43.574092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f920179fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92030f5ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9202625970>]}


============================== 20:29:43.583582 | 222e4d75-339a-44ef-87ae-77c96f5fc953 ==============================
[0m20:29:43.583582 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:29:43.585047 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m20:29:43.745432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '222e4d75-339a-44ef-87ae-77c96f5fc953', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f920156d040>]}
[0m20:29:44.067351 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qjxhabrl'
[0m20:29:44.068364 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:29:45.149438 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:29:45.151233 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:29:45.260958 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:29:45.269013 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:29:49.017696 [info ] [MainThread]: Installed from version 1.3.0
[0m20:29:49.018562 [info ] [MainThread]: Up to date!
[0m20:29:49.019832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '222e4d75-339a-44ef-87ae-77c96f5fc953', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f920109f620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f920116ef30>]}
[0m20:29:49.021602 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 5.5408998, "process_user_time": 4.007123, "process_kernel_time": 0.399713, "process_mem_max_rss": "104344", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m20:29:49.022737 [debug] [MainThread]: Command `dbt deps` succeeded at 20:29:49.022606 after 5.54 seconds
[0m20:29:49.023575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92031bcbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f920179d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f920179fec0>]}
[0m20:29:49.024480 [debug] [MainThread]: Flushing usage events
[0m20:29:53.743790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91f0b14050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91eefffcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91eee3e2d0>]}


============================== 20:29:53.753425 | a846281e-b2c1-41a8-809e-64910d00580d ==============================
[0m20:29:53.753425 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:29:53.754715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:29:55.077716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a846281e-b2c1-41a8-809e-64910d00580d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91cbc19dc0>]}
[0m20:29:55.149017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a846281e-b2c1-41a8-809e-64910d00580d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91cb91a180>]}
[0m20:29:55.150444 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:29:55.363698 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:29:56.475451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:29:56.476470 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/core/core_flights.sql
[0m20:29:56.802735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a846281e-b2c1-41a8-809e-64910d00580d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91caf01070>]}
[0m20:29:57.074159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a846281e-b2c1-41a8-809e-64910d00580d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91cb408a70>]}
[0m20:29:57.075660 [info ] [MainThread]: Found 10 models, 1 seed, 1 source, 602 macros
[0m20:29:57.077785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a846281e-b2c1-41a8-809e-64910d00580d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91caebb6e0>]}
[0m20:29:57.081350 [info ] [MainThread]: 
[0m20:29:57.083291 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:29:57.085347 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m20:29:57.086835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:57.491486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m20:29:57.492509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:29:57.803471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a846281e-b2c1-41a8-809e-64910d00580d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91ef71d340>]}
[0m20:29:57.804996 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:29:57.806144 [info ] [MainThread]: 
[0m20:29:57.818683 [debug] [Thread-1 (]: Began running node seed.flights_project.airports
[0m20:29:57.820082 [info ] [Thread-1 (]: 1 of 1 START seed file db_project_dataset.airports ............................. [RUN]
[0m20:29:57.821351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now seed.flights_project.airports)
[0m20:29:57.822340 [debug] [Thread-1 (]: Began compiling node seed.flights_project.airports
[0m20:29:57.823387 [debug] [Thread-1 (]: Began executing node seed.flights_project.airports
[0m20:29:57.960439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:01.452724 [debug] [Thread-1 (]: On seed.flights_project.airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.flights_project.airports"} */

    alter table `db-project-456518`.`db_project_dataset`.`airports` set OPTIONS()
  
[0m20:30:01.596703 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:add3a15a-2b1d-45b6-8619-86f406aee541&page=queryresults
[0m20:30:01.854665 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.flights_project.airports"
[0m20:30:01.886651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a846281e-b2c1-41a8-809e-64910d00580d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91ef762cf0>]}
[0m20:30:01.887808 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file db_project_dataset.airports ......................... [[32mINSERT 3376[0m in 4.06s]
[0m20:30:01.889196 [debug] [Thread-1 (]: Finished running node seed.flights_project.airports
[0m20:30:01.891815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:30:01.892689 [debug] [MainThread]: Connection 'seed.flights_project.airports' was properly closed.
[0m20:30:01.893506 [info ] [MainThread]: 
[0m20:30:01.894453 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 4.81 seconds (4.81s).
[0m20:30:01.896031 [debug] [MainThread]: Command end result
[0m20:30:01.981216 [info ] [MainThread]: 
[0m20:30:01.982347 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:30:01.983323 [info ] [MainThread]: 
[0m20:30:01.984409 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:30:01.986136 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 8.330469, "process_user_time": 5.385569, "process_kernel_time": 0.660683, "process_mem_max_rss": "262620", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:30:01.987203 [debug] [MainThread]: Command `dbt seed` succeeded at 20:30:01.987059 after 8.33 seconds
[0m20:30:01.988195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91f2a0bbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91efc0b260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91efc0ade0>]}
[0m20:30:01.989207 [debug] [MainThread]: Flushing usage events
[0m20:30:08.417561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a1086060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a0b9d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a1086300>]}


============================== 20:30:08.436582 | acac0fd8-6b8f-4764-922c-8bf5a74c908f ==============================
[0m20:30:08.436582 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:30:08.438224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:30:10.604923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acac0fd8-6b8f-4764-922c-8bf5a74c908f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f727cd29280>]}
[0m20:30:10.723437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acac0fd8-6b8f-4764-922c-8bf5a74c908f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f727cdae780>]}
[0m20:30:10.725334 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:30:10.980712 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:30:12.600463 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:30:12.601293 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:30:12.668249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acac0fd8-6b8f-4764-922c-8bf5a74c908f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f727cd74620>]}
[0m20:30:12.861078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acac0fd8-6b8f-4764-922c-8bf5a74c908f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f727cbcab70>]}
[0m20:30:12.862409 [info ] [MainThread]: Found 10 models, 1 seed, 1 source, 602 macros
[0m20:30:12.863479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acac0fd8-6b8f-4764-922c-8bf5a74c908f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f727ca557c0>]}
[0m20:30:12.866684 [info ] [MainThread]: 
[0m20:30:12.868396 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:30:12.876630 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m20:30:12.877715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:30:13.270197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m20:30:13.272079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:30:13.669024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acac0fd8-6b8f-4764-922c-8bf5a74c908f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f727c985220>]}
[0m20:30:13.670206 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:30:13.671107 [info ] [MainThread]: 
[0m20:30:13.686214 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m20:30:13.687366 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m20:30:13.688399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m20:30:13.689399 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m20:30:13.705529 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m20:30:13.715976 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m20:30:13.741395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:14.125565 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m20:30:14.139266 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m20:30:14.957638 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:01268526-5938-47a2-a495-f34cf86d19be&page=queryresults
[0m20:30:16.585133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acac0fd8-6b8f-4764-922c-8bf5a74c908f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f727d924a40>]}
[0m20:30:16.586656 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.90s]
[0m20:30:16.588546 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m20:30:16.590088 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m20:30:16.591255 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m20:30:16.592506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m20:30:16.593851 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m20:30:16.621316 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m20:30:16.633786 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m20:30:16.768004 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m20:30:16.781271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:16.825875 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted) as timestamp) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted) as timestamp) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m20:30:17.241816 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:9d0ca572-f86f-41ee-8c16-45e236514763&page=queryresults
[0m20:30:17.440438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acac0fd8-6b8f-4764-922c-8bf5a74c908f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a10b1280>]}
[0m20:30:17.443435 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m20:30:17.446546 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m20:30:17.449586 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m20:30:17.451127 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m20:30:17.452980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m20:30:17.454351 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m20:30:17.469289 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m20:30:17.484567 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m20:30:17.490446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:17.878344 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m20:30:17.889244 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.flight_month,
    flight_data.dep_time,
    flight_data.arr_time,
    
case
    when arrival_time >= departure_time then 
      TIMEDIFF(minute, departure_time, arrival_time)
    else 
      TIMEDIFF(minute, departure_time, arrival_time) + 1440  -- +24hrs if next day
  end as airtime_minutes,
 as airtime,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m20:30:18.752433 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:50a58d1f-1d41-4847-9afb-8506bf6ee6d1&page=queryresults
[0m20:30:18.754116 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword AS at [35:2]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got keyword AS at [35:2]')
[0m20:30:19.551382 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:ce368097-aa77-4acc-92e4-b8ef861c43c0&page=queryresults
[0m20:30:19.553257 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:ce368097-aa77-4acc-92e4-b8ef861c43c0&page=queryresults
[0m20:30:19.561951 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  Syntax error: Expected ")" but got keyword AS at [35:2]
  compiled code at target/run/flights_project/models/core/core_flights.sql
[0m20:30:19.563038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acac0fd8-6b8f-4764-922c-8bf5a74c908f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f727c827590>]}
[0m20:30:19.564186 [error] [Thread-1 (]: 3 of 10 ERROR creating sql table model db_project_dataset.core_flights ......... [[31mERROR[0m in 2.11s]
[0m20:30:19.565459 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m20:30:19.567905 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m20:30:19.568994 [info ] [Thread-1 (]: 4 of 10 SKIP relation db_project_dataset.dim_carriers .......................... [[33mSKIP[0m]
[0m20:30:19.570068 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m20:30:19.571052 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m20:30:19.571966 [info ] [Thread-1 (]: 5 of 10 SKIP relation db_project_dataset.dim_dates ............................. [[33mSKIP[0m]
[0m20:30:19.573042 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m20:30:19.574026 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m20:30:19.575039 [info ] [Thread-1 (]: 6 of 10 SKIP relation db_project_dataset.fact_delays_by_flight_num ............. [[33mSKIP[0m]
[0m20:30:19.576488 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m20:30:19.577465 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m20:30:19.578426 [info ] [Thread-1 (]: 7 of 10 SKIP relation db_project_dataset.fact_delays_departure_by_airport ...... [[33mSKIP[0m]
[0m20:30:19.579607 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m20:30:19.580592 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m20:30:19.581871 [info ] [Thread-1 (]: 8 of 10 SKIP relation db_project_dataset.fact_departures.by_year ............... [[33mSKIP[0m]
[0m20:30:19.583329 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m20:30:19.584318 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m20:30:19.585303 [info ] [Thread-1 (]: 9 of 10 SKIP relation db_project_dataset.fact_departures_by_airport_year ....... [[33mSKIP[0m]
[0m20:30:19.586554 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m20:30:19.587511 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m20:30:19.588469 [info ] [Thread-1 (]: 10 of 10 SKIP relation db_project_dataset.fact_most_departures_airport ......... [[33mSKIP[0m]
[0m20:30:19.589810 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m20:30:19.592503 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:30:19.593371 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m20:30:19.594296 [info ] [MainThread]: 
[0m20:30:19.595365 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 6.73 seconds (6.73s).
[0m20:30:19.598079 [debug] [MainThread]: Command end result
[0m20:30:19.694937 [info ] [MainThread]: 
[0m20:30:19.696436 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:30:19.697600 [info ] [MainThread]: 
[0m20:30:19.698922 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  Syntax error: Expected ")" but got keyword AS at [35:2]
  compiled code at target/run/flights_project/models/core/core_flights.sql
[0m20:30:19.700160 [info ] [MainThread]: 
[0m20:30:19.701272 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=7 TOTAL=10
[0m20:30:19.703399 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.390471, "process_user_time": 7.797142, "process_kernel_time": 0.778715, "process_mem_max_rss": "254700", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:30:19.704893 [debug] [MainThread]: Command `dbt run` failed at 20:30:19.704657 after 11.39 seconds
[0m20:30:19.706063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a0a38200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f727cc03800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a14695e0>]}
[0m20:30:19.707273 [debug] [MainThread]: Flushing usage events
[0m20:32:19.804981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d846bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d6afa9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d7ba2870>]}


============================== 20:32:19.813718 | 77a9c3fd-5abb-46f1-9308-186f8c4e75a5 ==============================
[0m20:32:19.813718 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:32:19.814933 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:32:19.972097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77a9c3fd-5abb-46f1-9308-186f8c4e75a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d67df7a0>]}
[0m20:32:20.287450 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-i8k29xld'
[0m20:32:20.288482 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:32:20.443438 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:32:20.445027 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:32:20.621140 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:32:20.629360 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:32:24.400182 [info ] [MainThread]: Installed from version 1.3.0
[0m20:32:24.401129 [info ] [MainThread]: Up to date!
[0m20:32:24.402168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '77a9c3fd-5abb-46f1-9308-186f8c4e75a5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d69c0470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d6293ce0>]}
[0m20:32:24.403698 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.6905503, "process_user_time": 3.115055, "process_kernel_time": 0.280455, "process_mem_max_rss": "104496", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m20:32:24.404617 [debug] [MainThread]: Command `dbt deps` succeeded at 20:32:24.404478 after 4.69 seconds
[0m20:32:24.405418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50da50b260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d6af8f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d99aa1b0>]}
[0m20:32:24.406233 [debug] [MainThread]: Flushing usage events
[0m20:32:28.518530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520b067cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520b203230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520bef5850>]}


============================== 20:32:28.526743 | 738de117-3cae-4e47-91cf-e22d512ddb77 ==============================
[0m20:32:28.526743 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:32:28.528150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:32:30.368922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '738de117-3cae-4e47-91cf-e22d512ddb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520b944830>]}
[0m20:32:30.545534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '738de117-3cae-4e47-91cf-e22d512ddb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51e7466a80>]}
[0m20:32:30.546985 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:32:30.785260 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:32:32.376848 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:32:32.378685 [debug] [MainThread]: Partial parsing: updated file: flights_project://macros/airtime_minutes.sql
[0m20:32:32.791691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '738de117-3cae-4e47-91cf-e22d512ddb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51e68ee780>]}
[0m20:32:33.274611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '738de117-3cae-4e47-91cf-e22d512ddb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51e6eaa900>]}
[0m20:32:33.275953 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m20:32:33.277430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '738de117-3cae-4e47-91cf-e22d512ddb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51e69bf5c0>]}
[0m20:32:33.285772 [info ] [MainThread]: 
[0m20:32:33.287528 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:32:33.290648 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m20:32:33.292417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:33.713100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m20:32:33.714815 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:32:34.086590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '738de117-3cae-4e47-91cf-e22d512ddb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51e6ae20f0>]}
[0m20:32:34.088896 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:32:34.091090 [info ] [MainThread]: 
[0m20:32:34.110220 [debug] [Thread-1 (]: Began running node seed.flights_project.airports
[0m20:32:34.112639 [info ] [Thread-1 (]: 1 of 1 START seed file db_project_dataset.airports ............................. [RUN]
[0m20:32:34.115470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now seed.flights_project.airports)
[0m20:32:34.117315 [debug] [Thread-1 (]: Began compiling node seed.flights_project.airports
[0m20:32:34.119309 [debug] [Thread-1 (]: Began executing node seed.flights_project.airports
[0m20:32:34.294533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:36.741840 [debug] [Thread-1 (]: On seed.flights_project.airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.flights_project.airports"} */

    alter table `db-project-456518`.`db_project_dataset`.`airports` set OPTIONS()
  
[0m20:32:36.902858 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e71db630-87d6-4d1b-aea2-3e3469e0b9d6&page=queryresults
[0m20:32:37.092706 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.flights_project.airports"
[0m20:32:37.131621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '738de117-3cae-4e47-91cf-e22d512ddb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520bef5d60>]}
[0m20:32:37.132884 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file db_project_dataset.airports ......................... [[32mINSERT 3376[0m in 3.02s]
[0m20:32:37.134441 [debug] [Thread-1 (]: Finished running node seed.flights_project.airports
[0m20:32:37.137478 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:32:37.138356 [debug] [MainThread]: Connection 'seed.flights_project.airports' was properly closed.
[0m20:32:37.139218 [info ] [MainThread]: 
[0m20:32:37.140323 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.85 seconds (3.85s).
[0m20:32:37.141892 [debug] [MainThread]: Command end result
[0m20:32:37.246443 [info ] [MainThread]: 
[0m20:32:37.248278 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:32:37.249604 [info ] [MainThread]: 
[0m20:32:37.250830 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:32:37.252897 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 8.82024, "process_user_time": 6.600559, "process_kernel_time": 0.817591, "process_mem_max_rss": "264508", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:32:37.254799 [debug] [MainThread]: Command `dbt seed` succeeded at 20:32:37.254604 after 8.82 seconds
[0m20:32:37.256001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520e61f260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51e75fa480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51e75f80e0>]}
[0m20:32:37.257755 [debug] [MainThread]: Flushing usage events
[0m20:32:42.971633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24fa3e61e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24fa5f3c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24fb478ad0>]}


============================== 20:32:42.983789 | b5743b23-2720-4868-80de-79245368c483 ==============================
[0m20:32:42.983789 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:32:42.984960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:32:45.070200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5743b23-2720-4868-80de-79245368c483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24d6d8f350>]}
[0m20:32:45.193747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5743b23-2720-4868-80de-79245368c483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24dd180380>]}
[0m20:32:45.195865 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:32:45.590201 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:32:47.249615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:32:47.250454 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:32:47.325850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5743b23-2720-4868-80de-79245368c483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24d69f6b10>]}
[0m20:32:47.522462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5743b23-2720-4868-80de-79245368c483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24d67f60c0>]}
[0m20:32:47.524045 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m20:32:47.525374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5743b23-2720-4868-80de-79245368c483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24d65af200>]}
[0m20:32:47.529582 [info ] [MainThread]: 
[0m20:32:47.531336 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:32:47.541297 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m20:32:47.542559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:47.904479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m20:32:47.906205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:32:48.352998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5743b23-2720-4868-80de-79245368c483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24fa04aa20>]}
[0m20:32:48.354609 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:32:48.355669 [info ] [MainThread]: 
[0m20:32:48.366747 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m20:32:48.368009 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m20:32:48.369223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m20:32:48.370167 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m20:32:48.383494 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m20:32:48.396001 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m20:32:48.420197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:48.797286 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m20:32:48.808873 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m20:32:49.580670 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:616d0190-f175-4b00-b7aa-1348f3ad44fd&page=queryresults
[0m20:32:51.154991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5743b23-2720-4868-80de-79245368c483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24d755c710>]}
[0m20:32:51.156449 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.78s]
[0m20:32:51.158040 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m20:32:51.159191 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m20:32:51.160990 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m20:32:51.162784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m20:32:51.164608 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m20:32:51.190332 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m20:32:51.201522 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m20:32:51.312852 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m20:32:51.325270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:51.365773 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted) as timestamp) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted) as timestamp) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m20:32:51.762568 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:24a151a8-dc8a-4ce6-a52c-fd3cd448037f&page=queryresults
[0m20:32:51.895128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5743b23-2720-4868-80de-79245368c483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24d669bf50>]}
[0m20:32:51.896878 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 0.73s]
[0m20:32:51.898906 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m20:32:51.901518 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m20:32:51.903159 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m20:32:51.905152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m20:32:51.906727 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m20:32:51.914468 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m20:32:51.924527 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m20:32:51.929345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:52.257653 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m20:32:52.269860 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.flight_month,
    flight_data.dep_time,
    flight_data.arr_time,
    
case
    when arrival_time >= departure_time then 
      TIMEDIFF(minute, departure_time, arrival_time)
    else 
      TIMEDIFF(minute, departure_time, arrival_time) + 1440  -- +24hrs if next day
 as airtime,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m20:32:53.057011 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:6885d899-b352-4c16-b22c-571453c40c7c&page=queryresults
[0m20:32:53.058908 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword END but got keyword AS at [34:2]; reason: invalidQuery, location: query, message: Syntax error: Expected keyword END but got keyword AS at [34:2]')
[0m20:32:53.780345 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:1e6d37ec-0a29-44ac-accf-cdacd680162b&page=queryresults
[0m20:32:53.782212 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:1e6d37ec-0a29-44ac-accf-cdacd680162b&page=queryresults
[0m20:32:53.790699 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  Syntax error: Expected keyword END but got keyword AS at [34:2]
  compiled code at target/run/flights_project/models/core/core_flights.sql
[0m20:32:53.791823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5743b23-2720-4868-80de-79245368c483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24d6498b00>]}
[0m20:32:53.792997 [error] [Thread-1 (]: 3 of 10 ERROR creating sql table model db_project_dataset.core_flights ......... [[31mERROR[0m in 1.89s]
[0m20:32:53.794366 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m20:32:53.796772 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m20:32:53.797710 [info ] [Thread-1 (]: 4 of 10 SKIP relation db_project_dataset.dim_carriers .......................... [[33mSKIP[0m]
[0m20:32:53.798926 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m20:32:53.800017 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m20:32:53.801034 [info ] [Thread-1 (]: 5 of 10 SKIP relation db_project_dataset.dim_dates ............................. [[33mSKIP[0m]
[0m20:32:53.802153 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m20:32:53.803173 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m20:32:53.804164 [info ] [Thread-1 (]: 6 of 10 SKIP relation db_project_dataset.fact_delays_by_flight_num ............. [[33mSKIP[0m]
[0m20:32:53.805419 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m20:32:53.806419 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m20:32:53.807349 [info ] [Thread-1 (]: 7 of 10 SKIP relation db_project_dataset.fact_delays_departure_by_airport ...... [[33mSKIP[0m]
[0m20:32:53.808575 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m20:32:53.809514 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m20:32:53.810420 [info ] [Thread-1 (]: 8 of 10 SKIP relation db_project_dataset.fact_departures.by_year ............... [[33mSKIP[0m]
[0m20:32:53.811515 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m20:32:53.812442 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m20:32:53.813376 [info ] [Thread-1 (]: 9 of 10 SKIP relation db_project_dataset.fact_departures_by_airport_year ....... [[33mSKIP[0m]
[0m20:32:53.814502 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m20:32:53.815771 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m20:32:53.816717 [info ] [Thread-1 (]: 10 of 10 SKIP relation db_project_dataset.fact_most_departures_airport ......... [[33mSKIP[0m]
[0m20:32:53.817837 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m20:32:53.820431 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:32:53.821349 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m20:32:53.822235 [info ] [MainThread]: 
[0m20:32:53.823231 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 6.29 seconds (6.29s).
[0m20:32:53.825328 [debug] [MainThread]: Command end result
[0m20:32:53.925402 [info ] [MainThread]: 
[0m20:32:53.927158 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:32:53.928597 [info ] [MainThread]: 
[0m20:32:53.930515 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  Syntax error: Expected keyword END but got keyword AS at [34:2]
  compiled code at target/run/flights_project/models/core/core_flights.sql
[0m20:32:53.931832 [info ] [MainThread]: 
[0m20:32:53.933052 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=7 TOTAL=10
[0m20:32:53.935022 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.068713, "process_user_time": 7.074244, "process_kernel_time": 0.961066, "process_mem_max_rss": "254544", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:32:53.936578 [debug] [MainThread]: Command `dbt run` failed at 20:32:53.936294 after 11.07 seconds
[0m20:32:53.937971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24fa42fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24d6469250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24d646b050>]}
[0m20:32:53.939114 [debug] [MainThread]: Flushing usage events
[0m20:34:16.276024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4080a31190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4080c1c320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4081dc61b0>]}


============================== 20:34:16.286250 | de247671-3f4a-49e4-8de1-2e653a2df9bb ==============================
[0m20:34:16.286250 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:34:16.287572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:34:19.729141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de247671-3f4a-49e4-8de1-2e653a2df9bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4060775880>]}
[0m20:34:19.830573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de247671-3f4a-49e4-8de1-2e653a2df9bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40801133e0>]}
[0m20:34:19.831879 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:34:20.157862 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:34:22.171445 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:34:22.172928 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/core/core_flights.sql
[0m20:34:22.174078 [debug] [MainThread]: Partial parsing: updated file: flights_project://macros/airtime_minutes.sql
[0m20:34:22.888503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de247671-3f4a-49e4-8de1-2e653a2df9bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4060777d70>]}
[0m20:34:23.251600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de247671-3f4a-49e4-8de1-2e653a2df9bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40606e2a50>]}
[0m20:34:23.253890 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m20:34:23.255526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de247671-3f4a-49e4-8de1-2e653a2df9bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4080a33980>]}
[0m20:34:23.261329 [info ] [MainThread]: 
[0m20:34:23.264181 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:34:23.267667 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m20:34:23.271797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:23.790037 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m20:34:23.792500 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:34:24.239001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de247671-3f4a-49e4-8de1-2e653a2df9bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4060136240>]}
[0m20:34:24.240795 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:34:24.242444 [info ] [MainThread]: 
[0m20:34:24.253970 [debug] [Thread-1 (]: Began running node seed.flights_project.airports
[0m20:34:24.255746 [info ] [Thread-1 (]: 1 of 1 START seed file db_project_dataset.airports ............................. [RUN]
[0m20:34:24.257240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now seed.flights_project.airports)
[0m20:34:24.258759 [debug] [Thread-1 (]: Began compiling node seed.flights_project.airports
[0m20:34:24.260185 [debug] [Thread-1 (]: Began executing node seed.flights_project.airports
[0m20:34:24.463990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:34:28.609390 [debug] [Thread-1 (]: On seed.flights_project.airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.flights_project.airports"} */

    alter table `db-project-456518`.`db_project_dataset`.`airports` set OPTIONS()
  
[0m20:34:28.748102 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:dca5e83c-7477-44bf-83d4-13eee652bb80&page=queryresults
[0m20:34:28.900223 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.flights_project.airports"
[0m20:34:28.964397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de247671-3f4a-49e4-8de1-2e653a2df9bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4081735760>]}
[0m20:34:28.966510 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file db_project_dataset.airports ......................... [[32mINSERT 3376[0m in 4.71s]
[0m20:34:28.968658 [debug] [Thread-1 (]: Finished running node seed.flights_project.airports
[0m20:34:28.972163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:34:28.974058 [debug] [MainThread]: Connection 'seed.flights_project.airports' was properly closed.
[0m20:34:28.976236 [info ] [MainThread]: 
[0m20:34:28.978283 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.71 seconds (5.71s).
[0m20:34:28.980534 [debug] [MainThread]: Command end result
[0m20:34:29.138246 [info ] [MainThread]: 
[0m20:34:29.145294 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:34:29.150816 [info ] [MainThread]: 
[0m20:34:29.154819 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:34:29.162012 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 12.973119, "process_user_time": 10.026984, "process_kernel_time": 1.244398, "process_mem_max_rss": "262424", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:34:29.164251 [debug] [MainThread]: Command `dbt seed` succeeded at 20:34:29.163649 after 12.98 seconds
[0m20:34:29.166446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4083e57260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4081dc61b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4058e06ed0>]}
[0m20:34:29.168704 [debug] [MainThread]: Flushing usage events
[0m20:34:35.947664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b9fbde780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b9d6afe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b9e1cacc0>]}


============================== 20:34:35.965631 | 0787c188-6e5e-4307-95ee-e1eaec7184ce ==============================
[0m20:34:35.965631 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:34:35.968188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:34:37.950709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0787c188-6e5e-4307-95ee-e1eaec7184ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b79a50380>]}
[0m20:34:38.037134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0787c188-6e5e-4307-95ee-e1eaec7184ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b79fade80>]}
[0m20:34:38.038860 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:34:38.299785 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:34:40.126961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:34:40.128266 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:34:40.196441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0787c188-6e5e-4307-95ee-e1eaec7184ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7a119370>]}
[0m20:34:40.504906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0787c188-6e5e-4307-95ee-e1eaec7184ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b796d87d0>]}
[0m20:34:40.508005 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m20:34:40.510138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0787c188-6e5e-4307-95ee-e1eaec7184ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b796215e0>]}
[0m20:34:40.516193 [info ] [MainThread]: 
[0m20:34:40.520416 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:34:40.543179 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m20:34:40.545132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:41.004472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m20:34:41.007471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:34:41.350254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0787c188-6e5e-4307-95ee-e1eaec7184ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b9d483b60>]}
[0m20:34:41.351932 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:34:41.353000 [info ] [MainThread]: 
[0m20:34:41.365161 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m20:34:41.366417 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m20:34:41.367667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m20:34:41.368665 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m20:34:41.382664 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m20:34:41.397615 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m20:34:41.424339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:34:41.809207 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m20:34:41.828791 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m20:34:42.046338 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e2b96ff7-2c15-4783-8c4c-c93f1c3b7ec9&page=queryresults
[0m20:34:43.617580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0787c188-6e5e-4307-95ee-e1eaec7184ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7a2f4560>]}
[0m20:34:43.619447 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.25s]
[0m20:34:43.620990 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m20:34:43.622236 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m20:34:43.623404 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m20:34:43.624628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m20:34:43.625913 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m20:34:43.653084 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m20:34:43.663398 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m20:34:43.784652 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m20:34:43.800667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:34:43.866015 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted) as timestamp) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted) as timestamp) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m20:34:44.328451 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:5b6d6ec8-3ec0-48fc-951c-a5bc31fdf182&page=queryresults
[0m20:34:44.501061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0787c188-6e5e-4307-95ee-e1eaec7184ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b79669580>]}
[0m20:34:44.504146 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m20:34:44.508596 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m20:34:44.511290 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m20:34:44.512458 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m20:34:44.513793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m20:34:44.514746 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m20:34:44.526042 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m20:34:44.536699 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m20:34:44.542981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:34:44.840737 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m20:34:44.852412 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.flight_month,
    flight_data.dep_time,
    flight_data.arr_time,
    
    case
        when flight_data.arr_time >= flight_data.dep_time then 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE)
        else 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE) + 1440
    end
 as airtime,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m20:34:45.368531 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:206c3e71-31ed-4df1-85b6-c0426dbb8e21&page=queryresults
[0m20:34:45.765618 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid timestamp: '2002-11-05 12:24'; reason: invalidQuery, location: query, message: Invalid timestamp: '2002-11-05 12:24'; reason: invalidQuery, location: query, message: Invalid timestamp: '1999-11-14 11:08'; reason: invalidQuery, location: query, message: Invalid timestamp: '1990-11-28 21:19'")
[0m20:34:46.572051 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:d8359e30-fb1d-4ca4-a619-6f1b6c7da03a&page=queryresults
[0m20:34:46.946977 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:d8359e30-fb1d-4ca4-a619-6f1b6c7da03a&page=queryresults
[0m20:34:46.957133 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  Invalid timestamp: '1999-07-09 17:43'
  compiled code at target/run/flights_project/models/core/core_flights.sql
[0m20:34:46.958316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0787c188-6e5e-4307-95ee-e1eaec7184ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b79431130>]}
[0m20:34:46.959496 [error] [Thread-1 (]: 3 of 10 ERROR creating sql table model db_project_dataset.core_flights ......... [[31mERROR[0m in 2.44s]
[0m20:34:46.960807 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m20:34:46.963489 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m20:34:46.964734 [info ] [Thread-1 (]: 4 of 10 SKIP relation db_project_dataset.dim_carriers .......................... [[33mSKIP[0m]
[0m20:34:46.965887 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m20:34:46.966867 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m20:34:46.967999 [info ] [Thread-1 (]: 5 of 10 SKIP relation db_project_dataset.dim_dates ............................. [[33mSKIP[0m]
[0m20:34:46.969387 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m20:34:46.970452 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m20:34:46.971570 [info ] [Thread-1 (]: 6 of 10 SKIP relation db_project_dataset.fact_delays_by_flight_num ............. [[33mSKIP[0m]
[0m20:34:46.972918 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m20:34:46.973909 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m20:34:46.974858 [info ] [Thread-1 (]: 7 of 10 SKIP relation db_project_dataset.fact_delays_departure_by_airport ...... [[33mSKIP[0m]
[0m20:34:46.976010 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m20:34:46.976995 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m20:34:46.977910 [info ] [Thread-1 (]: 8 of 10 SKIP relation db_project_dataset.fact_departures.by_year ............... [[33mSKIP[0m]
[0m20:34:46.978960 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m20:34:46.979982 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m20:34:46.980977 [info ] [Thread-1 (]: 9 of 10 SKIP relation db_project_dataset.fact_departures_by_airport_year ....... [[33mSKIP[0m]
[0m20:34:46.982059 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m20:34:46.983060 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m20:34:46.984020 [info ] [Thread-1 (]: 10 of 10 SKIP relation db_project_dataset.fact_most_departures_airport ......... [[33mSKIP[0m]
[0m20:34:46.985359 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m20:34:46.988232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:34:46.989110 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m20:34:46.990014 [info ] [MainThread]: 
[0m20:34:46.990881 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 6.47 seconds (6.47s).
[0m20:34:46.993058 [debug] [MainThread]: Command end result
[0m20:34:47.094168 [info ] [MainThread]: 
[0m20:34:47.095285 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:34:47.096177 [info ] [MainThread]: 
[0m20:34:47.097409 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  Invalid timestamp: '1999-07-09 17:43'
  compiled code at target/run/flights_project/models/core/core_flights.sql
[0m20:34:47.098430 [info ] [MainThread]: 
[0m20:34:47.099566 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=7 TOTAL=10
[0m20:34:47.101328 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.288549, "process_user_time": 7.819598, "process_kernel_time": 0.868844, "process_mem_max_rss": "254216", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:34:47.102712 [debug] [MainThread]: Command `dbt run` failed at 20:34:47.102522 after 11.29 seconds
[0m20:34:47.103784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b9d621280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b9e1cacc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b9d7f9640>]}
[0m20:34:47.105110 [debug] [MainThread]: Flushing usage events
[0m20:39:52.695255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b5d388590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b5dc57410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b5cd51a90>]}


============================== 20:39:52.707335 | 736539d8-13ce-4d0e-92f1-bafe2035cee7 ==============================
[0m20:39:52.707335 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:39:52.708935 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:39:54.081808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '736539d8-13ce-4d0e-92f1-bafe2035cee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b3940b7d0>]}
[0m20:39:54.158815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '736539d8-13ce-4d0e-92f1-bafe2035cee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b39abf530>]}
[0m20:39:54.160054 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:39:54.404157 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:39:56.020292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:39:56.022086 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:39:56.113619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '736539d8-13ce-4d0e-92f1-bafe2035cee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b392544a0>]}
[0m20:39:56.316595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '736539d8-13ce-4d0e-92f1-bafe2035cee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b3906a3c0>]}
[0m20:39:56.317836 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m20:39:56.318865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '736539d8-13ce-4d0e-92f1-bafe2035cee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b38e13890>]}
[0m20:39:56.322766 [info ] [MainThread]: 
[0m20:39:56.324376 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:39:56.333102 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m20:39:56.334275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:56.950529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m20:39:56.952086 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:39:57.256610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '736539d8-13ce-4d0e-92f1-bafe2035cee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b5e0f8590>]}
[0m20:39:57.258205 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:39:57.259224 [info ] [MainThread]: 
[0m20:39:57.271752 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m20:39:57.273062 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m20:39:57.274339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m20:39:57.275266 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m20:39:57.290374 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m20:39:57.305017 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m20:39:57.340475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:57.720076 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m20:39:57.733083 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m20:39:57.982265 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:3c449a77-ff1e-4fac-ab89-a4eb36364c4e&page=queryresults
[0m20:39:59.830445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '736539d8-13ce-4d0e-92f1-bafe2035cee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b39bc44d0>]}
[0m20:39:59.832329 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.55s]
[0m20:39:59.834219 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m20:39:59.835353 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m20:39:59.836884 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m20:39:59.838697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m20:39:59.840172 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m20:39:59.890203 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m20:39:59.900991 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m20:40:00.079509 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m20:40:00.086977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:00.129521 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted) as timestamp) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted) as timestamp) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m20:40:00.514286 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:15bbab14-e3de-416d-b331-3a662f1d9ca3&page=queryresults
[0m20:40:00.684249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '736539d8-13ce-4d0e-92f1-bafe2035cee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b5e18b230>]}
[0m20:40:00.685793 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m20:40:00.687721 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m20:40:00.690470 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m20:40:00.691651 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m20:40:00.693072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m20:40:00.694254 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m20:40:00.704037 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m20:40:00.714435 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m20:40:00.719775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:01.030996 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m20:40:01.042428 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.flight_month,
    flight_data.dep_time,
    flight_data.arr_time,
    
    case
        when flight_data.arr_time >= flight_data.dep_time then 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE)
        else 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE) + 1440
    end
 as airtime,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m20:40:01.515649 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:f04ca72b-1e01-41a9-a2d5-7a6d4dd51a04&page=queryresults
[0m20:40:01.924277 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid timestamp: '1996-06-12 16:21'; reason: invalidQuery, location: query, message: Invalid timestamp: '1996-06-12 16:21'; reason: invalidQuery, location: query, message: Invalid timestamp: '1998-01-25 07:15'; reason: invalidQuery, location: query, message: Invalid timestamp: '1999-11-16 11:00'; reason: invalidQuery, location: query, message: Invalid timestamp: '1997-10-04 17:29'; reason: invalidQuery, location: query, message: Invalid timestamp: '1993-04-25 18:27'; reason: invalidQuery, location: query, message: Invalid timestamp: '1991-03-31 09:35'; reason: invalidQuery, location: query, message: Invalid timestamp: '1998-04-25 09:30'; reason: invalidQuery, location: query, message: Invalid timestamp: '1989-08-02 11:48'; reason: invalidQuery, location: query, message: Invalid timestamp: '1998-10-21 16:52'")
[0m20:40:03.208207 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:315f49f7-b71d-4c60-9657-fa6e34163939&page=queryresults
[0m20:40:03.580836 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:315f49f7-b71d-4c60-9657-fa6e34163939&page=queryresults
[0m20:40:03.592037 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  Invalid timestamp: '1996-04-20 10:59'
  compiled code at target/run/flights_project/models/core/core_flights.sql
[0m20:40:03.595050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '736539d8-13ce-4d0e-92f1-bafe2035cee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b5c945610>]}
[0m20:40:03.597624 [error] [Thread-1 (]: 3 of 10 ERROR creating sql table model db_project_dataset.core_flights ......... [[31mERROR[0m in 2.90s]
[0m20:40:03.600034 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m20:40:03.604165 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m20:40:03.605736 [info ] [Thread-1 (]: 4 of 10 SKIP relation db_project_dataset.dim_carriers .......................... [[33mSKIP[0m]
[0m20:40:03.607161 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m20:40:03.608443 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m20:40:03.609567 [info ] [Thread-1 (]: 5 of 10 SKIP relation db_project_dataset.dim_dates ............................. [[33mSKIP[0m]
[0m20:40:03.611662 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m20:40:03.613403 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m20:40:03.614732 [info ] [Thread-1 (]: 6 of 10 SKIP relation db_project_dataset.fact_delays_by_flight_num ............. [[33mSKIP[0m]
[0m20:40:03.617551 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m20:40:03.618761 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m20:40:03.620119 [info ] [Thread-1 (]: 7 of 10 SKIP relation db_project_dataset.fact_delays_departure_by_airport ...... [[33mSKIP[0m]
[0m20:40:03.621401 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m20:40:03.622858 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m20:40:03.624151 [info ] [Thread-1 (]: 8 of 10 SKIP relation db_project_dataset.fact_departures.by_year ............... [[33mSKIP[0m]
[0m20:40:03.625727 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m20:40:03.627275 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m20:40:03.629447 [info ] [Thread-1 (]: 9 of 10 SKIP relation db_project_dataset.fact_departures_by_airport_year ....... [[33mSKIP[0m]
[0m20:40:03.631352 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m20:40:03.632770 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m20:40:03.634078 [info ] [Thread-1 (]: 10 of 10 SKIP relation db_project_dataset.fact_most_departures_airport ......... [[33mSKIP[0m]
[0m20:40:03.635516 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m20:40:03.638594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:03.639869 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m20:40:03.641255 [info ] [MainThread]: 
[0m20:40:03.642166 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 7.32 seconds (7.32s).
[0m20:40:03.645034 [debug] [MainThread]: Command end result
[0m20:40:03.748094 [info ] [MainThread]: 
[0m20:40:03.749819 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:40:03.751095 [info ] [MainThread]: 
[0m20:40:03.752684 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  Invalid timestamp: '1996-04-20 10:59'
  compiled code at target/run/flights_project/models/core/core_flights.sql
[0m20:40:03.754150 [info ] [MainThread]: 
[0m20:40:03.755614 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=7 TOTAL=10
[0m20:40:03.758028 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.158588, "process_user_time": 5.982777, "process_kernel_time": 0.664753, "process_mem_max_rss": "254076", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:40:03.759644 [debug] [MainThread]: Command `dbt run` failed at 20:40:03.759317 after 11.16 seconds
[0m20:40:03.761965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b38ec45f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b6094f200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b38ccbbf0>]}
[0m20:40:03.763124 [debug] [MainThread]: Flushing usage events
[0m20:43:14.483726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa76d058260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa76dc58110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa76bcbde20>]}


============================== 20:43:14.492484 | 150ee1fa-f044-42cf-8c9b-8756a79d2ece ==============================
[0m20:43:14.492484 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:43:14.493543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:43:15.876213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '150ee1fa-f044-42cf-8c9b-8756a79d2ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74ceef8f0>]}
[0m20:43:15.944959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '150ee1fa-f044-42cf-8c9b-8756a79d2ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74c8c7800>]}
[0m20:43:15.946117 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:43:16.171993 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:43:17.216656 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:43:17.217653 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m20:43:17.567017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '150ee1fa-f044-42cf-8c9b-8756a79d2ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74745acf0>]}
[0m20:43:17.833895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '150ee1fa-f044-42cf-8c9b-8756a79d2ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa747502d80>]}
[0m20:43:17.835137 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m20:43:17.836389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '150ee1fa-f044-42cf-8c9b-8756a79d2ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74c358ce0>]}
[0m20:43:17.840637 [info ] [MainThread]: 
[0m20:43:17.842419 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:43:17.850919 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m20:43:17.851988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:43:18.275730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m20:43:18.276725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:43:18.589956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '150ee1fa-f044-42cf-8c9b-8756a79d2ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74745aa50>]}
[0m20:43:18.591802 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:43:18.593086 [info ] [MainThread]: 
[0m20:43:18.613892 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m20:43:18.615801 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m20:43:18.618257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m20:43:18.620052 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m20:43:18.644780 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m20:43:18.661773 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m20:43:18.692338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:19.151674 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m20:43:19.159212 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m20:43:19.387273 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:eb35d4ad-1e88-4769-9586-995168916957&page=queryresults
[0m20:43:20.667785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '150ee1fa-f044-42cf-8c9b-8756a79d2ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa747518950>]}
[0m20:43:20.669136 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.05s]
[0m20:43:20.670480 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m20:43:20.671538 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m20:43:20.672557 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m20:43:20.673679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m20:43:20.674611 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m20:43:20.681298 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m20:43:20.690968 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m20:43:20.731056 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m20:43:20.739462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:20.785724 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted) as datetime) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted) as datetime) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m20:43:21.125455 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:f8657b0b-4e7b-4763-b653-7c0b18d0d239&page=queryresults
[0m20:43:21.263014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '150ee1fa-f044-42cf-8c9b-8756a79d2ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa747423170>]}
[0m20:43:21.265464 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 0.59s]
[0m20:43:21.267842 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m20:43:21.270406 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m20:43:21.272876 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m20:43:21.274485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m20:43:21.275879 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m20:43:21.300252 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m20:43:21.317710 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m20:43:21.322783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:21.641627 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m20:43:21.653851 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.flight_month,
    flight_data.dep_time,
    flight_data.arr_time,
    
    case
        when flight_data.arr_time >= flight_data.dep_time then 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE)
        else 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE) + 1440
    end
 as airtime,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m20:43:22.105311 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:88343499-8ede-4836-a54e-adfc0e8df41c&page=queryresults
[0m20:43:22.496708 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid datetime string "1998-10-21 16:52"; reason: invalidQuery, location: query, message: Invalid datetime string "1998-10-21 16:52"; reason: invalidQuery, location: query, message: Invalid datetime string "2005-11-23 14:49"; reason: invalidQuery, location: query, message: Invalid datetime string "1990-12-30 18:06"; reason: invalidQuery, location: query, message: Invalid datetime string "1999-11-16 11:00"')
[0m20:43:23.302206 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:8f62933a-4e74-4f10-9c4c-978652de6d6a&page=queryresults
[0m20:43:23.678951 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:8f62933a-4e74-4f10-9c4c-978652de6d6a&page=queryresults
[0m20:43:24.180659 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  Invalid datetime string "1988-11-20 13:12"
  compiled code at target/run/flights_project/models/core/core_flights.sql
[0m20:43:24.181925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '150ee1fa-f044-42cf-8c9b-8756a79d2ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7478a9a30>]}
[0m20:43:24.183478 [error] [Thread-1 (]: 3 of 10 ERROR creating sql table model db_project_dataset.core_flights ......... [[31mERROR[0m in 2.91s]
[0m20:43:24.185545 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m20:43:24.188871 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m20:43:24.190695 [info ] [Thread-1 (]: 4 of 10 SKIP relation db_project_dataset.dim_carriers .......................... [[33mSKIP[0m]
[0m20:43:24.192749 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m20:43:24.194142 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m20:43:24.195265 [info ] [Thread-1 (]: 5 of 10 SKIP relation db_project_dataset.dim_dates ............................. [[33mSKIP[0m]
[0m20:43:24.196539 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m20:43:24.197623 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m20:43:24.198808 [info ] [Thread-1 (]: 6 of 10 SKIP relation db_project_dataset.fact_delays_by_flight_num ............. [[33mSKIP[0m]
[0m20:43:24.199989 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m20:43:24.201031 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m20:43:24.202023 [info ] [Thread-1 (]: 7 of 10 SKIP relation db_project_dataset.fact_delays_departure_by_airport ...... [[33mSKIP[0m]
[0m20:43:24.203172 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m20:43:24.204187 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m20:43:24.205178 [info ] [Thread-1 (]: 8 of 10 SKIP relation db_project_dataset.fact_departures.by_year ............... [[33mSKIP[0m]
[0m20:43:24.206325 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m20:43:24.207568 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m20:43:24.209664 [info ] [Thread-1 (]: 9 of 10 SKIP relation db_project_dataset.fact_departures_by_airport_year ....... [[33mSKIP[0m]
[0m20:43:24.210988 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m20:43:24.212050 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m20:43:24.213063 [info ] [Thread-1 (]: 10 of 10 SKIP relation db_project_dataset.fact_most_departures_airport ......... [[33mSKIP[0m]
[0m20:43:24.214186 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m20:43:24.216820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:43:24.217713 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m20:43:24.218595 [info ] [MainThread]: 
[0m20:43:24.219507 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 6.38 seconds (6.38s).
[0m20:43:24.221841 [debug] [MainThread]: Command end result
[0m20:43:24.320800 [info ] [MainThread]: 
[0m20:43:24.322239 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:43:24.323166 [info ] [MainThread]: 
[0m20:43:24.324248 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  Invalid datetime string "1988-11-20 13:12"
  compiled code at target/run/flights_project/models/core/core_flights.sql
[0m20:43:24.325432 [info ] [MainThread]: 
[0m20:43:24.326389 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=7 TOTAL=10
[0m20:43:24.328030 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.947873, "process_user_time": 7.591757, "process_kernel_time": 0.841162, "process_mem_max_rss": "256700", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:43:24.329131 [debug] [MainThread]: Command `dbt run` failed at 20:43:24.328943 after 9.95 seconds
[0m20:43:24.330075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa76dc58110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74745b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa76f0f7230>]}
[0m20:43:24.331033 [debug] [MainThread]: Flushing usage events
[0m20:44:35.545767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccfb3244d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccfb327170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccfb325640>]}


============================== 20:44:35.565757 | 98e1b915-a6c9-4838-9dbd-db70e63cc12a ==============================
[0m20:44:35.565757 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:44:35.569355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:44:37.079610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98e1b915-a6c9-4838-9dbd-db70e63cc12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd7c63980>]}
[0m20:44:37.224545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98e1b915-a6c9-4838-9dbd-db70e63cc12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccdc790ec0>]}
[0m20:44:37.227043 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:44:37.725450 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:44:39.442956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:44:39.444082 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m20:44:40.036565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98e1b915-a6c9-4838-9dbd-db70e63cc12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd761f2f0>]}
[0m20:44:40.339658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98e1b915-a6c9-4838-9dbd-db70e63cc12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd7784e90>]}
[0m20:44:40.341193 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m20:44:40.342647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98e1b915-a6c9-4838-9dbd-db70e63cc12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd77c3740>]}
[0m20:44:40.347941 [info ] [MainThread]: 
[0m20:44:40.349878 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:44:40.362480 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m20:44:40.364004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:44:40.764471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m20:44:40.766044 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:44:41.132984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98e1b915-a6c9-4838-9dbd-db70e63cc12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd77c2450>]}
[0m20:44:41.135061 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:44:41.137839 [info ] [MainThread]: 
[0m20:44:41.149380 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m20:44:41.151352 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m20:44:41.153487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m20:44:41.154816 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m20:44:41.168548 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m20:44:41.176219 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m20:44:41.201702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:41.607497 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m20:44:41.624496 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m20:44:41.846343 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:aa4302a6-245c-4f0a-a380-b55f9de97f01&page=queryresults
[0m20:44:43.426976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98e1b915-a6c9-4838-9dbd-db70e63cc12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccdc80ca10>]}
[0m20:44:43.428309 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.27s]
[0m20:44:43.429837 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m20:44:43.431270 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m20:44:43.432543 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m20:44:43.433961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m20:44:43.434866 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m20:44:43.441890 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m20:44:43.448593 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m20:44:43.479762 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m20:44:43.486456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:43.529021 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted, ':00') as datetime) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted, ':00') as datetime) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m20:44:43.927966 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:066f6e18-d17c-40b8-8b0e-bd0bbea4547d&page=queryresults
[0m20:44:44.060207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98e1b915-a6c9-4838-9dbd-db70e63cc12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd7730e00>]}
[0m20:44:44.062128 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 0.63s]
[0m20:44:44.064164 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m20:44:44.068232 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m20:44:44.069873 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m20:44:44.071547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m20:44:44.072969 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m20:44:44.098029 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m20:44:44.122616 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m20:44:44.131743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:44.490250 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m20:44:44.513614 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.flight_month,
    flight_data.dep_time,
    flight_data.arr_time,
    
    case
        when flight_data.arr_time >= flight_data.dep_time then 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE)
        else 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE) + 1440
    end
 as airtime,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m20:44:45.002236 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:3d73250a-4260-4c0a-b936-92636fe10a65&page=queryresults
[0m20:44:45.386398 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid datetime string "1998-01-13 24:00:00"; reason: invalidQuery, location: query, message: Invalid datetime string "1998-01-13 24:00:00"; reason: invalidQuery, location: query, message: Invalid datetime string "2007-08-02 24:00:00"; reason: invalidQuery, location: query, message: Invalid datetime string "1989-04-30 24:00:00"; reason: invalidQuery, location: query, message: Invalid datetime string "1999-04-04 24:00:00"')
[0m20:44:46.363631 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:cc4c11be-823a-42cc-95bf-306f39bfda06&page=queryresults
[0m20:44:46.751945 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:cc4c11be-823a-42cc-95bf-306f39bfda06&page=queryresults
[0m20:44:46.762252 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  Invalid datetime string "1992-08-09 24:00:00"
  compiled code at target/run/flights_project/models/core/core_flights.sql
[0m20:44:46.763750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98e1b915-a6c9-4838-9dbd-db70e63cc12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd7bb9b80>]}
[0m20:44:46.765118 [error] [Thread-1 (]: 3 of 10 ERROR creating sql table model db_project_dataset.core_flights ......... [[31mERROR[0m in 2.69s]
[0m20:44:46.769577 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m20:44:46.773398 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m20:44:46.774617 [info ] [Thread-1 (]: 4 of 10 SKIP relation db_project_dataset.dim_carriers .......................... [[33mSKIP[0m]
[0m20:44:46.776139 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m20:44:46.777108 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m20:44:46.777942 [info ] [Thread-1 (]: 5 of 10 SKIP relation db_project_dataset.dim_dates ............................. [[33mSKIP[0m]
[0m20:44:46.778824 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m20:44:46.780021 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m20:44:46.781038 [info ] [Thread-1 (]: 6 of 10 SKIP relation db_project_dataset.fact_delays_by_flight_num ............. [[33mSKIP[0m]
[0m20:44:46.782018 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m20:44:46.784846 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m20:44:46.786347 [info ] [Thread-1 (]: 7 of 10 SKIP relation db_project_dataset.fact_delays_departure_by_airport ...... [[33mSKIP[0m]
[0m20:44:46.787500 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m20:44:46.788715 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m20:44:46.789933 [info ] [Thread-1 (]: 8 of 10 SKIP relation db_project_dataset.fact_departures.by_year ............... [[33mSKIP[0m]
[0m20:44:46.791505 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m20:44:46.793421 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m20:44:46.795088 [info ] [Thread-1 (]: 9 of 10 SKIP relation db_project_dataset.fact_departures_by_airport_year ....... [[33mSKIP[0m]
[0m20:44:46.796261 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m20:44:46.797603 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m20:44:46.799185 [info ] [Thread-1 (]: 10 of 10 SKIP relation db_project_dataset.fact_most_departures_airport ......... [[33mSKIP[0m]
[0m20:44:46.803017 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m20:44:46.807467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:44:46.809070 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m20:44:46.810572 [info ] [MainThread]: 
[0m20:44:46.811822 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 6.46 seconds (6.46s).
[0m20:44:46.815958 [debug] [MainThread]: Command end result
[0m20:44:46.969504 [info ] [MainThread]: 
[0m20:44:46.971685 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:44:46.973233 [info ] [MainThread]: 
[0m20:44:46.975509 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  Invalid datetime string "1992-08-09 24:00:00"
  compiled code at target/run/flights_project/models/core/core_flights.sql
[0m20:44:46.977282 [info ] [MainThread]: 
[0m20:44:46.979053 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=7 TOTAL=10
[0m20:44:46.982615 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.579813, "process_user_time": 8.283449, "process_kernel_time": 0.983136, "process_mem_max_rss": "256108", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:44:46.987870 [debug] [MainThread]: Command `dbt run` failed at 20:44:46.987204 after 11.59 seconds
[0m20:44:46.989551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccff42f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccfb95ed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccfb95f6b0>]}
[0m20:44:46.991541 [debug] [MainThread]: Flushing usage events
[0m20:46:57.586401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb978b9e870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb979ecc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb978b220c0>]}


============================== 20:46:57.607779 | 4a05e8ca-6623-4bc0-ae20-705b3b028c5b ==============================
[0m20:46:57.607779 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:46:57.610191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:47:00.333546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a05e8ca-6623-4bc0-ae20-705b3b028c5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97928c770>]}
[0m20:47:00.516093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a05e8ca-6623-4bc0-ae20-705b3b028c5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9592ac9b0>]}
[0m20:47:00.517494 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:47:00.798940 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:47:03.244931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:47:03.246352 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m20:47:03.930300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a05e8ca-6623-4bc0-ae20-705b3b028c5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb95820f5f0>]}
[0m20:47:04.284544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a05e8ca-6623-4bc0-ae20-705b3b028c5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb958388c50>]}
[0m20:47:04.286867 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m20:47:04.288522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a05e8ca-6623-4bc0-ae20-705b3b028c5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb958f5f590>]}
[0m20:47:04.293947 [info ] [MainThread]: 
[0m20:47:04.296365 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:47:04.312126 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m20:47:04.313982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:04.699666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m20:47:04.700820 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:47:05.019038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a05e8ca-6623-4bc0-ae20-705b3b028c5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97962dac0>]}
[0m20:47:05.021398 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:47:05.023283 [info ] [MainThread]: 
[0m20:47:05.042597 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m20:47:05.045997 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m20:47:05.048182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m20:47:05.050012 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m20:47:05.065990 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m20:47:05.077255 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m20:47:05.115279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:47:05.530580 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m20:47:05.546954 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m20:47:05.803933 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:9563e4a0-cb58-477e-9a09-0cc0cc52a0ba&page=queryresults
[0m20:47:07.493734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a05e8ca-6623-4bc0-ae20-705b3b028c5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb958dea090>]}
[0m20:47:07.501043 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.44s]
[0m20:47:07.507130 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m20:47:07.509814 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m20:47:07.513329 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m20:47:07.524836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m20:47:07.530277 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m20:47:07.549659 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m20:47:07.576075 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m20:47:07.742039 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m20:47:07.787662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:47:07.885790 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', WHEN DepTimeFormatted = '24:00' THEN '00:00', ':00') as datetime) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', WHEN ArrTimeFormatted = '24:00' THEN '00:00', ':00') as datetime) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m20:47:08.356865 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:278fa54a-4640-4684-95c2-0946d0c773d8&page=queryresults
[0m20:47:08.358838 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword WHEN at [15:50]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword WHEN at [15:50]')
[0m20:47:09.952460 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:651c42dd-3f35-4ff0-ab11-029539d46436&page=queryresults
[0m20:47:09.954962 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:651c42dd-3f35-4ff0-ab11-029539d46436&page=queryresults
[0m20:47:09.976885 [debug] [Thread-1 (]: Database Error in model stg_flights (models/stg_flights.sql)
  Syntax error: Unexpected keyword WHEN at [15:50]
  compiled code at target/run/flights_project/models/stg_flights.sql
[0m20:47:09.979458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a05e8ca-6623-4bc0-ae20-705b3b028c5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb95874e420>]}
[0m20:47:09.982966 [error] [Thread-1 (]: 2 of 10 ERROR creating sql view model db_project_dataset.stg_flights ........... [[31mERROR[0m in 2.46s]
[0m20:47:09.989686 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m20:47:09.994284 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m20:47:09.995858 [info ] [Thread-1 (]: 3 of 10 SKIP relation db_project_dataset.core_flights .......................... [[33mSKIP[0m]
[0m20:47:09.997484 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m20:47:10.002565 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m20:47:10.006107 [info ] [Thread-1 (]: 4 of 10 SKIP relation db_project_dataset.dim_carriers .......................... [[33mSKIP[0m]
[0m20:47:10.007854 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m20:47:10.009374 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m20:47:10.011181 [info ] [Thread-1 (]: 5 of 10 SKIP relation db_project_dataset.dim_dates ............................. [[33mSKIP[0m]
[0m20:47:10.012982 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m20:47:10.014605 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m20:47:10.016131 [info ] [Thread-1 (]: 6 of 10 SKIP relation db_project_dataset.fact_delays_by_flight_num ............. [[33mSKIP[0m]
[0m20:47:10.018990 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m20:47:10.024843 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m20:47:10.027375 [info ] [Thread-1 (]: 7 of 10 SKIP relation db_project_dataset.fact_delays_departure_by_airport ...... [[33mSKIP[0m]
[0m20:47:10.029579 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m20:47:10.031575 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m20:47:10.036481 [info ] [Thread-1 (]: 8 of 10 SKIP relation db_project_dataset.fact_departures.by_year ............... [[33mSKIP[0m]
[0m20:47:10.048906 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m20:47:10.052142 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m20:47:10.058966 [info ] [Thread-1 (]: 9 of 10 SKIP relation db_project_dataset.fact_departures_by_airport_year ....... [[33mSKIP[0m]
[0m20:47:10.065298 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m20:47:10.069705 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m20:47:10.071721 [info ] [Thread-1 (]: 10 of 10 SKIP relation db_project_dataset.fact_most_departures_airport ......... [[33mSKIP[0m]
[0m20:47:10.073794 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m20:47:10.077655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:47:10.078736 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m20:47:10.080538 [info ] [MainThread]: 
[0m20:47:10.082557 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 5.78 seconds (5.78s).
[0m20:47:10.087815 [debug] [MainThread]: Command end result
[0m20:47:10.315916 [info ] [MainThread]: 
[0m20:47:10.321793 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:47:10.323752 [info ] [MainThread]: 
[0m20:47:10.325433 [error] [MainThread]:   Database Error in model stg_flights (models/stg_flights.sql)
  Syntax error: Unexpected keyword WHEN at [15:50]
  compiled code at target/run/flights_project/models/stg_flights.sql
[0m20:47:10.326847 [info ] [MainThread]: 
[0m20:47:10.328170 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=8 TOTAL=10
[0m20:47:10.330801 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.864603, "process_user_time": 9.384306, "process_kernel_time": 1.126116, "process_mem_max_rss": "256084", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:47:10.332396 [debug] [MainThread]: Command `dbt run` failed at 20:47:10.332139 after 12.87 seconds
[0m20:47:10.333818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97844c320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97bf47230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9588b5e80>]}
[0m20:47:10.343680 [debug] [MainThread]: Flushing usage events
[0m20:49:00.847817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ab31a930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20aacf3ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20aacf0320>]}


============================== 20:49:00.859601 | ae1efbf2-742e-4b23-b6a4-486df90a3d14 ==============================
[0m20:49:00.859601 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:49:00.861163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:49:03.170515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae1efbf2-742e-4b23-b6a4-486df90a3d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f208d39c170>]}
[0m20:49:03.330029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae1efbf2-742e-4b23-b6a4-486df90a3d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20aae44b30>]}
[0m20:49:03.332987 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:49:03.784683 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:49:05.534425 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:49:05.536151 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m20:49:06.167901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae1efbf2-742e-4b23-b6a4-486df90a3d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2086b6aa50>]}
[0m20:49:06.489601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae1efbf2-742e-4b23-b6a4-486df90a3d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2086ad3890>]}
[0m20:49:06.491089 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m20:49:06.492359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae1efbf2-742e-4b23-b6a4-486df90a3d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2086c17a10>]}
[0m20:49:06.498778 [info ] [MainThread]: 
[0m20:49:06.500916 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:49:06.517813 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m20:49:06.519842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:06.966719 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m20:49:06.972378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:07.413018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae1efbf2-742e-4b23-b6a4-486df90a3d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2086c142f0>]}
[0m20:49:07.414509 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:49:07.415500 [info ] [MainThread]: 
[0m20:49:07.425784 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m20:49:07.427284 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m20:49:07.428524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m20:49:07.429513 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m20:49:07.441074 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m20:49:07.452302 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m20:49:07.480657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:07.883573 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m20:49:07.894127 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m20:49:08.172224 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:828272cd-c3e6-4352-8d9a-42905cc62991&page=queryresults
[0m20:49:10.076747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae1efbf2-742e-4b23-b6a4-486df90a3d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2086bd79b0>]}
[0m20:49:10.078165 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.65s]
[0m20:49:10.079476 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m20:49:10.080613 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m20:49:10.081690 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m20:49:10.082670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m20:49:10.083566 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m20:49:10.090488 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m20:49:10.098636 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m20:49:10.139403 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m20:49:10.153410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:10.206879 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    CAST(CONCAT(CAST(FlightDate AS STRING),' ',
        CASE 
            WHEN DepTimeFormatted = '24:00' THEN '00:00:00'
            ELSE CONCAT(DepTimeFormatted, ':00')
            END
        ) AS datetime
    ) AS dep_time,
    CAST(CONCAT(CAST(FlightDate AS STRING),' ',
        CASE 
            WHEN ArrTimeFormatted = '24:00' THEN '00:00:00'
            ELSE CONCAT(ArrTimeFormatted, ':00')
            END
        ) AS datetime
    ) AS arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m20:49:10.566838 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:30b1a8ef-af25-4578-9ab6-3ed072238845&page=queryresults
[0m20:49:10.752329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae1efbf2-742e-4b23-b6a4-486df90a3d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2086b6c620>]}
[0m20:49:10.769199 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 0.67s]
[0m20:49:10.774646 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m20:49:10.784669 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m20:49:10.788990 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m20:49:10.799852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m20:49:10.803381 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m20:49:10.862848 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m20:49:10.912188 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m20:49:10.923709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:11.299652 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m20:49:11.311882 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.flight_month,
    flight_data.dep_time,
    flight_data.arr_time,
    
    case
        when flight_data.arr_time >= flight_data.dep_time then 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE)
        else 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE) + 1440
    end
 as airtime,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m20:49:11.790452 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e1e40659-b264-4b94-938b-dbed34702c40&page=queryresults
[0m20:49:12.168934 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid datetime string "2003-08-07 24:21:00"; reason: invalidQuery, location: query, message: Invalid datetime string "2003-08-07 24:21:00"')
[0m20:49:13.164840 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e28491aa-43b1-411e-a611-5597d775d156&page=queryresults
[0m20:49:13.576566 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e28491aa-43b1-411e-a611-5597d775d156&page=queryresults
[0m20:49:13.585553 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  Invalid datetime string "2003-08-03 24:02:00"
  compiled code at target/run/flights_project/models/core/core_flights.sql
[0m20:49:13.586910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae1efbf2-742e-4b23-b6a4-486df90a3d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f208700a810>]}
[0m20:49:13.588052 [error] [Thread-1 (]: 3 of 10 ERROR creating sql table model db_project_dataset.core_flights ......... [[31mERROR[0m in 2.79s]
[0m20:49:13.589475 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m20:49:13.591962 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m20:49:13.593027 [info ] [Thread-1 (]: 4 of 10 SKIP relation db_project_dataset.dim_carriers .......................... [[33mSKIP[0m]
[0m20:49:13.594340 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m20:49:13.595404 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m20:49:13.596368 [info ] [Thread-1 (]: 5 of 10 SKIP relation db_project_dataset.dim_dates ............................. [[33mSKIP[0m]
[0m20:49:13.597604 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m20:49:13.598551 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m20:49:13.599530 [info ] [Thread-1 (]: 6 of 10 SKIP relation db_project_dataset.fact_delays_by_flight_num ............. [[33mSKIP[0m]
[0m20:49:13.600785 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m20:49:13.601872 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m20:49:13.602885 [info ] [Thread-1 (]: 7 of 10 SKIP relation db_project_dataset.fact_delays_departure_by_airport ...... [[33mSKIP[0m]
[0m20:49:13.604035 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m20:49:13.604988 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m20:49:13.605973 [info ] [Thread-1 (]: 8 of 10 SKIP relation db_project_dataset.fact_departures.by_year ............... [[33mSKIP[0m]
[0m20:49:13.607196 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m20:49:13.608516 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m20:49:13.609679 [info ] [Thread-1 (]: 9 of 10 SKIP relation db_project_dataset.fact_departures_by_airport_year ....... [[33mSKIP[0m]
[0m20:49:13.610878 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m20:49:13.612010 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m20:49:13.613060 [info ] [Thread-1 (]: 10 of 10 SKIP relation db_project_dataset.fact_most_departures_airport ......... [[33mSKIP[0m]
[0m20:49:13.614253 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m20:49:13.617265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:13.618090 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m20:49:13.618967 [info ] [MainThread]: 
[0m20:49:13.619946 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 7.12 seconds (7.12s).
[0m20:49:13.622159 [debug] [MainThread]: Command end result
[0m20:49:13.711110 [info ] [MainThread]: 
[0m20:49:13.712427 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:49:13.713699 [info ] [MainThread]: 
[0m20:49:13.715449 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  Invalid datetime string "2003-08-03 24:02:00"
  compiled code at target/run/flights_project/models/core/core_flights.sql
[0m20:49:13.716930 [info ] [MainThread]: 
[0m20:49:13.718232 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=7 TOTAL=10
[0m20:49:13.721126 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 13.000619, "process_user_time": 9.601025, "process_kernel_time": 1.002194, "process_mem_max_rss": "254564", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:49:13.722843 [debug] [MainThread]: Command `dbt run` failed at 20:49:13.722611 after 13.00 seconds
[0m20:49:13.724100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20aad5c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20aad87830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20aaabdf10>]}
[0m20:49:13.725650 [debug] [MainThread]: Flushing usage events
[0m20:52:15.246986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ec710080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ec7889b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31f001c7a0>]}


============================== 20:52:15.255892 | 7a36761e-f92d-4736-a72a-be365c021372 ==============================
[0m20:52:15.255892 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:52:15.257351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:52:16.526614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a36761e-f92d-4736-a72a-be365c021372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c9059070>]}
[0m20:52:16.607134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a36761e-f92d-4736-a72a-be365c021372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ed6f88c0>]}
[0m20:52:16.608367 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:52:16.820056 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:52:19.282046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:52:19.284272 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m20:52:20.166544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a36761e-f92d-4736-a72a-be365c021372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c87c2a80>]}
[0m20:52:20.739056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a36761e-f92d-4736-a72a-be365c021372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c8870260>]}
[0m20:52:20.741274 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m20:52:20.743238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a36761e-f92d-4736-a72a-be365c021372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c8717dd0>]}
[0m20:52:20.753737 [info ] [MainThread]: 
[0m20:52:20.756407 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:52:20.776386 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m20:52:20.777870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:21.390962 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m20:52:21.392530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:21.741605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a36761e-f92d-4736-a72a-be365c021372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c8cd34a0>]}
[0m20:52:21.744285 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:52:21.746600 [info ] [MainThread]: 
[0m20:52:21.770699 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m20:52:21.772303 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m20:52:21.773770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m20:52:21.774978 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m20:52:21.803484 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m20:52:21.818682 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m20:52:21.866885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:22.327939 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m20:52:22.340646 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m20:52:22.559475 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:b092de28-a364-41c0-ad37-2a7b5c5f6c09&page=queryresults
[0m20:52:23.895935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a36761e-f92d-4736-a72a-be365c021372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c9624830>]}
[0m20:52:23.898409 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.12s]
[0m20:52:23.902429 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m20:52:23.903922 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m20:52:23.905142 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m20:52:23.906502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m20:52:23.907548 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m20:52:23.921137 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m20:52:23.934940 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m20:52:23.987641 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m20:52:23.999982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:24.062529 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    CAST(CONCAT(CAST(FlightDate AS STRING),' ',
        CASE 
            WHEN DepTimeFormatted LIKE '24:%' THEN '00:00:00'
            ELSE CONCAT(DepTimeFormatted, ':00')
        END
    ) AS datetime) AS dep_time,
    CAST(CONCAT(CAST(FlightDate AS STRING),' ',
        CASE 
            WHEN ArrTimeFormatted LIKE '24:%' THEN '00:00:00' 
            ELSE CONCAT(ArrTimeFormatted, ':00')
        END
    ) AS datetime) AS arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m20:52:24.436050 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e8be4a4c-8c9b-4b51-a0ba-830947a57185&page=queryresults
[0m20:52:24.605057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a36761e-f92d-4736-a72a-be365c021372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ec3c4080>]}
[0m20:52:24.607335 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 0.70s]
[0m20:52:24.611471 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m20:52:24.616576 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m20:52:24.621157 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m20:52:24.623984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m20:52:24.627610 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m20:52:24.673992 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m20:52:24.691459 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m20:52:24.701458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:25.048528 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m20:52:25.059956 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.flight_month,
    flight_data.dep_time,
    flight_data.arr_time,
    
    case
        when flight_data.arr_time >= flight_data.dep_time then 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE)
        else 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE) + 1440
    end
 as airtime,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m20:52:25.617920 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:8d31f2a2-a592-45f6-b2f6-df4ed7e7271d&page=queryresults
[0m20:52:26.080873 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid datetime string "2005-10-06 25:05:00"; reason: invalidQuery, location: query, message: Invalid datetime string "2005-10-06 25:05:00"')
[0m20:52:27.010049 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c0167169-e2ab-47df-82f8-cb687c3ed0f8&page=queryresults
[0m20:52:27.399528 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c0167169-e2ab-47df-82f8-cb687c3ed0f8&page=queryresults
[0m20:52:27.415479 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  Invalid datetime string "2006-03-24 25:05:00"
  compiled code at target/run/flights_project/models/core/core_flights.sql
[0m20:52:27.416623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a36761e-f92d-4736-a72a-be365c021372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c8c59370>]}
[0m20:52:27.417831 [error] [Thread-1 (]: 3 of 10 ERROR creating sql table model db_project_dataset.core_flights ......... [[31mERROR[0m in 2.79s]
[0m20:52:27.419250 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m20:52:27.421768 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m20:52:27.422897 [info ] [Thread-1 (]: 4 of 10 SKIP relation db_project_dataset.dim_carriers .......................... [[33mSKIP[0m]
[0m20:52:27.427553 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m20:52:27.429796 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m20:52:27.432110 [info ] [Thread-1 (]: 5 of 10 SKIP relation db_project_dataset.dim_dates ............................. [[33mSKIP[0m]
[0m20:52:27.434186 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m20:52:27.436358 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m20:52:27.438434 [info ] [Thread-1 (]: 6 of 10 SKIP relation db_project_dataset.fact_delays_by_flight_num ............. [[33mSKIP[0m]
[0m20:52:27.441498 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m20:52:27.444039 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m20:52:27.445822 [info ] [Thread-1 (]: 7 of 10 SKIP relation db_project_dataset.fact_delays_departure_by_airport ...... [[33mSKIP[0m]
[0m20:52:27.447944 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m20:52:27.450828 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m20:52:27.453933 [info ] [Thread-1 (]: 8 of 10 SKIP relation db_project_dataset.fact_departures.by_year ............... [[33mSKIP[0m]
[0m20:52:27.456255 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m20:52:27.459329 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m20:52:27.461536 [info ] [Thread-1 (]: 9 of 10 SKIP relation db_project_dataset.fact_departures_by_airport_year ....... [[33mSKIP[0m]
[0m20:52:27.463582 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m20:52:27.465676 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m20:52:27.467613 [info ] [Thread-1 (]: 10 of 10 SKIP relation db_project_dataset.fact_most_departures_airport ......... [[33mSKIP[0m]
[0m20:52:27.469444 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m20:52:27.473854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:27.475900 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m20:52:27.478176 [info ] [MainThread]: 
[0m20:52:27.479826 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 6.72 seconds (6.72s).
[0m20:52:27.485877 [debug] [MainThread]: Command end result
[0m20:52:27.655858 [info ] [MainThread]: 
[0m20:52:27.657639 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:52:27.660822 [info ] [MainThread]: 
[0m20:52:27.662564 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  Invalid datetime string "2006-03-24 25:05:00"
  compiled code at target/run/flights_project/models/core/core_flights.sql
[0m20:52:27.664009 [info ] [MainThread]: 
[0m20:52:27.665089 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=7 TOTAL=10
[0m20:52:27.667469 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.5231695, "process_user_time": 7.129346, "process_kernel_time": 0.808482, "process_mem_max_rss": "256172", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:52:27.668766 [debug] [MainThread]: Command `dbt run` failed at 20:52:27.668508 after 12.52 seconds
[0m20:52:27.669837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ecf962d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ecf960f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ec9fb1d0>]}
[0m20:52:27.671414 [debug] [MainThread]: Flushing usage events
[0m20:57:08.048214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16a8186420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16a7f0de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16a8186030>]}


============================== 20:57:08.070021 | 9fef2581-4dd1-4b1a-bca5-20b332a27f37 ==============================
[0m20:57:08.070021 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:57:08.073124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:57:10.359532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fef2581-4dd1-4b1a-bca5-20b332a27f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16a951ef30>]}
[0m20:57:10.513203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fef2581-4dd1-4b1a-bca5-20b332a27f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16a7b2ac00>]}
[0m20:57:10.515579 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:57:10.761722 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:57:12.712752 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:57:12.713974 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m20:57:13.312043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fef2581-4dd1-4b1a-bca5-20b332a27f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1683f6af30>]}
[0m20:57:13.687745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fef2581-4dd1-4b1a-bca5-20b332a27f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1683f83650>]}
[0m20:57:13.689300 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m20:57:13.690880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fef2581-4dd1-4b1a-bca5-20b332a27f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1683e3d5e0>]}
[0m20:57:13.695402 [info ] [MainThread]: 
[0m20:57:13.698511 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:57:13.711842 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m20:57:13.713466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:14.707436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m20:57:14.708607 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:57:15.090335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fef2581-4dd1-4b1a-bca5-20b332a27f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1683e3c170>]}
[0m20:57:15.092188 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:57:15.093576 [info ] [MainThread]: 
[0m20:57:15.110010 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m20:57:15.111221 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m20:57:15.112334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m20:57:15.114157 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m20:57:15.133551 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m20:57:15.152439 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m20:57:15.202755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:15.668626 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m20:57:15.681727 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m20:57:15.918331 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:b6be00eb-536b-485a-8656-246b9067a8fb&page=queryresults
[0m20:57:17.349824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fef2581-4dd1-4b1a-bca5-20b332a27f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f168902c3b0>]}
[0m20:57:17.356913 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.23s]
[0m20:57:17.360003 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m20:57:17.362106 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m20:57:17.371709 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m20:57:17.374827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m20:57:17.376823 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m20:57:17.393855 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m20:57:17.409224 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m20:57:17.460719 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m20:57:17.471262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:17.516799 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted, ':00') as datetime) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted, ':00') as datetime) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null
    and (cast(DepTimeFormatted as integer) < 2400 AND cast(ArrTimeFormatted as integer) < 2400);


[0m20:57:17.934727 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:f0c7e037-e5be-4ff7-960b-dbf680b3ea89&page=queryresults
[0m20:57:18.094303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fef2581-4dd1-4b1a-bca5-20b332a27f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1683e9f110>]}
[0m20:57:18.098444 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 0.72s]
[0m20:57:18.100852 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m20:57:18.103219 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m20:57:18.104587 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m20:57:18.106394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m20:57:18.107789 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m20:57:18.126732 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m20:57:18.143281 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m20:57:18.150250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:18.483697 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m20:57:18.496505 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.flight_month,
    flight_data.dep_time,
    flight_data.arr_time,
    
    case
        when flight_data.arr_time >= flight_data.dep_time then 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE)
        else 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE) + 1440
    end
 as airtime,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m20:57:18.988988 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e80761c1-b24b-4a48-90b5-0bde08722b11&page=queryresults
[0m20:57:19.631265 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Bad int64 value: 14:00; while executing the filter on column 'DepTimeFormatted'; reason: invalidQuery, location: query, message: Bad int64 value: 14:00; while executing the filter on column 'DepTimeFormatted'; reason: invalidQuery, location: query, message: Bad int64 value: 08:33; while executing the filter on column 'DepTimeFormatted'; reason: invalidQuery, location: query, message: Bad int64 value: 08:20; while executing the filter on column 'DepTimeFormatted'; reason: invalidQuery, location: query, message: Bad int64 value: 20:32; while executing the filter on column 'DepTimeFormatted'; reason: invalidQuery, location: query, message: Bad int64 value: 17:07; while executing the filter on column 'DepTimeFormatted'; reason: invalidQuery, location: query, message: Bad int64 value: 14:18; while executing the filter on column 'DepTimeFormatted'; reason: invalidQuery, location: query, message: Bad int64 value: 07:15; while executing the filter on column 'DepTimeFormatted'; reason: invalidQuery, location: query, message: Bad int64 value: 18:57; while executing the filter on column 'DepTimeFormatted'; reason: invalidQuery, location: query, message: Bad int64 value: 10:30; while executing the filter on column 'DepTimeFormatted'; reason: invalidQuery, location: query, message: Bad int64 value: 19:50; while executing the filter on column 'DepTimeFormatted'")
[0m20:57:20.248081 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:6687cdef-ab74-445f-934f-39f54f8dc818&page=queryresults
[0m20:57:20.501658 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:6687cdef-ab74-445f-934f-39f54f8dc818&page=queryresults
[0m20:57:20.517263 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  Bad int64 value: 17:22; while executing the filter on column 'DepTimeFormatted'
  compiled code at target/run/flights_project/models/core/core_flights.sql
[0m20:57:20.519170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fef2581-4dd1-4b1a-bca5-20b332a27f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f168841d2b0>]}
[0m20:57:20.521201 [error] [Thread-1 (]: 3 of 10 ERROR creating sql table model db_project_dataset.core_flights ......... [[31mERROR[0m in 2.41s]
[0m20:57:20.523331 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m20:57:20.526917 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m20:57:20.529867 [info ] [Thread-1 (]: 4 of 10 SKIP relation db_project_dataset.dim_carriers .......................... [[33mSKIP[0m]
[0m20:57:20.533388 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m20:57:20.534759 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m20:57:20.535906 [info ] [Thread-1 (]: 5 of 10 SKIP relation db_project_dataset.dim_dates ............................. [[33mSKIP[0m]
[0m20:57:20.537271 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m20:57:20.538956 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m20:57:20.540388 [info ] [Thread-1 (]: 6 of 10 SKIP relation db_project_dataset.fact_delays_by_flight_num ............. [[33mSKIP[0m]
[0m20:57:20.541773 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m20:57:20.542892 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m20:57:20.546387 [info ] [Thread-1 (]: 7 of 10 SKIP relation db_project_dataset.fact_delays_departure_by_airport ...... [[33mSKIP[0m]
[0m20:57:20.549863 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m20:57:20.551408 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m20:57:20.552971 [info ] [Thread-1 (]: 8 of 10 SKIP relation db_project_dataset.fact_departures.by_year ............... [[33mSKIP[0m]
[0m20:57:20.554440 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m20:57:20.555799 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m20:57:20.557240 [info ] [Thread-1 (]: 9 of 10 SKIP relation db_project_dataset.fact_departures_by_airport_year ....... [[33mSKIP[0m]
[0m20:57:20.558890 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m20:57:20.560365 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m20:57:20.561894 [info ] [Thread-1 (]: 10 of 10 SKIP relation db_project_dataset.fact_most_departures_airport ......... [[33mSKIP[0m]
[0m20:57:20.565110 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m20:57:20.568693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:57:20.569644 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m20:57:20.570617 [info ] [MainThread]: 
[0m20:57:20.571835 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 6.87 seconds (6.87s).
[0m20:57:20.575473 [debug] [MainThread]: Command end result
[0m20:57:20.680548 [info ] [MainThread]: 
[0m20:57:20.682653 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:57:20.684321 [info ] [MainThread]: 
[0m20:57:20.686035 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  Bad int64 value: 17:22; while executing the filter on column 'DepTimeFormatted'
  compiled code at target/run/flights_project/models/core/core_flights.sql
[0m20:57:20.687429 [info ] [MainThread]: 
[0m20:57:20.688827 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=7 TOTAL=10
[0m20:57:20.691208 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.781262, "process_user_time": 9.186854, "process_kernel_time": 1.106849, "process_mem_max_rss": "254328", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:57:20.692718 [debug] [MainThread]: Command `dbt run` failed at 20:57:20.692438 after 12.78 seconds
[0m20:57:20.693968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16a8bfc200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16a7f597c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16a83d8d70>]}
[0m20:57:20.696245 [debug] [MainThread]: Flushing usage events
[0m21:00:52.159555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4920cb5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4920e17ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4920e143e0>]}


============================== 21:00:52.171597 | b3a93fb4-31a5-4708-b933-0e13e0af4167 ==============================
[0m21:00:52.171597 [info ] [MainThread]: Running with dbt=1.8.1
[0m21:00:52.173302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:00:54.024037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3a93fb4-31a5-4708-b933-0e13e0af4167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49011e24b0>]}
[0m21:00:54.207847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3a93fb4-31a5-4708-b933-0e13e0af4167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f492124e390>]}
[0m21:00:54.209292 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:00:54.547489 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m21:00:56.292028 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:00:56.293326 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m21:00:56.775348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3a93fb4-31a5-4708-b933-0e13e0af4167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49003a3d40>]}
[0m21:00:57.343948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3a93fb4-31a5-4708-b933-0e13e0af4167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490058f500>]}
[0m21:00:57.345759 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m21:00:57.347408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3a93fb4-31a5-4708-b933-0e13e0af4167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490047bbf0>]}
[0m21:00:57.353494 [info ] [MainThread]: 
[0m21:00:57.355002 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:00:57.363825 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m21:00:57.364789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:57.830139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m21:00:57.831899 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:58.195787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3a93fb4-31a5-4708-b933-0e13e0af4167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49218b8500>]}
[0m21:00:58.197639 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:00:58.200891 [info ] [MainThread]: 
[0m21:00:58.231212 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m21:00:58.237355 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m21:00:58.240630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m21:00:58.241949 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m21:00:58.263001 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m21:00:58.276759 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m21:00:58.314450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:58.763042 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m21:00:58.776216 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m21:00:58.994263 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:18e85b8a-50bf-4394-8718-2eee2293b0a3&page=queryresults
[0m21:01:00.929159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3a93fb4-31a5-4708-b933-0e13e0af4167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49014ac650>]}
[0m21:01:00.931738 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.69s]
[0m21:01:00.941125 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m21:01:00.943567 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m21:01:00.946189 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m21:01:00.958638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m21:01:00.960884 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m21:01:00.978844 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m21:01:01.011339 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m21:01:01.089408 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m21:01:01.104964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:01.216387 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted, ':00') as datetime) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted, ':00') as datetime) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null
    and (split_part(DepTimeFormatted, ':', 1)::integer < 24)
    and (split_part(ArrTimeFormatted, ':', 1)::integer < 24);


[0m21:01:02.141326 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:a6df92ea-6ee7-462d-9e78-2067d0389b23&page=queryresults
[0m21:01:02.156037 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "," but got ":" at [36:46]; reason: invalidQuery, location: query, message: Syntax error: Expected "," but got ":" at [36:46]')
[0m21:01:02.635868 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:63ac084e-6e6f-494a-93bb-06ab4f965e1b&page=queryresults
[0m21:01:02.886739 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:63ac084e-6e6f-494a-93bb-06ab4f965e1b&page=queryresults
[0m21:01:02.911995 [debug] [Thread-1 (]: Database Error in model stg_flights (models/stg_flights.sql)
  Syntax error: Expected "," but got ":" at [36:46]
  compiled code at target/run/flights_project/models/stg_flights.sql
[0m21:01:02.923213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3a93fb4-31a5-4708-b933-0e13e0af4167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4900470500>]}
[0m21:01:02.925731 [error] [Thread-1 (]: 2 of 10 ERROR creating sql view model db_project_dataset.stg_flights ........... [[31mERROR[0m in 1.96s]
[0m21:01:02.933461 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m21:01:02.937957 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m21:01:02.940856 [info ] [Thread-1 (]: 3 of 10 SKIP relation db_project_dataset.core_flights .......................... [[33mSKIP[0m]
[0m21:01:02.942839 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m21:01:02.946286 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m21:01:02.949392 [info ] [Thread-1 (]: 4 of 10 SKIP relation db_project_dataset.dim_carriers .......................... [[33mSKIP[0m]
[0m21:01:02.952470 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m21:01:02.954135 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m21:01:02.955960 [info ] [Thread-1 (]: 5 of 10 SKIP relation db_project_dataset.dim_dates ............................. [[33mSKIP[0m]
[0m21:01:02.958562 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m21:01:02.960847 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m21:01:02.962918 [info ] [Thread-1 (]: 6 of 10 SKIP relation db_project_dataset.fact_delays_by_flight_num ............. [[33mSKIP[0m]
[0m21:01:02.968038 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m21:01:02.969723 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m21:01:02.971507 [info ] [Thread-1 (]: 7 of 10 SKIP relation db_project_dataset.fact_delays_departure_by_airport ...... [[33mSKIP[0m]
[0m21:01:02.974043 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m21:01:02.975937 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m21:01:02.977602 [info ] [Thread-1 (]: 8 of 10 SKIP relation db_project_dataset.fact_departures.by_year ............... [[33mSKIP[0m]
[0m21:01:02.983993 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m21:01:02.985874 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m21:01:02.988930 [info ] [Thread-1 (]: 9 of 10 SKIP relation db_project_dataset.fact_departures_by_airport_year ....... [[33mSKIP[0m]
[0m21:01:02.991401 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m21:01:02.993688 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m21:01:02.997071 [info ] [Thread-1 (]: 10 of 10 SKIP relation db_project_dataset.fact_most_departures_airport ......... [[33mSKIP[0m]
[0m21:01:03.001302 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m21:01:03.005598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:01:03.006551 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m21:01:03.007828 [info ] [MainThread]: 
[0m21:01:03.010649 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 5.65 seconds (5.65s).
[0m21:01:03.014840 [debug] [MainThread]: Command end result
[0m21:01:03.171471 [info ] [MainThread]: 
[0m21:01:03.172892 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:01:03.173870 [info ] [MainThread]: 
[0m21:01:03.175142 [error] [MainThread]:   Database Error in model stg_flights (models/stg_flights.sql)
  Syntax error: Expected "," but got ":" at [36:46]
  compiled code at target/run/flights_project/models/stg_flights.sql
[0m21:01:03.176279 [info ] [MainThread]: 
[0m21:01:03.177427 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=8 TOTAL=10
[0m21:01:03.179259 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.179338, "process_user_time": 8.747959, "process_kernel_time": 0.951954, "process_mem_max_rss": "255700", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:01:03.180350 [debug] [MainThread]: Command `dbt run` failed at 21:01:03.180119 after 11.18 seconds
[0m21:01:03.181887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49006d40b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f492124e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4900a2dfd0>]}
[0m21:01:03.183042 [debug] [MainThread]: Flushing usage events
[0m21:02:29.699057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28000821b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2801c07ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28003b63c0>]}


============================== 21:02:29.713342 | bc212767-70e5-420d-b0cc-e0336b9a7300 ==============================
[0m21:02:29.713342 [info ] [MainThread]: Running with dbt=1.8.1
[0m21:02:29.715713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:02:31.421241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc212767-70e5-420d-b0cc-e0336b9a7300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28002654f0>]}
[0m21:02:31.525074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc212767-70e5-420d-b0cc-e0336b9a7300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27e0f66fc0>]}
[0m21:02:31.526620 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:02:32.028727 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m21:02:33.337094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:02:33.338971 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m21:02:33.744891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc212767-70e5-420d-b0cc-e0336b9a7300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27dbff6e10>]}
[0m21:02:34.024219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc212767-70e5-420d-b0cc-e0336b9a7300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27dbf43650>]}
[0m21:02:34.025523 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m21:02:34.026955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc212767-70e5-420d-b0cc-e0336b9a7300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27dbf57fb0>]}
[0m21:02:34.030800 [info ] [MainThread]: 
[0m21:02:34.032554 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:02:34.043512 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m21:02:34.044924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:34.498342 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m21:02:34.499591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:02:34.823758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc212767-70e5-420d-b0cc-e0336b9a7300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27e023a960>]}
[0m21:02:34.825363 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:02:34.826368 [info ] [MainThread]: 
[0m21:02:34.838442 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m21:02:34.839747 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m21:02:34.840949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m21:02:34.841979 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m21:02:34.854062 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m21:02:34.863708 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m21:02:34.887133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:02:35.277195 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m21:02:35.289747 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m21:02:35.541998 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:a4181384-3bb6-4b09-84cf-cc9ac19dcae0&page=queryresults
[0m21:02:36.944428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc212767-70e5-420d-b0cc-e0336b9a7300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27e0f444d0>]}
[0m21:02:36.945813 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.10s]
[0m21:02:36.947077 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m21:02:36.948313 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m21:02:36.949883 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m21:02:36.951048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m21:02:36.951955 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m21:02:36.959935 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m21:02:36.968080 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m21:02:37.006521 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m21:02:37.018564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:02:37.070394 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted, ':00') as datetime) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted, ':00') as datetime) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null
    and (cast(split_part(DepTimeFormatted, ':', 1) as integer) < 24)
    and (cast(split_part(ArrTimeFormatted, ':', 1) as integer) < 24);


[0m21:02:37.514129 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:47a2cceb-2d25-42e0-bebe-bbf477890d54&page=queryresults
[0m21:02:37.680804 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Function not found: split_part at [36:15]; reason: invalidQuery, location: query, message: Function not found: split_part at [36:15]')
[0m21:02:38.702318 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:61c83d21-24d8-470d-9361-fb664e83eb0f&page=queryresults
[0m21:02:38.812059 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:61c83d21-24d8-470d-9361-fb664e83eb0f&page=queryresults
[0m21:02:38.824003 [debug] [Thread-1 (]: Database Error in model stg_flights (models/stg_flights.sql)
  Function not found: split_part at [36:15]
  compiled code at target/run/flights_project/models/stg_flights.sql
[0m21:02:38.826045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc212767-70e5-420d-b0cc-e0336b9a7300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27dbff3f20>]}
[0m21:02:38.828115 [error] [Thread-1 (]: 2 of 10 ERROR creating sql view model db_project_dataset.stg_flights ........... [[31mERROR[0m in 1.87s]
[0m21:02:38.829990 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m21:02:38.833982 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m21:02:38.835339 [info ] [Thread-1 (]: 3 of 10 SKIP relation db_project_dataset.core_flights .......................... [[33mSKIP[0m]
[0m21:02:38.836880 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m21:02:38.839629 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m21:02:38.840990 [info ] [Thread-1 (]: 4 of 10 SKIP relation db_project_dataset.dim_carriers .......................... [[33mSKIP[0m]
[0m21:02:38.842557 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m21:02:38.844063 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m21:02:38.845230 [info ] [Thread-1 (]: 5 of 10 SKIP relation db_project_dataset.dim_dates ............................. [[33mSKIP[0m]
[0m21:02:38.846723 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m21:02:38.848019 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m21:02:38.849477 [info ] [Thread-1 (]: 6 of 10 SKIP relation db_project_dataset.fact_delays_by_flight_num ............. [[33mSKIP[0m]
[0m21:02:38.850960 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m21:02:38.852441 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m21:02:38.854290 [info ] [Thread-1 (]: 7 of 10 SKIP relation db_project_dataset.fact_delays_departure_by_airport ...... [[33mSKIP[0m]
[0m21:02:38.856066 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m21:02:38.857234 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m21:02:38.858345 [info ] [Thread-1 (]: 8 of 10 SKIP relation db_project_dataset.fact_departures.by_year ............... [[33mSKIP[0m]
[0m21:02:38.859641 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m21:02:38.860855 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m21:02:38.861963 [info ] [Thread-1 (]: 9 of 10 SKIP relation db_project_dataset.fact_departures_by_airport_year ....... [[33mSKIP[0m]
[0m21:02:38.863293 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m21:02:38.864411 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m21:02:38.865547 [info ] [Thread-1 (]: 10 of 10 SKIP relation db_project_dataset.fact_most_departures_airport ......... [[33mSKIP[0m]
[0m21:02:38.866881 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m21:02:38.869216 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:02:38.870175 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m21:02:38.871755 [info ] [MainThread]: 
[0m21:02:38.873219 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 4.84 seconds (4.84s).
[0m21:02:38.875768 [debug] [MainThread]: Command end result
[0m21:02:38.975786 [info ] [MainThread]: 
[0m21:02:38.977582 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:02:38.980443 [info ] [MainThread]: 
[0m21:02:38.982034 [error] [MainThread]:   Database Error in model stg_flights (models/stg_flights.sql)
  Function not found: split_part at [36:15]
  compiled code at target/run/flights_project/models/stg_flights.sql
[0m21:02:38.983348 [info ] [MainThread]: 
[0m21:02:38.984585 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=8 TOTAL=10
[0m21:02:38.986293 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.414849, "process_user_time": 6.268733, "process_kernel_time": 0.833821, "process_mem_max_rss": "256284", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:02:38.987643 [debug] [MainThread]: Command `dbt run` failed at 21:02:38.987434 after 9.42 seconds
[0m21:02:38.988639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2800442240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2803cab230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28002f7bf0>]}
[0m21:02:38.989497 [debug] [MainThread]: Flushing usage events
[0m21:03:43.015094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3445962570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3445253e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34459629f0>]}


============================== 21:03:43.026443 | 54a1b846-e869-4753-a278-8dca400d42ed ==============================
[0m21:03:43.026443 [info ] [MainThread]: Running with dbt=1.8.1
[0m21:03:43.027560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:03:44.663028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54a1b846-e869-4753-a278-8dca400d42ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3444ff0e30>]}
[0m21:03:44.780308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54a1b846-e869-4753-a278-8dca400d42ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34220d06b0>]}
[0m21:03:44.784618 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:03:45.122909 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m21:03:47.287465 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:03:47.289236 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m21:03:48.076104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54a1b846-e869-4753-a278-8dca400d42ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34210febd0>]}
[0m21:03:48.352558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54a1b846-e869-4753-a278-8dca400d42ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34211ace60>]}
[0m21:03:48.353852 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m21:03:48.355073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54a1b846-e869-4753-a278-8dca400d42ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3421337500>]}
[0m21:03:48.358765 [info ] [MainThread]: 
[0m21:03:48.360773 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:03:48.371366 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m21:03:48.372570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:48.723478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m21:03:48.725472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:49.057154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54a1b846-e869-4753-a278-8dca400d42ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3448d62d80>]}
[0m21:03:49.059315 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:03:49.061640 [info ] [MainThread]: 
[0m21:03:49.109215 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m21:03:49.119676 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m21:03:49.122814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m21:03:49.124591 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m21:03:49.167373 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m21:03:49.179529 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m21:03:49.213469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:49.574723 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m21:03:49.591173 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m21:03:49.860605 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:b5c9b86f-c14c-4bcc-baab-b824ed9248ab&page=queryresults
[0m21:03:51.320548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54a1b846-e869-4753-a278-8dca400d42ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342103d670>]}
[0m21:03:51.328429 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.20s]
[0m21:03:51.342205 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m21:03:51.346277 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m21:03:51.349467 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m21:03:51.352881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m21:03:51.966410 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m21:03:51.980389 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m21:03:51.987322 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m21:03:52.027718 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m21:03:52.066526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:52.131389 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted, ':00') as datetime) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted, ':00') as datetime) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null
    and CAST(SPLIT(DepTimeFormatted, ':')[SAFE_OFFSET(0)] AS integer) < 24
    and CAST(SPLIT(ArrTimeFormatted, ':')[SAFE_OFFSET(0)] AS integer) < 24;


[0m21:03:52.518070 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:9b30ced2-f552-401a-bc4e-f1f21d001725&page=queryresults
[0m21:03:52.698055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54a1b846-e869-4753-a278-8dca400d42ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3421581310>]}
[0m21:03:52.700064 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 1.35s]
[0m21:03:52.702113 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m21:03:52.704126 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m21:03:52.705223 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m21:03:52.706314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m21:03:52.707167 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m21:03:52.733846 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m21:03:52.748260 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m21:03:52.753795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:53.118811 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m21:03:53.131209 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.flight_month,
    flight_data.dep_time,
    flight_data.arr_time,
    
    case
        when flight_data.arr_time >= flight_data.dep_time then 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE)
        else 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE) + 1440
    end
 as airtime,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m21:03:53.598481 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:0d067ec9-5288-4f57-9950-43c77bb9287c&page=queryresults
[0m21:03:54.007109 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid datetime string "2004-08-21 01:60:00"; reason: invalidQuery, location: query, message: Invalid datetime string "2004-08-21 01:60:00"')
[0m21:03:54.564486 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:4972dc74-31a7-41a5-8b0d-31293de9b652&page=queryresults
[0m21:03:55.203101 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:4972dc74-31a7-41a5-8b0d-31293de9b652&page=queryresults
[0m21:03:55.211987 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  Invalid datetime string "2004-08-21 01:60:00"
  compiled code at target/run/flights_project/models/core/core_flights.sql
[0m21:03:55.213126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54a1b846-e869-4753-a278-8dca400d42ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34213360c0>]}
[0m21:03:55.214372 [error] [Thread-1 (]: 3 of 10 ERROR creating sql table model db_project_dataset.core_flights ......... [[31mERROR[0m in 2.51s]
[0m21:03:55.215784 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m21:03:55.218441 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m21:03:55.219471 [info ] [Thread-1 (]: 4 of 10 SKIP relation db_project_dataset.dim_carriers .......................... [[33mSKIP[0m]
[0m21:03:55.220821 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m21:03:55.221901 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m21:03:55.222850 [info ] [Thread-1 (]: 5 of 10 SKIP relation db_project_dataset.dim_dates ............................. [[33mSKIP[0m]
[0m21:03:55.224001 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m21:03:55.224956 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m21:03:55.225899 [info ] [Thread-1 (]: 6 of 10 SKIP relation db_project_dataset.fact_delays_by_flight_num ............. [[33mSKIP[0m]
[0m21:03:55.227014 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m21:03:55.227993 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m21:03:55.228941 [info ] [Thread-1 (]: 7 of 10 SKIP relation db_project_dataset.fact_delays_departure_by_airport ...... [[33mSKIP[0m]
[0m21:03:55.230034 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m21:03:55.230978 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m21:03:55.231863 [info ] [Thread-1 (]: 8 of 10 SKIP relation db_project_dataset.fact_departures.by_year ............... [[33mSKIP[0m]
[0m21:03:55.233002 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m21:03:55.234047 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m21:03:55.235075 [info ] [Thread-1 (]: 9 of 10 SKIP relation db_project_dataset.fact_departures_by_airport_year ....... [[33mSKIP[0m]
[0m21:03:55.236290 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m21:03:55.237256 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m21:03:55.238180 [info ] [Thread-1 (]: 10 of 10 SKIP relation db_project_dataset.fact_most_departures_airport ......... [[33mSKIP[0m]
[0m21:03:55.239310 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m21:03:55.241856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:55.242700 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m21:03:55.243626 [info ] [MainThread]: 
[0m21:03:55.244500 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 6.88 seconds (6.88s).
[0m21:03:55.246683 [debug] [MainThread]: Command end result
[0m21:03:55.346814 [info ] [MainThread]: 
[0m21:03:55.348075 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:03:55.349072 [info ] [MainThread]: 
[0m21:03:55.350175 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  Invalid datetime string "2004-08-21 01:60:00"
  compiled code at target/run/flights_project/models/core/core_flights.sql
[0m21:03:55.351129 [info ] [MainThread]: 
[0m21:03:55.352111 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=7 TOTAL=10
[0m21:03:55.353987 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.520993, "process_user_time": 8.041511, "process_kernel_time": 0.869082, "process_mem_max_rss": "257696", "process_in_blocks": "16", "command_success": false, "process_out_blocks": "0"}
[0m21:03:55.355193 [debug] [MainThread]: Command `dbt run` failed at 21:03:55.355027 after 12.52 seconds
[0m21:03:55.356222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3448bf8bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3445b67c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3421773b00>]}
[0m21:03:55.357245 [debug] [MainThread]: Flushing usage events
[0m21:05:48.785892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba26b6930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba2d59730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba26b75c0>]}


============================== 21:05:48.796565 | 698dbd43-1a12-4e49-a9e6-c8be438c2049 ==============================
[0m21:05:48.796565 [info ] [MainThread]: Running with dbt=1.8.1
[0m21:05:48.797901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:05:50.256940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '698dbd43-1a12-4e49-a9e6-c8be438c2049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7eb0f9b0>]}
[0m21:05:50.362617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '698dbd43-1a12-4e49-a9e6-c8be438c2049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7f16e270>]}
[0m21:05:50.364316 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:05:50.596502 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m21:05:52.792170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:05:52.793512 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m21:05:53.237661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '698dbd43-1a12-4e49-a9e6-c8be438c2049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7e6fea50>]}
[0m21:05:53.515946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '698dbd43-1a12-4e49-a9e6-c8be438c2049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7e63a9f0>]}
[0m21:05:53.517111 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m21:05:53.518238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '698dbd43-1a12-4e49-a9e6-c8be438c2049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7e95f230>]}
[0m21:05:53.522039 [info ] [MainThread]: 
[0m21:05:53.523656 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:05:53.534147 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m21:05:53.535293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:54.107620 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m21:05:54.109118 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:05:54.435435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '698dbd43-1a12-4e49-a9e6-c8be438c2049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba26ba750>]}
[0m21:05:54.437242 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:05:54.438801 [info ] [MainThread]: 
[0m21:05:54.449519 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m21:05:54.450813 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m21:05:54.452321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m21:05:54.453666 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m21:05:54.466462 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m21:05:54.479682 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m21:05:54.502817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:54.900222 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m21:05:54.912125 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m21:05:55.128831 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:f5b3104d-45df-461f-a88d-84d11e31fe52&page=queryresults
[0m21:05:56.731296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '698dbd43-1a12-4e49-a9e6-c8be438c2049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7f5385f0>]}
[0m21:05:56.733029 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.28s]
[0m21:05:56.735095 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m21:05:56.736708 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m21:05:56.738780 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m21:05:56.741282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m21:05:56.742627 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m21:05:56.752158 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m21:05:56.765662 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m21:05:56.818039 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m21:05:56.830812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:56.878120 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted, ':00') as datetime) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted, ':00') as datetime) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60;


[0m21:05:57.249012 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:d690dfa3-2b8f-4008-9a21-b7d0c823047b&page=queryresults
[0m21:05:57.380427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '698dbd43-1a12-4e49-a9e6-c8be438c2049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7e6a7170>]}
[0m21:05:57.382658 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 0.64s]
[0m21:05:57.384569 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m21:05:57.390153 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m21:05:57.392130 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m21:05:57.393857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m21:05:57.395082 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m21:05:57.417535 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m21:05:57.433906 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m21:05:57.441432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:57.842530 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m21:05:57.854630 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.flight_month,
    flight_data.dep_time,
    flight_data.arr_time,
    
    case
        when flight_data.arr_time >= flight_data.dep_time then 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE)
        else 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE) + 1440
    end
 as airtime,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m21:05:58.302448 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:34551318-6a77-4e93-83b7-8f19c8b27597&page=queryresults
[0m21:06:03.961039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '698dbd43-1a12-4e49-a9e6-c8be438c2049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7e6f8350>]}
[0m21:06:03.962753 [info ] [Thread-1 (]: 3 of 10 OK created sql table model db_project_dataset.core_flights ............. [[32mCREATE TABLE (112.3m rows, 11.7 GiB processed)[0m in 6.57s]
[0m21:06:03.964680 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m21:06:03.967078 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m21:06:03.968410 [info ] [Thread-1 (]: 4 of 10 START sql table model db_project_dataset.dim_carriers .................. [RUN]
[0m21:06:03.969882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.core_flights, now model.flights_project.dim_carriers)
[0m21:06:03.970803 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_carriers
[0m21:06:03.975762 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_carriers"
[0m21:06:03.986352 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_carriers
[0m21:06:03.991578 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_carriers"
[0m21:06:04.001853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:04.042862 [debug] [Thread-1 (]: On model.flights_project.dim_carriers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_carriers"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_carriers`
      
    
    

    OPTIONS()
    as (
      

select distinct 
    carrier_code,
    carrier_desc
from `db-project-456518`.`db_project_dataset`.`core_flights`
    );
  
[0m21:06:04.448281 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c873c69a-12ae-488a-be0a-9e865e0714df&page=queryresults
[0m21:06:06.320297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '698dbd43-1a12-4e49-a9e6-c8be438c2049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7e7f52b0>]}
[0m21:06:06.321923 [info ] [Thread-1 (]: 4 of 10 OK created sql table model db_project_dataset.dim_carriers ............. [[32mCREATE TABLE (29.0 rows, 3.9 GiB processed)[0m in 2.35s]
[0m21:06:06.324127 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m21:06:06.325827 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m21:06:06.327669 [info ] [Thread-1 (]: 5 of 10 START sql table model db_project_dataset.dim_dates ..................... [RUN]
[0m21:06:06.330214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_carriers, now model.flights_project.dim_dates)
[0m21:06:06.331755 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_dates
[0m21:06:06.341330 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_dates"
[0m21:06:06.357874 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_dates
[0m21:06:06.364174 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_dates"
[0m21:06:06.379900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:06.446103 [debug] [Thread-1 (]: On model.flights_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_dates"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_dates`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select distinct flight_date
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)

select 
    flight_date,
    extract(year from flight_date) as year,
    extract(quarter from flight_date) as quarter,
    extract(month from flight_date) as month,
    extract(day from flight_date) as day,
    extract(week from flight_date) as week,
    dayofweek(flight_date) as weekday,
    case when dayofweek(flight_date) in (1, 7) then 'Weekend' else 'Weekday' end as day_type
from flight_data
    );
  
[0m21:06:06.820176 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:b6b8f1ff-0fad-4ffd-ab93-c44b8bd0edb8&page=queryresults
[0m21:06:06.936965 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Function not found: dayofweek at [27:5]; reason: invalidQuery, location: query, message: Function not found: dayofweek at [27:5]')
[0m21:06:07.384086 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:0248c9b6-aa1b-42b4-bf62-188d5a30838e&page=queryresults
[0m21:06:07.494734 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:0248c9b6-aa1b-42b4-bf62-188d5a30838e&page=queryresults
[0m21:06:07.509002 [debug] [Thread-1 (]: Database Error in model dim_dates (models/marts/dim_dates.sql)
  Function not found: dayofweek at [27:5]
  compiled code at target/run/flights_project/models/marts/dim_dates.sql
[0m21:06:07.510541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '698dbd43-1a12-4e49-a9e6-c8be438c2049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7f5d4a40>]}
[0m21:06:07.512689 [error] [Thread-1 (]: 5 of 10 ERROR creating sql table model db_project_dataset.dim_dates ............ [[31mERROR[0m in 1.18s]
[0m21:06:07.517619 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m21:06:07.520905 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m21:06:07.523864 [info ] [Thread-1 (]: 6 of 10 START sql table model db_project_dataset.fact_delays_by_flight_num ..... [RUN]
[0m21:06:07.525844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_dates, now model.flights_project.fact_delays_by_flight_num)
[0m21:06:07.527194 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_by_flight_num
[0m21:06:07.541136 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_by_flight_num"
[0m21:06:07.557582 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_by_flight_num
[0m21:06:07.566652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:07.976426 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_by_flight_num"
[0m21:06:07.989335 [debug] [Thread-1 (]: On model.flights_project.fact_delays_by_flight_num: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_by_flight_num"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_delays_by_flight_num`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where arr_delay > 0 or dep_delay > 0
)

select 
    flight_num,
    count(*) as total_flights_with_delays,
    sum(dep_delay) as total_dep_delay,
    sum(arr_delay) as total_arr_delay,
    avg(dep_delay) as avg_dep_delay,
    avg(arr_delay) as avg_arr_delay,
    min(dep_delay) as min_dep_delay,
    min(arr_delay) as min_arr_delay,
    max(dep_delay) as max_dep_delay,
    max(arr_delay) as max_arr_delay
from flight_data
group by flight_num
    );
  
[0m21:06:08.206717 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:59d9586f-46eb-4f6f-ba97-5c9eb14f5de3&page=queryresults
[0m21:06:10.031991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '698dbd43-1a12-4e49-a9e6-c8be438c2049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7e5dbdd0>]}
[0m21:06:10.033687 [info ] [Thread-1 (]: 6 of 10 OK created sql table model db_project_dataset.fact_delays_by_flight_num  [[32mCREATE TABLE (8.1k rows, 2.5 GiB processed)[0m in 2.51s]
[0m21:06:10.035648 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m21:06:10.037111 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m21:06:10.038568 [info ] [Thread-1 (]: 7 of 10 START sql table model db_project_dataset.fact_delays_departure_by_airport  [RUN]
[0m21:06:10.039803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_delays_by_flight_num, now model.flights_project.fact_delays_departure_by_airport)
[0m21:06:10.041001 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_departure_by_airport
[0m21:06:10.053958 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_departure_by_airport"
[0m21:06:10.063948 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_departure_by_airport
[0m21:06:10.069555 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_departure_by_airport"
[0m21:06:10.079962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:10.122864 [debug] [Thread-1 (]: On model.flights_project.fact_delays_departure_by_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_departure_by_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_delays_departure_by_airport`
      
    
    

    OPTIONS()
    as (
      

with delayed_departures as (
    select 
        dep_airport, 
        delay_status
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where DepDelay is not null
)

select 
    dep_airport,
    delay_status, 
    count(*) AS delay_count
from delayed_departures
group by OriginAirport, delay_status
order by delay_count desc
    );
  
[0m21:06:10.575582 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:52b7884f-d45f-4373-818c-e866f0f92d18&page=queryresults
[0m21:06:10.689765 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: DepDelay; Did you mean dep_delay? at [20:11]; reason: invalidQuery, location: query, message: Unrecognized name: DepDelay; Did you mean dep_delay? at [20:11]')
[0m21:06:11.126122 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:3cc1fa03-d978-4df1-a131-c327e0c2b3be&page=queryresults
[0m21:06:11.227297 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:3cc1fa03-d978-4df1-a131-c327e0c2b3be&page=queryresults
[0m21:06:11.233490 [debug] [Thread-1 (]: Database Error in model fact_delays_departure_by_airport (models/marts/fact_delays_departure_by_airport.sql)
  Unrecognized name: DepDelay; Did you mean dep_delay? at [20:11]
  compiled code at target/run/flights_project/models/marts/fact_delays_departure_by_airport.sql
[0m21:06:11.234793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '698dbd43-1a12-4e49-a9e6-c8be438c2049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7e75e330>]}
[0m21:06:11.236393 [error] [Thread-1 (]: 7 of 10 ERROR creating sql table model db_project_dataset.fact_delays_departure_by_airport  [[31mERROR[0m in 1.20s]
[0m21:06:11.238354 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m21:06:11.239789 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m21:06:11.241380 [info ] [Thread-1 (]: 8 of 10 START sql table model db_project_dataset.fact_departures.by_year ....... [RUN]
[0m21:06:11.242706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_delays_departure_by_airport, now model.flights_project.fact_departures.by_year)
[0m21:06:11.243702 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures.by_year
[0m21:06:11.251781 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures.by_year"
[0m21:06:11.261712 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures.by_year
[0m21:06:11.270020 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures.by_year"
[0m21:06:11.279173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:11.344657 [debug] [Thread-1 (]: On model.flights_project.fact_departures.by_year: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures.by_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures.by_year`
      
    
    

    OPTIONS()
    as (
      

select
    extract(year from f.date) as year,
    count(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
group by year
order by year
    );
  
[0m21:06:11.612057 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:2747c03d-c7e2-41fc-ba34-37eb1221e436&page=queryresults
[0m21:06:11.613478 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.; reason: invalid, location: db-project-456518.db_project_dataset.fact_departures.by_year, message: Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.")
[0m21:06:11.815857 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:8d636779-d57c-4cdf-a177-420e7daffa42&page=queryresults
[0m21:06:11.818239 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:8d636779-d57c-4cdf-a177-420e7daffa42&page=queryresults
[0m21:06:11.826510 [debug] [Thread-1 (]: Database Error in model fact_departures.by_year (models/marts/fact_departures.by_year.sql)
  Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/flights_project/models/marts/fact_departures.by_year.sql
[0m21:06:11.828237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '698dbd43-1a12-4e49-a9e6-c8be438c2049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7e5db290>]}
[0m21:06:11.830482 [error] [Thread-1 (]: 8 of 10 ERROR creating sql table model db_project_dataset.fact_departures.by_year  [[31mERROR[0m in 0.59s]
[0m21:06:11.832267 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m21:06:11.833628 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m21:06:11.835338 [info ] [Thread-1 (]: 9 of 10 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m21:06:11.836700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures.by_year, now model.flights_project.fact_departures_by_airport_year)
[0m21:06:11.837994 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m21:06:11.845948 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m21:06:11.856899 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m21:06:11.862181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:12.266618 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m21:06:12.278291 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    count(*) as num_departures
from flights_data
group by origin
    );
  
[0m21:06:12.513026 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:3214d894-9776-483a-a90f-e6652f397f9f&page=queryresults
[0m21:06:14.320567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '698dbd43-1a12-4e49-a9e6-c8be438c2049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7e5efef0>]}
[0m21:06:14.322256 [info ] [Thread-1 (]: 9 of 10 OK created sql table model db_project_dataset.fact_departures_by_airport_year  [[32mCREATE TABLE (343.0 rows, 535.6 MiB processed)[0m in 2.48s]
[0m21:06:14.324127 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m21:06:14.325575 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m21:06:14.327463 [info ] [Thread-1 (]: 10 of 10 START sql table model db_project_dataset.fact_most_departures_airport . [RUN]
[0m21:06:14.329359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures_by_airport_year, now model.flights_project.fact_most_departures_airport)
[0m21:06:14.330674 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_most_departures_airport
[0m21:06:14.339796 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_most_departures_airport"
[0m21:06:14.353540 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_most_departures_airport
[0m21:06:14.362570 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_most_departures_airport"
[0m21:06:14.378015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:14.426205 [debug] [Thread-1 (]: On model.flights_project.fact_most_departures_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_most_departures_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_most_departures_airport`
      
    
    

    OPTIONS()
    as (
      

select
    a.name as airport_name,
    a.city,
    a.state,
    COUNT(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
join `db-project-456518`.`db_project_dataset`.`dim_airports` a on f.origin_airport_id = a.airport_id
group by airport_name, a.city, a.state
order by num_departures desc
    );
  
[0m21:06:14.813465 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:26e5b1d8-9927-45fe-afaf-b6463b44dfd7&page=queryresults
[0m21:06:14.941282 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name origin_airport_id not found inside f at [21:69]; reason: invalidQuery, location: query, message: Name origin_airport_id not found inside f at [21:69]')
[0m21:06:16.044229 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:5959553b-538d-4d7a-8ffb-1b5defda3434&page=queryresults
[0m21:06:16.150180 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:5959553b-538d-4d7a-8ffb-1b5defda3434&page=queryresults
[0m21:06:16.156476 [debug] [Thread-1 (]: Database Error in model fact_most_departures_airport (models/marts/fact_most_departures_airport.sql)
  Name origin_airport_id not found inside f at [21:69]
  compiled code at target/run/flights_project/models/marts/fact_most_departures_airport.sql
[0m21:06:16.158271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '698dbd43-1a12-4e49-a9e6-c8be438c2049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7e5aed50>]}
[0m21:06:16.159571 [error] [Thread-1 (]: 10 of 10 ERROR creating sql table model db_project_dataset.fact_most_departures_airport  [[31mERROR[0m in 1.83s]
[0m21:06:16.161164 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m21:06:16.163550 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:06:16.164384 [debug] [MainThread]: Connection 'model.flights_project.fact_most_departures_airport' was properly closed.
[0m21:06:16.165306 [info ] [MainThread]: 
[0m21:06:16.166303 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 22.64 seconds (22.64s).
[0m21:06:16.169798 [debug] [MainThread]: Command end result
[0m21:06:16.277772 [info ] [MainThread]: 
[0m21:06:16.279144 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m21:06:16.280078 [info ] [MainThread]: 
[0m21:06:16.281328 [error] [MainThread]:   Database Error in model dim_dates (models/marts/dim_dates.sql)
  Function not found: dayofweek at [27:5]
  compiled code at target/run/flights_project/models/marts/dim_dates.sql
[0m21:06:16.282264 [info ] [MainThread]: 
[0m21:06:16.283426 [error] [MainThread]:   Database Error in model fact_delays_departure_by_airport (models/marts/fact_delays_departure_by_airport.sql)
  Unrecognized name: DepDelay; Did you mean dep_delay? at [20:11]
  compiled code at target/run/flights_project/models/marts/fact_delays_departure_by_airport.sql
[0m21:06:16.284421 [info ] [MainThread]: 
[0m21:06:16.285752 [error] [MainThread]:   Database Error in model fact_departures.by_year (models/marts/fact_departures.by_year.sql)
  Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/flights_project/models/marts/fact_departures.by_year.sql
[0m21:06:16.286900 [info ] [MainThread]: 
[0m21:06:16.288407 [error] [MainThread]:   Database Error in model fact_most_departures_airport (models/marts/fact_most_departures_airport.sql)
  Name origin_airport_id not found inside f at [21:69]
  compiled code at target/run/flights_project/models/marts/fact_most_departures_airport.sql
[0m21:06:16.289947 [info ] [MainThread]: 
[0m21:06:16.291238 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=4 SKIP=0 TOTAL=10
[0m21:06:16.293164 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 27.608158, "process_user_time": 7.05953, "process_kernel_time": 0.779948, "process_mem_max_rss": "256396", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:06:16.294398 [debug] [MainThread]: Command `dbt run` failed at 21:06:16.294208 after 27.61 seconds
[0m21:06:16.295569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba62df230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7ea12570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba292b5c0>]}
[0m21:06:16.296690 [debug] [MainThread]: Flushing usage events
[0m21:09:51.103083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3efe70830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3efe724e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3efe709b0>]}


============================== 21:09:51.112482 | ce1e40ca-8fac-4105-9983-2be00fd7ad9b ==============================
[0m21:09:51.112482 [info ] [MainThread]: Running with dbt=1.8.1
[0m21:09:51.113886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:09:52.580095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce1e40ca-8fac-4105-9983-2be00fd7ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f010e0c0>]}
[0m21:09:52.652103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce1e40ca-8fac-4105-9983-2be00fd7ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f0337020>]}
[0m21:09:52.653378 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:09:52.876637 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m21:09:54.166965 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m21:09:54.167990 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/marts/fact_departures.by_year.sql
[0m21:09:54.168820 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/marts/fact_delays_departure_by_airport.sql
[0m21:09:54.169603 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/marts/dim_dates.sql
[0m21:09:54.170719 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/marts/fact_most_departures_airport.sql
[0m21:09:54.501322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce1e40ca-8fac-4105-9983-2be00fd7ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3cbefb860>]}
[0m21:09:54.770695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce1e40ca-8fac-4105-9983-2be00fd7ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3d027fa40>]}
[0m21:09:54.771913 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m21:09:54.773161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce1e40ca-8fac-4105-9983-2be00fd7ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f0337020>]}
[0m21:09:54.777406 [info ] [MainThread]: 
[0m21:09:54.778944 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:09:54.787017 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m21:09:54.788116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:09:55.226247 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m21:09:55.227920 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:09:55.548557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce1e40ca-8fac-4105-9983-2be00fd7ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3d0cc4e30>]}
[0m21:09:55.550062 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:09:55.551241 [info ] [MainThread]: 
[0m21:09:55.567079 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m21:09:55.568848 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m21:09:55.570370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m21:09:55.571726 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m21:09:55.585443 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m21:09:55.599208 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m21:09:55.634963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:09:56.049523 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m21:09:56.059713 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m21:09:56.309759 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:b21c913f-baef-4680-8a5a-f3ab0c2677c0&page=queryresults
[0m21:09:57.642209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce1e40ca-8fac-4105-9983-2be00fd7ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3cbe5b290>]}
[0m21:09:57.643745 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.07s]
[0m21:09:57.645301 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m21:09:57.646419 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m21:09:57.647669 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m21:09:57.649139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m21:09:57.650627 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m21:09:57.675489 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m21:09:57.686236 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m21:09:57.716129 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m21:09:57.728220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:09:57.768146 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted, ':00') as datetime) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted, ':00') as datetime) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60;


[0m21:09:58.182682 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e2e90f8a-b2dc-4488-879d-a0f5cf23cfbf&page=queryresults
[0m21:09:58.352835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce1e40ca-8fac-4105-9983-2be00fd7ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3d050c7a0>]}
[0m21:09:58.354646 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 0.70s]
[0m21:09:58.356717 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m21:09:58.359094 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m21:09:58.360207 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m21:09:58.361349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m21:09:58.362253 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m21:09:58.373406 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m21:09:58.383796 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m21:09:58.391365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:09:58.705692 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m21:09:58.719759 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.flight_month,
    flight_data.dep_time,
    flight_data.arr_time,
    
    case
        when flight_data.arr_time >= flight_data.dep_time then 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE)
        else 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE) + 1440
    end
 as airtime,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m21:09:59.258688 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:aa359a37-4a9c-4ef8-a783-2d9add6250d5&page=queryresults
[0m21:10:04.516625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce1e40ca-8fac-4105-9983-2be00fd7ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3cbee3140>]}
[0m21:10:04.518633 [info ] [Thread-1 (]: 3 of 10 OK created sql table model db_project_dataset.core_flights ............. [[32mCREATE TABLE (112.3m rows, 11.7 GiB processed)[0m in 6.16s]
[0m21:10:04.521558 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m21:10:04.524720 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m21:10:04.527016 [info ] [Thread-1 (]: 4 of 10 START sql table model db_project_dataset.dim_carriers .................. [RUN]
[0m21:10:04.529046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.core_flights, now model.flights_project.dim_carriers)
[0m21:10:04.530885 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_carriers
[0m21:10:04.542884 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_carriers"
[0m21:10:04.563642 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_carriers
[0m21:10:04.570801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:04.894447 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_carriers"
[0m21:10:04.907712 [debug] [Thread-1 (]: On model.flights_project.dim_carriers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_carriers"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_carriers`
      
    
    

    OPTIONS()
    as (
      

select distinct 
    carrier_code,
    carrier_desc
from `db-project-456518`.`db_project_dataset`.`core_flights`
    );
  
[0m21:10:05.102667 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:7efa057a-8a99-49ba-b08f-28169565679a&page=queryresults
[0m21:10:06.942954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce1e40ca-8fac-4105-9983-2be00fd7ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3efaac2f0>]}
[0m21:10:06.945016 [info ] [Thread-1 (]: 4 of 10 OK created sql table model db_project_dataset.dim_carriers ............. [[32mCREATE TABLE (29.0 rows, 3.9 GiB processed)[0m in 2.41s]
[0m21:10:06.946851 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m21:10:06.948039 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m21:10:06.949185 [info ] [Thread-1 (]: 5 of 10 START sql table model db_project_dataset.dim_dates ..................... [RUN]
[0m21:10:06.950411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_carriers, now model.flights_project.dim_dates)
[0m21:10:06.953167 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_dates
[0m21:10:06.963596 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_dates"
[0m21:10:06.982764 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_dates
[0m21:10:06.990528 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_dates"
[0m21:10:07.001580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:07.053865 [debug] [Thread-1 (]: On model.flights_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_dates"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_dates`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select distinct flight_date
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)

select 
    flight_date,
    extract(year from flight_date) as year,
    extract(quarter from flight_date) as quarter,
    extract(month from flight_date) as month,
    extract(day from flight_date) as day,
    extract(week from flight_date) as week,
    EXTRACT(dayofweek from your_date_column),
    case when dayofweek(flight_date) in (1, 7) then 'Weekend' else 'Weekday' end as day_type
from flight_data
    );
  
[0m21:10:07.473373 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:2f6df34d-4964-4674-9571-e798cd7c3c27&page=queryresults
[0m21:10:07.619772 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: your_date_column at [27:28]; reason: invalidQuery, location: query, message: Unrecognized name: your_date_column at [27:28]')
[0m21:10:08.310784 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e71335ff-5ee1-4cd2-bffe-f81ca67e6de0&page=queryresults
[0m21:10:08.452372 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e71335ff-5ee1-4cd2-bffe-f81ca67e6de0&page=queryresults
[0m21:10:08.462031 [debug] [Thread-1 (]: Database Error in model dim_dates (models/marts/dim_dates.sql)
  Unrecognized name: your_date_column at [27:28]
  compiled code at target/run/flights_project/models/marts/dim_dates.sql
[0m21:10:08.463696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce1e40ca-8fac-4105-9983-2be00fd7ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3cad16930>]}
[0m21:10:08.467724 [error] [Thread-1 (]: 5 of 10 ERROR creating sql table model db_project_dataset.dim_dates ............ [[31mERROR[0m in 1.51s]
[0m21:10:08.470544 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m21:10:08.471989 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m21:10:08.474024 [info ] [Thread-1 (]: 6 of 10 START sql table model db_project_dataset.fact_delays_by_flight_num ..... [RUN]
[0m21:10:08.475496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_dates, now model.flights_project.fact_delays_by_flight_num)
[0m21:10:08.476806 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_by_flight_num
[0m21:10:08.482978 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_by_flight_num"
[0m21:10:08.495235 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_by_flight_num
[0m21:10:08.501391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:08.882587 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_by_flight_num"
[0m21:10:08.897009 [debug] [Thread-1 (]: On model.flights_project.fact_delays_by_flight_num: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_by_flight_num"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_delays_by_flight_num`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where arr_delay > 0 or dep_delay > 0
)

select 
    flight_num,
    count(*) as total_flights_with_delays,
    sum(dep_delay) as total_dep_delay,
    sum(arr_delay) as total_arr_delay,
    avg(dep_delay) as avg_dep_delay,
    avg(arr_delay) as avg_arr_delay,
    min(dep_delay) as min_dep_delay,
    min(arr_delay) as min_arr_delay,
    max(dep_delay) as max_dep_delay,
    max(arr_delay) as max_arr_delay
from flight_data
group by flight_num
    );
  
[0m21:10:09.090778 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:177685da-2079-4b26-8f1a-b0c9da91bac5&page=queryresults
[0m21:10:10.627721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce1e40ca-8fac-4105-9983-2be00fd7ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3cbee2b70>]}
[0m21:10:10.637480 [info ] [Thread-1 (]: 6 of 10 OK created sql table model db_project_dataset.fact_delays_by_flight_num  [[32mCREATE TABLE (8.1k rows, 2.5 GiB processed)[0m in 2.15s]
[0m21:10:10.641128 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m21:10:10.643211 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m21:10:10.645412 [info ] [Thread-1 (]: 7 of 10 START sql table model db_project_dataset.fact_delays_departure_by_airport  [RUN]
[0m21:10:10.647477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_delays_by_flight_num, now model.flights_project.fact_delays_departure_by_airport)
[0m21:10:10.649422 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_departure_by_airport
[0m21:10:10.660775 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_departure_by_airport"
[0m21:10:10.676855 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_departure_by_airport
[0m21:10:10.690957 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_departure_by_airport"
[0m21:10:10.707443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:10.762586 [debug] [Thread-1 (]: On model.flights_project.fact_delays_departure_by_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_departure_by_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_delays_departure_by_airport`
      
    
    

    OPTIONS()
    as (
      

with delayed_departures as (
    select 
        dep_airport, 
        delay_status
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where dep_delay is not null
)

select 
    dep_airport,
    delay_status, 
    count(*) AS delay_count
from delayed_departures
group by dep_airport, delay_status
order by delay_count desc
    );
  
[0m21:10:11.161443 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:33c18efc-6e64-49f5-8522-2e208dbf49f2&page=queryresults
[0m21:10:12.715068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce1e40ca-8fac-4105-9983-2be00fd7ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3cadc79e0>]}
[0m21:10:12.717624 [info ] [Thread-1 (]: 7 of 10 OK created sql table model db_project_dataset.fact_delays_departure_by_airport  [[32mCREATE TABLE (1.3k rows, 4.1 GiB processed)[0m in 2.07s]
[0m21:10:12.723340 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m21:10:12.725482 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m21:10:12.727909 [info ] [Thread-1 (]: 8 of 10 START sql table model db_project_dataset.fact_departures.by_year ....... [RUN]
[0m21:10:12.729435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_delays_departure_by_airport, now model.flights_project.fact_departures.by_year)
[0m21:10:12.730545 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures.by_year
[0m21:10:12.741382 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures.by_year"
[0m21:10:12.761093 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures.by_year
[0m21:10:12.771514 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures.by_year"
[0m21:10:12.789641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:12.854742 [debug] [Thread-1 (]: On model.flights_project.fact_departures.by_year: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures.by_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures.by_year`
      
    
    

    OPTIONS()
    as (
      

select
    extract(year from f.date) as year,
    count(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights`
group by year
order by year
    );
  
[0m21:10:13.151650 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:9c3dcf68-c575-4bc0-a52c-2a69401dfbe9&page=queryresults
[0m21:10:13.154916 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.; reason: invalid, location: db-project-456518.db_project_dataset.fact_departures.by_year, message: Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.")
[0m21:10:13.491231 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:7497c1af-14b6-41c0-a914-e91d3f626cbf&page=queryresults
[0m21:10:13.492579 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:7497c1af-14b6-41c0-a914-e91d3f626cbf&page=queryresults
[0m21:10:13.498271 [debug] [Thread-1 (]: Database Error in model fact_departures.by_year (models/marts/fact_departures.by_year.sql)
  Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/flights_project/models/marts/fact_departures.by_year.sql
[0m21:10:13.499693 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce1e40ca-8fac-4105-9983-2be00fd7ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3d03474d0>]}
[0m21:10:13.501048 [error] [Thread-1 (]: 8 of 10 ERROR creating sql table model db_project_dataset.fact_departures.by_year  [[31mERROR[0m in 0.77s]
[0m21:10:13.502920 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m21:10:13.504127 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m21:10:13.505391 [info ] [Thread-1 (]: 9 of 10 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m21:10:13.506771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures.by_year, now model.flights_project.fact_departures_by_airport_year)
[0m21:10:13.507805 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m21:10:13.513745 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m21:10:13.523968 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m21:10:13.529266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:13.846780 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m21:10:13.877153 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    count(*) as num_departures
from flights_data
group by origin
    );
  
[0m21:10:14.058552 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:090e2c12-531d-4065-802d-c01f867d0e9d&page=queryresults
[0m21:10:15.595288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce1e40ca-8fac-4105-9983-2be00fd7ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3cadc88f0>]}
[0m21:10:15.597026 [info ] [Thread-1 (]: 9 of 10 OK created sql table model db_project_dataset.fact_departures_by_airport_year  [[32mCREATE TABLE (343.0 rows, 535.6 MiB processed)[0m in 2.09s]
[0m21:10:15.598724 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m21:10:15.600057 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m21:10:15.601445 [info ] [Thread-1 (]: 10 of 10 START sql table model db_project_dataset.fact_most_departures_airport . [RUN]
[0m21:10:15.602929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures_by_airport_year, now model.flights_project.fact_most_departures_airport)
[0m21:10:15.604461 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_most_departures_airport
[0m21:10:15.609960 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_most_departures_airport"
[0m21:10:15.621364 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_most_departures_airport
[0m21:10:15.626548 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_most_departures_airport"
[0m21:10:15.635883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:15.678684 [debug] [Thread-1 (]: On model.flights_project.fact_most_departures_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_most_departures_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_most_departures_airport`
      
    
    

    OPTIONS()
    as (
      

select
    airport_name,
    a.city,
    a.state,
    COUNT(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
join `db-project-456518`.`db_project_dataset`.`dim_airports` a on f.dep_airport = a.airport
group by airport_name, a.city, a.state
order by num_departures desc
    );
  
[0m21:10:16.051369 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:6a39a870-3eac-40d1-b9f4-98771431acf8&page=queryresults
[0m21:10:16.151905 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name airport not found inside a at [21:85]; reason: invalidQuery, location: query, message: Name airport not found inside a at [21:85]')
[0m21:10:16.773611 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:db4243e3-611b-4176-9ccf-e61329a81220&page=queryresults
[0m21:10:16.897812 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:db4243e3-611b-4176-9ccf-e61329a81220&page=queryresults
[0m21:10:16.907161 [debug] [Thread-1 (]: Database Error in model fact_most_departures_airport (models/marts/fact_most_departures_airport.sql)
  Name airport not found inside a at [21:85]
  compiled code at target/run/flights_project/models/marts/fact_most_departures_airport.sql
[0m21:10:16.908402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce1e40ca-8fac-4105-9983-2be00fd7ad9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3c8c06360>]}
[0m21:10:16.910251 [error] [Thread-1 (]: 10 of 10 ERROR creating sql table model db_project_dataset.fact_most_departures_airport  [[31mERROR[0m in 1.31s]
[0m21:10:16.911662 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m21:10:16.914710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:10:16.915699 [debug] [MainThread]: Connection 'model.flights_project.fact_most_departures_airport' was properly closed.
[0m21:10:16.916667 [info ] [MainThread]: 
[0m21:10:16.918391 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 22.14 seconds (22.14s).
[0m21:10:16.922285 [debug] [MainThread]: Command end result
[0m21:10:17.030704 [info ] [MainThread]: 
[0m21:10:17.031941 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m21:10:17.033001 [info ] [MainThread]: 
[0m21:10:17.034637 [error] [MainThread]:   Database Error in model dim_dates (models/marts/dim_dates.sql)
  Unrecognized name: your_date_column at [27:28]
  compiled code at target/run/flights_project/models/marts/dim_dates.sql
[0m21:10:17.036900 [info ] [MainThread]: 
[0m21:10:17.040721 [error] [MainThread]:   Database Error in model fact_departures.by_year (models/marts/fact_departures.by_year.sql)
  Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/flights_project/models/marts/fact_departures.by_year.sql
[0m21:10:17.043873 [info ] [MainThread]: 
[0m21:10:17.047247 [error] [MainThread]:   Database Error in model fact_most_departures_airport (models/marts/fact_most_departures_airport.sql)
  Name airport not found inside a at [21:85]
  compiled code at target/run/flights_project/models/marts/fact_most_departures_airport.sql
[0m21:10:17.049300 [info ] [MainThread]: 
[0m21:10:17.052161 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=0 TOTAL=10
[0m21:10:17.057714 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 26.046558, "process_user_time": 6.63029, "process_kernel_time": 0.866119, "process_mem_max_rss": "258680", "process_in_blocks": "56", "command_success": false, "process_out_blocks": "0"}
[0m21:10:17.060429 [debug] [MainThread]: Command `dbt run` failed at 21:10:17.059902 after 26.05 seconds
[0m21:10:17.062503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f0643f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3d0be3cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3d11b16a0>]}
[0m21:10:17.064933 [debug] [MainThread]: Flushing usage events
[0m21:11:08.207487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe126178140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12683a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe126178470>]}


============================== 21:11:08.216763 | 3051adc5-0c25-472c-9fa0-439d8e5b2c82 ==============================
[0m21:11:08.216763 [info ] [MainThread]: Running with dbt=1.8.1
[0m21:11:08.218179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:11:09.438058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3051adc5-0c25-472c-9fa0-439d8e5b2c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe125f6d460>]}
[0m21:11:09.517139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3051adc5-0c25-472c-9fa0-439d8e5b2c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe127186f30>]}
[0m21:11:09.519387 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:11:09.734135 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m21:11:11.081400 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:11:11.082616 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/marts/dim_dates.sql
[0m21:11:11.409555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3051adc5-0c25-472c-9fa0-439d8e5b2c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1020cfd70>]}
[0m21:11:11.685126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3051adc5-0c25-472c-9fa0-439d8e5b2c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe125f6d460>]}
[0m21:11:11.686371 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m21:11:11.687702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3051adc5-0c25-472c-9fa0-439d8e5b2c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe125ed98e0>]}
[0m21:11:11.691958 [info ] [MainThread]: 
[0m21:11:11.693706 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:11:11.702065 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m21:11:11.703116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:11:12.151725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m21:11:12.154297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:11:12.499875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3051adc5-0c25-472c-9fa0-439d8e5b2c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe10213fb60>]}
[0m21:11:12.501207 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:11:12.502249 [info ] [MainThread]: 
[0m21:11:12.516625 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m21:11:12.518277 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m21:11:12.519728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m21:11:12.521315 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m21:11:12.539308 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m21:11:12.548786 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m21:11:12.576300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:12.935556 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m21:11:12.948158 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m21:11:13.191056 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:4eb3d29c-02f7-4358-974c-93b3b3276be7&page=queryresults
[0m21:11:14.754110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3051adc5-0c25-472c-9fa0-439d8e5b2c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12683aa50>]}
[0m21:11:14.755557 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.23s]
[0m21:11:14.757190 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m21:11:14.758340 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m21:11:14.759505 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m21:11:14.760931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m21:11:14.762121 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m21:11:14.788480 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m21:11:14.800468 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m21:11:14.831289 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m21:11:14.843416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:14.884630 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted, ':00') as datetime) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted, ':00') as datetime) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60;


[0m21:11:15.239082 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:9af1e796-a061-416e-88ec-26a60238b5b1&page=queryresults
[0m21:11:15.358194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3051adc5-0c25-472c-9fa0-439d8e5b2c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1024c7c80>]}
[0m21:11:15.360473 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 0.60s]
[0m21:11:15.362314 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m21:11:15.364960 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m21:11:15.366381 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m21:11:15.367580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m21:11:15.368612 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m21:11:15.379354 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m21:11:15.390954 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m21:11:15.401068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:15.723450 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m21:11:15.736475 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.flight_month,
    flight_data.dep_time,
    flight_data.arr_time,
    
    case
        when flight_data.arr_time >= flight_data.dep_time then 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE)
        else 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE) + 1440
    end
 as airtime,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m21:11:16.240097 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:9e05fcfe-f816-46cf-afa4-fb456db7fc59&page=queryresults
[0m21:11:21.206509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3051adc5-0c25-472c-9fa0-439d8e5b2c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe101fa3110>]}
[0m21:11:21.208328 [info ] [Thread-1 (]: 3 of 10 OK created sql table model db_project_dataset.core_flights ............. [[32mCREATE TABLE (112.3m rows, 11.7 GiB processed)[0m in 5.84s]
[0m21:11:21.210262 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m21:11:21.212953 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m21:11:21.214476 [info ] [Thread-1 (]: 4 of 10 START sql table model db_project_dataset.dim_carriers .................. [RUN]
[0m21:11:21.215903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.core_flights, now model.flights_project.dim_carriers)
[0m21:11:21.216894 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_carriers
[0m21:11:21.225638 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_carriers"
[0m21:11:21.235629 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_carriers
[0m21:11:21.241137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:21.622269 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_carriers"
[0m21:11:21.634972 [debug] [Thread-1 (]: On model.flights_project.dim_carriers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_carriers"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_carriers`
      
    
    

    OPTIONS()
    as (
      

select distinct 
    carrier_code,
    carrier_desc
from `db-project-456518`.`db_project_dataset`.`core_flights`
    );
  
[0m21:11:21.849190 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:a99b34dd-8d4c-44b5-a11f-6c3931a163d4&page=queryresults
[0m21:11:23.434747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3051adc5-0c25-472c-9fa0-439d8e5b2c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe101fba390>]}
[0m21:11:23.436318 [info ] [Thread-1 (]: 4 of 10 OK created sql table model db_project_dataset.dim_carriers ............. [[32mCREATE TABLE (29.0 rows, 3.9 GiB processed)[0m in 2.22s]
[0m21:11:23.438204 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m21:11:23.439758 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m21:11:23.441142 [info ] [Thread-1 (]: 5 of 10 START sql table model db_project_dataset.dim_dates ..................... [RUN]
[0m21:11:23.443084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_carriers, now model.flights_project.dim_dates)
[0m21:11:23.446044 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_dates
[0m21:11:23.452168 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_dates"
[0m21:11:23.464673 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_dates
[0m21:11:23.472420 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_dates"
[0m21:11:23.483585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:23.532693 [debug] [Thread-1 (]: On model.flights_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_dates"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_dates`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select distinct flight_date
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)

select 
    flight_date,
    extract(year from flight_date) as year,
    extract(quarter from flight_date) as quarter,
    extract(month from flight_date) as month,
    extract(day from flight_date) as day,
    extract(week from flight_date) as week,
    EXTRACT(dayofweek from flight_date),
    case when dayofweek(flight_date) in (1, 7) then 'Weekend' else 'Weekday' end as day_type
from flight_data
    );
  
[0m21:11:23.951684 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:6fbcb3e5-3e12-4581-b702-a9f1b34f8f03&page=queryresults
[0m21:11:24.073883 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Function not found: dayofweek at [28:15]; reason: invalidQuery, location: query, message: Function not found: dayofweek at [28:15]')
[0m21:11:24.632899 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:897aa679-417a-4241-9410-2983aa538e62&page=queryresults
[0m21:11:24.737455 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:897aa679-417a-4241-9410-2983aa538e62&page=queryresults
[0m21:11:24.747152 [debug] [Thread-1 (]: Database Error in model dim_dates (models/marts/dim_dates.sql)
  Function not found: dayofweek at [28:15]
  compiled code at target/run/flights_project/models/marts/dim_dates.sql
[0m21:11:24.748262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3051adc5-0c25-472c-9fa0-439d8e5b2c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1274b7bc0>]}
[0m21:11:24.749436 [error] [Thread-1 (]: 5 of 10 ERROR creating sql table model db_project_dataset.dim_dates ............ [[31mERROR[0m in 1.31s]
[0m21:11:24.750769 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m21:11:24.751789 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m21:11:24.753605 [info ] [Thread-1 (]: 6 of 10 START sql table model db_project_dataset.fact_delays_by_flight_num ..... [RUN]
[0m21:11:24.754865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_dates, now model.flights_project.fact_delays_by_flight_num)
[0m21:11:24.755906 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_by_flight_num
[0m21:11:24.763316 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_by_flight_num"
[0m21:11:24.773252 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_by_flight_num
[0m21:11:24.777552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:25.097316 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_by_flight_num"
[0m21:11:25.107945 [debug] [Thread-1 (]: On model.flights_project.fact_delays_by_flight_num: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_by_flight_num"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_delays_by_flight_num`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where arr_delay > 0 or dep_delay > 0
)

select 
    flight_num,
    count(*) as total_flights_with_delays,
    sum(dep_delay) as total_dep_delay,
    sum(arr_delay) as total_arr_delay,
    avg(dep_delay) as avg_dep_delay,
    avg(arr_delay) as avg_arr_delay,
    min(dep_delay) as min_dep_delay,
    min(arr_delay) as min_arr_delay,
    max(dep_delay) as max_dep_delay,
    max(arr_delay) as max_arr_delay
from flight_data
group by flight_num
    );
  
[0m21:11:25.292202 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:531fcb90-6ecc-4561-b32a-626d6494b63a&page=queryresults
[0m21:11:26.825224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3051adc5-0c25-472c-9fa0-439d8e5b2c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe100e90c20>]}
[0m21:11:26.827273 [info ] [Thread-1 (]: 6 of 10 OK created sql table model db_project_dataset.fact_delays_by_flight_num  [[32mCREATE TABLE (8.1k rows, 2.5 GiB processed)[0m in 2.07s]
[0m21:11:26.829092 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m21:11:26.830492 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m21:11:26.832027 [info ] [Thread-1 (]: 7 of 10 START sql table model db_project_dataset.fact_delays_departure_by_airport  [RUN]
[0m21:11:26.833285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_delays_by_flight_num, now model.flights_project.fact_delays_departure_by_airport)
[0m21:11:26.834310 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_departure_by_airport
[0m21:11:26.839161 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_departure_by_airport"
[0m21:11:26.848513 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_departure_by_airport
[0m21:11:26.858360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:27.160481 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_departure_by_airport"
[0m21:11:27.170927 [debug] [Thread-1 (]: On model.flights_project.fact_delays_departure_by_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_departure_by_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_delays_departure_by_airport`
      
    
    

    OPTIONS()
    as (
      

with delayed_departures as (
    select 
        dep_airport, 
        delay_status
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where dep_delay is not null
)

select 
    dep_airport,
    delay_status, 
    count(*) AS delay_count
from delayed_departures
group by dep_airport, delay_status
order by delay_count desc
    );
  
[0m21:11:27.359291 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:44c6352e-3b89-41fa-b4d8-7c186e6f5d7b&page=queryresults
[0m21:11:28.931344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3051adc5-0c25-472c-9fa0-439d8e5b2c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe100ebbf80>]}
[0m21:11:28.933335 [info ] [Thread-1 (]: 7 of 10 OK created sql table model db_project_dataset.fact_delays_departure_by_airport  [[32mCREATE TABLE (1.3k rows, 4.1 GiB processed)[0m in 2.10s]
[0m21:11:28.935455 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m21:11:28.936800 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m21:11:28.938024 [info ] [Thread-1 (]: 8 of 10 START sql table model db_project_dataset.fact_departures.by_year ....... [RUN]
[0m21:11:28.939368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_delays_departure_by_airport, now model.flights_project.fact_departures.by_year)
[0m21:11:28.940404 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures.by_year
[0m21:11:28.945168 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures.by_year"
[0m21:11:28.957261 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures.by_year
[0m21:11:28.961773 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures.by_year"
[0m21:11:28.971982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:29.011354 [debug] [Thread-1 (]: On model.flights_project.fact_departures.by_year: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures.by_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures.by_year`
      
    
    

    OPTIONS()
    as (
      

select
    extract(year from f.date) as year,
    count(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights`
group by year
order by year
    );
  
[0m21:11:29.309863 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:3dd981a2-2897-466a-9c98-4bb0c86892ce&page=queryresults
[0m21:11:29.311665 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.; reason: invalid, location: db-project-456518.db_project_dataset.fact_departures.by_year, message: Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.")
[0m21:11:29.575870 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:bbb809f2-26c4-4c29-83f9-713af26fca36&page=queryresults
[0m21:11:29.577679 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:bbb809f2-26c4-4c29-83f9-713af26fca36&page=queryresults
[0m21:11:29.584792 [debug] [Thread-1 (]: Database Error in model fact_departures.by_year (models/marts/fact_departures.by_year.sql)
  Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/flights_project/models/marts/fact_departures.by_year.sql
[0m21:11:29.586029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3051adc5-0c25-472c-9fa0-439d8e5b2c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe129c4ed80>]}
[0m21:11:29.587198 [error] [Thread-1 (]: 8 of 10 ERROR creating sql table model db_project_dataset.fact_departures.by_year  [[31mERROR[0m in 0.65s]
[0m21:11:29.588591 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m21:11:29.589594 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m21:11:29.590766 [info ] [Thread-1 (]: 9 of 10 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m21:11:29.591950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures.by_year, now model.flights_project.fact_departures_by_airport_year)
[0m21:11:29.592861 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m21:11:29.597621 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m21:11:29.609390 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m21:11:29.613605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:29.967465 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m21:11:29.978134 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    count(*) as num_departures
from flights_data
group by origin
    );
  
[0m21:11:30.167027 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:243e110e-2d81-44ab-aa01-694fdee91820&page=queryresults
[0m21:11:31.735027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3051adc5-0c25-472c-9fa0-439d8e5b2c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe102086510>]}
[0m21:11:31.736938 [info ] [Thread-1 (]: 9 of 10 OK created sql table model db_project_dataset.fact_departures_by_airport_year  [[32mCREATE TABLE (343.0 rows, 535.6 MiB processed)[0m in 2.14s]
[0m21:11:31.738796 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m21:11:31.740548 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m21:11:31.741972 [info ] [Thread-1 (]: 10 of 10 START sql table model db_project_dataset.fact_most_departures_airport . [RUN]
[0m21:11:31.743068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures_by_airport_year, now model.flights_project.fact_most_departures_airport)
[0m21:11:31.744068 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_most_departures_airport
[0m21:11:31.749169 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_most_departures_airport"
[0m21:11:31.760601 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_most_departures_airport
[0m21:11:31.765203 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_most_departures_airport"
[0m21:11:31.777882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:31.822946 [debug] [Thread-1 (]: On model.flights_project.fact_most_departures_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_most_departures_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_most_departures_airport`
      
    
    

    OPTIONS()
    as (
      

select
    airport_name,
    a.city,
    a.state,
    COUNT(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
join `db-project-456518`.`db_project_dataset`.`dim_airports` a on f.dep_airport = a.airport
group by airport_name, a.city, a.state
order by num_departures desc
    );
  
[0m21:11:32.191990 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:3836f131-8e76-4d8e-80d4-c1d3e730e903&page=queryresults
[0m21:11:32.294999 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name airport not found inside a at [21:85]; reason: invalidQuery, location: query, message: Name airport not found inside a at [21:85]')
[0m21:11:32.711194 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:d20cc2c7-08fb-447e-9573-dfaa5500fa99&page=queryresults
[0m21:11:32.803138 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:d20cc2c7-08fb-447e-9573-dfaa5500fa99&page=queryresults
[0m21:11:32.812276 [debug] [Thread-1 (]: Database Error in model fact_most_departures_airport (models/marts/fact_most_departures_airport.sql)
  Name airport not found inside a at [21:85]
  compiled code at target/run/flights_project/models/marts/fact_most_departures_airport.sql
[0m21:11:32.814468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3051adc5-0c25-472c-9fa0-439d8e5b2c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe100e8f8c0>]}
[0m21:11:32.816569 [error] [Thread-1 (]: 10 of 10 ERROR creating sql table model db_project_dataset.fact_most_departures_airport  [[31mERROR[0m in 1.07s]
[0m21:11:32.818197 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m21:11:32.820405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:11:32.821218 [debug] [MainThread]: Connection 'model.flights_project.fact_most_departures_airport' was properly closed.
[0m21:11:32.822146 [info ] [MainThread]: 
[0m21:11:32.823183 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 21.13 seconds (21.13s).
[0m21:11:32.827509 [debug] [MainThread]: Command end result
[0m21:11:32.950089 [info ] [MainThread]: 
[0m21:11:32.951959 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m21:11:32.953592 [info ] [MainThread]: 
[0m21:11:32.955396 [error] [MainThread]:   Database Error in model dim_dates (models/marts/dim_dates.sql)
  Function not found: dayofweek at [28:15]
  compiled code at target/run/flights_project/models/marts/dim_dates.sql
[0m21:11:32.957851 [info ] [MainThread]: 
[0m21:11:32.961186 [error] [MainThread]:   Database Error in model fact_departures.by_year (models/marts/fact_departures.by_year.sql)
  Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/flights_project/models/marts/fact_departures.by_year.sql
[0m21:11:32.964132 [info ] [MainThread]: 
[0m21:11:32.965965 [error] [MainThread]:   Database Error in model fact_most_departures_airport (models/marts/fact_most_departures_airport.sql)
  Name airport not found inside a at [21:85]
  compiled code at target/run/flights_project/models/marts/fact_most_departures_airport.sql
[0m21:11:32.967067 [info ] [MainThread]: 
[0m21:11:32.968946 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=0 TOTAL=10
[0m21:11:32.971977 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 24.854456, "process_user_time": 6.26179, "process_kernel_time": 0.764117, "process_mem_max_rss": "255584", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:11:32.974720 [debug] [MainThread]: Command `dbt run` failed at 21:11:32.973853 after 24.86 seconds
[0m21:11:32.978475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe129c73230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1261a3800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe128814710>]}
[0m21:11:32.980393 [debug] [MainThread]: Flushing usage events
[0m21:13:34.063097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd01dcc51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd01f0580b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd01fc53c50>]}


============================== 21:13:34.077217 | 6efa94e9-3775-4a81-8071-dbd5874b9756 ==============================
[0m21:13:34.077217 [info ] [MainThread]: Running with dbt=1.8.1
[0m21:13:34.078901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:13:35.549800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6efa94e9-3775-4a81-8071-dbd5874b9756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff9de3830>]}
[0m21:13:35.636336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6efa94e9-3775-4a81-8071-dbd5874b9756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcffbd3b020>]}
[0m21:13:35.637985 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:13:35.892406 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m21:13:38.245367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:13:38.246971 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/marts/fact_departures.by_year.sql
[0m21:13:38.248174 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/marts/dim_dates.sql
[0m21:13:39.026080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6efa94e9-3775-4a81-8071-dbd5874b9756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff9999c10>]}
[0m21:13:39.311177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6efa94e9-3775-4a81-8071-dbd5874b9756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd01e3fbe30>]}
[0m21:13:39.312654 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m21:13:39.313964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6efa94e9-3775-4a81-8071-dbd5874b9756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff9b3cd40>]}
[0m21:13:39.319767 [info ] [MainThread]: 
[0m21:13:39.321485 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:13:39.330064 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m21:13:39.331446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:39.758483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m21:13:39.760135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:13:40.093978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6efa94e9-3775-4a81-8071-dbd5874b9756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff9a40230>]}
[0m21:13:40.096771 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:13:40.102151 [info ] [MainThread]: 
[0m21:13:40.139350 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m21:13:40.142048 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m21:13:40.145637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m21:13:40.147442 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m21:13:40.173691 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m21:13:40.190114 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m21:13:40.251770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:40.703504 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m21:13:40.715785 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m21:13:40.957351 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:9595e515-d9ae-4071-9ec6-d4998a08b34a&page=queryresults
[0m21:13:42.287462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6efa94e9-3775-4a81-8071-dbd5874b9756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcffa372810>]}
[0m21:13:42.288971 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.14s]
[0m21:13:42.290528 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m21:13:42.292362 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m21:13:42.293667 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m21:13:42.295021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m21:13:42.296453 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m21:13:42.337785 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m21:13:42.345284 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m21:13:42.391846 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m21:13:42.401133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:42.444561 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted, ':00') as datetime) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted, ':00') as datetime) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60;


[0m21:13:42.778811 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:ff7cfe26-0a22-46ed-ac8c-c0b869383754&page=queryresults
[0m21:13:42.921804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6efa94e9-3775-4a81-8071-dbd5874b9756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff9aad610>]}
[0m21:13:42.923781 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 0.63s]
[0m21:13:42.925395 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m21:13:42.927265 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m21:13:42.928351 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m21:13:42.929467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m21:13:42.930541 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m21:13:42.945782 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m21:13:42.961228 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m21:13:42.969329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:43.317936 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m21:13:43.333479 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.flight_month,
    flight_data.dep_time,
    flight_data.arr_time,
    
    case
        when flight_data.arr_time >= flight_data.dep_time then 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE)
        else 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE) + 1440
    end
 as airtime,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m21:13:43.826200 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:91555545-27dd-4fb1-a536-7e7dfdfd7629&page=queryresults
[0m21:13:49.090885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6efa94e9-3775-4a81-8071-dbd5874b9756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff94c3500>]}
[0m21:13:49.093182 [info ] [Thread-1 (]: 3 of 10 OK created sql table model db_project_dataset.core_flights ............. [[32mCREATE TABLE (112.3m rows, 11.7 GiB processed)[0m in 6.16s]
[0m21:13:49.095002 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m21:13:49.097485 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m21:13:49.098938 [info ] [Thread-1 (]: 4 of 10 START sql table model db_project_dataset.dim_carriers .................. [RUN]
[0m21:13:49.100194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.core_flights, now model.flights_project.dim_carriers)
[0m21:13:49.101414 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_carriers
[0m21:13:49.108928 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_carriers"
[0m21:13:49.125065 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_carriers
[0m21:13:49.132839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:50.041384 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_carriers"
[0m21:13:50.055688 [debug] [Thread-1 (]: On model.flights_project.dim_carriers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_carriers"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_carriers`
      
    
    

    OPTIONS()
    as (
      

select distinct 
    carrier_code,
    carrier_desc
from `db-project-456518`.`db_project_dataset`.`core_flights`
    );
  
[0m21:13:50.247985 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:abe12f98-5a84-44e1-ba59-dc06f4755851&page=queryresults
[0m21:13:51.796249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6efa94e9-3775-4a81-8071-dbd5874b9756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcffa035e20>]}
[0m21:13:51.798156 [info ] [Thread-1 (]: 4 of 10 OK created sql table model db_project_dataset.dim_carriers ............. [[32mCREATE TABLE (29.0 rows, 3.9 GiB processed)[0m in 2.70s]
[0m21:13:51.799954 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m21:13:51.801214 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m21:13:51.802481 [info ] [Thread-1 (]: 5 of 10 START sql table model db_project_dataset.dim_dates ..................... [RUN]
[0m21:13:51.803757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_carriers, now model.flights_project.dim_dates)
[0m21:13:51.806272 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_dates
[0m21:13:51.814148 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_dates"
[0m21:13:51.826223 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_dates
[0m21:13:51.834073 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_dates"
[0m21:13:51.845487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:51.888449 [debug] [Thread-1 (]: On model.flights_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_dates"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_dates`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select distinct flight_date
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)

select 
    flight_date,
    extract(year from flight_date) as year,
    extract(quarter from flight_date) as quarter,
    extract(month from flight_date) as month,
    extract(day from flight_date) as day,
    extract(week from flight_date) as week,
    extract(dayofweek from flight_date) as day_of_week,
    case 
    when extract(dayofweek from flight_date) in (1, 7) then 'Weekend' 
    else 'Weekday' 
    end as day_type
from flight_data
    );
  
[0m21:13:52.253651 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:5107b273-39a2-4e87-bcf9-5287be54f59e&page=queryresults
[0m21:13:53.791778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6efa94e9-3775-4a81-8071-dbd5874b9756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff957e780>]}
[0m21:13:53.793869 [info ] [Thread-1 (]: 5 of 10 OK created sql table model db_project_dataset.dim_dates ................ [[32mCREATE TABLE (7.4k rows, 857.0 MiB processed)[0m in 1.99s]
[0m21:13:53.795797 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m21:13:53.797234 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m21:13:53.798852 [info ] [Thread-1 (]: 6 of 10 START sql table model db_project_dataset.fact_delays_by_flight_num ..... [RUN]
[0m21:13:53.800308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_dates, now model.flights_project.fact_delays_by_flight_num)
[0m21:13:53.801415 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_by_flight_num
[0m21:13:53.806207 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_by_flight_num"
[0m21:13:53.819724 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_by_flight_num
[0m21:13:53.825054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:54.129689 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_by_flight_num"
[0m21:13:54.144338 [debug] [Thread-1 (]: On model.flights_project.fact_delays_by_flight_num: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_by_flight_num"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_delays_by_flight_num`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where arr_delay > 0 or dep_delay > 0
)

select 
    flight_num,
    count(*) as total_flights_with_delays,
    sum(dep_delay) as total_dep_delay,
    sum(arr_delay) as total_arr_delay,
    avg(dep_delay) as avg_dep_delay,
    avg(arr_delay) as avg_arr_delay,
    min(dep_delay) as min_dep_delay,
    min(arr_delay) as min_arr_delay,
    max(dep_delay) as max_dep_delay,
    max(arr_delay) as max_arr_delay
from flight_data
group by flight_num
    );
  
[0m21:13:54.330916 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:f77ec02f-1b82-4591-96b1-1d6a8a4d9a96&page=queryresults
[0m21:13:55.853992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6efa94e9-3775-4a81-8071-dbd5874b9756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff94acbc0>]}
[0m21:13:55.855614 [info ] [Thread-1 (]: 6 of 10 OK created sql table model db_project_dataset.fact_delays_by_flight_num  [[32mCREATE TABLE (8.1k rows, 2.5 GiB processed)[0m in 2.05s]
[0m21:13:55.857259 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m21:13:55.858666 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m21:13:55.859863 [info ] [Thread-1 (]: 7 of 10 START sql table model db_project_dataset.fact_delays_departure_by_airport  [RUN]
[0m21:13:55.861064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_delays_by_flight_num, now model.flights_project.fact_delays_departure_by_airport)
[0m21:13:55.862071 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_departure_by_airport
[0m21:13:55.866827 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_departure_by_airport"
[0m21:13:55.879246 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_departure_by_airport
[0m21:13:55.888112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:56.197409 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_departure_by_airport"
[0m21:13:56.213245 [debug] [Thread-1 (]: On model.flights_project.fact_delays_departure_by_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_departure_by_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_delays_departure_by_airport`
      
    
    

    OPTIONS()
    as (
      

with delayed_departures as (
    select 
        dep_airport, 
        delay_status
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where dep_delay is not null
)

select 
    dep_airport,
    delay_status, 
    count(*) AS delay_count
from delayed_departures
group by dep_airport, delay_status
order by delay_count desc
    );
  
[0m21:13:56.389748 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e3aa9cec-06b1-44a0-81fa-0bae328c15eb&page=queryresults
[0m21:13:57.944562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6efa94e9-3775-4a81-8071-dbd5874b9756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff83405f0>]}
[0m21:13:57.947326 [info ] [Thread-1 (]: 7 of 10 OK created sql table model db_project_dataset.fact_delays_departure_by_airport  [[32mCREATE TABLE (1.3k rows, 4.1 GiB processed)[0m in 2.08s]
[0m21:13:57.950253 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m21:13:57.953182 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m21:13:57.955812 [info ] [Thread-1 (]: 8 of 10 START sql table model db_project_dataset.fact_departures.by_year ....... [RUN]
[0m21:13:57.957445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_delays_departure_by_airport, now model.flights_project.fact_departures.by_year)
[0m21:13:57.961173 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures.by_year
[0m21:13:57.976034 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures.by_year"
[0m21:13:57.995094 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures.by_year
[0m21:13:58.000917 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures.by_year"
[0m21:13:58.014278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:58.062004 [debug] [Thread-1 (]: On model.flights_project.fact_departures.by_year: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures.by_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures.by_year`
      
    
    

    OPTIONS()
    as (
      

select
    extract(year from f.date) as year,
    count(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
group by year
order by year
    );
  
[0m21:13:58.368920 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:f3a7e275-c657-422c-b74f-2964def452cd&page=queryresults
[0m21:13:58.370327 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.; reason: invalid, location: db-project-456518.db_project_dataset.fact_departures.by_year, message: Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.")
[0m21:13:58.874881 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e02ff41d-c354-409d-a3b4-3f09b867d3f6&page=queryresults
[0m21:13:58.876635 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e02ff41d-c354-409d-a3b4-3f09b867d3f6&page=queryresults
[0m21:13:58.886079 [debug] [Thread-1 (]: Database Error in model fact_departures.by_year (models/marts/fact_departures.by_year.sql)
  Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/flights_project/models/marts/fact_departures.by_year.sql
[0m21:13:58.887185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6efa94e9-3775-4a81-8071-dbd5874b9756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd01db83c20>]}
[0m21:13:58.888365 [error] [Thread-1 (]: 8 of 10 ERROR creating sql table model db_project_dataset.fact_departures.by_year  [[31mERROR[0m in 0.93s]
[0m21:13:58.889878 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m21:13:58.890984 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m21:13:58.892740 [info ] [Thread-1 (]: 9 of 10 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m21:13:58.893975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures.by_year, now model.flights_project.fact_departures_by_airport_year)
[0m21:13:58.894934 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m21:13:58.899912 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m21:13:58.910585 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m21:13:58.914678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:59.222070 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m21:13:59.234468 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    count(*) as num_departures
from flights_data
group by origin
    );
  
[0m21:13:59.440908 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:8cd43f96-d1f5-4a63-8fd5-effd62c4b824&page=queryresults
[0m21:14:00.720014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6efa94e9-3775-4a81-8071-dbd5874b9756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff991d9a0>]}
[0m21:14:00.722135 [info ] [Thread-1 (]: 9 of 10 OK created sql table model db_project_dataset.fact_departures_by_airport_year  [[32mCREATE TABLE (343.0 rows, 535.6 MiB processed)[0m in 1.83s]
[0m21:14:00.724580 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m21:14:00.726451 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m21:14:00.728196 [info ] [Thread-1 (]: 10 of 10 START sql table model db_project_dataset.fact_most_departures_airport . [RUN]
[0m21:14:00.729504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures_by_airport_year, now model.flights_project.fact_most_departures_airport)
[0m21:14:00.730764 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_most_departures_airport
[0m21:14:00.738860 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_most_departures_airport"
[0m21:14:00.751153 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_most_departures_airport
[0m21:14:00.758459 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_most_departures_airport"
[0m21:14:00.766827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:00.819162 [debug] [Thread-1 (]: On model.flights_project.fact_most_departures_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_most_departures_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_most_departures_airport`
      
    
    

    OPTIONS()
    as (
      

select
    airport_name,
    a.city,
    a.state,
    COUNT(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
join `db-project-456518`.`db_project_dataset`.`dim_airports` a on f.dep_airport = a.airport
group by airport_name, a.city, a.state
order by num_departures desc
    );
  
[0m21:14:01.186516 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:0dfeca25-793c-4f2a-8be7-647736b05fc2&page=queryresults
[0m21:14:01.281494 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name airport not found inside a at [21:85]; reason: invalidQuery, location: query, message: Name airport not found inside a at [21:85]')
[0m21:14:01.823038 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:f74df984-ee74-4e7f-bb29-06563f91d61e&page=queryresults
[0m21:14:01.955269 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:f74df984-ee74-4e7f-bb29-06563f91d61e&page=queryresults
[0m21:14:01.964018 [debug] [Thread-1 (]: Database Error in model fact_most_departures_airport (models/marts/fact_most_departures_airport.sql)
  Name airport not found inside a at [21:85]
  compiled code at target/run/flights_project/models/marts/fact_most_departures_airport.sql
[0m21:14:01.965153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6efa94e9-3775-4a81-8071-dbd5874b9756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff83d1970>]}
[0m21:14:01.966573 [error] [Thread-1 (]: 10 of 10 ERROR creating sql table model db_project_dataset.fact_most_departures_airport  [[31mERROR[0m in 1.24s]
[0m21:14:01.967880 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m21:14:01.970067 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:14:01.970858 [debug] [MainThread]: Connection 'model.flights_project.fact_most_departures_airport' was properly closed.
[0m21:14:01.971709 [info ] [MainThread]: 
[0m21:14:01.972594 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 22.65 seconds (22.65s).
[0m21:14:01.977457 [debug] [MainThread]: Command end result
[0m21:14:02.076742 [info ] [MainThread]: 
[0m21:14:02.077902 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:14:02.078999 [info ] [MainThread]: 
[0m21:14:02.080116 [error] [MainThread]:   Database Error in model fact_departures.by_year (models/marts/fact_departures.by_year.sql)
  Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/flights_project/models/marts/fact_departures.by_year.sql
[0m21:14:02.081302 [info ] [MainThread]: 
[0m21:14:02.082523 [error] [MainThread]:   Database Error in model fact_most_departures_airport (models/marts/fact_most_departures_airport.sql)
  Name airport not found inside a at [21:85]
  compiled code at target/run/flights_project/models/marts/fact_most_departures_airport.sql
[0m21:14:02.083520 [info ] [MainThread]: 
[0m21:14:02.084671 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m21:14:02.086401 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 28.15027, "process_user_time": 7.542615, "process_kernel_time": 0.72993, "process_mem_max_rss": "258252", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:14:02.087321 [debug] [MainThread]: Command `dbt run` failed at 21:14:02.087177 after 28.15 seconds
[0m21:14:02.088157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd01d4fcd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd01eec5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd01e8a00e0>]}
[0m21:14:02.089198 [debug] [MainThread]: Flushing usage events
[0m21:15:32.705597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6349a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec634980b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6349bda0>]}


============================== 21:15:32.717039 | f077b323-4f1b-4583-a2bf-f85d1cf11cf6 ==============================
[0m21:15:32.717039 [info ] [MainThread]: Running with dbt=1.8.1
[0m21:15:32.718080 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:15:35.551228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f077b323-4f1b-4583-a2bf-f85d1cf11cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec3f747740>]}
[0m21:15:35.638657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f077b323-4f1b-4583-a2bf-f85d1cf11cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec3f4b1d00>]}
[0m21:15:35.640269 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:15:35.928072 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m21:15:37.209908 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:15:37.211050 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/marts/fact_most_departures_airport.sql
[0m21:15:37.639341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f077b323-4f1b-4583-a2bf-f85d1cf11cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec3eca61b0>]}
[0m21:15:37.948141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f077b323-4f1b-4583-a2bf-f85d1cf11cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec44870500>]}
[0m21:15:37.949630 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m21:15:37.950770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f077b323-4f1b-4583-a2bf-f85d1cf11cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec3ee205f0>]}
[0m21:15:37.954414 [info ] [MainThread]: 
[0m21:15:37.956366 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:15:37.964606 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m21:15:37.965677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:38.360264 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m21:15:38.361850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:15:38.693696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f077b323-4f1b-4583-a2bf-f85d1cf11cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec63be2450>]}
[0m21:15:38.695274 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:15:38.696350 [info ] [MainThread]: 
[0m21:15:38.713733 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m21:15:38.716149 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m21:15:38.717959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m21:15:38.719713 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m21:15:38.735854 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m21:15:38.748425 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m21:15:38.782099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:39.121095 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m21:15:39.137766 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m21:15:39.388806 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:7299c32f-3200-4406-99da-6b31d8cf3dd9&page=queryresults
[0m21:15:41.039780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f077b323-4f1b-4583-a2bf-f85d1cf11cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec3ed46e10>]}
[0m21:15:41.045340 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.32s]
[0m21:15:41.048956 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m21:15:41.051129 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m21:15:41.055518 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m21:15:41.062879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m21:15:41.065342 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m21:15:41.120585 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m21:15:41.131734 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m21:15:41.193936 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m21:15:41.202035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:41.271371 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted, ':00') as datetime) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted, ':00') as datetime) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60;


[0m21:15:41.670871 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:d4966b5d-e7d1-41bc-a8b9-b6e80aab3209&page=queryresults
[0m21:15:41.854532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f077b323-4f1b-4583-a2bf-f85d1cf11cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec3ed44590>]}
[0m21:15:41.856150 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 0.79s]
[0m21:15:41.857824 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m21:15:41.860238 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m21:15:41.861593 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m21:15:41.862871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m21:15:41.863874 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m21:15:41.874679 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m21:15:41.885932 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m21:15:41.893736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:42.229644 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m21:15:42.249276 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.flight_month,
    flight_data.dep_time,
    flight_data.arr_time,
    
    case
        when flight_data.arr_time >= flight_data.dep_time then 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE)
        else 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE) + 1440
    end
 as airtime,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m21:15:42.739842 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:68a87066-86a2-4051-9e5f-3d522ed39e10&page=queryresults
[0m21:15:48.044222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f077b323-4f1b-4583-a2bf-f85d1cf11cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec3ec7af30>]}
[0m21:15:48.045815 [info ] [Thread-1 (]: 3 of 10 OK created sql table model db_project_dataset.core_flights ............. [[32mCREATE TABLE (112.3m rows, 11.7 GiB processed)[0m in 6.18s]
[0m21:15:48.047401 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m21:15:48.049520 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m21:15:48.050667 [info ] [Thread-1 (]: 4 of 10 START sql table model db_project_dataset.dim_carriers .................. [RUN]
[0m21:15:48.051824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.core_flights, now model.flights_project.dim_carriers)
[0m21:15:48.052810 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_carriers
[0m21:15:48.060971 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_carriers"
[0m21:15:48.072025 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_carriers
[0m21:15:48.079372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:48.400467 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_carriers"
[0m21:15:48.415803 [debug] [Thread-1 (]: On model.flights_project.dim_carriers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_carriers"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_carriers`
      
    
    

    OPTIONS()
    as (
      

select distinct 
    carrier_code,
    carrier_desc
from `db-project-456518`.`db_project_dataset`.`core_flights`
    );
  
[0m21:15:48.611539 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:48d2efc4-b3b2-45ff-87f9-88cf210d00c2&page=queryresults
[0m21:15:50.291880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f077b323-4f1b-4583-a2bf-f85d1cf11cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec628a6120>]}
[0m21:15:50.293228 [info ] [Thread-1 (]: 4 of 10 OK created sql table model db_project_dataset.dim_carriers ............. [[32mCREATE TABLE (29.0 rows, 3.9 GiB processed)[0m in 2.24s]
[0m21:15:50.294605 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m21:15:50.295597 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m21:15:50.296630 [info ] [Thread-1 (]: 5 of 10 START sql table model db_project_dataset.dim_dates ..................... [RUN]
[0m21:15:50.297978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_carriers, now model.flights_project.dim_dates)
[0m21:15:50.300460 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_dates
[0m21:15:50.307577 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_dates"
[0m21:15:50.317124 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_dates
[0m21:15:50.322199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:50.632652 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_dates"
[0m21:15:50.645569 [debug] [Thread-1 (]: On model.flights_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_dates"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_dates`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select distinct flight_date
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)

select 
    flight_date,
    extract(year from flight_date) as year,
    extract(quarter from flight_date) as quarter,
    extract(month from flight_date) as month,
    extract(day from flight_date) as day,
    extract(week from flight_date) as week,
    extract(dayofweek from flight_date) as day_of_week,
    case 
    when extract(dayofweek from flight_date) in (1, 7) then 'Weekend' 
    else 'Weekday' 
    end as day_type
from flight_data
    );
  
[0m21:15:50.828113 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:1dc24c82-5903-4ad6-861e-56ea3efed286&page=queryresults
[0m21:15:52.375559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f077b323-4f1b-4583-a2bf-f85d1cf11cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec3f1758e0>]}
[0m21:15:52.376856 [info ] [Thread-1 (]: 5 of 10 OK created sql table model db_project_dataset.dim_dates ................ [[32mCREATE TABLE (7.4k rows, 857.0 MiB processed)[0m in 2.08s]
[0m21:15:52.378369 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m21:15:52.379476 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m21:15:52.380540 [info ] [Thread-1 (]: 6 of 10 START sql table model db_project_dataset.fact_delays_by_flight_num ..... [RUN]
[0m21:15:52.381553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_dates, now model.flights_project.fact_delays_by_flight_num)
[0m21:15:52.382420 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_by_flight_num
[0m21:15:52.390531 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_by_flight_num"
[0m21:15:52.398474 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_by_flight_num
[0m21:15:52.403261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:52.699281 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_by_flight_num"
[0m21:15:52.720439 [debug] [Thread-1 (]: On model.flights_project.fact_delays_by_flight_num: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_by_flight_num"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_delays_by_flight_num`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where arr_delay > 0 or dep_delay > 0
)

select 
    flight_num,
    count(*) as total_flights_with_delays,
    sum(dep_delay) as total_dep_delay,
    sum(arr_delay) as total_arr_delay,
    avg(dep_delay) as avg_dep_delay,
    avg(arr_delay) as avg_arr_delay,
    min(dep_delay) as min_dep_delay,
    min(arr_delay) as min_arr_delay,
    max(dep_delay) as max_dep_delay,
    max(arr_delay) as max_arr_delay
from flight_data
group by flight_num
    );
  
[0m21:15:52.934226 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:4473b38a-41dd-4c07-a283-7ec5c36a5b98&page=queryresults
[0m21:15:54.490965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f077b323-4f1b-4583-a2bf-f85d1cf11cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec3ed2a8d0>]}
[0m21:15:54.492754 [info ] [Thread-1 (]: 6 of 10 OK created sql table model db_project_dataset.fact_delays_by_flight_num  [[32mCREATE TABLE (8.1k rows, 2.5 GiB processed)[0m in 2.11s]
[0m21:15:54.494792 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m21:15:54.496292 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m21:15:54.499963 [info ] [Thread-1 (]: 7 of 10 START sql table model db_project_dataset.fact_delays_departure_by_airport  [RUN]
[0m21:15:54.502793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_delays_by_flight_num, now model.flights_project.fact_delays_departure_by_airport)
[0m21:15:54.504281 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_departure_by_airport
[0m21:15:54.510699 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_departure_by_airport"
[0m21:15:54.522651 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_departure_by_airport
[0m21:15:54.540615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:54.954202 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_departure_by_airport"
[0m21:15:54.985752 [debug] [Thread-1 (]: On model.flights_project.fact_delays_departure_by_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_departure_by_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_delays_departure_by_airport`
      
    
    

    OPTIONS()
    as (
      

with delayed_departures as (
    select 
        dep_airport, 
        delay_status
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where dep_delay is not null
)

select 
    dep_airport,
    delay_status, 
    count(*) AS delay_count
from delayed_departures
group by dep_airport, delay_status
order by delay_count desc
    );
  
[0m21:15:55.216977 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:b89dfd5c-dc22-4d0e-b189-4f2ffc962e0a&page=queryresults
[0m21:15:56.796024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f077b323-4f1b-4583-a2bf-f85d1cf11cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec3c2e1610>]}
[0m21:15:56.797399 [info ] [Thread-1 (]: 7 of 10 OK created sql table model db_project_dataset.fact_delays_departure_by_airport  [[32mCREATE TABLE (1.3k rows, 4.1 GiB processed)[0m in 2.29s]
[0m21:15:56.798816 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m21:15:56.800741 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m21:15:56.803379 [info ] [Thread-1 (]: 8 of 10 START sql table model db_project_dataset.fact_departures.by_year ....... [RUN]
[0m21:15:56.804901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_delays_departure_by_airport, now model.flights_project.fact_departures.by_year)
[0m21:15:56.805768 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures.by_year
[0m21:15:56.813111 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures.by_year"
[0m21:15:56.823834 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures.by_year
[0m21:15:56.828652 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures.by_year"
[0m21:15:56.839201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:56.883869 [debug] [Thread-1 (]: On model.flights_project.fact_departures.by_year: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures.by_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures.by_year`
      
    
    

    OPTIONS()
    as (
      

select
    extract(year from f.date) as year,
    count(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
group by year
order by year
    );
  
[0m21:15:57.152332 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:ff73846b-7b2a-480d-8285-6d6b4bf182b7&page=queryresults
[0m21:15:57.154008 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.; reason: invalid, location: db-project-456518.db_project_dataset.fact_departures.by_year, message: Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.")
[0m21:15:58.015942 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:34c63183-7e82-4ecf-9351-b315cdc89a92&page=queryresults
[0m21:15:58.018714 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:34c63183-7e82-4ecf-9351-b315cdc89a92&page=queryresults
[0m21:15:58.028360 [debug] [Thread-1 (]: Database Error in model fact_departures.by_year (models/marts/fact_departures.by_year.sql)
  Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/flights_project/models/marts/fact_departures.by_year.sql
[0m21:15:58.029532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f077b323-4f1b-4583-a2bf-f85d1cf11cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec3c2e1580>]}
[0m21:15:58.030833 [error] [Thread-1 (]: 8 of 10 ERROR creating sql table model db_project_dataset.fact_departures.by_year  [[31mERROR[0m in 1.22s]
[0m21:15:58.032677 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m21:15:58.034586 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m21:15:58.038787 [info ] [Thread-1 (]: 9 of 10 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m21:15:58.040317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures.by_year, now model.flights_project.fact_departures_by_airport_year)
[0m21:15:58.041881 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m21:15:58.052162 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m21:15:58.075224 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m21:15:58.086214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:58.541318 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m21:15:58.555988 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    count(*) as num_departures
from flights_data
group by origin
    );
  
[0m21:15:58.760111 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:7a4f788e-3617-455a-bbfd-90a078ddbe14&page=queryresults
[0m21:16:00.357110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f077b323-4f1b-4583-a2bf-f85d1cf11cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec3ed25940>]}
[0m21:16:00.358769 [info ] [Thread-1 (]: 9 of 10 OK created sql table model db_project_dataset.fact_departures_by_airport_year  [[32mCREATE TABLE (343.0 rows, 535.6 MiB processed)[0m in 2.32s]
[0m21:16:00.360589 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m21:16:00.361950 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m21:16:00.363486 [info ] [Thread-1 (]: 10 of 10 START sql table model db_project_dataset.fact_most_departures_airport . [RUN]
[0m21:16:00.364986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures_by_airport_year, now model.flights_project.fact_most_departures_airport)
[0m21:16:00.366779 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_most_departures_airport
[0m21:16:00.375391 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_most_departures_airport"
[0m21:16:00.387470 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_most_departures_airport
[0m21:16:00.395629 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_most_departures_airport"
[0m21:16:00.408372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:00.456374 [debug] [Thread-1 (]: On model.flights_project.fact_most_departures_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_most_departures_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_most_departures_airport`
      
    
    

    OPTIONS()
    as (
      

select
    a.airport_name,
    a.city,
    a.state,
    COUNT(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
join `db-project-456518`.`db_project_dataset`.`dim_airports` a on f.dep_airport = a.airport_name
group by airport_name, a.city, a.state
order by num_departures desc
    );
  
[0m21:16:00.873027 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:6afc527b-d51f-4204-82f9-0989a37fd5d6&page=queryresults
[0m21:16:02.457284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f077b323-4f1b-4583-a2bf-f85d1cf11cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec3ec61910>]}
[0m21:16:02.459543 [info ] [Thread-1 (]: 10 of 10 OK created sql table model db_project_dataset.fact_most_departures_airport  [[32mCREATE TABLE (352.0 rows, 2.7 GiB processed)[0m in 2.09s]
[0m21:16:02.461435 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m21:16:02.465085 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:16:02.466189 [debug] [MainThread]: Connection 'model.flights_project.fact_most_departures_airport' was properly closed.
[0m21:16:02.468479 [info ] [MainThread]: 
[0m21:16:02.470163 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 24.51 seconds (24.51s).
[0m21:16:02.475286 [debug] [MainThread]: Command end result
[0m21:16:02.578948 [info ] [MainThread]: 
[0m21:16:02.580432 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:16:02.581404 [info ] [MainThread]: 
[0m21:16:02.582943 [error] [MainThread]:   Database Error in model fact_departures.by_year (models/marts/fact_departures.by_year.sql)
  Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/flights_project/models/marts/fact_departures.by_year.sql
[0m21:16:02.585262 [info ] [MainThread]: 
[0m21:16:02.586652 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m21:16:02.588856 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 30.088438, "process_user_time": 9.079922, "process_kernel_time": 1.025524, "process_mem_max_rss": "258504", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:16:02.590314 [debug] [MainThread]: Command `dbt run` failed at 21:16:02.590071 after 30.09 seconds
[0m21:16:02.591591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec62a960f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec647963f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6545cd10>]}
[0m21:16:02.592638 [debug] [MainThread]: Flushing usage events
[0m21:19:23.319894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55c8a3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55c8a25d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55c8a27b0>]}


============================== 21:19:23.329361 | 85aaa798-3d19-44d8-ba88-7a3b67f0d478 ==============================
[0m21:19:23.329361 [info ] [MainThread]: Running with dbt=1.8.1
[0m21:19:23.332728 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:19:26.782228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85aaa798-3d19-44d8-ba88-7a3b67f0d478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53cc44170>]}
[0m21:19:26.863928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85aaa798-3d19-44d8-ba88-7a3b67f0d478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53c9c3f80>]}
[0m21:19:26.865556 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:19:27.142700 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m21:19:28.600368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:19:28.602033 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/marts/fact_departures.by_year.sql
[0m21:19:29.007803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85aaa798-3d19-44d8-ba88-7a3b67f0d478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53c6b4260>]}
[0m21:19:29.332707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85aaa798-3d19-44d8-ba88-7a3b67f0d478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53c8dd2e0>]}
[0m21:19:29.334346 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m21:19:29.336061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85aaa798-3d19-44d8-ba88-7a3b67f0d478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53c716c60>]}
[0m21:19:29.340180 [info ] [MainThread]: 
[0m21:19:29.341738 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:19:29.352185 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m21:19:29.353693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:29.997442 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m21:19:29.998883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:30.305910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85aaa798-3d19-44d8-ba88-7a3b67f0d478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53cd8f230>]}
[0m21:19:30.308048 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:19:30.309412 [info ] [MainThread]: 
[0m21:19:30.336205 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m21:19:30.337836 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m21:19:30.339369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m21:19:30.340584 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m21:19:30.356915 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m21:19:30.366994 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m21:19:30.393784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:30.794219 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m21:19:30.807298 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m21:19:31.077023 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:d5d8a55b-6d85-421e-aa03-96e32ff93c59&page=queryresults
[0m21:19:32.376185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85aaa798-3d19-44d8-ba88-7a3b67f0d478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53c0e8260>]}
[0m21:19:32.378400 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.04s]
[0m21:19:32.380208 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m21:19:32.381493 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m21:19:32.382865 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m21:19:32.384416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m21:19:32.385661 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m21:19:32.414037 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m21:19:32.422515 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m21:19:32.455189 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m21:19:32.464978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:32.510541 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted, ':00') as datetime) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted, ':00') as datetime) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60;


[0m21:19:32.848115 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:eb533165-a53d-478e-a7fe-88441730d9f1&page=queryresults
[0m21:19:32.990280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85aaa798-3d19-44d8-ba88-7a3b67f0d478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55bcd0830>]}
[0m21:19:32.991753 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 0.61s]
[0m21:19:32.993291 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m21:19:32.995833 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m21:19:32.997214 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m21:19:32.998521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m21:19:33.000117 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m21:19:33.015188 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m21:19:33.029064 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m21:19:33.038725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:33.379254 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m21:19:33.392087 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.flight_month,
    flight_data.dep_time,
    flight_data.arr_time,
    
    case
        when flight_data.arr_time >= flight_data.dep_time then 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE)
        else 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE) + 1440
    end
 as airtime,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m21:19:33.832697 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:f76c160d-a5f2-42cb-953e-0779297c2d09&page=queryresults
[0m21:19:38.429873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85aaa798-3d19-44d8-ba88-7a3b67f0d478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53c070110>]}
[0m21:19:38.432665 [info ] [Thread-1 (]: 3 of 10 OK created sql table model db_project_dataset.core_flights ............. [[32mCREATE TABLE (112.3m rows, 11.7 GiB processed)[0m in 5.43s]
[0m21:19:38.435874 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m21:19:38.439105 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m21:19:38.440405 [info ] [Thread-1 (]: 4 of 10 START sql table model db_project_dataset.dim_carriers .................. [RUN]
[0m21:19:38.441750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.core_flights, now model.flights_project.dim_carriers)
[0m21:19:38.442731 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_carriers
[0m21:19:38.451880 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_carriers"
[0m21:19:38.464547 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_carriers
[0m21:19:38.469182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:38.768632 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_carriers"
[0m21:19:38.782570 [debug] [Thread-1 (]: On model.flights_project.dim_carriers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_carriers"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_carriers`
      
    
    

    OPTIONS()
    as (
      

select distinct 
    carrier_code,
    carrier_desc
from `db-project-456518`.`db_project_dataset`.`core_flights`
    );
  
[0m21:19:38.974356 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:2ae0a061-f316-41d9-afab-4f49b8c32945&page=queryresults
[0m21:19:40.580516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85aaa798-3d19-44d8-ba88-7a3b67f0d478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53c0bf0b0>]}
[0m21:19:40.582715 [info ] [Thread-1 (]: 4 of 10 OK created sql table model db_project_dataset.dim_carriers ............. [[32mCREATE TABLE (29.0 rows, 3.9 GiB processed)[0m in 2.14s]
[0m21:19:40.584889 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m21:19:40.586182 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m21:19:40.587273 [info ] [Thread-1 (]: 5 of 10 START sql table model db_project_dataset.dim_dates ..................... [RUN]
[0m21:19:40.588376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_carriers, now model.flights_project.dim_dates)
[0m21:19:40.590369 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_dates
[0m21:19:40.596866 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_dates"
[0m21:19:40.606349 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_dates
[0m21:19:40.611608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:41.006572 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_dates"
[0m21:19:41.020790 [debug] [Thread-1 (]: On model.flights_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_dates"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_dates`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select distinct flight_date
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)

select 
    flight_date,
    extract(year from flight_date) as year,
    extract(quarter from flight_date) as quarter,
    extract(month from flight_date) as month,
    extract(day from flight_date) as day,
    extract(week from flight_date) as week,
    extract(dayofweek from flight_date) as day_of_week,
    case 
    when extract(dayofweek from flight_date) in (1, 7) then 'Weekend' 
    else 'Weekday' 
    end as day_type
from flight_data
    );
  
[0m21:19:41.252192 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:1312ad26-a165-44b6-ac9a-c073845cd316&page=queryresults
[0m21:19:42.785408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85aaa798-3d19-44d8-ba88-7a3b67f0d478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53cf53200>]}
[0m21:19:42.787196 [info ] [Thread-1 (]: 5 of 10 OK created sql table model db_project_dataset.dim_dates ................ [[32mCREATE TABLE (7.4k rows, 857.0 MiB processed)[0m in 2.20s]
[0m21:19:42.789815 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m21:19:42.791245 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m21:19:42.792983 [info ] [Thread-1 (]: 6 of 10 START sql table model db_project_dataset.fact_delays_by_flight_num ..... [RUN]
[0m21:19:42.794956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_dates, now model.flights_project.fact_delays_by_flight_num)
[0m21:19:42.796121 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_by_flight_num
[0m21:19:42.801524 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_by_flight_num"
[0m21:19:42.812872 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_by_flight_num
[0m21:19:42.816975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:43.157952 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_by_flight_num"
[0m21:19:43.170259 [debug] [Thread-1 (]: On model.flights_project.fact_delays_by_flight_num: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_by_flight_num"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_delays_by_flight_num`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where arr_delay > 0 or dep_delay > 0
)

select 
    flight_num,
    count(*) as total_flights_with_delays,
    sum(dep_delay) as total_dep_delay,
    sum(arr_delay) as total_arr_delay,
    avg(dep_delay) as avg_dep_delay,
    avg(arr_delay) as avg_arr_delay,
    min(dep_delay) as min_dep_delay,
    min(arr_delay) as min_arr_delay,
    max(dep_delay) as max_dep_delay,
    max(arr_delay) as max_arr_delay
from flight_data
group by flight_num
    );
  
[0m21:19:43.388214 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:08f07591-36e2-4a6d-9524-5bdd6d69b8c1&page=queryresults
[0m21:19:44.897758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85aaa798-3d19-44d8-ba88-7a3b67f0d478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53c7e4b90>]}
[0m21:19:44.899557 [info ] [Thread-1 (]: 6 of 10 OK created sql table model db_project_dataset.fact_delays_by_flight_num  [[32mCREATE TABLE (8.1k rows, 2.5 GiB processed)[0m in 2.10s]
[0m21:19:44.901449 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m21:19:44.902954 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m21:19:44.904461 [info ] [Thread-1 (]: 7 of 10 START sql table model db_project_dataset.fact_delays_departure_by_airport  [RUN]
[0m21:19:44.905799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_delays_by_flight_num, now model.flights_project.fact_delays_departure_by_airport)
[0m21:19:44.906813 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_departure_by_airport
[0m21:19:44.912444 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_departure_by_airport"
[0m21:19:44.923065 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_departure_by_airport
[0m21:19:44.931104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:45.250219 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_departure_by_airport"
[0m21:19:45.263535 [debug] [Thread-1 (]: On model.flights_project.fact_delays_departure_by_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_departure_by_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_delays_departure_by_airport`
      
    
    

    OPTIONS()
    as (
      

with delayed_departures as (
    select 
        dep_airport, 
        delay_status
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where dep_delay is not null
)

select 
    dep_airport,
    delay_status, 
    count(*) AS delay_count
from delayed_departures
group by dep_airport, delay_status
order by delay_count desc
    );
  
[0m21:19:45.434438 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:d5b883d3-f6f7-4360-8688-85da13669b3d&page=queryresults
[0m21:19:47.091146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85aaa798-3d19-44d8-ba88-7a3b67f0d478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53c7e4c50>]}
[0m21:19:47.093494 [info ] [Thread-1 (]: 7 of 10 OK created sql table model db_project_dataset.fact_delays_departure_by_airport  [[32mCREATE TABLE (1.3k rows, 4.1 GiB processed)[0m in 2.19s]
[0m21:19:47.095408 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m21:19:47.096778 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m21:19:47.098132 [info ] [Thread-1 (]: 8 of 10 START sql table model db_project_dataset.fact_departures.by_year ....... [RUN]
[0m21:19:47.099387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_delays_departure_by_airport, now model.flights_project.fact_departures.by_year)
[0m21:19:47.100287 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures.by_year
[0m21:19:47.107610 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures.by_year"
[0m21:19:47.118410 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures.by_year
[0m21:19:47.124147 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures.by_year"
[0m21:19:47.139206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:47.183197 [debug] [Thread-1 (]: On model.flights_project.fact_departures.by_year: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures.by_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures.by_year`
      
    
    

    OPTIONS()
    as (
      

select
    extract(year from f.flight_date) as year,
    count(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
group by year
order by year
    );
  
[0m21:19:47.507638 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:be35e947-44a1-4371-a050-a5a7980f4a7d&page=queryresults
[0m21:19:47.509722 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.; reason: invalid, location: db-project-456518.db_project_dataset.fact_departures.by_year, message: Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.")
[0m21:19:48.447903 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:d6bb7aaf-8d34-4c51-9c9f-5f255ba32898&page=queryresults
[0m21:19:48.449935 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:d6bb7aaf-8d34-4c51-9c9f-5f255ba32898&page=queryresults
[0m21:19:48.459804 [debug] [Thread-1 (]: Database Error in model fact_departures.by_year (models/marts/fact_departures.by_year.sql)
  Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/flights_project/models/marts/fact_departures.by_year.sql
[0m21:19:48.461518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85aaa798-3d19-44d8-ba88-7a3b67f0d478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53c169a00>]}
[0m21:19:48.462932 [error] [Thread-1 (]: 8 of 10 ERROR creating sql table model db_project_dataset.fact_departures.by_year  [[31mERROR[0m in 1.36s]
[0m21:19:48.464994 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m21:19:48.466758 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m21:19:48.468716 [info ] [Thread-1 (]: 9 of 10 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m21:19:48.469863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures.by_year, now model.flights_project.fact_departures_by_airport_year)
[0m21:19:48.470835 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m21:19:48.476475 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m21:19:48.486661 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m21:19:48.490809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:48.840625 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m21:19:48.852515 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    count(*) as num_departures
from flights_data
group by origin
    );
  
[0m21:19:49.035291 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:b81b1b3a-9f05-4333-99d9-9e53a82a96a4&page=queryresults
[0m21:19:50.579708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85aaa798-3d19-44d8-ba88-7a3b67f0d478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53c0b57f0>]}
[0m21:19:50.581720 [info ] [Thread-1 (]: 9 of 10 OK created sql table model db_project_dataset.fact_departures_by_airport_year  [[32mCREATE TABLE (343.0 rows, 535.6 MiB processed)[0m in 2.11s]
[0m21:19:50.583700 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m21:19:50.585204 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m21:19:50.586640 [info ] [Thread-1 (]: 10 of 10 START sql table model db_project_dataset.fact_most_departures_airport . [RUN]
[0m21:19:50.588070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures_by_airport_year, now model.flights_project.fact_most_departures_airport)
[0m21:19:50.589164 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_most_departures_airport
[0m21:19:50.594922 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_most_departures_airport"
[0m21:19:50.607893 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_most_departures_airport
[0m21:19:50.613139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:50.918540 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_most_departures_airport"
[0m21:19:50.931060 [debug] [Thread-1 (]: On model.flights_project.fact_most_departures_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_most_departures_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_most_departures_airport`
      
    
    

    OPTIONS()
    as (
      

select
    a.airport_name,
    a.city,
    a.state,
    COUNT(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
join `db-project-456518`.`db_project_dataset`.`dim_airports` a on f.dep_airport = a.airport_name
group by airport_name, a.city, a.state
order by num_departures desc
    );
  
[0m21:19:51.120131 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:66d8bc12-5339-44ad-8320-5efcdf2a042d&page=queryresults
[0m21:19:52.918048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85aaa798-3d19-44d8-ba88-7a3b67f0d478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53c2958e0>]}
[0m21:19:52.920229 [info ] [Thread-1 (]: 10 of 10 OK created sql table model db_project_dataset.fact_most_departures_airport  [[32mCREATE TABLE (352.0 rows, 2.7 GiB processed)[0m in 2.33s]
[0m21:19:52.922793 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m21:19:52.926454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:19:52.927601 [debug] [MainThread]: Connection 'model.flights_project.fact_most_departures_airport' was properly closed.
[0m21:19:52.929069 [info ] [MainThread]: 
[0m21:19:52.930536 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 23.59 seconds (23.59s).
[0m21:19:52.934958 [debug] [MainThread]: Command end result
[0m21:19:53.077292 [info ] [MainThread]: 
[0m21:19:53.079479 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:19:53.081249 [info ] [MainThread]: 
[0m21:19:53.083015 [error] [MainThread]:   Database Error in model fact_departures.by_year (models/marts/fact_departures.by_year.sql)
  Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/flights_project/models/marts/fact_departures.by_year.sql
[0m21:19:53.085267 [info ] [MainThread]: 
[0m21:19:53.088146 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m21:19:53.091731 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 29.939705, "process_user_time": 10.351967, "process_kernel_time": 1.188915, "process_mem_max_rss": "256444", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:19:53.096266 [debug] [MainThread]: Command `dbt run` failed at 21:19:53.095820 after 29.94 seconds
[0m21:19:53.098457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55fcdb230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55c30aff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55c30bad0>]}
[0m21:19:53.099846 [debug] [MainThread]: Flushing usage events
[0m21:24:36.397492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8c1e3d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8c92ed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8a73a5a0>]}


============================== 21:24:36.412754 | 1d13dcff-ff99-454a-8803-9415eb5d5c2a ==============================
[0m21:24:36.412754 [info ] [MainThread]: Running with dbt=1.8.1
[0m21:24:36.416058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:24:38.849910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d13dcff-ff99-454a-8803-9415eb5d5c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8b5b8980>]}
[0m21:24:39.081716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d13dcff-ff99-454a-8803-9415eb5d5c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe66ccfd40>]}
[0m21:24:39.084170 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:24:39.490993 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m21:24:41.365242 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:24:41.367483 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/sources/sources.yml
[0m21:24:41.368734 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m21:24:42.166434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d13dcff-ff99-454a-8803-9415eb5d5c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe666c50d0>]}
[0m21:24:42.423520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d13dcff-ff99-454a-8803-9415eb5d5c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe666c43e0>]}
[0m21:24:42.425478 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m21:24:42.427119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d13dcff-ff99-454a-8803-9415eb5d5c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe66c14440>]}
[0m21:24:42.432675 [info ] [MainThread]: 
[0m21:24:42.434999 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:24:42.451949 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m21:24:42.453609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:42.999233 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m21:24:43.000336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:24:43.343006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d13dcff-ff99-454a-8803-9415eb5d5c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe667bb890>]}
[0m21:24:43.344570 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:24:43.345617 [info ] [MainThread]: 
[0m21:24:43.363131 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m21:24:43.364426 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m21:24:43.365566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m21:24:43.366500 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m21:24:43.381732 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m21:24:43.393635 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m21:24:43.427192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:24:44.001339 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m21:24:44.023295 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m21:24:44.279636 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:0f195f6e-71b8-419a-9f18-41cfa141eead&page=queryresults
[0m21:24:45.922679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d13dcff-ff99-454a-8803-9415eb5d5c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8ae62d80>]}
[0m21:24:45.924447 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.56s]
[0m21:24:45.926235 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m21:24:45.927423 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m21:24:45.928595 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m21:24:45.929954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m21:24:45.930954 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m21:24:45.938038 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m21:24:45.950103 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m21:24:45.987357 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m21:24:45.999928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:24:46.041847 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted, ':00') as datetime) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted, ':00') as datetime) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60;


[0m21:24:46.520036 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:4320f7b3-be3b-4433-a3b6-582fd8254e42&page=queryresults
[0m21:24:46.685086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d13dcff-ff99-454a-8803-9415eb5d5c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe65471f40>]}
[0m21:24:46.686849 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 0.76s]
[0m21:24:46.688972 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m21:24:46.691845 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m21:24:46.693574 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m21:24:46.695115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m21:24:46.696279 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m21:24:46.702931 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m21:24:46.712621 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m21:24:46.717011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:24:47.043800 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m21:24:47.054897 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.flight_month,
    flight_data.dep_time,
    flight_data.arr_time,
    
    case
        when flight_data.arr_time >= flight_data.dep_time then 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE)
        else 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE) + 1440
    end
 as airtime,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m21:24:47.570248 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:8a1ec324-a296-43ea-8504-5c38eb8e00d8&page=queryresults
[0m21:24:52.523177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d13dcff-ff99-454a-8803-9415eb5d5c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe66aba900>]}
[0m21:24:52.525651 [info ] [Thread-1 (]: 3 of 10 OK created sql table model db_project_dataset.core_flights ............. [[32mCREATE TABLE (112.3m rows, 11.7 GiB processed)[0m in 5.83s]
[0m21:24:52.527983 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m21:24:52.532212 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m21:24:52.535380 [info ] [Thread-1 (]: 4 of 10 START sql table model db_project_dataset.dim_carriers .................. [RUN]
[0m21:24:52.537993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.core_flights, now model.flights_project.dim_carriers)
[0m21:24:52.539669 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_carriers
[0m21:24:52.547537 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_carriers"
[0m21:24:52.566873 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_carriers
[0m21:24:52.574319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:24:52.934461 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_carriers"
[0m21:24:52.956868 [debug] [Thread-1 (]: On model.flights_project.dim_carriers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_carriers"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_carriers`
      
    
    

    OPTIONS()
    as (
      

select distinct 
    carrier_code,
    carrier_desc
from `db-project-456518`.`db_project_dataset`.`core_flights`
    );
  
[0m21:24:53.162307 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:be5418c3-0681-4f40-a13b-74466a2e2ad8&page=queryresults
[0m21:24:54.763545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d13dcff-ff99-454a-8803-9415eb5d5c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe65473b90>]}
[0m21:24:54.765802 [info ] [Thread-1 (]: 4 of 10 OK created sql table model db_project_dataset.dim_carriers ............. [[32mCREATE TABLE (29.0 rows, 3.9 GiB processed)[0m in 2.23s]
[0m21:24:54.770430 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m21:24:54.772085 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m21:24:54.773281 [info ] [Thread-1 (]: 5 of 10 START sql table model db_project_dataset.dim_dates ..................... [RUN]
[0m21:24:54.774420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_carriers, now model.flights_project.dim_dates)
[0m21:24:54.775730 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_dates
[0m21:24:54.784467 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_dates"
[0m21:24:54.795277 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_dates
[0m21:24:54.801115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:24:55.119603 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_dates"
[0m21:24:55.129733 [debug] [Thread-1 (]: On model.flights_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_dates"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_dates`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select distinct flight_date
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)

select 
    flight_date,
    extract(year from flight_date) as year,
    extract(quarter from flight_date) as quarter,
    extract(month from flight_date) as month,
    extract(day from flight_date) as day,
    extract(week from flight_date) as week,
    extract(dayofweek from flight_date) as day_of_week,
    case 
    when extract(dayofweek from flight_date) in (1, 7) then 'Weekend' 
    else 'Weekday' 
    end as day_type
from flight_data
    );
  
[0m21:24:55.326729 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:75145417-76a3-4a12-8b51-46fd53dfecfb&page=queryresults
[0m21:24:56.876545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d13dcff-ff99-454a-8803-9415eb5d5c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe64359880>]}
[0m21:24:56.877991 [info ] [Thread-1 (]: 5 of 10 OK created sql table model db_project_dataset.dim_dates ................ [[32mCREATE TABLE (7.4k rows, 857.0 MiB processed)[0m in 2.10s]
[0m21:24:56.879413 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m21:24:56.880635 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m21:24:56.881757 [info ] [Thread-1 (]: 6 of 10 START sql table model db_project_dataset.fact_delays_by_flight_num ..... [RUN]
[0m21:24:56.883463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_dates, now model.flights_project.fact_delays_by_flight_num)
[0m21:24:56.885158 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_by_flight_num
[0m21:24:56.892493 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_by_flight_num"
[0m21:24:56.907342 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_by_flight_num
[0m21:24:56.918046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:24:57.269083 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_by_flight_num"
[0m21:24:57.281824 [debug] [Thread-1 (]: On model.flights_project.fact_delays_by_flight_num: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_by_flight_num"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_delays_by_flight_num`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where arr_delay > 0 or dep_delay > 0
)

select 
    flight_num,
    count(*) as total_flights_with_delays,
    sum(dep_delay) as total_dep_delay,
    sum(arr_delay) as total_arr_delay,
    avg(dep_delay) as avg_dep_delay,
    avg(arr_delay) as avg_arr_delay,
    min(dep_delay) as min_dep_delay,
    min(arr_delay) as min_arr_delay,
    max(dep_delay) as max_dep_delay,
    max(arr_delay) as max_arr_delay
from flight_data
group by flight_num
    );
  
[0m21:24:57.535553 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:28b1c455-3427-496a-9083-d94ff2431437&page=queryresults
[0m21:25:00.266227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d13dcff-ff99-454a-8803-9415eb5d5c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe64377a10>]}
[0m21:25:00.268510 [info ] [Thread-1 (]: 6 of 10 OK created sql table model db_project_dataset.fact_delays_by_flight_num  [[32mCREATE TABLE (8.1k rows, 2.5 GiB processed)[0m in 3.38s]
[0m21:25:00.270452 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m21:25:00.271866 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m21:25:00.273360 [info ] [Thread-1 (]: 7 of 10 START sql table model db_project_dataset.fact_delays_departure_by_airport  [RUN]
[0m21:25:00.274751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_delays_by_flight_num, now model.flights_project.fact_delays_departure_by_airport)
[0m21:25:00.275983 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_departure_by_airport
[0m21:25:00.284142 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_departure_by_airport"
[0m21:25:00.295319 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_departure_by_airport
[0m21:25:00.302598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:00.645499 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_departure_by_airport"
[0m21:25:00.663662 [debug] [Thread-1 (]: On model.flights_project.fact_delays_departure_by_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_departure_by_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_delays_departure_by_airport`
      
    
    

    OPTIONS()
    as (
      

with delayed_departures as (
    select 
        dep_airport, 
        delay_status
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where dep_delay is not null
)

select 
    dep_airport,
    delay_status, 
    count(*) AS delay_count
from delayed_departures
group by dep_airport, delay_status
order by delay_count desc
    );
  
[0m21:25:00.873540 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:788e45ce-1bbf-45af-ac48-16bfe6f5a50c&page=queryresults
[0m21:25:02.444242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d13dcff-ff99-454a-8803-9415eb5d5c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe65469f40>]}
[0m21:25:02.446327 [info ] [Thread-1 (]: 7 of 10 OK created sql table model db_project_dataset.fact_delays_departure_by_airport  [[32mCREATE TABLE (1.3k rows, 4.1 GiB processed)[0m in 2.17s]
[0m21:25:02.448775 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m21:25:02.450911 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m21:25:02.452037 [info ] [Thread-1 (]: 8 of 10 START sql table model db_project_dataset.fact_departures.by_year ....... [RUN]
[0m21:25:02.453308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_delays_departure_by_airport, now model.flights_project.fact_departures.by_year)
[0m21:25:02.454207 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures.by_year
[0m21:25:02.460949 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures.by_year"
[0m21:25:02.475521 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures.by_year
[0m21:25:02.480135 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures.by_year"
[0m21:25:02.493185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:02.534979 [debug] [Thread-1 (]: On model.flights_project.fact_departures.by_year: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures.by_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures.by_year`
      
    
    

    OPTIONS()
    as (
      

select
    extract(year from f.flight_date) as year,
    count(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
group by year
order by year
    );
  
[0m21:25:02.813031 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:ce34aee0-0542-4f6c-82bd-c28ace22a66b&page=queryresults
[0m21:25:02.815430 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.; reason: invalid, location: db-project-456518.db_project_dataset.fact_departures.by_year, message: Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.")
[0m21:25:03.474121 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:eeaa7e76-a838-4803-9119-db3a40c00319&page=queryresults
[0m21:25:03.476347 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:eeaa7e76-a838-4803-9119-db3a40c00319&page=queryresults
[0m21:25:03.493783 [debug] [Thread-1 (]: Database Error in model fact_departures.by_year (models/marts/fact_departures.by_year.sql)
  Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/flights_project/models/marts/fact_departures.by_year.sql
[0m21:25:03.495643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d13dcff-ff99-454a-8803-9415eb5d5c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe6434ddf0>]}
[0m21:25:03.501741 [error] [Thread-1 (]: 8 of 10 ERROR creating sql table model db_project_dataset.fact_departures.by_year  [[31mERROR[0m in 1.04s]
[0m21:25:03.511099 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m21:25:03.513415 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m21:25:03.520885 [info ] [Thread-1 (]: 9 of 10 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m21:25:03.525577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures.by_year, now model.flights_project.fact_departures_by_airport_year)
[0m21:25:03.531562 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m21:25:03.546584 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m21:25:03.561502 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m21:25:03.569504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:03.884163 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m21:25:03.895701 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    count(*) as num_departures
from flights_data
group by origin
    );
  
[0m21:25:04.163369 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:96ad4767-5be6-4953-ad47-18dbe800c4c2&page=queryresults
[0m21:25:05.725708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d13dcff-ff99-454a-8803-9415eb5d5c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe644180e0>]}
[0m21:25:05.727394 [info ] [Thread-1 (]: 9 of 10 OK created sql table model db_project_dataset.fact_departures_by_airport_year  [[32mCREATE TABLE (343.0 rows, 535.6 MiB processed)[0m in 2.20s]
[0m21:25:05.729292 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m21:25:05.730926 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m21:25:05.732698 [info ] [Thread-1 (]: 10 of 10 START sql table model db_project_dataset.fact_most_departures_airport . [RUN]
[0m21:25:05.733991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures_by_airport_year, now model.flights_project.fact_most_departures_airport)
[0m21:25:05.735037 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_most_departures_airport
[0m21:25:05.740052 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_most_departures_airport"
[0m21:25:05.752396 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_most_departures_airport
[0m21:25:05.761601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:06.083850 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_most_departures_airport"
[0m21:25:06.098691 [debug] [Thread-1 (]: On model.flights_project.fact_most_departures_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_most_departures_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_most_departures_airport`
      
    
    

    OPTIONS()
    as (
      

select
    a.airport_name,
    a.city,
    a.state,
    COUNT(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
join `db-project-456518`.`db_project_dataset`.`dim_airports` a on f.dep_airport = a.airport_name
group by airport_name, a.city, a.state
order by num_departures desc
    );
  
[0m21:25:06.288152 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:dc56f5ac-d4a8-40d4-bef5-f48e83480531&page=queryresults
[0m21:25:07.888479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d13dcff-ff99-454a-8803-9415eb5d5c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe64408290>]}
[0m21:25:07.890352 [info ] [Thread-1 (]: 10 of 10 OK created sql table model db_project_dataset.fact_most_departures_airport  [[32mCREATE TABLE (352.0 rows, 2.7 GiB processed)[0m in 2.15s]
[0m21:25:07.892678 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m21:25:07.899178 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:25:07.901165 [debug] [MainThread]: Connection 'model.flights_project.fact_most_departures_airport' was properly closed.
[0m21:25:07.902724 [info ] [MainThread]: 
[0m21:25:07.904261 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 25.47 seconds (25.47s).
[0m21:25:07.909151 [debug] [MainThread]: Command end result
[0m21:25:08.050072 [info ] [MainThread]: 
[0m21:25:08.054317 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:25:08.055799 [info ] [MainThread]: 
[0m21:25:08.057861 [error] [MainThread]:   Database Error in model fact_departures.by_year (models/marts/fact_departures.by_year.sql)
  Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/flights_project/models/marts/fact_departures.by_year.sql
[0m21:25:08.059513 [info ] [MainThread]: 
[0m21:25:08.060643 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m21:25:08.064836 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 31.90076, "process_user_time": 10.18239, "process_kernel_time": 0.973095, "process_mem_max_rss": "261720", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:25:08.067462 [debug] [MainThread]: Command `dbt run` failed at 21:25:08.067050 after 31.90 seconds
[0m21:25:08.069295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8a7c7aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe66c177a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe6435a2d0>]}
[0m21:25:08.070727 [debug] [MainThread]: Flushing usage events
[0m21:25:43.720496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a95120ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a95156db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a94c74b00>]}


============================== 21:25:43.729840 | a5c427d9-3ebd-48f9-97db-5521f7a14d4c ==============================
[0m21:25:43.729840 [info ] [MainThread]: Running with dbt=1.8.1
[0m21:25:43.731401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:25:43.894329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5c427d9-3ebd-48f9-97db-5521f7a14d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a95686930>]}
[0m21:25:44.403477 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-by0sjp1y'
[0m21:25:44.404643 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:25:44.634967 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:25:44.637692 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:25:44.734509 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:25:44.745432 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:25:48.420662 [info ] [MainThread]: Installed from version 1.3.0
[0m21:25:48.421627 [info ] [MainThread]: Up to date!
[0m21:25:48.422651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a5c427d9-3ebd-48f9-97db-5521f7a14d4c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a95a8aff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9445e9f0>]}
[0m21:25:48.424315 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.79054, "process_user_time": 3.408384, "process_kernel_time": 0.337857, "process_mem_max_rss": "104356", "process_in_blocks": "8", "process_out_blocks": "176"}
[0m21:25:48.425213 [debug] [MainThread]: Command `dbt deps` succeeded at 21:25:48.425083 after 4.79 seconds
[0m21:25:48.426064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a98547260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a956869c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a94416ff0>]}
[0m21:25:48.427023 [debug] [MainThread]: Flushing usage events
[0m21:25:53.900354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a0857e480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a0982acf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a0a04b380>]}


============================== 21:25:53.912440 | f88de786-5177-4e68-9795-00deafe21d6c ==============================
[0m21:25:53.912440 [info ] [MainThread]: Running with dbt=1.8.1
[0m21:25:53.913976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:25:55.224174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f88de786-5177-4e68-9795-00deafe21d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e88860c0>]}
[0m21:25:55.293633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f88de786-5177-4e68-9795-00deafe21d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e97bf260>]}
[0m21:25:55.294788 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:25:55.542110 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m21:25:56.831567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:25:56.832394 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:25:56.901401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f88de786-5177-4e68-9795-00deafe21d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e81e3110>]}
[0m21:25:57.104327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f88de786-5177-4e68-9795-00deafe21d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e806c620>]}
[0m21:25:57.105528 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m21:25:57.106875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f88de786-5177-4e68-9795-00deafe21d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e8885070>]}
[0m21:25:57.110175 [info ] [MainThread]: 
[0m21:25:57.111796 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:25:57.114734 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m21:25:57.116048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:25:57.484202 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m21:25:57.485185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:25:57.796232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f88de786-5177-4e68-9795-00deafe21d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e8170290>]}
[0m21:25:57.797782 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:25:57.799462 [info ] [MainThread]: 
[0m21:25:57.809282 [debug] [Thread-1 (]: Began running node seed.flights_project.airports
[0m21:25:57.810509 [info ] [Thread-1 (]: 1 of 1 START seed file db_project_dataset.airports ............................. [RUN]
[0m21:25:57.812258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now seed.flights_project.airports)
[0m21:25:57.813189 [debug] [Thread-1 (]: Began compiling node seed.flights_project.airports
[0m21:25:57.814213 [debug] [Thread-1 (]: Began executing node seed.flights_project.airports
[0m21:25:58.043099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:00.434989 [debug] [Thread-1 (]: On seed.flights_project.airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.flights_project.airports"} */

    alter table `db-project-456518`.`db_project_dataset`.`airports` set OPTIONS()
  
[0m21:26:00.579694 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:0f1aa9b1-b448-471a-bf86-9c2aaae28a62&page=queryresults
[0m21:26:00.723449 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.flights_project.airports"
[0m21:26:00.756036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f88de786-5177-4e68-9795-00deafe21d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a09279af0>]}
[0m21:26:00.757223 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file db_project_dataset.airports ......................... [[32mINSERT 3376[0m in 2.94s]
[0m21:26:00.758800 [debug] [Thread-1 (]: Finished running node seed.flights_project.airports
[0m21:26:00.761572 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:26:00.762420 [debug] [MainThread]: Connection 'seed.flights_project.airports' was properly closed.
[0m21:26:00.763242 [info ] [MainThread]: 
[0m21:26:00.764287 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.65 seconds (3.65s).
[0m21:26:00.765866 [debug] [MainThread]: Command end result
[0m21:26:00.861430 [info ] [MainThread]: 
[0m21:26:00.862779 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:26:00.864365 [info ] [MainThread]: 
[0m21:26:00.865498 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:26:00.867212 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 7.06017, "process_user_time": 6.505574, "process_kernel_time": 0.664441, "process_mem_max_rss": "260400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:26:00.868263 [debug] [MainThread]: Command `dbt seed` succeeded at 21:26:00.868110 after 7.06 seconds
[0m21:26:00.869289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a07f89d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e819cc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e819f890>]}
[0m21:26:00.870242 [debug] [MainThread]: Flushing usage events
[0m21:26:06.009353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4ecccf290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4eceb5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4ef2a3e00>]}


============================== 21:26:06.018007 | e90b7dc0-02bc-4dc5-ab1d-33b95f41c14c ==============================
[0m21:26:06.018007 [info ] [MainThread]: Running with dbt=1.8.1
[0m21:26:06.019412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:26:07.358819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e90b7dc0-02bc-4dc5-ab1d-33b95f41c14c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c9480b90>]}
[0m21:26:07.430945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e90b7dc0-02bc-4dc5-ab1d-33b95f41c14c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c9ebe6c0>]}
[0m21:26:07.432775 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:26:07.664137 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m21:26:08.754255 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:26:08.755003 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:26:08.819067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e90b7dc0-02bc-4dc5-ab1d-33b95f41c14c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c9c19430>]}
[0m21:26:09.005594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e90b7dc0-02bc-4dc5-ab1d-33b95f41c14c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c909e150>]}
[0m21:26:09.007308 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m21:26:09.009125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e90b7dc0-02bc-4dc5-ab1d-33b95f41c14c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c9940a70>]}
[0m21:26:09.012706 [info ] [MainThread]: 
[0m21:26:09.014382 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:26:09.023766 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m21:26:09.024796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:09.371030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m21:26:09.372387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:09.673377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e90b7dc0-02bc-4dc5-ab1d-33b95f41c14c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c9c1b1d0>]}
[0m21:26:09.674751 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:26:09.676004 [info ] [MainThread]: 
[0m21:26:09.687181 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m21:26:09.688362 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m21:26:09.689419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m21:26:09.690367 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m21:26:09.703766 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m21:26:09.715063 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m21:26:09.741038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:10.108757 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m21:26:10.120551 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m21:26:10.331963 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:166c24ae-b6d8-498a-99b3-a059952731c2&page=queryresults
[0m21:26:11.904054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e90b7dc0-02bc-4dc5-ab1d-33b95f41c14c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c9bf4560>]}
[0m21:26:11.905412 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.21s]
[0m21:26:11.907054 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m21:26:11.908749 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m21:26:11.910837 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m21:26:11.912950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m21:26:11.914423 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m21:26:11.940993 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m21:26:11.953481 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m21:26:12.065099 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m21:26:12.077902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:12.121865 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted, ':00') as datetime) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted, ':00') as datetime) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60;


[0m21:26:12.469211 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:6ffa823a-941b-4a2a-a0f9-902178d140d0&page=queryresults
[0m21:26:12.617257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e90b7dc0-02bc-4dc5-ab1d-33b95f41c14c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4ee090200>]}
[0m21:26:12.619167 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 0.70s]
[0m21:26:12.621449 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m21:26:12.624150 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m21:26:12.625300 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m21:26:12.626669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m21:26:12.627607 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m21:26:12.635056 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m21:26:12.647738 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m21:26:12.652325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:12.976285 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m21:26:12.986329 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.flight_month,
    flight_data.dep_time,
    flight_data.arr_time,
    
    case
        when flight_data.arr_time >= flight_data.dep_time then 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE)
        else 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE) + 1440
    end
 as airtime,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m21:26:13.419720 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:47aeb385-c438-485e-8314-b86c44f875cd&page=queryresults
[0m21:26:17.718090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e90b7dc0-02bc-4dc5-ab1d-33b95f41c14c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c8f47740>]}
[0m21:26:17.720126 [info ] [Thread-1 (]: 3 of 10 OK created sql table model db_project_dataset.core_flights ............. [[32mCREATE TABLE (112.3m rows, 11.7 GiB processed)[0m in 5.09s]
[0m21:26:17.722316 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m21:26:17.725891 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m21:26:17.727782 [info ] [Thread-1 (]: 4 of 10 START sql table model db_project_dataset.dim_carriers .................. [RUN]
[0m21:26:17.729763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.core_flights, now model.flights_project.dim_carriers)
[0m21:26:17.731263 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_carriers
[0m21:26:17.738990 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_carriers"
[0m21:26:17.750355 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_carriers
[0m21:26:17.757000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:18.079263 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_carriers"
[0m21:26:18.091491 [debug] [Thread-1 (]: On model.flights_project.dim_carriers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_carriers"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_carriers`
      
    
    

    OPTIONS()
    as (
      

select distinct 
    carrier_code,
    carrier_desc
from `db-project-456518`.`db_project_dataset`.`core_flights`
    );
  
[0m21:26:18.306150 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:05f8eadf-9791-4b54-a5c2-a8a624d935d7&page=queryresults
[0m21:26:19.867438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e90b7dc0-02bc-4dc5-ab1d-33b95f41c14c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c8e5f7a0>]}
[0m21:26:19.869252 [info ] [Thread-1 (]: 4 of 10 OK created sql table model db_project_dataset.dim_carriers ............. [[32mCREATE TABLE (29.0 rows, 3.9 GiB processed)[0m in 2.14s]
[0m21:26:19.871471 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m21:26:19.873700 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m21:26:19.875824 [info ] [Thread-1 (]: 5 of 10 START sql table model db_project_dataset.dim_dates ..................... [RUN]
[0m21:26:19.878039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_carriers, now model.flights_project.dim_dates)
[0m21:26:19.880216 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_dates
[0m21:26:19.890109 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_dates"
[0m21:26:19.902457 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_dates
[0m21:26:19.911214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:20.272606 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_dates"
[0m21:26:20.280948 [debug] [Thread-1 (]: On model.flights_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_dates"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_dates`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select distinct flight_date
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)

select 
    flight_date,
    extract(year from flight_date) as year,
    extract(quarter from flight_date) as quarter,
    extract(month from flight_date) as month,
    extract(day from flight_date) as day,
    extract(week from flight_date) as week,
    extract(dayofweek from flight_date) as day_of_week,
    case 
    when extract(dayofweek from flight_date) in (1, 7) then 'Weekend' 
    else 'Weekday' 
    end as day_type
from flight_data
    );
  
[0m21:26:20.474587 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:95b3be48-2fee-4a3b-b983-7d7a125a486b&page=queryresults
[0m21:26:21.986141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e90b7dc0-02bc-4dc5-ab1d-33b95f41c14c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c8d7fe90>]}
[0m21:26:21.987842 [info ] [Thread-1 (]: 5 of 10 OK created sql table model db_project_dataset.dim_dates ................ [[32mCREATE TABLE (7.4k rows, 857.0 MiB processed)[0m in 2.11s]
[0m21:26:21.989826 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m21:26:21.991061 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m21:26:21.992336 [info ] [Thread-1 (]: 6 of 10 START sql table model db_project_dataset.fact_delays_by_flight_num ..... [RUN]
[0m21:26:21.994101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_dates, now model.flights_project.fact_delays_by_flight_num)
[0m21:26:21.995516 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_by_flight_num
[0m21:26:22.002121 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_by_flight_num"
[0m21:26:22.011099 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_by_flight_num
[0m21:26:22.021439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:22.338773 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_by_flight_num"
[0m21:26:22.390776 [debug] [Thread-1 (]: On model.flights_project.fact_delays_by_flight_num: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_by_flight_num"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_delays_by_flight_num`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where arr_delay > 0 or dep_delay > 0
)

select 
    flight_num,
    count(*) as total_flights_with_delays,
    sum(dep_delay) as total_dep_delay,
    sum(arr_delay) as total_arr_delay,
    avg(dep_delay) as avg_dep_delay,
    avg(arr_delay) as avg_arr_delay,
    min(dep_delay) as min_dep_delay,
    min(arr_delay) as min_arr_delay,
    max(dep_delay) as max_dep_delay,
    max(arr_delay) as max_arr_delay
from flight_data
group by flight_num
    );
  
[0m21:26:22.602934 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e1e06e09-7d86-4ac3-9420-0a437e9f264b&page=queryresults
[0m21:26:24.178454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e90b7dc0-02bc-4dc5-ab1d-33b95f41c14c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c8d7dc40>]}
[0m21:26:24.180360 [info ] [Thread-1 (]: 6 of 10 OK created sql table model db_project_dataset.fact_delays_by_flight_num  [[32mCREATE TABLE (8.1k rows, 2.5 GiB processed)[0m in 2.18s]
[0m21:26:24.182315 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m21:26:24.183772 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m21:26:24.185273 [info ] [Thread-1 (]: 7 of 10 START sql table model db_project_dataset.fact_delays_departure_by_airport  [RUN]
[0m21:26:24.187714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_delays_by_flight_num, now model.flights_project.fact_delays_departure_by_airport)
[0m21:26:24.189536 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_departure_by_airport
[0m21:26:24.198582 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_departure_by_airport"
[0m21:26:24.208961 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_departure_by_airport
[0m21:26:24.216278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:24.569537 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_departure_by_airport"
[0m21:26:24.578364 [debug] [Thread-1 (]: On model.flights_project.fact_delays_departure_by_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_departure_by_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_delays_departure_by_airport`
      
    
    

    OPTIONS()
    as (
      

with delayed_departures as (
    select 
        dep_airport, 
        delay_status
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where dep_delay is not null
)

select 
    dep_airport,
    delay_status, 
    count(*) AS delay_count
from delayed_departures
group by dep_airport, delay_status
order by delay_count desc
    );
  
[0m21:26:24.772710 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:ffe51e43-af45-4484-8c4c-d56688f8cee4&page=queryresults
[0m21:26:26.321632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e90b7dc0-02bc-4dc5-ab1d-33b95f41c14c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c8d72f00>]}
[0m21:26:26.325830 [info ] [Thread-1 (]: 7 of 10 OK created sql table model db_project_dataset.fact_delays_departure_by_airport  [[32mCREATE TABLE (1.3k rows, 4.1 GiB processed)[0m in 2.13s]
[0m21:26:26.335765 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m21:26:26.337972 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures.by_year
[0m21:26:26.342645 [info ] [Thread-1 (]: 8 of 10 START sql table model db_project_dataset.fact_departures.by_year ....... [RUN]
[0m21:26:26.345209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_delays_departure_by_airport, now model.flights_project.fact_departures.by_year)
[0m21:26:26.347341 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures.by_year
[0m21:26:26.360376 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures.by_year"
[0m21:26:26.379803 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures.by_year
[0m21:26:26.389955 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures.by_year"
[0m21:26:26.403383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:26.461203 [debug] [Thread-1 (]: On model.flights_project.fact_departures.by_year: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures.by_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures.by_year`
      
    
    

    OPTIONS()
    as (
      

select
    extract(year from f.flight_date) as year,
    count(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
group by year
order by year
    );
  
[0m21:26:26.723950 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:a3d57bbe-f630-4b2d-9da6-4107ab2eb24f&page=queryresults
[0m21:26:26.728273 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.; reason: invalid, location: db-project-456518.db_project_dataset.fact_departures.by_year, message: Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.")
[0m21:26:26.895887 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:b17c5fbe-359d-435b-998b-19bf2c87d68c&page=queryresults
[0m21:26:26.898520 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:b17c5fbe-359d-435b-998b-19bf2c87d68c&page=queryresults
[0m21:26:26.907630 [debug] [Thread-1 (]: Database Error in model fact_departures.by_year (models/marts/fact_departures.by_year.sql)
  Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/flights_project/models/marts/fact_departures.by_year.sql
[0m21:26:26.908995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e90b7dc0-02bc-4dc5-ab1d-33b95f41c14c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c8d70140>]}
[0m21:26:26.913733 [error] [Thread-1 (]: 8 of 10 ERROR creating sql table model db_project_dataset.fact_departures.by_year  [[31mERROR[0m in 0.56s]
[0m21:26:26.915307 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures.by_year
[0m21:26:26.916460 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m21:26:26.918596 [info ] [Thread-1 (]: 9 of 10 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m21:26:26.920124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures.by_year, now model.flights_project.fact_departures_by_airport_year)
[0m21:26:26.921533 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m21:26:26.930213 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m21:26:26.942486 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m21:26:26.957320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:27.280447 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m21:26:27.295308 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    count(*) as num_departures
from flights_data
group by origin
    );
  
[0m21:26:27.484252 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:5da59d45-f6c8-47aa-bb8c-17f7271b3a3a&page=queryresults
[0m21:26:29.020278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e90b7dc0-02bc-4dc5-ab1d-33b95f41c14c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c8d2ccb0>]}
[0m21:26:29.022063 [info ] [Thread-1 (]: 9 of 10 OK created sql table model db_project_dataset.fact_departures_by_airport_year  [[32mCREATE TABLE (343.0 rows, 535.6 MiB processed)[0m in 2.10s]
[0m21:26:29.024136 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m21:26:29.025687 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m21:26:29.027460 [info ] [Thread-1 (]: 10 of 10 START sql table model db_project_dataset.fact_most_departures_airport . [RUN]
[0m21:26:29.028986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures_by_airport_year, now model.flights_project.fact_most_departures_airport)
[0m21:26:29.030181 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_most_departures_airport
[0m21:26:29.037144 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_most_departures_airport"
[0m21:26:29.051153 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_most_departures_airport
[0m21:26:29.065663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:29.359692 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_most_departures_airport"
[0m21:26:29.372349 [debug] [Thread-1 (]: On model.flights_project.fact_most_departures_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_most_departures_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_most_departures_airport`
      
    
    

    OPTIONS()
    as (
      

select
    a.airport_name,
    a.city,
    a.state,
    COUNT(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
join `db-project-456518`.`db_project_dataset`.`dim_airports` a on f.dep_airport = a.airport_name
group by airport_name, a.city, a.state
order by num_departures desc
    );
  
[0m21:26:29.598371 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:71b727c1-fa38-4463-a6ec-b4881a1df553&page=queryresults
[0m21:26:31.200230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e90b7dc0-02bc-4dc5-ab1d-33b95f41c14c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c91ce7b0>]}
[0m21:26:31.204605 [info ] [Thread-1 (]: 10 of 10 OK created sql table model db_project_dataset.fact_most_departures_airport  [[32mCREATE TABLE (352.0 rows, 2.7 GiB processed)[0m in 2.17s]
[0m21:26:31.209395 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m21:26:31.212838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:26:31.213818 [debug] [MainThread]: Connection 'model.flights_project.fact_most_departures_airport' was properly closed.
[0m21:26:31.215111 [info ] [MainThread]: 
[0m21:26:31.216362 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 22.20 seconds (22.20s).
[0m21:26:31.226178 [debug] [MainThread]: Command end result
[0m21:26:31.370697 [info ] [MainThread]: 
[0m21:26:31.372249 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:26:31.373271 [info ] [MainThread]: 
[0m21:26:31.374444 [error] [MainThread]:   Database Error in model fact_departures.by_year (models/marts/fact_departures.by_year.sql)
  Invalid project ID 'db-project-456518.db_project_dataset'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/flights_project/models/marts/fact_departures.by_year.sql
[0m21:26:31.375700 [info ] [MainThread]: 
[0m21:26:31.376654 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m21:26:31.378258 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 25.459532, "process_user_time": 6.395954, "process_kernel_time": 0.789624, "process_mem_max_rss": "256308", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:26:31.379220 [debug] [MainThread]: Command `dbt run` failed at 21:26:31.379069 after 25.46 seconds
[0m21:26:31.380065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4f0a17230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4efec6660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4ed56a780>]}
[0m21:26:31.380974 [debug] [MainThread]: Flushing usage events
[0m21:27:56.107369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff704c73bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff704c71640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff704c706e0>]}


============================== 21:27:56.118812 | 33e67234-bd06-4fed-b00b-b3bdc92e2dd1 ==============================
[0m21:27:56.118812 [info ] [MainThread]: Running with dbt=1.8.1
[0m21:27:56.120814 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:27:57.925532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33e67234-bd06-4fed-b00b-b3bdc92e2dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6e0ec9fa0>]}
[0m21:27:58.007343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33e67234-bd06-4fed-b00b-b3bdc92e2dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6e18b0f80>]}
[0m21:27:58.009127 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:27:58.246378 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m21:28:00.356544 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m21:28:00.360506 [debug] [MainThread]: Partial parsing: added file: flights_project://models/marts/fact_departures_yearly.sql
[0m21:28:00.364296 [debug] [MainThread]: Partial parsing: deleted file: flights_project://models/marts/fact_departures.by_year.sql
[0m21:28:01.197245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33e67234-bd06-4fed-b00b-b3bdc92e2dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6e0aba150>]}
[0m21:28:01.485679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33e67234-bd06-4fed-b00b-b3bdc92e2dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6e0ab7050>]}
[0m21:28:01.487152 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m21:28:01.488502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33e67234-bd06-4fed-b00b-b3bdc92e2dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6e0ab72f0>]}
[0m21:28:01.492974 [info ] [MainThread]: 
[0m21:28:01.494527 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:28:01.503072 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m21:28:01.504330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:01.961192 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m21:28:01.962527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:28:02.374469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33e67234-bd06-4fed-b00b-b3bdc92e2dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff704a47b60>]}
[0m21:28:02.377698 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:28:02.381490 [info ] [MainThread]: 
[0m21:28:02.409749 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m21:28:02.411838 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m21:28:02.417968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m21:28:02.421178 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m21:28:02.450524 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m21:28:02.459680 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m21:28:02.492483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:28:02.885070 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m21:28:02.899436 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m21:28:03.118583 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:18cd6658-83cd-41d7-84b7-b2c5e066b5ff&page=queryresults
[0m21:28:04.767799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33e67234-bd06-4fed-b00b-b3bdc92e2dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6e0b702f0>]}
[0m21:28:04.769489 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.35s]
[0m21:28:04.771130 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m21:28:04.773282 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m21:28:04.775958 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m21:28:04.778495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m21:28:04.779929 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m21:28:04.823098 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m21:28:04.831769 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m21:28:04.871237 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m21:28:04.879971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:28:04.922537 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted, ':00') as datetime) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted, ':00') as datetime) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60;


[0m21:28:05.287669 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:249ebec3-97e2-4e68-9806-c499e39e0acd&page=queryresults
[0m21:28:05.421690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33e67234-bd06-4fed-b00b-b3bdc92e2dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6e0a8ed20>]}
[0m21:28:05.423995 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 0.64s]
[0m21:28:05.426714 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m21:28:05.429703 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m21:28:05.433318 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m21:28:05.434957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m21:28:05.436339 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m21:28:05.452405 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m21:28:05.471164 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m21:28:05.498462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:28:05.877720 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m21:28:05.889155 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.flight_month,
    flight_data.dep_time,
    flight_data.arr_time,
    
    case
        when flight_data.arr_time >= flight_data.dep_time then 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE)
        else 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE) + 1440
    end
 as airtime,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m21:28:06.360786 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:191e1ab8-e758-4c45-b9ad-4aaaf791c3ba&page=queryresults
[0m21:28:10.994038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33e67234-bd06-4fed-b00b-b3bdc92e2dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6e0a9f9b0>]}
[0m21:28:10.995943 [info ] [Thread-1 (]: 3 of 10 OK created sql table model db_project_dataset.core_flights ............. [[32mCREATE TABLE (112.3m rows, 11.7 GiB processed)[0m in 5.56s]
[0m21:28:10.997763 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m21:28:11.000653 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m21:28:11.002032 [info ] [Thread-1 (]: 4 of 10 START sql table model db_project_dataset.dim_carriers .................. [RUN]
[0m21:28:11.003316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.core_flights, now model.flights_project.dim_carriers)
[0m21:28:11.004581 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_carriers
[0m21:28:11.012074 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_carriers"
[0m21:28:11.021502 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_carriers
[0m21:28:11.025571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:28:11.484170 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_carriers"
[0m21:28:11.501502 [debug] [Thread-1 (]: On model.flights_project.dim_carriers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_carriers"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_carriers`
      
    
    

    OPTIONS()
    as (
      

select distinct 
    carrier_code,
    carrier_desc
from `db-project-456518`.`db_project_dataset`.`core_flights`
    );
  
[0m21:28:11.700907 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c229db14-f09d-432a-9009-d43fa2d0be92&page=queryresults
[0m21:28:13.257853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33e67234-bd06-4fed-b00b-b3bdc92e2dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7046393d0>]}
[0m21:28:13.259258 [info ] [Thread-1 (]: 4 of 10 OK created sql table model db_project_dataset.dim_carriers ............. [[32mCREATE TABLE (29.0 rows, 3.9 GiB processed)[0m in 2.25s]
[0m21:28:13.260780 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m21:28:13.262027 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m21:28:13.263446 [info ] [Thread-1 (]: 5 of 10 START sql table model db_project_dataset.dim_dates ..................... [RUN]
[0m21:28:13.265054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_carriers, now model.flights_project.dim_dates)
[0m21:28:13.270483 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_dates
[0m21:28:13.280800 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_dates"
[0m21:28:13.295325 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_dates
[0m21:28:13.306397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:28:13.657461 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_dates"
[0m21:28:13.669541 [debug] [Thread-1 (]: On model.flights_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_dates"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_dates`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select distinct flight_date
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)

select 
    flight_date,
    extract(year from flight_date) as year,
    extract(quarter from flight_date) as quarter,
    extract(month from flight_date) as month,
    extract(day from flight_date) as day,
    extract(week from flight_date) as week,
    extract(dayofweek from flight_date) as day_of_week,
    case 
    when extract(dayofweek from flight_date) in (1, 7) then 'Weekend' 
    else 'Weekday' 
    end as day_type
from flight_data
    );
  
[0m21:28:13.844598 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:118d9188-753e-468c-b53a-c7a7f4dfdb84&page=queryresults
[0m21:28:15.393317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33e67234-bd06-4fed-b00b-b3bdc92e2dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7049fc770>]}
[0m21:28:15.394687 [info ] [Thread-1 (]: 5 of 10 OK created sql table model db_project_dataset.dim_dates ................ [[32mCREATE TABLE (7.4k rows, 857.0 MiB processed)[0m in 2.13s]
[0m21:28:15.396060 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m21:28:15.397191 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m21:28:15.398468 [info ] [Thread-1 (]: 6 of 10 START sql table model db_project_dataset.fact_delays_by_flight_num ..... [RUN]
[0m21:28:15.399812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_dates, now model.flights_project.fact_delays_by_flight_num)
[0m21:28:15.400994 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_by_flight_num
[0m21:28:15.408313 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_by_flight_num"
[0m21:28:15.417748 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_by_flight_num
[0m21:28:15.422388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:28:15.735221 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_by_flight_num"
[0m21:28:15.751349 [debug] [Thread-1 (]: On model.flights_project.fact_delays_by_flight_num: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_by_flight_num"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_delays_by_flight_num`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where arr_delay > 0 or dep_delay > 0
)

select 
    flight_num,
    count(*) as total_flights_with_delays,
    sum(dep_delay) as total_dep_delay,
    sum(arr_delay) as total_arr_delay,
    avg(dep_delay) as avg_dep_delay,
    avg(arr_delay) as avg_arr_delay,
    min(dep_delay) as min_dep_delay,
    min(arr_delay) as min_arr_delay,
    max(dep_delay) as max_dep_delay,
    max(arr_delay) as max_arr_delay
from flight_data
group by flight_num
    );
  
[0m21:28:15.939160 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c4d23b3e-b7b1-4969-98c2-4e9f7ee546f0&page=queryresults
[0m21:28:17.491309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33e67234-bd06-4fed-b00b-b3bdc92e2dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6e010a3f0>]}
[0m21:28:17.493065 [info ] [Thread-1 (]: 6 of 10 OK created sql table model db_project_dataset.fact_delays_by_flight_num  [[32mCREATE TABLE (8.1k rows, 2.5 GiB processed)[0m in 2.09s]
[0m21:28:17.494998 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m21:28:17.496755 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_departure_by_airport
[0m21:28:17.500372 [info ] [Thread-1 (]: 7 of 10 START sql table model db_project_dataset.fact_delays_departure_by_airport  [RUN]
[0m21:28:17.502689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_delays_by_flight_num, now model.flights_project.fact_delays_departure_by_airport)
[0m21:28:17.504990 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_departure_by_airport
[0m21:28:17.514742 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_departure_by_airport"
[0m21:28:17.528225 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_departure_by_airport
[0m21:28:17.544461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:28:17.955628 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_departure_by_airport"
[0m21:28:17.968698 [debug] [Thread-1 (]: On model.flights_project.fact_delays_departure_by_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_departure_by_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_delays_departure_by_airport`
      
    
    

    OPTIONS()
    as (
      

with delayed_departures as (
    select 
        dep_airport, 
        delay_status
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where dep_delay is not null
)

select 
    dep_airport,
    delay_status, 
    count(*) AS delay_count
from delayed_departures
group by dep_airport, delay_status
order by delay_count desc
    );
  
[0m21:28:18.150750 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:5a2c463b-2ff1-4faf-9f6d-9894e8922eb5&page=queryresults
[0m21:28:19.690286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33e67234-bd06-4fed-b00b-b3bdc92e2dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6e012c680>]}
[0m21:28:19.692087 [info ] [Thread-1 (]: 7 of 10 OK created sql table model db_project_dataset.fact_delays_departure_by_airport  [[32mCREATE TABLE (1.3k rows, 4.1 GiB processed)[0m in 2.19s]
[0m21:28:19.694080 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_departure_by_airport
[0m21:28:19.695616 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m21:28:19.697025 [info ] [Thread-1 (]: 8 of 10 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m21:28:19.698770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_delays_departure_by_airport, now model.flights_project.fact_departures_by_airport_year)
[0m21:28:19.700003 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m21:28:19.708217 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m21:28:19.719397 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m21:28:19.724115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:28:20.036977 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m21:28:20.055388 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    count(*) as num_departures
from flights_data
group by origin
    );
  
[0m21:28:20.255612 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:5664ec0a-3b77-4794-b63d-83c89eaf990d&page=queryresults
[0m21:28:21.768007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33e67234-bd06-4fed-b00b-b3bdc92e2dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6e0b7f5f0>]}
[0m21:28:21.770852 [info ] [Thread-1 (]: 8 of 10 OK created sql table model db_project_dataset.fact_departures_by_airport_year  [[32mCREATE TABLE (343.0 rows, 535.6 MiB processed)[0m in 2.07s]
[0m21:28:21.772772 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m21:28:21.773814 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_yearly
[0m21:28:21.774876 [info ] [Thread-1 (]: 9 of 10 START sql table model db_project_dataset.fact_departures_yearly ........ [RUN]
[0m21:28:21.776242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures_by_airport_year, now model.flights_project.fact_departures_yearly)
[0m21:28:21.779055 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_yearly
[0m21:28:21.787117 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_yearly"
[0m21:28:21.795325 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_yearly
[0m21:28:21.801750 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_yearly"
[0m21:28:21.809570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:28:21.853285 [debug] [Thread-1 (]: On model.flights_project.fact_departures_yearly: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_yearly"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_yearly`
      
    
    

    OPTIONS()
    as (
      

select
    extract(year from f.flight_date) as year,
    count(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
group by year
order by year
    );
  
[0m21:28:22.211367 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:0bdaeac3-b659-441b-bf8b-720c043af5ec&page=queryresults
[0m21:28:23.742548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33e67234-bd06-4fed-b00b-b3bdc92e2dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6e0b7d5b0>]}
[0m21:28:23.744701 [info ] [Thread-1 (]: 9 of 10 OK created sql table model db_project_dataset.fact_departures_yearly ... [[32mCREATE TABLE (21.0 rows, 857.0 MiB processed)[0m in 1.97s]
[0m21:28:23.747206 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_yearly
[0m21:28:23.751752 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m21:28:23.757321 [info ] [Thread-1 (]: 10 of 10 START sql table model db_project_dataset.fact_most_departures_airport . [RUN]
[0m21:28:23.760667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures_yearly, now model.flights_project.fact_most_departures_airport)
[0m21:28:23.764036 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_most_departures_airport
[0m21:28:23.773982 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_most_departures_airport"
[0m21:28:23.787360 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_most_departures_airport
[0m21:28:23.792736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:28:24.156653 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_most_departures_airport"
[0m21:28:24.172638 [debug] [Thread-1 (]: On model.flights_project.fact_most_departures_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_most_departures_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_most_departures_airport`
      
    
    

    OPTIONS()
    as (
      

select
    a.airport_name,
    a.city,
    a.state,
    COUNT(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
join `db-project-456518`.`db_project_dataset`.`dim_airports` a on f.dep_airport = a.airport_name
group by airport_name, a.city, a.state
order by num_departures desc
    );
  
[0m21:28:24.375980 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:542a70ed-131f-4936-80f2-9671d5b190ec&page=queryresults
[0m21:28:25.892759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33e67234-bd06-4fed-b00b-b3bdc92e2dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6e00edee0>]}
[0m21:28:25.894595 [info ] [Thread-1 (]: 10 of 10 OK created sql table model db_project_dataset.fact_most_departures_airport  [[32mCREATE TABLE (352.0 rows, 2.7 GiB processed)[0m in 2.13s]
[0m21:28:25.896264 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m21:28:25.900397 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:28:25.901477 [debug] [MainThread]: Connection 'model.flights_project.fact_most_departures_airport' was properly closed.
[0m21:28:25.902544 [info ] [MainThread]: 
[0m21:28:25.903526 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 24.41 seconds (24.41s).
[0m21:28:25.907155 [debug] [MainThread]: Command end result
[0m21:28:26.004305 [info ] [MainThread]: 
[0m21:28:26.005536 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:28:26.006634 [info ] [MainThread]: 
[0m21:28:26.007994 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m21:28:26.010029 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 30.023348, "process_user_time": 8.508645, "process_kernel_time": 1.035556, "process_mem_max_rss": "257944", "process_in_blocks": "1264", "process_out_blocks": "0"}
[0m21:28:26.011223 [debug] [MainThread]: Command `dbt run` succeeded at 21:28:26.011058 after 30.02 seconds
[0m21:28:26.012292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7049f82c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7049f7f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6e0a8d2e0>]}
[0m21:28:26.013365 [debug] [MainThread]: Flushing usage events
[0m21:55:33.520735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87d06a36b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87d0bae840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87d0d45eb0>]}


============================== 21:55:33.537611 | 000ffd91-cf73-44ca-974d-f6470f69e983 ==============================
[0m21:55:33.537611 [info ] [MainThread]: Running with dbt=1.8.1
[0m21:55:33.539315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:55:35.143904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '000ffd91-cf73-44ca-974d-f6470f69e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b093c170>]}
[0m21:55:35.247498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '000ffd91-cf73-44ca-974d-f6470f69e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b093deb0>]}
[0m21:55:35.249759 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:55:35.599066 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m21:55:38.778070 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m21:55:38.779371 [debug] [MainThread]: Partial parsing: added file: flights_project://models/marts/fact_departure_delays_by_airport.sql
[0m21:55:38.780425 [debug] [MainThread]: Partial parsing: deleted file: flights_project://models/marts/fact_delays_departure_by_airport.sql
[0m21:55:39.196625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '000ffd91-cf73-44ca-974d-f6470f69e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87abcf2720>]}
[0m21:55:39.496340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '000ffd91-cf73-44ca-974d-f6470f69e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b0115550>]}
[0m21:55:39.498071 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m21:55:39.499615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '000ffd91-cf73-44ca-974d-f6470f69e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87abcf2d50>]}
[0m21:55:39.504165 [info ] [MainThread]: 
[0m21:55:39.506000 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:55:39.516485 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m21:55:39.517739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:40.008233 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m21:55:40.009894 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:40.359313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '000ffd91-cf73-44ca-974d-f6470f69e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b05d1cd0>]}
[0m21:55:40.360935 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:55:40.362163 [info ] [MainThread]: 
[0m21:55:40.377806 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m21:55:40.379517 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m21:55:40.380848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m21:55:40.381956 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m21:55:40.400083 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m21:55:40.411294 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m21:55:40.440900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:40.808768 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m21:55:40.821734 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m21:55:41.074501 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e5be7c08-929a-4209-b87a-4e7ad99d89d6&page=queryresults
[0m21:55:42.754585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '000ffd91-cf73-44ca-974d-f6470f69e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87abd71580>]}
[0m21:55:42.756200 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.37s]
[0m21:55:42.757697 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m21:55:42.758859 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m21:55:42.759928 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m21:55:42.761278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m21:55:42.762670 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m21:55:42.793925 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m21:55:42.808774 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m21:55:42.847361 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m21:55:42.858185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:42.903970 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted, ':00') as datetime) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted, ':00') as datetime) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60;


[0m21:55:43.275941 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:d44db781-2b40-4b10-b04b-38bbcf5a19f1&page=queryresults
[0m21:55:43.483129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '000ffd91-cf73-44ca-974d-f6470f69e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b03db6b0>]}
[0m21:55:43.484957 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 0.72s]
[0m21:55:43.486819 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m21:55:43.488965 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m21:55:43.490081 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m21:55:43.491264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m21:55:43.492301 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m21:55:43.504125 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m21:55:43.516574 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m21:55:43.525676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:43.865695 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m21:55:43.877611 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.flight_month,
    flight_data.dep_time,
    flight_data.arr_time,
    
    case
        when flight_data.arr_time >= flight_data.dep_time then 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE)
        else 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE) + 1440
    end
 as airtime,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m21:55:44.349547 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:8ade8b9a-f7dd-4625-9b72-34cf5efc6876&page=queryresults
[0m21:55:49.672829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '000ffd91-cf73-44ca-974d-f6470f69e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87abcb8a70>]}
[0m21:55:49.674838 [info ] [Thread-1 (]: 3 of 10 OK created sql table model db_project_dataset.core_flights ............. [[32mCREATE TABLE (112.3m rows, 11.7 GiB processed)[0m in 6.18s]
[0m21:55:49.676482 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m21:55:49.679104 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m21:55:49.680699 [info ] [Thread-1 (]: 4 of 10 START sql table model db_project_dataset.dim_carriers .................. [RUN]
[0m21:55:49.682110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.core_flights, now model.flights_project.dim_carriers)
[0m21:55:49.683041 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_carriers
[0m21:55:49.692602 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_carriers"
[0m21:55:49.703755 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_carriers
[0m21:55:49.708880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:50.041250 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_carriers"
[0m21:55:50.053731 [debug] [Thread-1 (]: On model.flights_project.dim_carriers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_carriers"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_carriers`
      
    
    

    OPTIONS()
    as (
      

select distinct 
    carrier_code,
    carrier_desc
from `db-project-456518`.`db_project_dataset`.`core_flights`
    );
  
[0m21:55:50.286384 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e3b617cd-f895-42fb-8c34-82770fbf6910&page=queryresults
[0m21:55:51.853312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '000ffd91-cf73-44ca-974d-f6470f69e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87cf95b860>]}
[0m21:55:51.855283 [info ] [Thread-1 (]: 4 of 10 OK created sql table model db_project_dataset.dim_carriers ............. [[32mCREATE TABLE (29.0 rows, 3.9 GiB processed)[0m in 2.17s]
[0m21:55:51.857399 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m21:55:51.858547 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m21:55:51.860211 [info ] [Thread-1 (]: 5 of 10 START sql table model db_project_dataset.dim_dates ..................... [RUN]
[0m21:55:51.861399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_carriers, now model.flights_project.dim_dates)
[0m21:55:51.863720 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_dates
[0m21:55:51.870592 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_dates"
[0m21:55:51.882569 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_dates
[0m21:55:51.887297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:52.233246 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_dates"
[0m21:55:52.289724 [debug] [Thread-1 (]: On model.flights_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_dates"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_dates`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select distinct flight_date
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)

select 
    flight_date,
    extract(year from flight_date) as year,
    extract(quarter from flight_date) as quarter,
    extract(month from flight_date) as month,
    extract(day from flight_date) as day,
    extract(week from flight_date) as week,
    extract(dayofweek from flight_date) as day_of_week,
    case 
    when extract(dayofweek from flight_date) in (1, 7) then 'Weekend' 
    else 'Weekday' 
    end as day_type
from flight_data
    );
  
[0m21:55:52.485232 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:d6410b87-56cf-4345-bd9b-60c441240e01&page=queryresults
[0m21:55:54.010537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '000ffd91-cf73-44ca-974d-f6470f69e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87d2605580>]}
[0m21:55:54.011984 [info ] [Thread-1 (]: 5 of 10 OK created sql table model db_project_dataset.dim_dates ................ [[32mCREATE TABLE (7.4k rows, 857.0 MiB processed)[0m in 2.15s]
[0m21:55:54.013458 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m21:55:54.014591 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m21:55:54.015969 [info ] [Thread-1 (]: 6 of 10 START sql table model db_project_dataset.fact_delays_by_flight_num ..... [RUN]
[0m21:55:54.017266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_dates, now model.flights_project.fact_delays_by_flight_num)
[0m21:55:54.018322 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_by_flight_num
[0m21:55:54.024332 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_by_flight_num"
[0m21:55:54.036454 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_by_flight_num
[0m21:55:54.042395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:54.346443 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_by_flight_num"
[0m21:55:54.359040 [debug] [Thread-1 (]: On model.flights_project.fact_delays_by_flight_num: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_by_flight_num"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_delays_by_flight_num`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where arr_delay > 0 or dep_delay > 0
)

select 
    flight_num,
    count(*) as total_flights_with_delays,
    sum(dep_delay) as total_dep_delay,
    sum(arr_delay) as total_arr_delay,
    avg(dep_delay) as avg_dep_delay,
    avg(arr_delay) as avg_arr_delay,
    min(dep_delay) as min_dep_delay,
    min(arr_delay) as min_arr_delay,
    max(dep_delay) as max_dep_delay,
    max(arr_delay) as max_arr_delay
from flight_data
group by flight_num
    );
  
[0m21:55:54.561776 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:f94dd69c-5076-4e3d-a847-acbba1b36ce5&page=queryresults
[0m21:55:56.104662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '000ffd91-cf73-44ca-974d-f6470f69e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87abcc3260>]}
[0m21:55:56.106792 [info ] [Thread-1 (]: 6 of 10 OK created sql table model db_project_dataset.fact_delays_by_flight_num  [[32mCREATE TABLE (8.1k rows, 2.5 GiB processed)[0m in 2.09s]
[0m21:55:56.108903 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m21:55:56.110184 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departure_delays_by_airport
[0m21:55:56.111732 [info ] [Thread-1 (]: 7 of 10 START sql table model db_project_dataset.fact_departure_delays_by_airport  [RUN]
[0m21:55:56.112964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_delays_by_flight_num, now model.flights_project.fact_departure_delays_by_airport)
[0m21:55:56.113982 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departure_delays_by_airport
[0m21:55:56.119341 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departure_delays_by_airport"
[0m21:55:56.132151 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departure_delays_by_airport
[0m21:55:56.140947 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departure_delays_by_airport"
[0m21:55:56.152177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:56.196124 [debug] [Thread-1 (]: On model.flights_project.fact_departure_delays_by_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departure_delays_by_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departure_delays_by_airport`
      
    
    

    OPTIONS()
    as (
      

with delayed_departures as (
    select 
        dep_airport, 
        dep_delay,
        arr_delay
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where dep_delay is not null
)

select 
    dep_airport,
    delay_status,
    arr_delay,
    count(*) AS delay_count
from delayed_departures
group by dep_airport, delay_status
order by delay_count desc
    );
  
[0m21:55:56.550193 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:ae02a44e-a739-44d4-b449-f5043068e57a&page=queryresults
[0m21:55:56.659474 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: delay_status at [26:5]; reason: invalidQuery, location: query, message: Unrecognized name: delay_status at [26:5]')
[0m21:55:56.997449 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:f27f2019-7a6e-43c8-bdec-1b99ecd1fdaf&page=queryresults
[0m21:55:57.112122 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:f27f2019-7a6e-43c8-bdec-1b99ecd1fdaf&page=queryresults
[0m21:55:57.121315 [debug] [Thread-1 (]: Database Error in model fact_departure_delays_by_airport (models/marts/fact_departure_delays_by_airport.sql)
  Unrecognized name: delay_status at [26:5]
  compiled code at target/run/flights_project/models/marts/fact_departure_delays_by_airport.sql
[0m21:55:57.122512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '000ffd91-cf73-44ca-974d-f6470f69e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87aab31bb0>]}
[0m21:55:57.123681 [error] [Thread-1 (]: 7 of 10 ERROR creating sql table model db_project_dataset.fact_departure_delays_by_airport  [[31mERROR[0m in 1.01s]
[0m21:55:57.125035 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departure_delays_by_airport
[0m21:55:57.126047 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m21:55:57.127765 [info ] [Thread-1 (]: 8 of 10 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m21:55:57.129039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departure_delays_by_airport, now model.flights_project.fact_departures_by_airport_year)
[0m21:55:57.130019 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m21:55:57.134910 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m21:55:57.144758 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m21:55:57.148974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:57.459530 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m21:55:57.471007 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    count(*) as num_departures
from flights_data
group by origin
    );
  
[0m21:55:57.669191 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:2108f905-33ed-481a-9623-354ad8d5ebd9&page=queryresults
[0m21:55:59.199184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '000ffd91-cf73-44ca-974d-f6470f69e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b02cc950>]}
[0m21:55:59.201255 [info ] [Thread-1 (]: 8 of 10 OK created sql table model db_project_dataset.fact_departures_by_airport_year  [[32mCREATE TABLE (343.0 rows, 535.6 MiB processed)[0m in 2.07s]
[0m21:55:59.203292 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m21:55:59.205059 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_yearly
[0m21:55:59.206978 [info ] [Thread-1 (]: 9 of 10 START sql table model db_project_dataset.fact_departures_yearly ........ [RUN]
[0m21:55:59.208528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures_by_airport_year, now model.flights_project.fact_departures_yearly)
[0m21:55:59.209745 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_yearly
[0m21:55:59.218167 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_yearly"
[0m21:55:59.230861 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_yearly
[0m21:55:59.235174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:59.537886 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_yearly"
[0m21:55:59.550633 [debug] [Thread-1 (]: On model.flights_project.fact_departures_yearly: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_yearly"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_yearly`
      
    
    

    OPTIONS()
    as (
      

select
    extract(year from f.flight_date) as year,
    count(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
group by year
order by year
    );
  
[0m21:55:59.724196 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:f54da010-72c6-4913-aab7-dc717685f18d&page=queryresults
[0m21:56:01.280342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '000ffd91-cf73-44ca-974d-f6470f69e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87abcc36b0>]}
[0m21:56:01.286611 [info ] [Thread-1 (]: 9 of 10 OK created sql table model db_project_dataset.fact_departures_yearly ... [[32mCREATE TABLE (21.0 rows, 857.0 MiB processed)[0m in 2.07s]
[0m21:56:01.289505 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_yearly
[0m21:56:01.297670 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m21:56:01.299125 [info ] [Thread-1 (]: 10 of 10 START sql table model db_project_dataset.fact_most_departures_airport . [RUN]
[0m21:56:01.300690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures_yearly, now model.flights_project.fact_most_departures_airport)
[0m21:56:01.301911 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_most_departures_airport
[0m21:56:01.308669 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_most_departures_airport"
[0m21:56:01.319088 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_most_departures_airport
[0m21:56:01.325534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:56:01.833780 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_most_departures_airport"
[0m21:56:02.185998 [debug] [Thread-1 (]: On model.flights_project.fact_most_departures_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_most_departures_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_most_departures_airport`
      
    
    

    OPTIONS()
    as (
      

select
    a.airport_name,
    a.city,
    a.state,
    COUNT(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
join `db-project-456518`.`db_project_dataset`.`dim_airports` a on f.dep_airport = a.airport_name
group by airport_name, a.city, a.state
order by num_departures desc
    );
  
[0m21:56:02.404690 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:426bf2a7-5bbb-4c92-ae0b-deb9dcb42b09&page=queryresults
[0m21:56:04.012082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '000ffd91-cf73-44ca-974d-f6470f69e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b0114aa0>]}
[0m21:56:04.014135 [info ] [Thread-1 (]: 10 of 10 OK created sql table model db_project_dataset.fact_most_departures_airport  [[32mCREATE TABLE (352.0 rows, 2.7 GiB processed)[0m in 2.71s]
[0m21:56:04.016343 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m21:56:04.020090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:56:04.021397 [debug] [MainThread]: Connection 'model.flights_project.fact_most_departures_airport' was properly closed.
[0m21:56:04.023337 [info ] [MainThread]: 
[0m21:56:04.024936 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 24.52 seconds (24.52s).
[0m21:56:04.031851 [debug] [MainThread]: Command end result
[0m21:56:04.139541 [info ] [MainThread]: 
[0m21:56:04.140965 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:56:04.142205 [info ] [MainThread]: 
[0m21:56:04.143499 [error] [MainThread]:   Database Error in model fact_departure_delays_by_airport (models/marts/fact_departure_delays_by_airport.sql)
  Unrecognized name: delay_status at [26:5]
  compiled code at target/run/flights_project/models/marts/fact_departure_delays_by_airport.sql
[0m21:56:04.144705 [info ] [MainThread]: 
[0m21:56:04.146146 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m21:56:04.148315 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 30.73739, "process_user_time": 7.739312, "process_kernel_time": 0.813079, "process_mem_max_rss": "259304", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:56:04.149904 [debug] [MainThread]: Command `dbt run` failed at 21:56:04.149693 after 30.74 seconds
[0m21:56:04.150959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87d3a63230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87cff8f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87abe53f20>]}
[0m21:56:04.152306 [debug] [MainThread]: Flushing usage events
[0m21:57:10.858095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee35bd5100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee36f70500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee376069c0>]}


============================== 21:57:10.869015 | 2fadca6a-6c32-48cb-8421-c54d462ce803 ==============================
[0m21:57:10.869015 [info ] [MainThread]: Running with dbt=1.8.1
[0m21:57:10.870645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:57:12.914667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2fadca6a-6c32-48cb-8421-c54d462ce803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee11f78170>]}
[0m21:57:12.991770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2fadca6a-6c32-48cb-8421-c54d462ce803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee1eb80cb0>]}
[0m21:57:12.993031 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:57:13.218469 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m21:57:14.635698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:57:14.636856 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/marts/fact_departure_delays_by_airport.sql
[0m21:57:15.029813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2fadca6a-6c32-48cb-8421-c54d462ce803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee118cbd40>]}
[0m21:57:15.417171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2fadca6a-6c32-48cb-8421-c54d462ce803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee117586b0>]}
[0m21:57:15.419092 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m21:57:15.420602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fadca6a-6c32-48cb-8421-c54d462ce803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee1168b950>]}
[0m21:57:15.425883 [info ] [MainThread]: 
[0m21:57:15.427773 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:57:15.438062 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m21:57:15.439173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:15.890427 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m21:57:15.891560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:57:16.230900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fadca6a-6c32-48cb-8421-c54d462ce803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee353c5f10>]}
[0m21:57:16.232410 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:57:16.234440 [info ] [MainThread]: 
[0m21:57:16.247190 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m21:57:16.248862 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m21:57:16.251699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m21:57:16.252860 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m21:57:16.270752 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m21:57:16.287931 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m21:57:16.314203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:57:16.697943 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m21:57:16.709698 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m21:57:16.923175 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:17b828b4-d863-42f4-a421-f6de754642aa&page=queryresults
[0m21:57:18.250413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fadca6a-6c32-48cb-8421-c54d462ce803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee122906e0>]}
[0m21:57:18.252842 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.00s]
[0m21:57:18.254649 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m21:57:18.256171 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m21:57:18.257489 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m21:57:18.258707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m21:57:18.259752 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m21:57:18.289168 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m21:57:18.305366 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m21:57:18.370575 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m21:57:18.392490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:57:18.454256 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted, ':00') as datetime) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted, ':00') as datetime) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60;


[0m21:57:18.844884 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:94a6fe3e-2ef9-406d-9572-388d444858a6&page=queryresults
[0m21:57:18.977965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fadca6a-6c32-48cb-8421-c54d462ce803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee34fdeed0>]}
[0m21:57:18.979767 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 0.72s]
[0m21:57:18.981970 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m21:57:18.985744 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m21:57:18.988439 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m21:57:18.989967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m21:57:18.991432 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m21:57:19.004965 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m21:57:19.018152 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m21:57:19.027861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:57:19.336740 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m21:57:19.353773 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.flight_month,
    flight_data.dep_time,
    flight_data.arr_time,
    
    case
        when flight_data.arr_time >= flight_data.dep_time then 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE)
        else 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE) + 1440
    end
 as airtime,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m21:57:19.834027 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:0a934e21-9292-4a93-9a6f-3e35b383d633&page=queryresults
[0m21:57:24.403376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fadca6a-6c32-48cb-8421-c54d462ce803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee113f3a40>]}
[0m21:57:24.405041 [info ] [Thread-1 (]: 3 of 10 OK created sql table model db_project_dataset.core_flights ............. [[32mCREATE TABLE (112.3m rows, 11.7 GiB processed)[0m in 5.41s]
[0m21:57:24.406791 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m21:57:24.410011 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m21:57:24.411995 [info ] [Thread-1 (]: 4 of 10 START sql table model db_project_dataset.dim_carriers .................. [RUN]
[0m21:57:24.415336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.core_flights, now model.flights_project.dim_carriers)
[0m21:57:24.416390 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_carriers
[0m21:57:24.425414 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_carriers"
[0m21:57:24.439581 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_carriers
[0m21:57:24.445145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:57:24.748220 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_carriers"
[0m21:57:24.772534 [debug] [Thread-1 (]: On model.flights_project.dim_carriers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_carriers"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_carriers`
      
    
    

    OPTIONS()
    as (
      

select distinct 
    carrier_code,
    carrier_desc
from `db-project-456518`.`db_project_dataset`.`core_flights`
    );
  
[0m21:57:24.959212 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:8ff84f0e-5254-4042-ab8b-e8a594ed5f77&page=queryresults
[0m21:57:26.487983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fadca6a-6c32-48cb-8421-c54d462ce803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee113f3350>]}
[0m21:57:26.489895 [info ] [Thread-1 (]: 4 of 10 OK created sql table model db_project_dataset.dim_carriers ............. [[32mCREATE TABLE (29.0 rows, 3.9 GiB processed)[0m in 2.07s]
[0m21:57:26.491540 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m21:57:26.492830 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m21:57:26.494070 [info ] [Thread-1 (]: 5 of 10 START sql table model db_project_dataset.dim_dates ..................... [RUN]
[0m21:57:26.495367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_carriers, now model.flights_project.dim_dates)
[0m21:57:26.497593 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_dates
[0m21:57:26.502511 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_dates"
[0m21:57:26.512901 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_dates
[0m21:57:26.518721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:57:26.822062 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_dates"
[0m21:57:26.834756 [debug] [Thread-1 (]: On model.flights_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_dates"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_dates`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select distinct flight_date
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)

select 
    flight_date,
    extract(year from flight_date) as year,
    extract(quarter from flight_date) as quarter,
    extract(month from flight_date) as month,
    extract(day from flight_date) as day,
    extract(week from flight_date) as week,
    extract(dayofweek from flight_date) as day_of_week,
    case 
    when extract(dayofweek from flight_date) in (1, 7) then 'Weekend' 
    else 'Weekday' 
    end as day_type
from flight_data
    );
  
[0m21:57:27.074678 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e06728b3-f235-4a5e-8696-5ba323925aa0&page=queryresults
[0m21:57:28.601537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fadca6a-6c32-48cb-8421-c54d462ce803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee114a73b0>]}
[0m21:57:28.603098 [info ] [Thread-1 (]: 5 of 10 OK created sql table model db_project_dataset.dim_dates ................ [[32mCREATE TABLE (7.4k rows, 857.0 MiB processed)[0m in 2.11s]
[0m21:57:28.605075 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m21:57:28.606606 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m21:57:28.608168 [info ] [Thread-1 (]: 6 of 10 START sql table model db_project_dataset.fact_delays_by_flight_num ..... [RUN]
[0m21:57:28.609695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_dates, now model.flights_project.fact_delays_by_flight_num)
[0m21:57:28.610665 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_by_flight_num
[0m21:57:28.615915 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_by_flight_num"
[0m21:57:28.625014 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_by_flight_num
[0m21:57:28.629453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:57:28.951552 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_by_flight_num"
[0m21:57:28.973371 [debug] [Thread-1 (]: On model.flights_project.fact_delays_by_flight_num: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_by_flight_num"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_delays_by_flight_num`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where arr_delay > 0 or dep_delay > 0
)

select 
    flight_num,
    count(*) as total_flights_with_delays,
    sum(dep_delay) as total_dep_delay,
    sum(arr_delay) as total_arr_delay,
    avg(dep_delay) as avg_dep_delay,
    avg(arr_delay) as avg_arr_delay,
    min(dep_delay) as min_dep_delay,
    min(arr_delay) as min_arr_delay,
    max(dep_delay) as max_dep_delay,
    max(arr_delay) as max_arr_delay
from flight_data
group by flight_num
    );
  
[0m21:57:29.148038 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:cbd1f0b0-3e12-4ab5-9480-4dd0192bdb2e&page=queryresults
[0m21:57:30.682615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fadca6a-6c32-48cb-8421-c54d462ce803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee118ca480>]}
[0m21:57:30.684420 [info ] [Thread-1 (]: 6 of 10 OK created sql table model db_project_dataset.fact_delays_by_flight_num  [[32mCREATE TABLE (8.1k rows, 2.5 GiB processed)[0m in 2.07s]
[0m21:57:30.686591 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m21:57:30.688234 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departure_delays_by_airport
[0m21:57:30.690179 [info ] [Thread-1 (]: 7 of 10 START sql table model db_project_dataset.fact_departure_delays_by_airport  [RUN]
[0m21:57:30.691888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_delays_by_flight_num, now model.flights_project.fact_departure_delays_by_airport)
[0m21:57:30.693771 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departure_delays_by_airport
[0m21:57:30.699120 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departure_delays_by_airport"
[0m21:57:30.711897 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departure_delays_by_airport
[0m21:57:30.721898 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departure_delays_by_airport"
[0m21:57:30.738963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:57:30.796729 [debug] [Thread-1 (]: On model.flights_project.fact_departure_delays_by_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departure_delays_by_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departure_delays_by_airport`
      
    
    

    OPTIONS()
    as (
      

with delayed_departures as (
    select 
        dep_airport, 
        dep_delay,
        arr_delay
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where dep_delay is not null
)

select 
    dep_airport,
    dep_delay,
    arr_delay,
    count(*) AS delay_count
from delayed_departures
group by dep_airport, delay_status
order by delay_count desc
    );
  
[0m21:57:31.157289 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:ebac79c5-6b17-4a9c-a5a7-a51f7c4bc4f1&page=queryresults
[0m21:57:31.257783 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: delay_status at [30:23]; reason: invalidQuery, location: query, message: Unrecognized name: delay_status at [30:23]')
[0m21:57:32.334216 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e83063d2-80dd-420c-9d80-80415bb34850&page=queryresults
[0m21:57:32.427953 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e83063d2-80dd-420c-9d80-80415bb34850&page=queryresults
[0m21:57:32.435841 [debug] [Thread-1 (]: Database Error in model fact_departure_delays_by_airport (models/marts/fact_departure_delays_by_airport.sql)
  Unrecognized name: delay_status at [30:23]
  compiled code at target/run/flights_project/models/marts/fact_departure_delays_by_airport.sql
[0m21:57:32.437087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fadca6a-6c32-48cb-8421-c54d462ce803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee10271df0>]}
[0m21:57:32.438381 [error] [Thread-1 (]: 7 of 10 ERROR creating sql table model db_project_dataset.fact_departure_delays_by_airport  [[31mERROR[0m in 1.75s]
[0m21:57:32.439615 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departure_delays_by_airport
[0m21:57:32.440565 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m21:57:32.443522 [info ] [Thread-1 (]: 8 of 10 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m21:57:32.444776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departure_delays_by_airport, now model.flights_project.fact_departures_by_airport_year)
[0m21:57:32.445643 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m21:57:32.450548 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m21:57:32.465223 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m21:57:32.469429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:57:32.797616 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m21:57:32.815528 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    count(*) as num_departures
from flights_data
group by origin
    );
  
[0m21:57:32.998569 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:3b8ebf44-d4c0-46df-a60f-f3ebe8518088&page=queryresults
[0m21:57:34.511368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fadca6a-6c32-48cb-8421-c54d462ce803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee34fdfcb0>]}
[0m21:57:34.513139 [info ] [Thread-1 (]: 8 of 10 OK created sql table model db_project_dataset.fact_departures_by_airport_year  [[32mCREATE TABLE (343.0 rows, 535.6 MiB processed)[0m in 2.07s]
[0m21:57:34.514966 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m21:57:34.516472 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_yearly
[0m21:57:34.517874 [info ] [Thread-1 (]: 9 of 10 START sql table model db_project_dataset.fact_departures_yearly ........ [RUN]
[0m21:57:34.519843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures_by_airport_year, now model.flights_project.fact_departures_yearly)
[0m21:57:34.520911 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_yearly
[0m21:57:34.526949 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_yearly"
[0m21:57:34.537603 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_yearly
[0m21:57:34.542012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:57:34.843180 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_yearly"
[0m21:57:34.854274 [debug] [Thread-1 (]: On model.flights_project.fact_departures_yearly: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_yearly"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_yearly`
      
    
    

    OPTIONS()
    as (
      

select
    extract(year from f.flight_date) as year,
    count(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
group by year
order by year
    );
  
[0m21:57:35.053362 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c6f292eb-d63f-496e-8f82-e7824b6692d6&page=queryresults
[0m21:57:36.563253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fadca6a-6c32-48cb-8421-c54d462ce803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee10270dd0>]}
[0m21:57:36.564942 [info ] [Thread-1 (]: 9 of 10 OK created sql table model db_project_dataset.fact_departures_yearly ... [[32mCREATE TABLE (21.0 rows, 857.0 MiB processed)[0m in 2.04s]
[0m21:57:36.566581 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_yearly
[0m21:57:36.568138 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m21:57:36.569605 [info ] [Thread-1 (]: 10 of 10 START sql table model db_project_dataset.fact_most_departures_airport . [RUN]
[0m21:57:36.570776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures_yearly, now model.flights_project.fact_most_departures_airport)
[0m21:57:36.571795 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_most_departures_airport
[0m21:57:36.577823 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_most_departures_airport"
[0m21:57:36.589548 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_most_departures_airport
[0m21:57:36.593686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:57:36.902431 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_most_departures_airport"
[0m21:57:36.913757 [debug] [Thread-1 (]: On model.flights_project.fact_most_departures_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_most_departures_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_most_departures_airport`
      
    
    

    OPTIONS()
    as (
      

select
    a.airport_name,
    a.city,
    a.state,
    COUNT(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
join `db-project-456518`.`db_project_dataset`.`dim_airports` a on f.dep_airport = a.airport_name
group by airport_name, a.city, a.state
order by num_departures desc
    );
  
[0m21:57:37.097733 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:76d6dee0-35a8-42c1-a5d1-2a76af8b36e0&page=queryresults
[0m21:57:38.609875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fadca6a-6c32-48cb-8421-c54d462ce803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee114a1100>]}
[0m21:57:38.612773 [info ] [Thread-1 (]: 10 of 10 OK created sql table model db_project_dataset.fact_most_departures_airport  [[32mCREATE TABLE (352.0 rows, 2.7 GiB processed)[0m in 2.04s]
[0m21:57:38.615710 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m21:57:38.620523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:57:38.621912 [debug] [MainThread]: Connection 'model.flights_project.fact_most_departures_airport' was properly closed.
[0m21:57:38.623429 [info ] [MainThread]: 
[0m21:57:38.625782 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 23.20 seconds (23.20s).
[0m21:57:38.631128 [debug] [MainThread]: Command end result
[0m21:57:38.757293 [info ] [MainThread]: 
[0m21:57:38.758976 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:57:38.760330 [info ] [MainThread]: 
[0m21:57:38.761478 [error] [MainThread]:   Database Error in model fact_departure_delays_by_airport (models/marts/fact_departure_delays_by_airport.sql)
  Unrecognized name: delay_status at [30:23]
  compiled code at target/run/flights_project/models/marts/fact_departure_delays_by_airport.sql
[0m21:57:38.762439 [info ] [MainThread]: 
[0m21:57:38.763466 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m21:57:38.765452 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 28.003565, "process_user_time": 7.707606, "process_kernel_time": 0.957282, "process_mem_max_rss": "257056", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:57:38.766669 [debug] [MainThread]: Command `dbt run` failed at 21:57:38.766482 after 28.00 seconds
[0m21:57:38.767721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee11524080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee11ba5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee3900f230>]}
[0m21:57:38.768562 [debug] [MainThread]: Flushing usage events
[0m22:03:46.044960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8541f2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8541c320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b84f707a0>]}


============================== 22:03:46.058033 | 2f70ef89-93ad-4845-b3e1-5628dee13016 ==============================
[0m22:03:46.058033 [info ] [MainThread]: Running with dbt=1.8.1
[0m22:03:46.059401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:03:48.900003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f70ef89-93ad-4845-b3e1-5628dee13016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b6262f170>]}
[0m22:03:48.998273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f70ef89-93ad-4845-b3e1-5628dee13016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b85ff4110>]}
[0m22:03:48.999604 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m22:03:49.687668 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m22:03:51.314488 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:03:51.315674 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:03:51.394114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f70ef89-93ad-4845-b3e1-5628dee13016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b846e7410>]}
[0m22:03:51.605046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f70ef89-93ad-4845-b3e1-5628dee13016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b60c03350>]}
[0m22:03:51.607143 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m22:03:51.608920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f70ef89-93ad-4845-b3e1-5628dee13016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b60de8500>]}
[0m22:03:51.614807 [info ] [MainThread]: 
[0m22:03:51.618397 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:03:51.647712 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m22:03:51.649790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:52.159446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m22:03:52.161595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:03:52.720111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f70ef89-93ad-4845-b3e1-5628dee13016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b60de8500>]}
[0m22:03:52.721994 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:03:52.723461 [info ] [MainThread]: 
[0m22:03:54.477807 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m22:03:54.479379 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m22:03:54.480605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m22:03:54.482060 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m22:03:54.502318 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m22:03:54.512182 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m22:03:54.540562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:03:54.917688 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m22:03:54.927732 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m22:03:55.206878 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:b164b59b-9809-4d3d-9275-7d606d0f4f05&page=queryresults
[0m22:03:56.497796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f70ef89-93ad-4845-b3e1-5628dee13016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b61be4980>]}
[0m22:03:56.503822 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.01s]
[0m22:03:56.505909 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m22:03:56.507509 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m22:03:56.509585 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m22:03:56.511394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m22:03:56.512901 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m22:03:56.564169 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m22:03:56.574217 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m22:03:56.769049 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m22:03:56.779758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:03:56.842762 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted, ':00') as datetime) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted, ':00') as datetime) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60;


[0m22:03:57.277522 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:43ba1388-7a4f-4408-ad4b-083d43c8262e&page=queryresults
[0m22:03:57.443656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f70ef89-93ad-4845-b3e1-5628dee13016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b60d501d0>]}
[0m22:03:57.445014 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m22:03:57.447198 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m22:03:57.449182 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m22:03:57.450380 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m22:03:57.452169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m22:03:57.453442 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m22:03:57.462939 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m22:03:57.471914 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m22:03:57.476397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:03:57.803311 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m22:03:57.814502 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.flight_month,
    flight_data.dep_time,
    flight_data.arr_time,
    
    case
        when flight_data.arr_time >= flight_data.dep_time then 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE)
        else 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE) + 1440
    end
 as airtime,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m22:03:58.307409 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:99e124a1-df39-4fee-b7c6-c4a42f667ebb&page=queryresults
[0m22:04:03.259242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f70ef89-93ad-4845-b3e1-5628dee13016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b6105f050>]}
[0m22:04:03.262513 [info ] [Thread-1 (]: 3 of 10 OK created sql table model db_project_dataset.core_flights ............. [[32mCREATE TABLE (112.3m rows, 11.7 GiB processed)[0m in 5.81s]
[0m22:04:03.268007 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m22:04:03.271782 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m22:04:03.273466 [info ] [Thread-1 (]: 4 of 10 START sql table model db_project_dataset.dim_carriers .................. [RUN]
[0m22:04:03.274917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.core_flights, now model.flights_project.dim_carriers)
[0m22:04:03.276400 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_carriers
[0m22:04:03.289249 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_carriers"
[0m22:04:03.300125 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_carriers
[0m22:04:03.307241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:03.603695 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_carriers"
[0m22:04:03.618522 [debug] [Thread-1 (]: On model.flights_project.dim_carriers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_carriers"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_carriers`
      
    
    

    OPTIONS()
    as (
      

select distinct 
    carrier_code,
    carrier_desc
from `db-project-456518`.`db_project_dataset`.`core_flights`
    );
  
[0m22:04:03.790846 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:9e03b326-9b9c-4db5-a489-139e95080e04&page=queryresults
[0m22:04:05.305907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f70ef89-93ad-4845-b3e1-5628dee13016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b602d65d0>]}
[0m22:04:05.307685 [info ] [Thread-1 (]: 4 of 10 OK created sql table model db_project_dataset.dim_carriers ............. [[32mCREATE TABLE (29.0 rows, 3.9 GiB processed)[0m in 2.03s]
[0m22:04:05.309811 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m22:04:05.315734 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m22:04:05.319023 [info ] [Thread-1 (]: 5 of 10 START sql table model db_project_dataset.dim_dates ..................... [RUN]
[0m22:04:05.321635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_carriers, now model.flights_project.dim_dates)
[0m22:04:05.323106 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_dates
[0m22:04:05.339886 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_dates"
[0m22:04:05.358533 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_dates
[0m22:04:05.372262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:05.740906 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_dates"
[0m22:04:05.752861 [debug] [Thread-1 (]: On model.flights_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_dates"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_dates`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select distinct flight_date
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)

select 
    flight_date,
    extract(year from flight_date) as year,
    extract(quarter from flight_date) as quarter,
    extract(month from flight_date) as month,
    extract(day from flight_date) as day,
    extract(week from flight_date) as week,
    extract(dayofweek from flight_date) as day_of_week,
    case 
    when extract(dayofweek from flight_date) in (1, 7) then 'Weekend' 
    else 'Weekday' 
    end as day_type
from flight_data
    );
  
[0m22:04:06.034699 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c03fb690-2b3f-44da-8fe4-167671d6f25e&page=queryresults
[0m22:04:07.579664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f70ef89-93ad-4845-b3e1-5628dee13016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b6033d520>]}
[0m22:04:07.581518 [info ] [Thread-1 (]: 5 of 10 OK created sql table model db_project_dataset.dim_dates ................ [[32mCREATE TABLE (7.4k rows, 857.0 MiB processed)[0m in 2.26s]
[0m22:04:07.583747 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m22:04:07.584946 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m22:04:07.586632 [info ] [Thread-1 (]: 6 of 10 START sql table model db_project_dataset.fact_delays_by_flight_num ..... [RUN]
[0m22:04:07.588134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_dates, now model.flights_project.fact_delays_by_flight_num)
[0m22:04:07.589177 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_by_flight_num
[0m22:04:07.596351 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_by_flight_num"
[0m22:04:07.608654 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_by_flight_num
[0m22:04:07.619120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:07.926691 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_by_flight_num"
[0m22:04:07.937835 [debug] [Thread-1 (]: On model.flights_project.fact_delays_by_flight_num: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_by_flight_num"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_delays_by_flight_num`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where arr_delay > 0 or dep_delay > 0
)

select 
    flight_num,
    count(*) as total_flights_with_delays,
    sum(dep_delay) as total_dep_delay,
    sum(arr_delay) as total_arr_delay,
    avg(dep_delay) as avg_dep_delay,
    avg(arr_delay) as avg_arr_delay,
    min(dep_delay) as min_dep_delay,
    min(arr_delay) as min_arr_delay,
    max(dep_delay) as max_dep_delay,
    max(arr_delay) as max_arr_delay
from flight_data
group by flight_num
    );
  
[0m22:04:08.121499 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:728ed5c6-4b04-4d57-b8f7-c3d02f7af2b3&page=queryresults
[0m22:04:10.009356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f70ef89-93ad-4845-b3e1-5628dee13016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b60355850>]}
[0m22:04:10.011134 [info ] [Thread-1 (]: 6 of 10 OK created sql table model db_project_dataset.fact_delays_by_flight_num  [[32mCREATE TABLE (8.1k rows, 2.5 GiB processed)[0m in 2.42s]
[0m22:04:10.012895 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m22:04:10.014104 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departure_delays_by_airport
[0m22:04:10.015841 [info ] [Thread-1 (]: 7 of 10 START sql table model db_project_dataset.fact_departure_delays_by_airport  [RUN]
[0m22:04:10.017396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_delays_by_flight_num, now model.flights_project.fact_departure_delays_by_airport)
[0m22:04:10.018587 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departure_delays_by_airport
[0m22:04:10.023666 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departure_delays_by_airport"
[0m22:04:10.034417 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departure_delays_by_airport
[0m22:04:10.039115 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departure_delays_by_airport"
[0m22:04:10.050317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:10.094523 [debug] [Thread-1 (]: On model.flights_project.fact_departure_delays_by_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departure_delays_by_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departure_delays_by_airport`
      
    
    

    OPTIONS()
    as (
      

with delayed_departures as (
    select 
        dep_airport, 
        dep_delay,
        arr_delay
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where dep_delay is not null
)

select 
    dep_airport,
    dep_delay,
    arr_delay,
    count(*) AS delay_count
from delayed_departures
group by dep_airport, delay_status
order by delay_count desc
    );
  
[0m22:04:10.439707 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:fb710240-55a8-48ad-b5eb-316923479861&page=queryresults
[0m22:04:10.586952 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: delay_status at [30:23]; reason: invalidQuery, location: query, message: Unrecognized name: delay_status at [30:23]')
[0m22:04:10.856092 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e6bee513-d1a3-45f3-ac41-efb981b00db7&page=queryresults
[0m22:04:10.951948 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e6bee513-d1a3-45f3-ac41-efb981b00db7&page=queryresults
[0m22:04:10.961284 [debug] [Thread-1 (]: Database Error in model fact_departure_delays_by_airport (models/marts/fact_departure_delays_by_airport.sql)
  Unrecognized name: delay_status at [30:23]
  compiled code at target/run/flights_project/models/marts/fact_departure_delays_by_airport.sql
[0m22:04:10.963996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f70ef89-93ad-4845-b3e1-5628dee13016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b61139400>]}
[0m22:04:10.965738 [error] [Thread-1 (]: 7 of 10 ERROR creating sql table model db_project_dataset.fact_departure_delays_by_airport  [[31mERROR[0m in 0.95s]
[0m22:04:10.967759 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departure_delays_by_airport
[0m22:04:10.969437 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m22:04:10.972658 [info ] [Thread-1 (]: 8 of 10 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m22:04:10.974270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departure_delays_by_airport, now model.flights_project.fact_departures_by_airport_year)
[0m22:04:10.975767 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m22:04:10.985071 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m22:04:11.001785 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m22:04:11.008616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:11.341493 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m22:04:11.355706 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    count(*) as num_departures
from flights_data
group by origin
    );
  
[0m22:04:11.543428 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:bfa6839f-14df-499e-aee7-15d7b2a7c765&page=queryresults
[0m22:04:13.080700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f70ef89-93ad-4845-b3e1-5628dee13016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b602d6d20>]}
[0m22:04:13.082347 [info ] [Thread-1 (]: 8 of 10 OK created sql table model db_project_dataset.fact_departures_by_airport_year  [[32mCREATE TABLE (343.0 rows, 535.6 MiB processed)[0m in 2.11s]
[0m22:04:13.084102 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m22:04:13.085348 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_yearly
[0m22:04:13.086891 [info ] [Thread-1 (]: 9 of 10 START sql table model db_project_dataset.fact_departures_yearly ........ [RUN]
[0m22:04:13.088359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures_by_airport_year, now model.flights_project.fact_departures_yearly)
[0m22:04:13.089945 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_yearly
[0m22:04:13.097478 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_yearly"
[0m22:04:13.110457 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_yearly
[0m22:04:13.115843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:13.447448 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_yearly"
[0m22:04:13.459536 [debug] [Thread-1 (]: On model.flights_project.fact_departures_yearly: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_yearly"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_yearly`
      
    
    

    OPTIONS()
    as (
      

select
    extract(year from f.flight_date) as year,
    count(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
group by year
order by year
    );
  
[0m22:04:13.714434 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:74db3806-05c8-4a11-8355-76afb94a74e9&page=queryresults
[0m22:04:15.253319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f70ef89-93ad-4845-b3e1-5628dee13016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b6033e360>]}
[0m22:04:15.255356 [info ] [Thread-1 (]: 9 of 10 OK created sql table model db_project_dataset.fact_departures_yearly ... [[32mCREATE TABLE (21.0 rows, 857.0 MiB processed)[0m in 2.17s]
[0m22:04:15.257705 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_yearly
[0m22:04:15.259550 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m22:04:15.261635 [info ] [Thread-1 (]: 10 of 10 START sql table model db_project_dataset.fact_most_departures_airport . [RUN]
[0m22:04:15.263182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures_yearly, now model.flights_project.fact_most_departures_airport)
[0m22:04:15.264083 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_most_departures_airport
[0m22:04:15.271932 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_most_departures_airport"
[0m22:04:15.281551 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_most_departures_airport
[0m22:04:15.288614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:15.597576 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_most_departures_airport"
[0m22:04:15.609868 [debug] [Thread-1 (]: On model.flights_project.fact_most_departures_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_most_departures_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_most_departures_airport`
      
    
    

    OPTIONS()
    as (
      

select
    a.airport_name,
    a.city,
    a.state,
    COUNT(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
join `db-project-456518`.`db_project_dataset`.`dim_airports` a on f.dep_airport = a.airport_name
group by airport_name, a.city, a.state
order by num_departures desc
    );
  
[0m22:04:15.900274 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:0f89a523-8170-4b43-a017-16e84a2f95a7&page=queryresults
[0m22:04:17.505511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f70ef89-93ad-4845-b3e1-5628dee13016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b603cb200>]}
[0m22:04:17.507545 [info ] [Thread-1 (]: 10 of 10 OK created sql table model db_project_dataset.fact_most_departures_airport  [[32mCREATE TABLE (352.0 rows, 2.7 GiB processed)[0m in 2.24s]
[0m22:04:17.509495 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m22:04:17.513123 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:04:17.514238 [debug] [MainThread]: Connection 'model.flights_project.fact_most_departures_airport' was properly closed.
[0m22:04:17.515159 [info ] [MainThread]: 
[0m22:04:17.516124 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 25.90 seconds (25.90s).
[0m22:04:17.519366 [debug] [MainThread]: Command end result
[0m22:04:17.611797 [info ] [MainThread]: 
[0m22:04:17.612933 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:04:17.614125 [info ] [MainThread]: 
[0m22:04:17.615328 [error] [MainThread]:   Database Error in model fact_departure_delays_by_airport (models/marts/fact_departure_delays_by_airport.sql)
  Unrecognized name: delay_status at [30:23]
  compiled code at target/run/flights_project/models/marts/fact_departure_delays_by_airport.sql
[0m22:04:17.616342 [info ] [MainThread]: 
[0m22:04:17.617345 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m22:04:17.619140 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 31.697914, "process_user_time": 12.06789, "process_kernel_time": 1.505376, "process_mem_max_rss": "255688", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:04:17.620152 [debug] [MainThread]: Command `dbt run` failed at 22:04:17.619995 after 31.70 seconds
[0m22:04:17.621041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b601dbb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8883b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b6032eb40>]}
[0m22:04:17.621992 [debug] [MainThread]: Flushing usage events
[0m22:04:47.964622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddf1159760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddf1ee0a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddf1158800>]}


============================== 22:04:47.975124 | 81a5a9a8-da4a-4516-a24c-31901c9a5e64 ==============================
[0m22:04:47.975124 [info ] [MainThread]: Running with dbt=1.8.1
[0m22:04:47.976486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:04:51.352898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81a5a9a8-da4a-4516-a24c-31901c9a5e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddcd55bad0>]}
[0m22:04:51.485192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81a5a9a8-da4a-4516-a24c-31901c9a5e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddcd6ad250>]}
[0m22:04:51.486623 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m22:04:51.827059 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m22:04:53.615802 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:04:53.618106 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/marts/fact_departure_delays_by_airport.sql
[0m22:04:54.067146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81a5a9a8-da4a-4516-a24c-31901c9a5e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddccf61df0>]}
[0m22:04:54.374683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81a5a9a8-da4a-4516-a24c-31901c9a5e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddcdde9ee0>]}
[0m22:04:54.376175 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m22:04:54.377444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81a5a9a8-da4a-4516-a24c-31901c9a5e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddccf52870>]}
[0m22:04:54.383761 [info ] [MainThread]: 
[0m22:04:54.385726 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:04:54.395851 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m22:04:54.397618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:54.733906 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m22:04:54.735954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:04:55.018849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81a5a9a8-da4a-4516-a24c-31901c9a5e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddf2642660>]}
[0m22:04:55.020340 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:04:55.021260 [info ] [MainThread]: 
[0m22:04:55.035798 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m22:04:55.037300 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m22:04:55.038778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m22:04:55.039939 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m22:04:55.054928 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m22:04:55.066219 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m22:04:55.095361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:55.507590 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m22:04:55.531783 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m22:04:55.750419 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:369e33c0-ce6c-4ff1-96df-0052b4a8718c&page=queryresults
[0m22:04:57.327522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81a5a9a8-da4a-4516-a24c-31901c9a5e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddcddc8500>]}
[0m22:04:57.331435 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.29s]
[0m22:04:57.334024 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m22:04:57.335721 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m22:04:57.337250 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m22:04:57.338900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m22:04:57.340345 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m22:04:57.384778 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m22:04:57.397492 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m22:04:57.454628 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m22:04:57.464433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:57.521641 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted, ':00') as datetime) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted, ':00') as datetime) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60;


[0m22:04:57.841093 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:784aa265-393a-478c-99f3-d12d6e235981&page=queryresults
[0m22:04:57.969240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81a5a9a8-da4a-4516-a24c-31901c9a5e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddf0aefad0>]}
[0m22:04:57.971061 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 0.63s]
[0m22:04:57.972796 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m22:04:57.974797 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m22:04:57.976251 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m22:04:57.977666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m22:04:57.978652 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m22:04:57.989326 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m22:04:57.999623 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m22:04:58.006781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:58.348291 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m22:04:58.362640 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.flight_month,
    flight_data.dep_time,
    flight_data.arr_time,
    
    case
        when flight_data.arr_time >= flight_data.dep_time then 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE)
        else 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE) + 1440
    end
 as airtime,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m22:04:58.840333 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:dd55b6c0-1fa3-4d48-a97d-6d1fad414db2&page=queryresults
[0m22:05:04.117598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81a5a9a8-da4a-4516-a24c-31901c9a5e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddccf47770>]}
[0m22:05:04.119222 [info ] [Thread-1 (]: 3 of 10 OK created sql table model db_project_dataset.core_flights ............. [[32mCREATE TABLE (112.3m rows, 11.7 GiB processed)[0m in 6.14s]
[0m22:05:04.121052 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m22:05:04.123485 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m22:05:04.125039 [info ] [Thread-1 (]: 4 of 10 START sql table model db_project_dataset.dim_carriers .................. [RUN]
[0m22:05:04.126849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.core_flights, now model.flights_project.dim_carriers)
[0m22:05:04.128110 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_carriers
[0m22:05:04.136165 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_carriers"
[0m22:05:04.150269 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_carriers
[0m22:05:04.155700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:04.495144 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_carriers"
[0m22:05:04.532968 [debug] [Thread-1 (]: On model.flights_project.dim_carriers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_carriers"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_carriers`
      
    
    

    OPTIONS()
    as (
      

select distinct 
    carrier_code,
    carrier_desc
from `db-project-456518`.`db_project_dataset`.`core_flights`
    );
  
[0m22:05:04.712044 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:7c4e539a-33d5-4d62-a453-ff6051089ec3&page=queryresults
[0m22:05:06.235666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81a5a9a8-da4a-4516-a24c-31901c9a5e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddccf0c320>]}
[0m22:05:06.237580 [info ] [Thread-1 (]: 4 of 10 OK created sql table model db_project_dataset.dim_carriers ............. [[32mCREATE TABLE (29.0 rows, 3.9 GiB processed)[0m in 2.11s]
[0m22:05:06.239368 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m22:05:06.240644 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m22:05:06.242436 [info ] [Thread-1 (]: 5 of 10 START sql table model db_project_dataset.dim_dates ..................... [RUN]
[0m22:05:06.245641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_carriers, now model.flights_project.dim_dates)
[0m22:05:06.248330 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_dates
[0m22:05:06.256113 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_dates"
[0m22:05:06.270544 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_dates
[0m22:05:06.276154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:06.582504 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_dates"
[0m22:05:06.598281 [debug] [Thread-1 (]: On model.flights_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_dates"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_dates`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select distinct flight_date
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)

select 
    flight_date,
    extract(year from flight_date) as year,
    extract(quarter from flight_date) as quarter,
    extract(month from flight_date) as month,
    extract(day from flight_date) as day,
    extract(week from flight_date) as week,
    extract(dayofweek from flight_date) as day_of_week,
    case 
    when extract(dayofweek from flight_date) in (1, 7) then 'Weekend' 
    else 'Weekday' 
    end as day_type
from flight_data
    );
  
[0m22:05:06.776848 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:d4b00146-0b17-4536-939b-57cc627019b3&page=queryresults
[0m22:05:08.312094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81a5a9a8-da4a-4516-a24c-31901c9a5e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddccffc5c0>]}
[0m22:05:08.313898 [info ] [Thread-1 (]: 5 of 10 OK created sql table model db_project_dataset.dim_dates ................ [[32mCREATE TABLE (7.4k rows, 857.0 MiB processed)[0m in 2.07s]
[0m22:05:08.316047 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m22:05:08.317571 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m22:05:08.318874 [info ] [Thread-1 (]: 6 of 10 START sql table model db_project_dataset.fact_delays_by_flight_num ..... [RUN]
[0m22:05:08.320613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_dates, now model.flights_project.fact_delays_by_flight_num)
[0m22:05:08.321848 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_by_flight_num
[0m22:05:08.327233 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_by_flight_num"
[0m22:05:08.336757 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_by_flight_num
[0m22:05:08.341459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:08.638634 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_by_flight_num"
[0m22:05:08.650191 [debug] [Thread-1 (]: On model.flights_project.fact_delays_by_flight_num: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_by_flight_num"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_delays_by_flight_num`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where arr_delay > 0 or dep_delay > 0
)

select 
    flight_num,
    count(*) as total_flights_with_delays,
    sum(dep_delay) as total_dep_delay,
    sum(arr_delay) as total_arr_delay,
    avg(dep_delay) as avg_dep_delay,
    avg(arr_delay) as avg_arr_delay,
    min(dep_delay) as min_dep_delay,
    min(arr_delay) as min_arr_delay,
    max(dep_delay) as max_dep_delay,
    max(arr_delay) as max_arr_delay
from flight_data
group by flight_num
    );
  
[0m22:05:08.846325 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:660c2040-3866-4685-b57d-3bb52d756b5c&page=queryresults
[0m22:05:10.685008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81a5a9a8-da4a-4516-a24c-31901c9a5e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddcd118680>]}
[0m22:05:10.687637 [info ] [Thread-1 (]: 6 of 10 OK created sql table model db_project_dataset.fact_delays_by_flight_num  [[32mCREATE TABLE (8.1k rows, 2.5 GiB processed)[0m in 2.36s]
[0m22:05:10.691651 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m22:05:10.699809 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departure_delays_by_airport
[0m22:05:10.702275 [info ] [Thread-1 (]: 7 of 10 START sql table model db_project_dataset.fact_departure_delays_by_airport  [RUN]
[0m22:05:10.707054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_delays_by_flight_num, now model.flights_project.fact_departure_delays_by_airport)
[0m22:05:10.709140 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departure_delays_by_airport
[0m22:05:10.730373 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departure_delays_by_airport"
[0m22:05:10.759821 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departure_delays_by_airport
[0m22:05:10.780373 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departure_delays_by_airport"
[0m22:05:10.795626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:10.864283 [debug] [Thread-1 (]: On model.flights_project.fact_departure_delays_by_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departure_delays_by_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departure_delays_by_airport`
      
    
    

    OPTIONS()
    as (
      

with delayed_departures as (
    select 
        dep_airport, 
        dep_delay,
        arr_delay
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where dep_delay is not null
)

select 
    dep_airport,
    dep_delay,
    arr_delay,
    count(*) AS delay_count
from delayed_departures
group by dep_airport
order by delay_count desc
    );
  
[0m22:05:11.247958 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:bf4314a2-2d5e-49e4-bd21-d8af4301b03b&page=queryresults
[0m22:05:11.391302 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column dep_delay which is neither grouped nor aggregated at [26:5]; reason: invalidQuery, location: query, message: SELECT list expression references column dep_delay which is neither grouped nor aggregated at [26:5]')
[0m22:05:11.620982 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c1d81f8f-0c67-4e72-a3c8-3e9152a97a6e&page=queryresults
[0m22:05:11.712308 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c1d81f8f-0c67-4e72-a3c8-3e9152a97a6e&page=queryresults
[0m22:05:11.723637 [debug] [Thread-1 (]: Database Error in model fact_departure_delays_by_airport (models/marts/fact_departure_delays_by_airport.sql)
  SELECT list expression references column dep_delay which is neither grouped nor aggregated at [26:5]
  compiled code at target/run/flights_project/models/marts/fact_departure_delays_by_airport.sql
[0m22:05:11.725215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81a5a9a8-da4a-4516-a24c-31901c9a5e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddf3783d10>]}
[0m22:05:11.727126 [error] [Thread-1 (]: 7 of 10 ERROR creating sql table model db_project_dataset.fact_departure_delays_by_airport  [[31mERROR[0m in 1.02s]
[0m22:05:11.728829 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departure_delays_by_airport
[0m22:05:11.729979 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m22:05:11.732147 [info ] [Thread-1 (]: 8 of 10 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m22:05:11.733368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departure_delays_by_airport, now model.flights_project.fact_departures_by_airport_year)
[0m22:05:11.734361 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m22:05:11.743531 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m22:05:11.755974 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m22:05:11.761653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:12.089252 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m22:05:12.101671 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    count(*) as num_departures
from flights_data
group by origin
    );
  
[0m22:05:12.274369 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:dd76255f-159d-465d-8346-9d8eeb8da5a2&page=queryresults
[0m22:05:14.528308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81a5a9a8-da4a-4516-a24c-31901c9a5e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddb7d551c0>]}
[0m22:05:14.530607 [info ] [Thread-1 (]: 8 of 10 OK created sql table model db_project_dataset.fact_departures_by_airport_year  [[32mCREATE TABLE (343.0 rows, 535.6 MiB processed)[0m in 2.79s]
[0m22:05:14.532611 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m22:05:14.534120 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_yearly
[0m22:05:14.537356 [info ] [Thread-1 (]: 9 of 10 START sql table model db_project_dataset.fact_departures_yearly ........ [RUN]
[0m22:05:14.540785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures_by_airport_year, now model.flights_project.fact_departures_yearly)
[0m22:05:14.544647 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_yearly
[0m22:05:14.556712 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_yearly"
[0m22:05:14.570307 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_yearly
[0m22:05:14.579410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:14.939548 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_yearly"
[0m22:05:14.987925 [debug] [Thread-1 (]: On model.flights_project.fact_departures_yearly: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_yearly"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_yearly`
      
    
    

    OPTIONS()
    as (
      

select
    extract(year from f.flight_date) as year,
    count(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
group by year
order by year
    );
  
[0m22:05:15.178529 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:5cb726c5-0569-4aa9-9648-31e590c4556c&page=queryresults
[0m22:05:16.696738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81a5a9a8-da4a-4516-a24c-31901c9a5e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddcd526630>]}
[0m22:05:16.697999 [info ] [Thread-1 (]: 9 of 10 OK created sql table model db_project_dataset.fact_departures_yearly ... [[32mCREATE TABLE (21.0 rows, 857.0 MiB processed)[0m in 2.16s]
[0m22:05:16.699419 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_yearly
[0m22:05:16.700316 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m22:05:16.702023 [info ] [Thread-1 (]: 10 of 10 START sql table model db_project_dataset.fact_most_departures_airport . [RUN]
[0m22:05:16.703260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures_yearly, now model.flights_project.fact_most_departures_airport)
[0m22:05:16.704134 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_most_departures_airport
[0m22:05:16.709654 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_most_departures_airport"
[0m22:05:16.715965 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_most_departures_airport
[0m22:05:16.720301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:17.039148 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_most_departures_airport"
[0m22:05:17.053440 [debug] [Thread-1 (]: On model.flights_project.fact_most_departures_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_most_departures_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_most_departures_airport`
      
    
    

    OPTIONS()
    as (
      

select
    a.airport_name,
    a.city,
    a.state,
    COUNT(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
join `db-project-456518`.`db_project_dataset`.`dim_airports` a on f.dep_airport = a.airport_name
group by airport_name, a.city, a.state
order by num_departures desc
    );
  
[0m22:05:17.240350 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:a4057873-67b0-4a7b-8303-3642254f3956&page=queryresults
[0m22:05:18.737655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81a5a9a8-da4a-4516-a24c-31901c9a5e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddb7df06e0>]}
[0m22:05:18.739542 [info ] [Thread-1 (]: 10 of 10 OK created sql table model db_project_dataset.fact_most_departures_airport  [[32mCREATE TABLE (352.0 rows, 2.7 GiB processed)[0m in 2.03s]
[0m22:05:18.741445 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m22:05:18.744656 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:18.746205 [debug] [MainThread]: Connection 'model.flights_project.fact_most_departures_airport' was properly closed.
[0m22:05:18.747476 [info ] [MainThread]: 
[0m22:05:18.748554 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 24.36 seconds (24.36s).
[0m22:05:18.753092 [debug] [MainThread]: Command end result
[0m22:05:18.860852 [info ] [MainThread]: 
[0m22:05:18.861962 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:05:18.862829 [info ] [MainThread]: 
[0m22:05:18.863831 [error] [MainThread]:   Database Error in model fact_departure_delays_by_airport (models/marts/fact_departure_delays_by_airport.sql)
  SELECT list expression references column dep_delay which is neither grouped nor aggregated at [26:5]
  compiled code at target/run/flights_project/models/marts/fact_departure_delays_by_airport.sql
[0m22:05:18.864673 [info ] [MainThread]: 
[0m22:05:18.865967 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m22:05:18.869282 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 31.008537, "process_user_time": 9.097856, "process_kernel_time": 1.106653, "process_mem_max_rss": "259080", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:18.870678 [debug] [MainThread]: Command `dbt run` failed at 22:05:18.870427 after 31.01 seconds
[0m22:05:18.871994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddf1ab9a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddcda0e5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddf0e38500>]}
[0m22:05:18.873159 [debug] [MainThread]: Flushing usage events
[0m22:05:53.479632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd73f09b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd7b61eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd7585880>]}


============================== 22:05:53.488253 | a9826d46-aefd-423c-99c7-00508a2cfa74 ==============================
[0m22:05:53.488253 [info ] [MainThread]: Running with dbt=1.8.1
[0m22:05:53.489968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:55.013317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9826d46-aefd-423c-99c7-00508a2cfa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccb3b63650>]}
[0m22:05:55.087227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9826d46-aefd-423c-99c7-00508a2cfa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd8a02c30>]}
[0m22:05:55.088767 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m22:05:55.344743 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m22:05:56.816838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:05:56.817934 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/marts/fact_departure_delays_by_airport.sql
[0m22:05:57.191615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9826d46-aefd-423c-99c7-00508a2cfa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccb34aa090>]}
[0m22:05:57.501474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9826d46-aefd-423c-99c7-00508a2cfa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd8809400>]}
[0m22:05:57.502648 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m22:05:57.503698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9826d46-aefd-423c-99c7-00508a2cfa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd7e16000>]}
[0m22:05:57.508383 [info ] [MainThread]: 
[0m22:05:57.509997 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:05:57.517580 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m22:05:57.518753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:57.854818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m22:05:57.856281 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:58.178679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9826d46-aefd-423c-99c7-00508a2cfa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd7e16000>]}
[0m22:05:58.180229 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:05:58.181401 [info ] [MainThread]: 
[0m22:05:58.195539 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m22:05:58.197415 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m22:05:58.198870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m22:05:58.200014 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m22:05:58.214893 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m22:05:58.225417 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m22:05:58.258007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:58.603448 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m22:05:58.614607 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m22:05:58.810042 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:4ce2cae8-1c35-444b-b892-c3348999d7fd&page=queryresults
[0m22:06:00.104454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9826d46-aefd-423c-99c7-00508a2cfa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccb35782f0>]}
[0m22:06:00.107429 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 1.90s]
[0m22:06:00.109516 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m22:06:00.110903 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m22:06:00.112205 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m22:06:00.113537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m22:06:00.114528 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m22:06:00.157556 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m22:06:00.168603 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m22:06:00.216220 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m22:06:00.226221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:00.278318 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted, ':00') as datetime) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted, ':00') as datetime) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60;


[0m22:06:00.634453 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:796a1c76-b2a8-40d7-a1a2-3ae0305690fc&page=queryresults
[0m22:06:00.780788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9826d46-aefd-423c-99c7-00508a2cfa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd702fce0>]}
[0m22:06:00.782554 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 0.67s]
[0m22:06:00.784249 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m22:06:00.786591 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m22:06:00.787905 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m22:06:00.792249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m22:06:00.794398 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m22:06:00.811519 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m22:06:00.820768 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m22:06:00.832672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:01.156794 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m22:06:01.169555 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.flight_month,
    flight_data.dep_time,
    flight_data.arr_time,
    
    case
        when flight_data.arr_time >= flight_data.dep_time then 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE)
        else 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE) + 1440
    end
 as airtime,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m22:06:01.650835 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c88df442-5b7c-44f2-a4e0-2e30de5a1dcc&page=queryresults
[0m22:06:06.581397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9826d46-aefd-423c-99c7-00508a2cfa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccb24d03e0>]}
[0m22:06:06.583157 [info ] [Thread-1 (]: 3 of 10 OK created sql table model db_project_dataset.core_flights ............. [[32mCREATE TABLE (112.3m rows, 11.7 GiB processed)[0m in 5.79s]
[0m22:06:06.585125 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m22:06:06.587512 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m22:06:06.589321 [info ] [Thread-1 (]: 4 of 10 START sql table model db_project_dataset.dim_carriers .................. [RUN]
[0m22:06:06.591002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.core_flights, now model.flights_project.dim_carriers)
[0m22:06:06.591905 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_carriers
[0m22:06:06.599922 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_carriers"
[0m22:06:06.610230 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_carriers
[0m22:06:06.614643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:06.960084 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_carriers"
[0m22:06:06.975500 [debug] [Thread-1 (]: On model.flights_project.dim_carriers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_carriers"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_carriers`
      
    
    

    OPTIONS()
    as (
      

select distinct 
    carrier_code,
    carrier_desc
from `db-project-456518`.`db_project_dataset`.`core_flights`
    );
  
[0m22:06:07.181311 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:3515567b-985e-4ecc-beec-3ec4db062cc8&page=queryresults
[0m22:06:08.706395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9826d46-aefd-423c-99c7-00508a2cfa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccb3456630>]}
[0m22:06:08.708484 [info ] [Thread-1 (]: 4 of 10 OK created sql table model db_project_dataset.dim_carriers ............. [[32mCREATE TABLE (29.0 rows, 3.9 GiB processed)[0m in 2.12s]
[0m22:06:08.710543 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m22:06:08.711774 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m22:06:08.713309 [info ] [Thread-1 (]: 5 of 10 START sql table model db_project_dataset.dim_dates ..................... [RUN]
[0m22:06:08.714909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_carriers, now model.flights_project.dim_dates)
[0m22:06:08.717855 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_dates
[0m22:06:08.725040 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_dates"
[0m22:06:08.735783 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_dates
[0m22:06:08.741261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:09.046740 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_dates"
[0m22:06:09.060911 [debug] [Thread-1 (]: On model.flights_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_dates"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_dates`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select distinct flight_date
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)

select 
    flight_date,
    extract(year from flight_date) as year,
    extract(quarter from flight_date) as quarter,
    extract(month from flight_date) as month,
    extract(day from flight_date) as day,
    extract(week from flight_date) as week,
    extract(dayofweek from flight_date) as day_of_week,
    case 
    when extract(dayofweek from flight_date) in (1, 7) then 'Weekend' 
    else 'Weekday' 
    end as day_type
from flight_data
    );
  
[0m22:06:09.246606 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c38ad5b9-c33d-443b-a430-ded4a618297e&page=queryresults
[0m22:06:10.765832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9826d46-aefd-423c-99c7-00508a2cfa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccb3456630>]}
[0m22:06:10.767873 [info ] [Thread-1 (]: 5 of 10 OK created sql table model db_project_dataset.dim_dates ................ [[32mCREATE TABLE (7.4k rows, 857.0 MiB processed)[0m in 2.05s]
[0m22:06:10.769885 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m22:06:10.771042 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m22:06:10.772210 [info ] [Thread-1 (]: 6 of 10 START sql table model db_project_dataset.fact_delays_by_flight_num ..... [RUN]
[0m22:06:10.773474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_dates, now model.flights_project.fact_delays_by_flight_num)
[0m22:06:10.774464 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_by_flight_num
[0m22:06:10.779373 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_by_flight_num"
[0m22:06:10.791098 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_by_flight_num
[0m22:06:10.795738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:11.104314 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_by_flight_num"
[0m22:06:11.118104 [debug] [Thread-1 (]: On model.flights_project.fact_delays_by_flight_num: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_by_flight_num"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_delays_by_flight_num`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where arr_delay > 0 or dep_delay > 0
)

select 
    flight_num,
    count(*) as total_flights_with_delays,
    sum(dep_delay) as total_dep_delay,
    sum(arr_delay) as total_arr_delay,
    avg(dep_delay) as avg_dep_delay,
    avg(arr_delay) as avg_arr_delay,
    min(dep_delay) as min_dep_delay,
    min(arr_delay) as min_arr_delay,
    max(dep_delay) as max_dep_delay,
    max(arr_delay) as max_arr_delay
from flight_data
group by flight_num
    );
  
[0m22:06:11.305085 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:be4a4f4f-2a19-4589-be47-2c7d4b42cc7e&page=queryresults
[0m22:06:12.830142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9826d46-aefd-423c-99c7-00508a2cfa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccb823d070>]}
[0m22:06:12.832369 [info ] [Thread-1 (]: 6 of 10 OK created sql table model db_project_dataset.fact_delays_by_flight_num  [[32mCREATE TABLE (8.1k rows, 2.5 GiB processed)[0m in 2.06s]
[0m22:06:12.834611 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m22:06:12.836253 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departure_delays_by_airport
[0m22:06:12.838264 [info ] [Thread-1 (]: 7 of 10 START sql table model db_project_dataset.fact_departure_delays_by_airport  [RUN]
[0m22:06:12.839656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_delays_by_flight_num, now model.flights_project.fact_departure_delays_by_airport)
[0m22:06:12.840745 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departure_delays_by_airport
[0m22:06:12.846342 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departure_delays_by_airport"
[0m22:06:12.857811 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departure_delays_by_airport
[0m22:06:12.869750 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departure_delays_by_airport"
[0m22:06:12.884527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:12.931191 [debug] [Thread-1 (]: On model.flights_project.fact_departure_delays_by_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departure_delays_by_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departure_delays_by_airport`
      
    
    

    OPTIONS()
    as (
      

with delayed_departures as (
    select 
        dep_airport, 
        dep_delay,
        arr_delay
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where dep_delay is not null
)

select 
    dep_airport,
    AVG(dep_delay),
    AVG(arr_delay),
    count(*) AS delay_count
from delayed_departures
group by dep_airport
order by delay_count desc
    );
  
[0m22:06:13.280460 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c37662c2-9fb9-49a1-8409-6d089b8cf7d3&page=queryresults
[0m22:06:13.388406 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE columns must be named, but column 2 has no name at [15:1]; reason: invalidQuery, location: query, message: CREATE TABLE columns must be named, but column 2 has no name at [15:1]')
[0m22:06:14.470078 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:43d5a367-8437-4ea3-ba67-a8e235ce9d4d&page=queryresults
[0m22:06:14.580587 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:43d5a367-8437-4ea3-ba67-a8e235ce9d4d&page=queryresults
[0m22:06:14.596824 [debug] [Thread-1 (]: Database Error in model fact_departure_delays_by_airport (models/marts/fact_departure_delays_by_airport.sql)
  CREATE TABLE columns must be named, but column 2 has no name at [15:1]
  compiled code at target/run/flights_project/models/marts/fact_departure_delays_by_airport.sql
[0m22:06:14.598108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9826d46-aefd-423c-99c7-00508a2cfa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccb25152e0>]}
[0m22:06:14.601534 [error] [Thread-1 (]: 7 of 10 ERROR creating sql table model db_project_dataset.fact_departure_delays_by_airport  [[31mERROR[0m in 1.76s]
[0m22:06:14.604484 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departure_delays_by_airport
[0m22:06:14.605656 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m22:06:14.607822 [info ] [Thread-1 (]: 8 of 10 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m22:06:14.609525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departure_delays_by_airport, now model.flights_project.fact_departures_by_airport_year)
[0m22:06:14.610630 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m22:06:14.619470 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m22:06:14.632931 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m22:06:14.640765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:14.949914 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m22:06:14.961383 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    count(*) as num_departures
from flights_data
group by origin
    );
  
[0m22:06:15.126600 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:bff3b11e-cc22-47e1-8793-446cf86af5a4&page=queryresults
[0m22:06:16.657935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9826d46-aefd-423c-99c7-00508a2cfa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccb3551460>]}
[0m22:06:16.659762 [info ] [Thread-1 (]: 8 of 10 OK created sql table model db_project_dataset.fact_departures_by_airport_year  [[32mCREATE TABLE (343.0 rows, 535.6 MiB processed)[0m in 2.05s]
[0m22:06:16.661659 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m22:06:16.663228 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_yearly
[0m22:06:16.665013 [info ] [Thread-1 (]: 9 of 10 START sql table model db_project_dataset.fact_departures_yearly ........ [RUN]
[0m22:06:16.667285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures_by_airport_year, now model.flights_project.fact_departures_yearly)
[0m22:06:16.668839 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_yearly
[0m22:06:16.677918 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_yearly"
[0m22:06:16.689946 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_yearly
[0m22:06:16.695113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:17.019475 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_yearly"
[0m22:06:17.031370 [debug] [Thread-1 (]: On model.flights_project.fact_departures_yearly: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_yearly"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_yearly`
      
    
    

    OPTIONS()
    as (
      

select
    extract(year from f.flight_date) as year,
    count(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
group by year
order by year
    );
  
[0m22:06:17.203918 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:5c520a64-2840-4a21-b5b7-cfb49b150464&page=queryresults
[0m22:06:18.739143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9826d46-aefd-423c-99c7-00508a2cfa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccb356ea50>]}
[0m22:06:18.741021 [info ] [Thread-1 (]: 9 of 10 OK created sql table model db_project_dataset.fact_departures_yearly ... [[32mCREATE TABLE (21.0 rows, 857.0 MiB processed)[0m in 2.07s]
[0m22:06:18.743016 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_yearly
[0m22:06:18.745360 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m22:06:18.746967 [info ] [Thread-1 (]: 10 of 10 START sql table model db_project_dataset.fact_most_departures_airport . [RUN]
[0m22:06:18.748574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures_yearly, now model.flights_project.fact_most_departures_airport)
[0m22:06:18.749836 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_most_departures_airport
[0m22:06:18.757975 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_most_departures_airport"
[0m22:06:18.768191 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_most_departures_airport
[0m22:06:18.772866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:19.065745 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_most_departures_airport"
[0m22:06:19.077533 [debug] [Thread-1 (]: On model.flights_project.fact_most_departures_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_most_departures_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_most_departures_airport`
      
    
    

    OPTIONS()
    as (
      

select
    a.airport_name,
    a.city,
    a.state,
    COUNT(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
join `db-project-456518`.`db_project_dataset`.`dim_airports` a on f.dep_airport = a.airport_name
group by airport_name, a.city, a.state
order by num_departures desc
    );
  
[0m22:06:19.254951 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:d4e2541c-2d6b-41ff-8de8-63d3352438b6&page=queryresults
[0m22:06:20.790457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9826d46-aefd-423c-99c7-00508a2cfa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccb3492930>]}
[0m22:06:20.792693 [info ] [Thread-1 (]: 10 of 10 OK created sql table model db_project_dataset.fact_most_departures_airport  [[32mCREATE TABLE (352.0 rows, 2.7 GiB processed)[0m in 2.04s]
[0m22:06:20.794572 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m22:06:20.798235 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:20.799741 [debug] [MainThread]: Connection 'model.flights_project.fact_most_departures_airport' was properly closed.
[0m22:06:20.800971 [info ] [MainThread]: 
[0m22:06:20.802166 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 23.29 seconds (23.29s).
[0m22:06:20.806952 [debug] [MainThread]: Command end result
[0m22:06:20.928005 [info ] [MainThread]: 
[0m22:06:20.929206 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:06:20.930104 [info ] [MainThread]: 
[0m22:06:20.931527 [error] [MainThread]:   Database Error in model fact_departure_delays_by_airport (models/marts/fact_departure_delays_by_airport.sql)
  CREATE TABLE columns must be named, but column 2 has no name at [15:1]
  compiled code at target/run/flights_project/models/marts/fact_departure_delays_by_airport.sql
[0m22:06:20.933840 [info ] [MainThread]: 
[0m22:06:20.935486 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m22:06:20.937594 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 27.55093, "process_user_time": 7.0665, "process_kernel_time": 0.841966, "process_mem_max_rss": "259272", "process_in_blocks": "8352", "command_success": false, "process_out_blocks": "0"}
[0m22:06:20.938769 [debug] [MainThread]: Command `dbt run` failed at 22:06:20.938604 after 27.55 seconds
[0m22:06:20.939766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccdb11f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccb92f7200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd7435790>]}
[0m22:06:20.940796 [debug] [MainThread]: Flushing usage events
[0m22:08:15.889549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf47f0fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf4607f500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf4607ca40>]}


============================== 22:08:15.910159 | a50c6b0b-8cc0-4580-8bcd-c46d22849e5b ==============================
[0m22:08:15.910159 [info ] [MainThread]: Running with dbt=1.8.1
[0m22:08:15.912512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:08:17.793767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a50c6b0b-8cc0-4580-8bcd-c46d22849e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf22a23470>]}
[0m22:08:17.882354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a50c6b0b-8cc0-4580-8bcd-c46d22849e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf22e21880>]}
[0m22:08:17.885478 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m22:08:18.216333 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m22:08:19.777478 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:08:19.778593 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/marts/fact_departure_delays_by_airport.sql
[0m22:08:20.222205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a50c6b0b-8cc0-4580-8bcd-c46d22849e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf223de480>]}
[0m22:08:20.545940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a50c6b0b-8cc0-4580-8bcd-c46d22849e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf2283ca10>]}
[0m22:08:20.547380 [info ] [MainThread]: Found 1 seed, 10 models, 1 source, 602 macros
[0m22:08:20.548847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a50c6b0b-8cc0-4580-8bcd-c46d22849e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf2231f110>]}
[0m22:08:20.554180 [info ] [MainThread]: 
[0m22:08:20.555843 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:08:20.564392 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m22:08:20.565661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:21.001464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m22:08:21.003193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:22.032172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a50c6b0b-8cc0-4580-8bcd-c46d22849e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf2298adb0>]}
[0m22:08:22.036088 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:08:22.044738 [info ] [MainThread]: 
[0m22:08:22.093917 [debug] [Thread-1 (]: Began running node model.flights_project.dim_airports
[0m22:08:22.097140 [info ] [Thread-1 (]: 1 of 10 START sql table model db_project_dataset.dim_airports .................. [RUN]
[0m22:08:22.099629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.dim_airports)
[0m22:08:22.101773 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_airports
[0m22:08:22.155241 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_airports"
[0m22:08:22.192476 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_airports
[0m22:08:22.298719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:22.815750 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_airports"
[0m22:08:22.827425 [debug] [Thread-1 (]: On model.flights_project.dim_airports: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_airports"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_airports`
      
    
    

    OPTIONS()
    as (
      

select
    iata as airport_code,
    airport as airport_name,
    city,
    state,
    country,
from `db-project-456518`.`db_project_dataset`.`airports`
    );
  
[0m22:08:23.045997 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:6bd82bb2-b9c2-4869-81fc-62a6c93aecb3&page=queryresults
[0m22:08:24.396619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a50c6b0b-8cc0-4580-8bcd-c46d22849e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf233643e0>]}
[0m22:08:24.400390 [info ] [Thread-1 (]: 1 of 10 OK created sql table model db_project_dataset.dim_airports ............. [[32mCREATE TABLE (3.4k rows, 141.3 KiB processed)[0m in 2.29s]
[0m22:08:24.403042 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_airports
[0m22:08:24.404927 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m22:08:24.409669 [info ] [Thread-1 (]: 2 of 10 START sql view model db_project_dataset.stg_flights .................... [RUN]
[0m22:08:24.416979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_airports, now model.flights_project.stg_flights)
[0m22:08:24.418698 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m22:08:24.502816 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m22:08:24.518029 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m22:08:24.617672 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m22:08:24.653524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:24.766582 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) as id,
    cast(FlightDate as date) as flight_date,
    cast(FlightMonth as date) as flight_month,
    cast(concat(cast(FlightDate as String), ' ', DepTimeFormatted, ':00') as datetime) as dep_time,
    cast(concat(cast(FlightDate as String), ' ', ArrTimeFormatted, ':00') as datetime) as arr_time,
    cast(FlightNum as integer) as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    cast(Origin as String) as origin,
    cast(Dest as String) as destination,
    cast(CarrierCode as String) as carrier_code,
    cast(CarrierDescription as String) as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(DepTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(0)] as integer) < 24
    and cast(split(ArrTimeFormatted, ':')[SAFE_OFFSET(1)] as integer) < 60;


[0m22:08:25.280326 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:a898f617-159f-45cb-84c7-61d14a82ebd2&page=queryresults
[0m22:08:25.438399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a50c6b0b-8cc0-4580-8bcd-c46d22849e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf227e87d0>]}
[0m22:08:25.441767 [info ] [Thread-1 (]: 2 of 10 OK created sql view model db_project_dataset.stg_flights ............... [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m22:08:25.444195 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m22:08:25.453068 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m22:08:25.455095 [info ] [Thread-1 (]: 3 of 10 START sql table model db_project_dataset.core_flights .................. [RUN]
[0m22:08:25.457453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.stg_flights, now model.flights_project.core_flights)
[0m22:08:25.458915 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m22:08:25.482212 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m22:08:25.525696 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m22:08:25.537866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:25.992256 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m22:08:26.034361 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.flight_month,
    flight_data.dep_time,
    flight_data.arr_time,
    
    case
        when flight_data.arr_time >= flight_data.dep_time then 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE)
        else 
            TIMESTAMP_DIFF(flight_data.arr_time, flight_data.dep_time, MINUTE) + 1440
    end
 as airtime,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m22:08:26.537602 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:0d3aeae3-5f86-42a6-b76c-ee231a6e9f1e&page=queryresults
[0m22:08:30.811125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a50c6b0b-8cc0-4580-8bcd-c46d22849e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf222a8290>]}
[0m22:08:30.813201 [info ] [Thread-1 (]: 3 of 10 OK created sql table model db_project_dataset.core_flights ............. [[32mCREATE TABLE (112.3m rows, 11.7 GiB processed)[0m in 5.35s]
[0m22:08:30.818480 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m22:08:30.827085 [debug] [Thread-1 (]: Began running node model.flights_project.dim_carriers
[0m22:08:30.829032 [info ] [Thread-1 (]: 4 of 10 START sql table model db_project_dataset.dim_carriers .................. [RUN]
[0m22:08:30.831431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.core_flights, now model.flights_project.dim_carriers)
[0m22:08:30.833028 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_carriers
[0m22:08:30.851734 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_carriers"
[0m22:08:30.870315 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_carriers
[0m22:08:30.878472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:31.296877 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_carriers"
[0m22:08:31.315173 [debug] [Thread-1 (]: On model.flights_project.dim_carriers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_carriers"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_carriers`
      
    
    

    OPTIONS()
    as (
      

select distinct 
    carrier_code,
    carrier_desc
from `db-project-456518`.`db_project_dataset`.`core_flights`
    );
  
[0m22:08:31.493776 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:9e83a677-7251-4917-b857-264833a61558&page=queryresults
[0m22:08:33.006557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a50c6b0b-8cc0-4580-8bcd-c46d22849e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf222c6db0>]}
[0m22:08:33.008351 [info ] [Thread-1 (]: 4 of 10 OK created sql table model db_project_dataset.dim_carriers ............. [[32mCREATE TABLE (29.0 rows, 3.9 GiB processed)[0m in 2.18s]
[0m22:08:33.009945 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_carriers
[0m22:08:33.011204 [debug] [Thread-1 (]: Began running node model.flights_project.dim_dates
[0m22:08:33.012509 [info ] [Thread-1 (]: 5 of 10 START sql table model db_project_dataset.dim_dates ..................... [RUN]
[0m22:08:33.014030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_carriers, now model.flights_project.dim_dates)
[0m22:08:33.016383 [debug] [Thread-1 (]: Began compiling node model.flights_project.dim_dates
[0m22:08:33.023065 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.dim_dates"
[0m22:08:33.033860 [debug] [Thread-1 (]: Began executing node model.flights_project.dim_dates
[0m22:08:33.039053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:33.366087 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.dim_dates"
[0m22:08:33.380591 [debug] [Thread-1 (]: On model.flights_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.dim_dates"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`dim_dates`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select distinct flight_date
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)

select 
    flight_date,
    extract(year from flight_date) as year,
    extract(quarter from flight_date) as quarter,
    extract(month from flight_date) as month,
    extract(day from flight_date) as day,
    extract(week from flight_date) as week,
    extract(dayofweek from flight_date) as day_of_week,
    case 
    when extract(dayofweek from flight_date) in (1, 7) then 'Weekend' 
    else 'Weekday' 
    end as day_type
from flight_data
    );
  
[0m22:08:33.565967 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:8dabd77a-7567-421f-a106-33d9ed6130d9&page=queryresults
[0m22:08:35.130126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a50c6b0b-8cc0-4580-8bcd-c46d22849e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf233643e0>]}
[0m22:08:35.131587 [info ] [Thread-1 (]: 5 of 10 OK created sql table model db_project_dataset.dim_dates ................ [[32mCREATE TABLE (7.4k rows, 857.0 MiB processed)[0m in 2.12s]
[0m22:08:35.133066 [debug] [Thread-1 (]: Finished running node model.flights_project.dim_dates
[0m22:08:35.134366 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m22:08:35.135561 [info ] [Thread-1 (]: 6 of 10 START sql table model db_project_dataset.fact_delays_by_flight_num ..... [RUN]
[0m22:08:35.136951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.dim_dates, now model.flights_project.fact_delays_by_flight_num)
[0m22:08:35.138025 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_by_flight_num
[0m22:08:35.143541 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_by_flight_num"
[0m22:08:35.154032 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_by_flight_num
[0m22:08:35.158774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:35.470754 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_by_flight_num"
[0m22:08:35.484382 [debug] [Thread-1 (]: On model.flights_project.fact_delays_by_flight_num: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_by_flight_num"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_delays_by_flight_num`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where arr_delay > 0 or dep_delay > 0
)

select 
    flight_num,
    count(*) as total_flights_with_delays,
    sum(dep_delay) as total_dep_delay,
    sum(arr_delay) as total_arr_delay,
    avg(dep_delay) as avg_dep_delay,
    avg(arr_delay) as avg_arr_delay,
    min(dep_delay) as min_dep_delay,
    min(arr_delay) as min_arr_delay,
    max(dep_delay) as max_dep_delay,
    max(arr_delay) as max_arr_delay
from flight_data
group by flight_num
    );
  
[0m22:08:35.647186 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:8f89237d-649e-47c4-905b-ca5b178b1d5b&page=queryresults
[0m22:08:37.155276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a50c6b0b-8cc0-4580-8bcd-c46d22849e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf2285da90>]}
[0m22:08:37.157392 [info ] [Thread-1 (]: 6 of 10 OK created sql table model db_project_dataset.fact_delays_by_flight_num  [[32mCREATE TABLE (8.1k rows, 2.5 GiB processed)[0m in 2.02s]
[0m22:08:37.159974 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m22:08:37.163174 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departure_delays_by_airport
[0m22:08:37.164583 [info ] [Thread-1 (]: 7 of 10 START sql table model db_project_dataset.fact_departure_delays_by_airport  [RUN]
[0m22:08:37.166571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_delays_by_flight_num, now model.flights_project.fact_departure_delays_by_airport)
[0m22:08:37.167969 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departure_delays_by_airport
[0m22:08:37.175884 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departure_delays_by_airport"
[0m22:08:37.189407 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departure_delays_by_airport
[0m22:08:37.205288 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departure_delays_by_airport"
[0m22:08:37.219241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:37.286801 [debug] [Thread-1 (]: On model.flights_project.fact_departure_delays_by_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departure_delays_by_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departure_delays_by_airport`
      
    
    

    OPTIONS()
    as (
      

with delayed_departures as (
    select 
        dep_airport, 
        dep_delay,
        arr_delay
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where dep_delay is not null
)

select 
    dep_airport,
    AVG(dep_delay) as average_dep_delay,
    AVG(arr_delay) as average_arr_delay,
    count(*) AS delay_count
from delayed_departures
group by dep_airport
order by delay_count desc
    );
  
[0m22:08:37.660816 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:b420bf95-002d-490f-9215-56d910eee971&page=queryresults
[0m22:08:39.197633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a50c6b0b-8cc0-4580-8bcd-c46d22849e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf22340920>]}
[0m22:08:39.200142 [info ] [Thread-1 (]: 7 of 10 OK created sql table model db_project_dataset.fact_departure_delays_by_airport  [[32mCREATE TABLE (343.0 rows, 4.4 GiB processed)[0m in 2.03s]
[0m22:08:39.203262 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departure_delays_by_airport
[0m22:08:39.206151 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m22:08:39.208932 [info ] [Thread-1 (]: 8 of 10 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m22:08:39.211074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departure_delays_by_airport, now model.flights_project.fact_departures_by_airport_year)
[0m22:08:39.212589 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m22:08:39.223985 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m22:08:39.252991 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m22:08:39.260369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:39.736441 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m22:08:39.759191 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    count(*) as num_departures
from flights_data
group by origin
    );
  
[0m22:08:39.940428 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:72e0678f-0156-436a-980d-6cee8fcd17c2&page=queryresults
[0m22:08:41.509500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a50c6b0b-8cc0-4580-8bcd-c46d22849e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf2237f500>]}
[0m22:08:42.107252 [info ] [Thread-1 (]: 8 of 10 OK created sql table model db_project_dataset.fact_departures_by_airport_year  [[32mCREATE TABLE (343.0 rows, 535.6 MiB processed)[0m in 2.30s]
[0m22:08:42.111024 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m22:08:42.112900 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_yearly
[0m22:08:42.115400 [info ] [Thread-1 (]: 9 of 10 START sql table model db_project_dataset.fact_departures_yearly ........ [RUN]
[0m22:08:42.117897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures_by_airport_year, now model.flights_project.fact_departures_yearly)
[0m22:08:42.121058 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_yearly
[0m22:08:42.127037 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_yearly"
[0m22:08:42.140732 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_yearly
[0m22:08:42.147064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:42.871239 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_yearly"
[0m22:08:42.882977 [debug] [Thread-1 (]: On model.flights_project.fact_departures_yearly: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_yearly"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_yearly`
      
    
    

    OPTIONS()
    as (
      

select
    extract(year from f.flight_date) as year,
    count(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
group by year
order by year
    );
  
[0m22:08:43.050055 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:8bbb7377-ab4d-4f51-a87a-e28d87ace231&page=queryresults
[0m22:08:44.586620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a50c6b0b-8cc0-4580-8bcd-c46d22849e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf460c7b90>]}
[0m22:08:44.588204 [info ] [Thread-1 (]: 9 of 10 OK created sql table model db_project_dataset.fact_departures_yearly ... [[32mCREATE TABLE (21.0 rows, 857.0 MiB processed)[0m in 2.47s]
[0m22:08:44.590406 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_yearly
[0m22:08:44.591517 [debug] [Thread-1 (]: Began running node model.flights_project.fact_most_departures_airport
[0m22:08:44.592962 [info ] [Thread-1 (]: 10 of 10 START sql table model db_project_dataset.fact_most_departures_airport . [RUN]
[0m22:08:44.594338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_project.fact_departures_yearly, now model.flights_project.fact_most_departures_airport)
[0m22:08:44.595825 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_most_departures_airport
[0m22:08:44.601491 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_most_departures_airport"
[0m22:08:44.611270 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_most_departures_airport
[0m22:08:44.616456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:44.888435 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_most_departures_airport"
[0m22:08:44.899430 [debug] [Thread-1 (]: On model.flights_project.fact_most_departures_airport: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_most_departures_airport"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_most_departures_airport`
      
    
    

    OPTIONS()
    as (
      

select
    a.airport_name,
    a.city,
    a.state,
    COUNT(*) as num_departures
from `db-project-456518`.`db_project_dataset`.`core_flights` f
join `db-project-456518`.`db_project_dataset`.`dim_airports` a on f.dep_airport = a.airport_name
group by airport_name, a.city, a.state
order by num_departures desc
    );
  
[0m22:08:45.506376 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:47764b82-86ad-430e-bf07-8abb87431d4d&page=queryresults
[0m22:08:46.501080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a50c6b0b-8cc0-4580-8bcd-c46d22849e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf227e94f0>]}
[0m22:08:46.502365 [info ] [Thread-1 (]: 10 of 10 OK created sql table model db_project_dataset.fact_most_departures_airport  [[32mCREATE TABLE (352.0 rows, 2.7 GiB processed)[0m in 1.91s]
[0m22:08:46.504046 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_most_departures_airport
[0m22:08:46.507039 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:08:46.508365 [debug] [MainThread]: Connection 'model.flights_project.fact_most_departures_airport' was properly closed.
[0m22:08:46.509503 [info ] [MainThread]: 
[0m22:08:46.510499 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 25.95 seconds (25.95s).
[0m22:08:46.514010 [debug] [MainThread]: Command end result
[0m22:08:46.622263 [info ] [MainThread]: 
[0m22:08:46.623456 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:08:46.624673 [info ] [MainThread]: 
[0m22:08:46.626062 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m22:08:46.628406 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 30.902529, "process_user_time": 8.982874, "process_kernel_time": 0.907464, "process_mem_max_rss": "256860", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:08:46.630037 [debug] [MainThread]: Command `dbt run` succeeded at 22:08:46.629717 after 30.90 seconds
[0m22:08:46.631346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf4607ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf464cb020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf464cb9e0>]}
[0m22:08:46.632450 [debug] [MainThread]: Flushing usage events
