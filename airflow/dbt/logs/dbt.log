[0m14:27:03.439261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1721a778f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f172131bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17257510a0>]}


============================== 14:27:03.448077 | e1aeab0f-3ed1-4b83-99c6-fff3377a045a ==============================
[0m14:27:03.448077 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:27:03.449669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_flights', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:27:03.471212 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Runtime Error
    Syntax error near line 9
    ------------------------------
    6  |       project: 'db-project-456518'
    7  |       dataset: 'db_project_dataset
    8  |       threads: 1
    9  |       keyfile: /opt/airflow/config/gcp-key.json
    
    Raw Error:
    ------------------------------
    while scanning a quoted scalar
      in "<unicode string>", line 7, column 16
    found unexpected end of stream
      in "<unicode string>", line 9, column 48
  
[0m14:27:03.479461 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.09913098, "process_user_time": 4.69919, "process_kernel_time": 0.228019, "process_mem_max_rss": "154580", "process_in_blocks": "41024", "process_out_blocks": "2648", "command_success": false}
[0m14:27:03.481955 [debug] [MainThread]: Command `dbt run` failed at 14:27:03.481123 after 0.10 seconds
[0m14:27:03.484212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17213d91c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f172147d040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17213de420>]}
[0m14:27:03.486148 [debug] [MainThread]: Flushing usage events
[0m14:28:20.007964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c4ae6690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c4ae6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c4ae66c0>]}


============================== 14:28:20.023799 | a5b7e24a-fca2-49c9-8019-a456ff730bca ==============================
[0m14:28:20.023799 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:28:20.025732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models stg_flights', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:28:20.039777 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Runtime Error
    Syntax error near line 9
    ------------------------------
    6  |       project: 'db-project-456518'
    7  |       dataset: 'db_project_dataset
    8  |       threads: 1
    9  |       keyfile: '/opt/airflow/config/gcp-key.json'
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 5, column 7
    did not find expected key
      in "<unicode string>", line 9, column 17
  
[0m14:28:20.042349 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.11970399, "process_user_time": 4.921313, "process_kernel_time": 0.199647, "process_mem_max_rss": "154560", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:28:20.043350 [debug] [MainThread]: Command `dbt run` failed at 14:28:20.043094 after 0.12 seconds
[0m14:28:20.044234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c91671a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c532e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c51c1880>]}
[0m14:28:20.045174 [debug] [MainThread]: Flushing usage events
[0m14:29:29.375928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf14f92600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf14e43860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf14e42bd0>]}


============================== 14:29:29.388971 | f454ea94-230d-4afb-a731-b4009811554e ==============================
[0m14:29:29.388971 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:29:29.391099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models stg_flights', 'send_anonymous_usage_stats': 'True'}
[0m14:29:31.346675 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "my_profile", target "dev" invalid: Runtime Error
    Must specify authentication method
[0m14:29:31.348637 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.0847673, "process_user_time": 6.93051, "process_kernel_time": 0.748055, "process_mem_max_rss": "243508", "process_in_blocks": "24216", "process_out_blocks": "2856", "command_success": false}
[0m14:29:31.350098 [debug] [MainThread]: Command `dbt run` failed at 14:29:31.349809 after 2.09 seconds
[0m14:29:31.351063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf14f92600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faef253b3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faef20edfa0>]}
[0m14:29:31.352053 [debug] [MainThread]: Flushing usage events
[0m14:30:45.091239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd78ae00a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd78aeae4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd78b07f680>]}


============================== 14:30:45.101204 | cdd4bdb6-35f0-47f6-a2a7-8b7fc8547bf1 ==============================
[0m14:30:45.101204 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:30:45.102883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_flights', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:30:46.934829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdd4bdb6-35f0-47f6-a2a7-8b7fc8547bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd78ae03980>]}
[0m14:30:47.262268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdd4bdb6-35f0-47f6-a2a7-8b7fc8547bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd767ea0680>]}
[0m14:30:47.264165 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m14:30:47.283188 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:30:47.293645 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:30:47.294765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cdd4bdb6-35f0-47f6-a2a7-8b7fc8547bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd78ae04fb0>]}
[0m14:30:49.579060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdd4bdb6-35f0-47f6-a2a7-8b7fc8547bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd767737020>]}
[0m14:30:49.614326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdd4bdb6-35f0-47f6-a2a7-8b7fc8547bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7675bb680>]}
[0m14:30:49.616434 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m14:30:49.618669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdd4bdb6-35f0-47f6-a2a7-8b7fc8547bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7675fede0>]}
[0m14:30:49.621055 [warn ] [MainThread]: The selection criterion 'stg_flights' does not match any nodes
[0m14:30:49.625267 [info ] [MainThread]: 
[0m14:30:49.627268 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:30:49.629407 [debug] [MainThread]: Command end result
[0m14:30:49.668921 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.703408, "process_user_time": 8.558564, "process_kernel_time": 0.658351, "process_mem_max_rss": "255024", "process_in_blocks": "10944", "process_out_blocks": "0"}
[0m14:30:49.670873 [debug] [MainThread]: Command `dbt run` succeeded at 14:30:49.670294 after 4.71 seconds
[0m14:30:49.672707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd78b9b0770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd78b5e0440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd76643caa0>]}
[0m14:30:49.674270 [debug] [MainThread]: Flushing usage events
[0m14:32:18.158919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7fb74e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7fb77b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7fb74770>]}


============================== 14:32:18.167566 | dc1bc2e4-bc49-432b-a073-3b8dfd929d53 ==============================
[0m14:32:18.167566 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:32:18.168909 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_flights', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:32:20.089726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc1bc2e4-bc49-432b-a073-3b8dfd929d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6070b740>]}
[0m14:32:20.286958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc1bc2e4-bc49-432b-a073-3b8dfd929d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6072fd70>]}
[0m14:32:20.288337 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m14:32:20.309613 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:32:20.472023 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m14:32:20.473472 [debug] [MainThread]: Partial parsing: added file: DB_project://models/stg_flights.sql
[0m14:32:20.474444 [debug] [MainThread]: Partial parsing: deleted file: DB_project://models/staging_model.sql
[0m14:32:20.964157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc1bc2e4-bc49-432b-a073-3b8dfd929d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae602436e0>]}
[0m14:32:21.075402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc1bc2e4-bc49-432b-a073-3b8dfd929d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6038c590>]}
[0m14:32:21.080253 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m14:32:21.082847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc1bc2e4-bc49-432b-a073-3b8dfd929d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae602dcc20>]}
[0m14:32:21.092505 [info ] [MainThread]: 
[0m14:32:21.096430 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:32:21.100317 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m14:32:21.108454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:21.658599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m14:32:21.659626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:32:22.020943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc1bc2e4-bc49-432b-a073-3b8dfd929d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae60326810>]}
[0m14:32:22.023251 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:32:22.024732 [info ] [MainThread]: 
[0m14:32:22.035894 [debug] [Thread-1 (]: Began running node model.DB_project.stg_flights
[0m14:32:22.037267 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m14:32:22.039038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.DB_project.stg_flights)
[0m14:32:22.040012 [debug] [Thread-1 (]: Began compiling node model.DB_project.stg_flights
[0m14:32:22.051017 [debug] [Thread-1 (]: Writing injected SQL for node "model.DB_project.stg_flights"
[0m14:32:22.068330 [debug] [Thread-1 (]: Timing info for model.DB_project.stg_flights (compile): 14:32:22.040811 => 14:32:22.067812
[0m14:32:22.069302 [debug] [Thread-1 (]: Began executing node model.DB_project.stg_flights
[0m14:32:22.114923 [debug] [Thread-1 (]: Writing runtime sql for node "model.DB_project.stg_flights"
[0m14:32:22.130998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:22.171531 [debug] [Thread-1 (]: On model.DB_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.DB_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    cast(FlightDate as date) as flight_date,
    extract(year from cast(FlightDate as date)) as flight_year,
    extract(month from cast(FlightDate as date)) as flight_month,
    extract(day from cast(FlightDate as date)) as flight_day,
    DepTimeFormatted as dep_time,
    ArrTimeFormatted as arr_time,
    FlightNumber as flight_num,
    ActualElapsedTime as actual_elapsed_time,

    case 
        when cast(floor(ArrTime / 100) * 60 + (ArrTime % 100) as int) < cast(floor(DepTime / 100) * 60 + (DepTime % 100) as int)
        then (cast(floor(ArrTime / 100) * 60 + (ArrTime % 100) as int) + 1440) - cast(floor(DepTime / 100) * 60 + (DepTime % 100) as int)
        else cast(floor(ArrTime / 100) * 60 + (ArrTime % 100) as int) - cast(floor(DepTime / 100) * 60 + (DepTime % 100) as int)
    end as airtime_minutes,

    ArrDelay as arr_delay,
    DepDelay as dep_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc
from raw_data;


[0m14:32:22.763226 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:a6abed24-adc8-4004-b400-0944b1b40215&page=queryresults
[0m14:32:22.764852 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "," but got "%" at [20:56]; reason: invalidQuery, location: query, message: Syntax error: Expected "," but got "%" at [20:56]')
[0m14:32:23.274880 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:e2b3b5cc-bd26-41bb-8dcf-2a0b754dda67&page=queryresults
[0m14:32:23.276750 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:e2b3b5cc-bd26-41bb-8dcf-2a0b754dda67&page=queryresults
[0m14:32:23.278542 [debug] [Thread-1 (]: Timing info for model.DB_project.stg_flights (execute): 14:32:22.070027 => 14:32:23.277914
[0m14:32:23.291837 [debug] [Thread-1 (]: Database Error in model stg_flights (models/stg_flights.sql)
  Syntax error: Expected "," but got "%" at [20:56]
  compiled Code at target/run/DB_project/models/stg_flights.sql
[0m14:32:23.293069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc1bc2e4-bc49-432b-a073-3b8dfd929d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6025f950>]}
[0m14:32:23.294410 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model db_project_dataset.stg_flights ............ [[31mERROR[0m in 1.25s]
[0m14:32:23.295977 [debug] [Thread-1 (]: Finished running node model.DB_project.stg_flights
[0m14:32:23.302673 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:23.305527 [debug] [MainThread]: Connection 'model.DB_project.stg_flights' was properly closed.
[0m14:32:23.308034 [info ] [MainThread]: 
[0m14:32:23.310942 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.21 seconds (2.21s).
[0m14:32:23.314230 [debug] [MainThread]: Command end result
[0m14:32:23.362834 [info ] [MainThread]: 
[0m14:32:23.364347 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:32:23.365515 [info ] [MainThread]: 
[0m14:32:23.366921 [error] [MainThread]:   Database Error in model stg_flights (models/stg_flights.sql)
  Syntax error: Expected "," but got "%" at [20:56]
  compiled Code at target/run/DB_project/models/stg_flights.sql
[0m14:32:23.368116 [info ] [MainThread]: 
[0m14:32:23.369423 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:32:23.372249 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.315644, "process_user_time": 8.290957, "process_kernel_time": 0.837067, "process_mem_max_rss": "260216", "process_in_blocks": "1184", "command_success": false, "process_out_blocks": "0"}
[0m14:32:23.373735 [debug] [MainThread]: Command `dbt run` failed at 14:32:23.373446 after 5.32 seconds
[0m14:32:23.374842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7fb31370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae841af1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae602a5970>]}
[0m14:32:23.376062 [debug] [MainThread]: Flushing usage events
[0m14:35:45.985609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc79d6e6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc79fd0770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc79e13f20>]}


============================== 14:35:45.994670 | 5926cfb5-4916-4055-bf73-e6deab2dc328 ==============================
[0m14:35:45.994670 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:35:45.996043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models stg_flights', 'send_anonymous_usage_stats': 'True'}
[0m14:35:47.473530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5926cfb5-4916-4055-bf73-e6deab2dc328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc571470b0>]}
[0m14:35:47.712662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5926cfb5-4916-4055-bf73-e6deab2dc328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc56b5f0e0>]}
[0m14:35:47.714507 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m14:35:47.741650 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:35:47.957343 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:35:47.958727 [debug] [MainThread]: Partial parsing: updated file: DB_project://models/stg_flights.sql
[0m14:35:48.354410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5926cfb5-4916-4055-bf73-e6deab2dc328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc56463320>]}
[0m14:35:48.423410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5926cfb5-4916-4055-bf73-e6deab2dc328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc567382c0>]}
[0m14:35:48.425746 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m14:35:48.431230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5926cfb5-4916-4055-bf73-e6deab2dc328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc564e5490>]}
[0m14:35:48.439537 [info ] [MainThread]: 
[0m14:35:48.444808 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:35:48.448686 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m14:35:48.450679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:48.909331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m14:35:48.910819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:49.259865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5926cfb5-4916-4055-bf73-e6deab2dc328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc56738e30>]}
[0m14:35:49.262744 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:35:49.264615 [info ] [MainThread]: 
[0m14:35:49.279964 [debug] [Thread-1 (]: Began running node model.DB_project.stg_flights
[0m14:35:49.281333 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m14:35:49.283073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.DB_project.stg_flights)
[0m14:35:49.285205 [debug] [Thread-1 (]: Began compiling node model.DB_project.stg_flights
[0m14:35:49.299766 [debug] [Thread-1 (]: Writing injected SQL for node "model.DB_project.stg_flights"
[0m14:35:49.314748 [debug] [Thread-1 (]: Timing info for model.DB_project.stg_flights (compile): 14:35:49.286719 => 14:35:49.314194
[0m14:35:49.315891 [debug] [Thread-1 (]: Began executing node model.DB_project.stg_flights
[0m14:35:49.406284 [debug] [Thread-1 (]: Writing runtime sql for node "model.DB_project.stg_flights"
[0m14:35:49.417546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:49.463875 [debug] [Thread-1 (]: On model.DB_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.DB_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    cast(FlightDate as date) as flight_date,
    extract(year from cast(FlightDate as date)) as flight_year,
    extract(month from cast(FlightDate as date)) as flight_month,
    extract(day from cast(FlightDate as date)) as flight_day,
    DepTimeFormatted as dep_time,
    ArrTimeFormatted as arr_time,
    FlightNumber as flight_num,
    ActualElapsedTime as actual_elapsed_time,

    case 
        when cast(floor(ArrTime / 100) * 60 + (ArrTime - floor(ArrTime / 100) * 100) as int)  < cast(floor(DepTime / 100) * 60 + (DepTime - floor(DepTime / 100) * 100) as int)
        then (cast(floor(ArrTime / 100) * 60 + (ArrTime - floor(ArrTime / 100) * 100) as int) + 1440) - cast(floor(DepTime / 100) * 60 + (DepTime - floor(DepTime / 100) * 100) as int)
        else cast(floor(ArrTime / 100) * 60 + (ArrTime - floor(ArrTime / 100) * 100) as int) - cast(floor(DepTime / 100) * 60 + (DepTime - floor(DepTime / 100) * 100) as int)
    end as airtime_minutes,

    ArrDelay as arr_delay,
    DepDelay as dep_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc
from raw_data;


[0m14:35:50.522587 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:4b4efef3-2a52-4456-865d-c7bcef68afbe&page=queryresults
[0m14:35:50.759837 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: FlightNumber; Did you mean FlightNum? at [16:5]; reason: invalidQuery, location: query, message: Unrecognized name: FlightNumber; Did you mean FlightNum? at [16:5]')
[0m14:35:52.486709 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:d044c4c0-4660-402a-8879-15903e65eab8&page=queryresults
[0m14:35:52.645840 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:d044c4c0-4660-402a-8879-15903e65eab8&page=queryresults
[0m14:35:52.647935 [debug] [Thread-1 (]: Timing info for model.DB_project.stg_flights (execute): 14:35:49.316906 => 14:35:52.647321
[0m14:35:52.657558 [debug] [Thread-1 (]: Database Error in model stg_flights (models/stg_flights.sql)
  Unrecognized name: FlightNumber; Did you mean FlightNum? at [16:5]
  compiled Code at target/run/DB_project/models/stg_flights.sql
[0m14:35:52.658668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5926cfb5-4916-4055-bf73-e6deab2dc328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc564a3ec0>]}
[0m14:35:52.659828 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model db_project_dataset.stg_flights ............ [[31mERROR[0m in 3.38s]
[0m14:35:52.661300 [debug] [Thread-1 (]: Finished running node model.DB_project.stg_flights
[0m14:35:52.665152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:52.666217 [debug] [MainThread]: Connection 'model.DB_project.stg_flights' was properly closed.
[0m14:35:52.667112 [info ] [MainThread]: 
[0m14:35:52.668236 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.22 seconds (4.22s).
[0m14:35:52.669727 [debug] [MainThread]: Command end result
[0m14:35:52.693878 [info ] [MainThread]: 
[0m14:35:52.695159 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:35:52.696212 [info ] [MainThread]: 
[0m14:35:52.697269 [error] [MainThread]:   Database Error in model stg_flights (models/stg_flights.sql)
  Unrecognized name: FlightNumber; Did you mean FlightNum? at [16:5]
  compiled Code at target/run/DB_project/models/stg_flights.sql
[0m14:35:52.698311 [info ] [MainThread]: 
[0m14:35:52.699608 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:35:52.701685 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.822738, "process_user_time": 6.947479, "process_kernel_time": 0.745092, "process_mem_max_rss": "260228", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:35:52.702913 [debug] [MainThread]: Command `dbt run` failed at 14:35:52.702659 after 6.82 seconds
[0m14:35:52.703887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc7a001fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc79db0e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc564bef90>]}
[0m14:35:52.704914 [debug] [MainThread]: Flushing usage events
[0m14:36:23.947698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4b5a68800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4b5bdc3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4b5a68bf0>]}


============================== 14:36:23.967242 | e7123257-7bea-4843-9b20-230ea9cc23cd ==============================
[0m14:36:23.967242 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:36:23.969241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_flights', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:36:25.907285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7123257-7bea-4843-9b20-230ea9cc23cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4930be840>]}
[0m14:36:26.108763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7123257-7bea-4843-9b20-230ea9cc23cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb498c0a2a0>]}
[0m14:36:26.110213 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m14:36:26.133163 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:36:26.296165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:36:26.297483 [debug] [MainThread]: Partial parsing: updated file: DB_project://models/stg_flights.sql
[0m14:36:26.761609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7123257-7bea-4843-9b20-230ea9cc23cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4923b7d40>]}
[0m14:36:26.805642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7123257-7bea-4843-9b20-230ea9cc23cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49228cbc0>]}
[0m14:36:26.807728 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m14:36:26.810301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7123257-7bea-4843-9b20-230ea9cc23cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb492204560>]}
[0m14:36:26.819135 [info ] [MainThread]: 
[0m14:36:26.824122 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:36:26.827414 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m14:36:26.828926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:27.231200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m14:36:27.232542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:27.586607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7123257-7bea-4843-9b20-230ea9cc23cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4920bd100>]}
[0m14:36:27.588519 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:36:27.589714 [info ] [MainThread]: 
[0m14:36:27.601182 [debug] [Thread-1 (]: Began running node model.DB_project.stg_flights
[0m14:36:27.602606 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m14:36:27.604377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.DB_project.stg_flights)
[0m14:36:27.605466 [debug] [Thread-1 (]: Began compiling node model.DB_project.stg_flights
[0m14:36:27.616188 [debug] [Thread-1 (]: Writing injected SQL for node "model.DB_project.stg_flights"
[0m14:36:27.625828 [debug] [Thread-1 (]: Timing info for model.DB_project.stg_flights (compile): 14:36:27.606209 => 14:36:27.625277
[0m14:36:27.626829 [debug] [Thread-1 (]: Began executing node model.DB_project.stg_flights
[0m14:36:27.671350 [debug] [Thread-1 (]: Writing runtime sql for node "model.DB_project.stg_flights"
[0m14:36:27.681236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:27.721866 [debug] [Thread-1 (]: On model.DB_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.DB_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    cast(FlightDate as date) as flight_date,
    extract(year from cast(FlightDate as date)) as flight_year,
    extract(month from cast(FlightDate as date)) as flight_month,
    extract(day from cast(FlightDate as date)) as flight_day,
    DepTimeFormatted as dep_time,
    ArrTimeFormatted as arr_time,
    FlightNum as flight_num,
    ActualElapsedTime as actual_elapsed_time,

    case 
        when cast(floor(ArrTime / 100) * 60 + (ArrTime - floor(ArrTime / 100) * 100) as int)  < cast(floor(DepTime / 100) * 60 + (DepTime - floor(DepTime / 100) * 100) as int)
        then (cast(floor(ArrTime / 100) * 60 + (ArrTime - floor(ArrTime / 100) * 100) as int) + 1440) - cast(floor(DepTime / 100) * 60 + (DepTime - floor(DepTime / 100) * 100) as int)
        else cast(floor(ArrTime / 100) * 60 + (ArrTime - floor(ArrTime / 100) * 100) as int) - cast(floor(DepTime / 100) * 60 + (DepTime - floor(DepTime / 100) * 100) as int)
    end as airtime_minutes,

    ArrDelay as arr_delay,
    DepDelay as dep_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc
from raw_data;


[0m14:36:28.734648 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:f6f496e0-45ec-4fcf-a958-48f384e299e3&page=queryresults
[0m14:36:28.865398 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator /\n  Argument types: STRING, INT64\n  Signature: FLOAT64 / FLOAT64\n    Argument 1: Unable to coerce type STRING to expected type FLOAT64\n  Signature: NUMERIC / NUMERIC\n    Argument 1: Unable to coerce type STRING to expected type NUMERIC\n  Signature: BIGNUMERIC / BIGNUMERIC\n    Argument 1: Unable to coerce type STRING to expected type BIGNUMERIC\n  Signature: INTERVAL / INT64\n    Argument 1: Unable to coerce type STRING to expected type INTERVAL at [20:25]; reason: invalidQuery, location: query, message: No matching signature for operator /\n  Argument types: STRING, INT64\n  Signature: FLOAT64 / FLOAT64\n    Argument 1: Unable to coerce type STRING to expected type FLOAT64\n  Signature: NUMERIC / NUMERIC\n    Argument 1: Unable to coerce type STRING to expected type NUMERIC\n  Signature: BIGNUMERIC / BIGNUMERIC\n    Argument 1: Unable to coerce type STRING to expected type BIGNUMERIC\n  Signature: INTERVAL / INT64\n    Argument 1: Unable to coerce type STRING to expected type INTERVAL at [20:25]')
[0m14:36:29.912534 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:d58fee04-3698-4282-aa06-d1c7ea1b1ae7&page=queryresults
[0m14:36:30.076192 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:d58fee04-3698-4282-aa06-d1c7ea1b1ae7&page=queryresults
[0m14:36:30.079622 [debug] [Thread-1 (]: Timing info for model.DB_project.stg_flights (execute): 14:36:27.627605 => 14:36:30.078437
[0m14:36:30.093901 [debug] [Thread-1 (]: Database Error in model stg_flights (models/stg_flights.sql)
  No matching signature for operator /
    Argument types: STRING, INT64
    Signature: FLOAT64 / FLOAT64
      Argument 1: Unable to coerce type STRING to expected type FLOAT64
    Signature: NUMERIC / NUMERIC
      Argument 1: Unable to coerce type STRING to expected type NUMERIC
    Signature: BIGNUMERIC / BIGNUMERIC
      Argument 1: Unable to coerce type STRING to expected type BIGNUMERIC
    Signature: INTERVAL / INT64
      Argument 1: Unable to coerce type STRING to expected type INTERVAL at [20:25]
  compiled Code at target/run/DB_project/models/stg_flights.sql
[0m14:36:30.097343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7123257-7bea-4843-9b20-230ea9cc23cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4921675c0>]}
[0m14:36:30.101049 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model db_project_dataset.stg_flights ............ [[31mERROR[0m in 2.49s]
[0m14:36:30.102717 [debug] [Thread-1 (]: Finished running node model.DB_project.stg_flights
[0m14:36:30.113203 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:36:30.115455 [debug] [MainThread]: Connection 'model.DB_project.stg_flights' was properly closed.
[0m14:36:30.117365 [info ] [MainThread]: 
[0m14:36:30.119421 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.30 seconds (3.30s).
[0m14:36:30.129521 [debug] [MainThread]: Command end result
[0m14:36:30.164980 [info ] [MainThread]: 
[0m14:36:30.166647 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:36:30.168195 [info ] [MainThread]: 
[0m14:36:30.169696 [error] [MainThread]:   Database Error in model stg_flights (models/stg_flights.sql)
  No matching signature for operator /
    Argument types: STRING, INT64
    Signature: FLOAT64 / FLOAT64
      Argument 1: Unable to coerce type STRING to expected type FLOAT64
    Signature: NUMERIC / NUMERIC
      Argument 1: Unable to coerce type STRING to expected type NUMERIC
    Signature: BIGNUMERIC / BIGNUMERIC
      Argument 1: Unable to coerce type STRING to expected type BIGNUMERIC
    Signature: INTERVAL / INT64
      Argument 1: Unable to coerce type STRING to expected type INTERVAL at [20:25]
  compiled Code at target/run/DB_project/models/stg_flights.sql
[0m14:36:30.171632 [info ] [MainThread]: 
[0m14:36:30.174988 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:36:30.179395 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.465526, "process_user_time": 8.787096, "process_kernel_time": 0.76235, "process_mem_max_rss": "259928", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:36:30.181103 [debug] [MainThread]: Command `dbt run` failed at 14:36:30.180712 after 6.47 seconds
[0m14:36:30.182278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4b5b73410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4b5b70ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4b5a68bf0>]}
[0m14:36:30.183274 [debug] [MainThread]: Flushing usage events
[0m14:37:01.675061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b8fc979b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b8fc96210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b8fc972c0>]}


============================== 14:37:01.728892 | 6dd23a5a-584f-407c-891b-323d48dd8ba8 ==============================
[0m14:37:01.728892 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:37:01.733561 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models stg_flights', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:37:03.789773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dd23a5a-584f-407c-891b-323d48dd8ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b706b5670>]}
[0m14:37:04.134215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dd23a5a-584f-407c-891b-323d48dd8ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b7096d8b0>]}
[0m14:37:04.136075 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m14:37:04.170343 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:37:04.512717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:37:04.514059 [debug] [MainThread]: Partial parsing: updated file: DB_project://models/stg_flights.sql
[0m14:37:05.213842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dd23a5a-584f-407c-891b-323d48dd8ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b70357230>]}
[0m14:37:05.255031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dd23a5a-584f-407c-891b-323d48dd8ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b7068cc50>]}
[0m14:37:05.257787 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m14:37:05.261947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dd23a5a-584f-407c-891b-323d48dd8ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b70434860>]}
[0m14:37:05.267300 [info ] [MainThread]: 
[0m14:37:05.270305 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:37:05.274622 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m14:37:05.279485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:05.679200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m14:37:05.680725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:37:06.088779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dd23a5a-584f-407c-891b-323d48dd8ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b70436d80>]}
[0m14:37:06.091944 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:37:06.095245 [info ] [MainThread]: 
[0m14:37:06.490870 [debug] [Thread-1 (]: Began running node model.DB_project.stg_flights
[0m14:37:06.492638 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m14:37:06.495314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.DB_project.stg_flights)
[0m14:37:06.496768 [debug] [Thread-1 (]: Began compiling node model.DB_project.stg_flights
[0m14:37:06.522807 [debug] [Thread-1 (]: Writing injected SQL for node "model.DB_project.stg_flights"
[0m14:37:06.535479 [debug] [Thread-1 (]: Timing info for model.DB_project.stg_flights (compile): 14:37:06.497836 => 14:37:06.534500
[0m14:37:06.537031 [debug] [Thread-1 (]: Began executing node model.DB_project.stg_flights
[0m14:37:06.688748 [debug] [Thread-1 (]: Writing runtime sql for node "model.DB_project.stg_flights"
[0m14:37:06.699831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:06.775619 [debug] [Thread-1 (]: On model.DB_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.DB_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    cast(FlightDate as date) as flight_date,
    extract(year from cast(FlightDate as date)) as flight_year,
    extract(month from cast(FlightDate as date)) as flight_month,
    extract(day from cast(FlightDate as date)) as flight_day,
    DepTimeFormatted as dep_time,
    ArrTimeFormatted as arr_time,
    FlightNum as flight_num,
    ActualElapsedTime as actual_elapsed_time,
    ArrDelay as arr_delay,
    DepDelay as dep_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc
from raw_data;


[0m14:37:07.518500 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:b17b3d21-ab6c-4f63-aac7-144b13baf497&page=queryresults
[0m14:37:07.698043 [debug] [Thread-1 (]: Timing info for model.DB_project.stg_flights (execute): 14:37:06.538060 => 14:37:07.697636
[0m14:37:07.699632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dd23a5a-584f-407c-891b-323d48dd8ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b70321f10>]}
[0m14:37:07.700810 [info ] [Thread-1 (]: 1 of 1 OK created sql view model db_project_dataset.stg_flights ................ [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m14:37:07.702059 [debug] [Thread-1 (]: Finished running node model.DB_project.stg_flights
[0m14:37:07.704925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:07.705996 [debug] [MainThread]: Connection 'model.DB_project.stg_flights' was properly closed.
[0m14:37:07.707540 [info ] [MainThread]: 
[0m14:37:07.708772 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.44 seconds (2.44s).
[0m14:37:07.710176 [debug] [MainThread]: Command end result
[0m14:37:07.732097 [info ] [MainThread]: 
[0m14:37:07.733306 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:37:07.734375 [info ] [MainThread]: 
[0m14:37:07.735608 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:37:07.738322 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.326928, "process_user_time": 9.675984, "process_kernel_time": 0.826644, "process_mem_max_rss": "259420", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:37:07.741195 [debug] [MainThread]: Command `dbt run` succeeded at 14:37:07.740639 after 6.33 seconds
[0m14:37:07.743180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b9425f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b90b36270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b70435c70>]}
[0m14:37:07.744267 [debug] [MainThread]: Flushing usage events
[0m15:18:59.684248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f109e1acce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f109e4d1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f109e1ad760>]}


============================== 15:18:59.694817 | 06c2595c-f9ea-4592-9ec2-c9496afc26d8 ==============================
[0m15:18:59.694817 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:18:59.696473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:18:59.894676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06c2595c-f9ea-4592-9ec2-c9496afc26d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f109e061700>]}
[0m15:18:59.899011 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7vfm0l2n'
[0m15:18:59.900059 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:19:00.195429 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:19:00.198426 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:19:00.295393 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:19:00.319516 [info ] [MainThread]: Updating lock file in file path: /opt/airflow/dbt/package-lock.yml
[0m15:19:00.359097 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qz9jz131'
[0m15:19:00.366905 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:19:07.214772 [info ] [MainThread]: Installed from version 1.3.0
[0m15:19:07.216725 [info ] [MainThread]: Up to date!
[0m15:19:07.219521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '06c2595c-f9ea-4592-9ec2-c9496afc26d8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f109e0b4dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f109e08d910>]}
[0m15:19:07.236682 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 7.698136, "process_user_time": 4.781647, "process_kernel_time": 0.431955, "process_mem_max_rss": "111696", "process_in_blocks": "48", "process_out_blocks": "176"}
[0m15:19:07.243247 [debug] [MainThread]: Command `dbt deps` succeeded at 15:19:07.242630 after 7.71 seconds
[0m15:19:07.245231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10a28071d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f109e1b3ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f109e320ef0>]}
[0m15:19:07.252403 [debug] [MainThread]: Flushing usage events
[0m15:19:13.723947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cfac4860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cfac7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cfac4830>]}


============================== 15:19:13.733935 | f325c220-5c71-44c6-b650-a9c44bdc1552 ==============================
[0m15:19:13.733935 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:19:13.735334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_flights', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:19:15.646603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f325c220-5c71-44c6-b650-a9c44bdc1552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47b091d0d0>]}
[0m15:19:15.907831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f325c220-5c71-44c6-b650-a9c44bdc1552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47b0fa1af0>]}
[0m15:19:15.910283 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m15:19:15.972082 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:19:16.020309 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:19:16.022542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f325c220-5c71-44c6-b650-a9c44bdc1552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47b03709e0>]}
[0m15:19:19.921827 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_flights (models/stg_flights.sql)
  
  Warning: `dbt_utils.surrogate_key` has been replaced by `dbt_utils.generate_surrogate_key`. The new macro treats null values differently to empty strings. To restore the behaviour of the original macro, add a global variable in dbt_project.yml called `surrogate_key_treat_nulls_as_empty_strings` to your dbt_project.yml file with a value of True. The DB_project.stg_flights model triggered this warning. 
  
  > in macro default__surrogate_key (macros/sql/surrogate_key.sql)
  > called by macro surrogate_key (macros/sql/surrogate_key.sql)
  > called by model stg_flights (models/stg_flights.sql)
[0m15:19:19.923899 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.308513, "process_user_time": 10.139698, "process_kernel_time": 0.818043, "process_mem_max_rss": "252312", "process_in_blocks": "3984", "process_out_blocks": "16", "command_success": false}
[0m15:19:19.925205 [debug] [MainThread]: Command `dbt run` failed at 15:19:19.924916 after 6.31 seconds
[0m15:19:19.926362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cfce4740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47b0361e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47b0387c80>]}
[0m15:19:19.927425 [debug] [MainThread]: Flushing usage events
[0m15:20:17.115850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa622067080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa621f7a900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa621fbe180>]}


============================== 15:20:17.125426 | a4adda03-cb30-43e9-8553-67084041f3a3 ==============================
[0m15:20:17.125426 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:20:17.126865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m15:20:17.325533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4adda03-cb30-43e9-8553-67084041f3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa622067080>]}
[0m15:20:17.714382 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-07rv2605'
[0m15:20:17.717412 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:20:17.837678 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:20:17.840541 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:20:17.957249 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:20:17.968696 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:20:24.249692 [info ] [MainThread]: Installed from version 1.3.0
[0m15:20:24.251174 [info ] [MainThread]: Up to date!
[0m15:20:24.252682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a4adda03-cb30-43e9-8553-67084041f3a3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa621d640e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa621d64080>]}
[0m15:20:24.255100 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 7.2435765, "process_user_time": 6.401634, "process_kernel_time": 0.473821, "process_mem_max_rss": "111512", "process_in_blocks": "16", "process_out_blocks": "176"}
[0m15:20:24.256596 [debug] [MainThread]: Command `dbt deps` succeeded at 15:20:24.256178 after 7.25 seconds
[0m15:20:24.258163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa62201eea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6265871d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa622e81070>]}
[0m15:20:24.260376 [debug] [MainThread]: Flushing usage events
[0m15:20:32.002631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd385daa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd38638170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd3a6e9070>]}


============================== 15:20:32.026020 | 3bf5f67f-faf9-4782-831c-8eab8df14a59 ==============================
[0m15:20:32.026020 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:20:32.027712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models stg_flights', 'send_anonymous_usage_stats': 'True'}
[0m15:20:35.440681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3bf5f67f-faf9-4782-831c-8eab8df14a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd1646dc70>]}
[0m15:20:35.814118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3bf5f67f-faf9-4782-831c-8eab8df14a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd1522d5b0>]}
[0m15:20:35.816447 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m15:20:35.917917 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:20:35.968591 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:20:35.969921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3bf5f67f-faf9-4782-831c-8eab8df14a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd14e70530>]}
[0m15:20:39.882467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bf5f67f-faf9-4782-831c-8eab8df14a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd14c58860>]}
[0m15:20:39.932199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bf5f67f-faf9-4782-831c-8eab8df14a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd14c5b1a0>]}
[0m15:20:39.934334 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m15:20:39.935859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bf5f67f-faf9-4782-831c-8eab8df14a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd14fc6ff0>]}
[0m15:20:39.941416 [info ] [MainThread]: 
[0m15:20:39.945851 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:20:39.949206 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m15:20:39.951079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:40.401857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m15:20:40.403768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:40.777069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bf5f67f-faf9-4782-831c-8eab8df14a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd14ebef60>]}
[0m15:20:40.779644 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:20:40.781591 [info ] [MainThread]: 
[0m15:20:40.795204 [debug] [Thread-1 (]: Began running node model.DB_project.stg_flights
[0m15:20:40.796749 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m15:20:40.798612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.DB_project.stg_flights)
[0m15:20:40.799771 [debug] [Thread-1 (]: Began compiling node model.DB_project.stg_flights
[0m15:20:40.814188 [debug] [Thread-1 (]: Timing info for model.DB_project.stg_flights (compile): 15:20:40.800599 => 15:20:40.813716
[0m15:20:40.820543 [debug] [Thread-1 (]: Compilation Error in model stg_flights (models/stg_flights.sql)
  'dict object' has no attribute 'generate'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:20:40.821908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bf5f67f-faf9-4782-831c-8eab8df14a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd07983800>]}
[0m15:20:40.823823 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model db_project_dataset.stg_flights ............ [[31mERROR[0m in 0.02s]
[0m15:20:40.826402 [debug] [Thread-1 (]: Finished running node model.DB_project.stg_flights
[0m15:20:40.830937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:40.832180 [debug] [MainThread]: Connection 'model.DB_project.stg_flights' was properly closed.
[0m15:20:40.833239 [info ] [MainThread]: 
[0m15:20:40.834336 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m15:20:40.835928 [debug] [MainThread]: Command end result
[0m15:20:40.876146 [info ] [MainThread]: 
[0m15:20:40.878301 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:20:40.879678 [info ] [MainThread]: 
[0m15:20:40.880939 [error] [MainThread]:   Compilation Error in model stg_flights (models/stg_flights.sql)
  'dict object' has no attribute 'generate'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:20:40.882653 [info ] [MainThread]: 
[0m15:20:40.884279 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:20:40.887232 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.133324, "process_user_time": 11.403333, "process_kernel_time": 0.994611, "process_mem_max_rss": "262592", "process_in_blocks": "8720", "command_success": false, "process_out_blocks": "0"}
[0m15:20:40.889225 [debug] [MainThread]: Command `dbt run` failed at 15:20:40.888704 after 9.14 seconds
[0m15:20:40.891276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd3cba3200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd38902ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd14cad520>]}
[0m15:20:40.892700 [debug] [MainThread]: Flushing usage events
[0m15:21:45.788581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39631c0e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39632087a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39631c0b30>]}


============================== 15:21:45.801711 | a732e39d-9993-4b25-8f76-e405bc14fdaf ==============================
[0m15:21:45.801711 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:21:45.804808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:21:46.148789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a732e39d-9993-4b25-8f76-e405bc14fdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39631c7b00>]}
[0m15:21:46.627198 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-x_46rijv'
[0m15:21:46.628104 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:21:46.722981 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:21:46.725757 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:21:46.816798 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:21:46.828739 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:21:51.890206 [info ] [MainThread]: Installed from version 1.3.0
[0m15:21:51.891249 [info ] [MainThread]: Up to date!
[0m15:21:51.892120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a732e39d-9993-4b25-8f76-e405bc14fdaf', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39630be090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39630bfb90>]}
[0m15:21:51.893793 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 6.2822366, "process_user_time": 4.838738, "process_kernel_time": 0.436196, "process_mem_max_rss": "111944", "process_in_blocks": "912", "process_out_blocks": "176"}
[0m15:21:51.894709 [debug] [MainThread]: Command `dbt deps` succeeded at 15:21:51.894484 after 6.28 seconds
[0m15:21:51.895477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396758f740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39637e29f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3963268ef0>]}
[0m15:21:51.896305 [debug] [MainThread]: Flushing usage events
[0m15:21:57.562227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18954471a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f189548c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1895445310>]}


============================== 15:21:57.574578 | d5290843-dcab-4a63-9100-22ad14745829 ==============================
[0m15:21:57.574578 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:21:57.576547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_flights', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:21:59.257530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5290843-dcab-4a63-9100-22ad14745829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1871ff0980>]}
[0m15:21:59.465703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5290843-dcab-4a63-9100-22ad14745829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18721b4cb0>]}
[0m15:21:59.467135 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m15:21:59.509350 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:22:00.724690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:22:00.727431 [debug] [MainThread]: Partial parsing: updated file: DB_project://models/stg_flights.sql
[0m15:22:01.326093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5290843-dcab-4a63-9100-22ad14745829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1871b2cfe0>]}
[0m15:22:01.388316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5290843-dcab-4a63-9100-22ad14745829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1871dd5370>]}
[0m15:22:01.390705 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m15:22:01.393419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5290843-dcab-4a63-9100-22ad14745829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1871a55be0>]}
[0m15:22:01.407000 [info ] [MainThread]: 
[0m15:22:01.410618 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:22:01.415770 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m15:22:01.417885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:01.828158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m15:22:01.829954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:02.160768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5290843-dcab-4a63-9100-22ad14745829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18726e4560>]}
[0m15:22:02.162833 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:22:02.164618 [info ] [MainThread]: 
[0m15:22:03.178739 [debug] [Thread-1 (]: Began running node model.DB_project.stg_flights
[0m15:22:03.180442 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m15:22:03.182625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.DB_project.stg_flights)
[0m15:22:03.183948 [debug] [Thread-1 (]: Began compiling node model.DB_project.stg_flights
[0m15:22:03.205263 [debug] [Thread-1 (]: Writing injected SQL for node "model.DB_project.stg_flights"
[0m15:22:03.219516 [debug] [Thread-1 (]: Timing info for model.DB_project.stg_flights (compile): 15:22:03.184893 => 15:22:03.218744
[0m15:22:03.221245 [debug] [Thread-1 (]: Began executing node model.DB_project.stg_flights
[0m15:22:03.294921 [debug] [Thread-1 (]: Writing runtime sql for node "model.DB_project.stg_flights"
[0m15:22:03.309541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:03.380246 [debug] [Thread-1 (]: On model.DB_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.DB_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    extract(year from cast(FlightDate as date)) as flight_year,
    extract(month from cast(FlightDate as date)) as flight_month,
    extract(day from cast(FlightDate as date)) as flight_day,
    DepTimeFormatted as dep_time,
    ArrTimeFormatted as arr_time,
    FlightNum as flight_num,
    ActualElapsedTime as actual_elapsed_time,
    ArrDelay as arr_delay,
    DepDelay as dep_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m15:22:03.816572 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:73aea34a-ef89-467d-9b48-5bc5780a6878&page=queryresults
[0m15:22:04.108302 [debug] [Thread-1 (]: Timing info for model.DB_project.stg_flights (execute): 15:22:03.222449 => 15:22:04.107897
[0m15:22:04.110484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5290843-dcab-4a63-9100-22ad14745829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1871dd7350>]}
[0m15:22:04.112322 [info ] [Thread-1 (]: 1 of 1 OK created sql view model db_project_dataset.stg_flights ................ [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m15:22:04.114449 [debug] [Thread-1 (]: Finished running node model.DB_project.stg_flights
[0m15:22:04.118949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:04.121284 [debug] [MainThread]: Connection 'model.DB_project.stg_flights' was properly closed.
[0m15:22:04.123511 [info ] [MainThread]: 
[0m15:22:04.124891 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.71 seconds (2.71s).
[0m15:22:04.126312 [debug] [MainThread]: Command end result
[0m15:22:04.166849 [info ] [MainThread]: 
[0m15:22:04.170886 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:04.173326 [info ] [MainThread]: 
[0m15:22:04.175023 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:22:04.177310 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.732887, "process_user_time": 8.345944, "process_kernel_time": 0.874978, "process_mem_max_rss": "261356", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:04.182054 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:04.180907 after 6.74 seconds
[0m15:22:04.183784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1899a0f200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1895403770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1895449bb0>]}
[0m15:22:04.189366 [debug] [MainThread]: Flushing usage events
[0m16:37:32.859752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e10bc0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e1015a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e10135f0>]}


============================== 16:37:32.870253 | f3f37c07-b523-42dd-badf-cccadce9ed4c ==============================
[0m16:37:32.870253 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:37:32.871655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:37:33.087799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3f37c07-b523-42dd-badf-cccadce9ed4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e1016030>]}
[0m16:37:33.538155 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-eukj1qri'
[0m16:37:33.539440 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:37:34.660689 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:37:34.663051 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:37:34.801793 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:37:34.811994 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:37:38.878752 [info ] [MainThread]: Installed from version 1.3.0
[0m16:37:38.880303 [info ] [MainThread]: Up to date!
[0m16:37:38.881664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f3f37c07-b523-42dd-badf-cccadce9ed4c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e0f0e4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e0f0f830>]}
[0m16:37:38.884380 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 6.1457167, "process_user_time": 4.483232, "process_kernel_time": 0.403983, "process_mem_max_rss": "111844", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m16:37:38.885695 [debug] [MainThread]: Command `dbt deps` succeeded at 16:37:38.885448 after 6.15 seconds
[0m16:37:38.886881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e1187290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e169a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1e0ef3740>]}
[0m16:37:38.888065 [debug] [MainThread]: Flushing usage events
[0m16:37:45.950328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fc076f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fc0aa2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fc076d490>]}


============================== 16:37:45.958678 | 543f83b9-2b2b-43ee-aa4f-33d7c1f1d185 ==============================
[0m16:37:45.958678 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:37:45.959985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_flights', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:37:47.575495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '543f83b9-2b2b-43ee-aa4f-33d7c1f1d185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f9fe2ee10>]}
[0m16:37:47.796120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '543f83b9-2b2b-43ee-aa4f-33d7c1f1d185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f9d3f7e30>]}
[0m16:37:47.797714 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:37:47.838111 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:37:47.871574 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m16:37:47.872839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '543f83b9-2b2b-43ee-aa4f-33d7c1f1d185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f9d23a5a0>]}
[0m16:37:51.380243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '543f83b9-2b2b-43ee-aa4f-33d7c1f1d185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f87c658b0>]}
[0m16:37:51.443202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '543f83b9-2b2b-43ee-aa4f-33d7c1f1d185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f87c9dca0>]}
[0m16:37:51.446159 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:37:51.449665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '543f83b9-2b2b-43ee-aa4f-33d7c1f1d185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f9d238050>]}
[0m16:37:51.459592 [info ] [MainThread]: 
[0m16:37:51.465650 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:37:51.470347 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:37:51.471891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:51.937831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:37:51.939186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:52.272738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '543f83b9-2b2b-43ee-aa4f-33d7c1f1d185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f9d148fe0>]}
[0m16:37:52.274794 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:37:52.276269 [info ] [MainThread]: 
[0m16:37:52.294934 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m16:37:52.296372 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m16:37:52.298143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.stg_flights)
[0m16:37:52.299339 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m16:37:52.315641 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m16:37:52.329800 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (compile): 16:37:52.300250 => 16:37:52.329258
[0m16:37:52.330741 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m16:37:52.387597 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m16:37:52.404386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:52.461267 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    cast( concat(cast(FlightDate as string), ' ', DepTimeFormatted) as timestamp) as dep_time,
    cast( concat(cast(FlightDate as string), ' ', ArrTimeFormatted) as timestamp) as arr_time,
    FlightNum as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m16:37:53.672552 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:49b4c53c-a455-4151-afa8-822661d78e1a&page=queryresults
[0m16:37:53.929804 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (execute): 16:37:52.331744 => 16:37:53.929443
[0m16:37:53.931437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '543f83b9-2b2b-43ee-aa4f-33d7c1f1d185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f9cf62b70>]}
[0m16:37:53.932856 [info ] [Thread-1 (]: 1 of 1 OK created sql view model db_project_dataset.stg_flights ................ [[32mCREATE VIEW (0 processed)[0m in 1.63s]
[0m16:37:53.934638 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m16:37:53.938362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:53.939410 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m16:37:53.940395 [info ] [MainThread]: 
[0m16:37:53.941587 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.48 seconds (2.48s).
[0m16:37:53.943573 [debug] [MainThread]: Command end result
[0m16:37:53.978773 [info ] [MainThread]: 
[0m16:37:53.980006 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:37:53.981080 [info ] [MainThread]: 
[0m16:37:53.982254 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:37:53.984288 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.137541, "process_user_time": 9.469152, "process_kernel_time": 0.620599, "process_mem_max_rss": "264808", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:37:53.985885 [debug] [MainThread]: Command `dbt run` succeeded at 16:37:53.985541 after 8.14 seconds
[0m16:37:53.987087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fc0aa2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f87cc8f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fc4dab200>]}
[0m16:37:53.988277 [debug] [MainThread]: Flushing usage events
[0m16:38:00.454272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cab783e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ca9868c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ca95a2870>]}


============================== 16:38:00.462826 | c1fecc43-d4e0-4de5-9edf-cdf947e64d50 ==============================
[0m16:38:00.462826 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:38:00.464170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models core_flights', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:38:01.896088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1fecc43-d4e0-4de5-9edf-cdf947e64d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c861cbc80>]}
[0m16:38:02.089119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1fecc43-d4e0-4de5-9edf-cdf947e64d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c862c42c0>]}
[0m16:38:02.091280 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:38:02.136064 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:38:03.041111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:38:03.041925 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:38:03.050917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1fecc43-d4e0-4de5-9edf-cdf947e64d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c86036300>]}
[0m16:38:03.083863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1fecc43-d4e0-4de5-9edf-cdf947e64d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c85fd84d0>]}
[0m16:38:03.085200 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:38:03.086553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1fecc43-d4e0-4de5-9edf-cdf947e64d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c85ef2690>]}
[0m16:38:03.089233 [info ] [MainThread]: 
[0m16:38:03.092445 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:38:03.095140 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:38:03.096262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:03.494735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:38:03.496542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:03.793951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1fecc43-d4e0-4de5-9edf-cdf947e64d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c85ef3020>]}
[0m16:38:03.796187 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:38:03.797681 [info ] [MainThread]: 
[0m16:38:03.811018 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m16:38:03.812441 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m16:38:03.814072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m16:38:03.815127 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m16:38:03.826827 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m16:38:03.843838 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 16:38:03.815889 => 16:38:03.843327
[0m16:38:03.844886 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m16:38:03.904671 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m16:38:03.925239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:03.967022 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    dep_airport.airport,
    dep_airport.city,
    dep_airport.state,
    dep_airport.country,
    flight_data.dest,
    arr_airport.airport,
    arr_airport.city,
    arr_airport.state,
    arr_airport.country,
from flight_data
inner join airports_data as dep_airport
on flight_data.origin = dep_airport.iata
inner join airports_data as arr_airport
on flight_data.dest = arr_airport.iata
    );
  
[0m16:38:04.430169 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:f85ed76e-652c-4098-96a8-9b83bdaf456e&page=queryresults
[0m16:38:04.432996 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    dep_airport.airport,
    dep_airport.city,
    dep_airport.state,
    dep_airport.country,
    flight_data.dest,
    arr_airport.airport,
    arr_airport.city,
    arr_airport.state,
    arr_airport.country,
from flight_data
inner join airports_data as dep_airport
on flight_data.origin = dep_airport.iata
inner join airports_data as arr_airport
on flight_data.dest = arr_airport.iata
    );
  
[0m16:38:04.435117 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2; reason: notFound, message: Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2

Location: europe-central2
Job ID: f85ed76e-652c-4098-96a8-9b83bdaf456e

[0m16:38:04.437364 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 16:38:03.845677 => 16:38:04.436651
[0m16:38:04.445946 [debug] [Thread-1 (]: Runtime Error in model core_flights (models/core/core_flights.sql)
  404 Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2; reason: notFound, message: Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2
  
  Location: europe-central2
  Job ID: f85ed76e-652c-4098-96a8-9b83bdaf456e
  
[0m16:38:04.447139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1fecc43-d4e0-4de5-9edf-cdf947e64d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c85e2f7a0>]}
[0m16:38:04.448358 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.core_flights .......... [[31mERROR[0m in 0.63s]
[0m16:38:04.449900 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m16:38:04.454869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:04.456196 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m16:38:04.457409 [info ] [MainThread]: 
[0m16:38:04.458754 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.37 seconds (1.37s).
[0m16:38:04.460569 [debug] [MainThread]: Command end result
[0m16:38:04.491468 [info ] [MainThread]: 
[0m16:38:04.492668 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:38:04.493698 [info ] [MainThread]: 
[0m16:38:04.495050 [error] [MainThread]:   Runtime Error in model core_flights (models/core/core_flights.sql)
  404 Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2; reason: notFound, message: Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2
  
  Location: europe-central2
  Job ID: f85ed76e-652c-4098-96a8-9b83bdaf456e
  
[0m16:38:04.496630 [info ] [MainThread]: 
[0m16:38:04.498186 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:38:04.500204 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.148358, "process_user_time": 5.818985, "process_kernel_time": 0.671036, "process_mem_max_rss": "256832", "process_in_blocks": "24", "command_success": false, "process_out_blocks": "0"}
[0m16:38:04.501492 [debug] [MainThread]: Command `dbt run` failed at 16:38:04.501238 after 4.15 seconds
[0m16:38:04.502559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ca990e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c86a71640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c8619d4c0>]}
[0m16:38:04.503809 [debug] [MainThread]: Flushing usage events
[0m16:41:22.411444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f267d5e94c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f267d5e8770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f267d5e8dd0>]}


============================== 16:41:22.422083 | 801164ed-532d-4425-8602-7965aabeacb2 ==============================
[0m16:41:22.422083 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:41:22.423683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models core_flights', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:41:23.841267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '801164ed-532d-4425-8602-7965aabeacb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2660eff8c0>]}
[0m16:41:24.035910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '801164ed-532d-4425-8602-7965aabeacb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f267e8ab9b0>]}
[0m16:41:24.037277 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:41:24.096880 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:41:24.136109 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:41:24.137716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '801164ed-532d-4425-8602-7965aabeacb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f265a035c70>]}
[0m16:41:27.482198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '801164ed-532d-4425-8602-7965aabeacb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2659e3bb00>]}
[0m16:41:27.516333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '801164ed-532d-4425-8602-7965aabeacb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2658bb92e0>]}
[0m16:41:27.517969 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:41:27.519515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '801164ed-532d-4425-8602-7965aabeacb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2658a14f80>]}
[0m16:41:27.523288 [info ] [MainThread]: 
[0m16:41:27.525873 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:41:27.529100 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:41:27.530765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:27.935535 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:41:27.936997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:28.269674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '801164ed-532d-4425-8602-7965aabeacb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f265a00f9b0>]}
[0m16:41:28.271823 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:41:28.273082 [info ] [MainThread]: 
[0m16:41:28.283869 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m16:41:28.285156 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m16:41:28.286888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m16:41:28.287963 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m16:41:28.299507 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m16:41:28.312319 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 16:41:28.288766 => 16:41:28.311806
[0m16:41:28.313357 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m16:41:28.370821 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m16:41:28.383700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:28.424732 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    dep_airport.airport,
    dep_airport.city,
    dep_airport.state,
    dep_airport.country,
    flight_data.dest,
    arr_airport.airport,
    arr_airport.city,
    arr_airport.state,
    arr_airport.country,
from flight_data
inner join airports_data as dep_airport
on flight_data.origin = dep_airport.iata
inner join airports_data as arr_airport
on flight_data.dest = arr_airport.iata
    );
  
[0m16:41:28.877459 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:becbdaaf-36ee-4153-ad12-26fa176e49b5&page=queryresults
[0m16:41:28.879664 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    dep_airport.airport,
    dep_airport.city,
    dep_airport.state,
    dep_airport.country,
    flight_data.dest,
    arr_airport.airport,
    arr_airport.city,
    arr_airport.state,
    arr_airport.country,
from flight_data
inner join airports_data as dep_airport
on flight_data.origin = dep_airport.iata
inner join airports_data as arr_airport
on flight_data.dest = arr_airport.iata
    );
  
[0m16:41:28.881388 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2; reason: notFound, message: Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2

Location: europe-central2
Job ID: becbdaaf-36ee-4153-ad12-26fa176e49b5

[0m16:41:28.883364 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 16:41:28.314037 => 16:41:28.882828
[0m16:41:28.890842 [debug] [Thread-1 (]: Runtime Error in model core_flights (models/core/core_flights.sql)
  404 Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2; reason: notFound, message: Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2
  
  Location: europe-central2
  Job ID: becbdaaf-36ee-4153-ad12-26fa176e49b5
  
[0m16:41:28.892000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '801164ed-532d-4425-8602-7965aabeacb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2659ce4350>]}
[0m16:41:28.893225 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.core_flights .......... [[31mERROR[0m in 0.61s]
[0m16:41:28.894863 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m16:41:28.898795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:28.899683 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m16:41:28.900545 [info ] [MainThread]: 
[0m16:41:28.901670 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.38 seconds (1.38s).
[0m16:41:28.903214 [debug] [MainThread]: Command end result
[0m16:41:28.939792 [info ] [MainThread]: 
[0m16:41:28.941522 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:41:28.943146 [info ] [MainThread]: 
[0m16:41:28.944966 [error] [MainThread]:   Runtime Error in model core_flights (models/core/core_flights.sql)
  404 Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2; reason: notFound, message: Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2
  
  Location: europe-central2
  Job ID: becbdaaf-36ee-4153-ad12-26fa176e49b5
  
[0m16:41:28.946809 [info ] [MainThread]: 
[0m16:41:28.948443 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:41:28.950800 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.7626467, "process_user_time": 8.500776, "process_kernel_time": 0.617875, "process_mem_max_rss": "264012", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:41:28.952385 [debug] [MainThread]: Command `dbt run` failed at 16:41:28.951919 after 6.76 seconds
[0m16:41:28.954069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2681bc7200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2659ce4350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2659bfc2c0>]}
[0m16:41:28.955362 [debug] [MainThread]: Flushing usage events
[0m16:43:41.235797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7482f320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e726a52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e726a5010>]}


============================== 16:43:41.245881 | f28c1c7d-abf8-47e9-b750-e65286ed5e18 ==============================
[0m16:43:41.245881 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:43:41.247292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m16:43:42.822526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f28c1c7d-abf8-47e9-b750-e65286ed5e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4f208830>]}
[0m16:43:43.009188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f28c1c7d-abf8-47e9-b750-e65286ed5e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e729cc740>]}
[0m16:43:43.010440 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:43:43.049504 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:43:43.953238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:43:43.954023 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:43:43.962702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f28c1c7d-abf8-47e9-b750-e65286ed5e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4f022a50>]}
[0m16:43:43.992518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f28c1c7d-abf8-47e9-b750-e65286ed5e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4eeac890>]}
[0m16:43:43.993772 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:43:43.995080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f28c1c7d-abf8-47e9-b750-e65286ed5e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4ee1e300>]}
[0m16:43:43.998457 [info ] [MainThread]: 
[0m16:43:44.001026 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:43:44.003885 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:43:44.005141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:44.619033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:43:44.620793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:43:44.978880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f28c1c7d-abf8-47e9-b750-e65286ed5e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4f1815b0>]}
[0m16:43:44.981034 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:43:44.982432 [info ] [MainThread]: 
[0m16:43:44.993796 [debug] [Thread-1 (]: Began running node seed.flights_project.airports
[0m16:43:44.994973 [info ] [Thread-1 (]: 1 of 1 START seed file db_project_dataset.airports ............................. [RUN]
[0m16:43:44.996492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now seed.flights_project.airports)
[0m16:43:44.997417 [debug] [Thread-1 (]: Began compiling node seed.flights_project.airports
[0m16:43:44.998455 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (compile): 16:43:44.998094 => 16:43:44.998100
[0m16:43:44.999468 [debug] [Thread-1 (]: Began executing node seed.flights_project.airports
[0m16:43:45.160586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:47.551624 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
LOAD TABLE
[0m16:43:47.553310 [debug] [Thread-1 (]: BigQuery adapter: Runtime Error
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3375; errors: 1; max bad: 0; error percent: 0
  Error while reading data, error message: Data between close quote character (") and field separator.; line_number: 1253 byte_offset_to_start_of_line: 89937 column_index: 1 column_name: "airport" column_type: STRING value: "W. H. \\"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m16:43:47.555082 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (execute): 16:43:45.000231 => 16:43:47.554531
[0m16:43:47.562512 [debug] [Thread-1 (]: Runtime Error in seed airports (seeds/airports.csv)
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3375; errors: 1; max bad: 0; error percent: 0
  Error while reading data, error message: Data between close quote character (") and field separator.; line_number: 1253 byte_offset_to_start_of_line: 89937 column_index: 1 column_name: "airport" column_type: STRING value: "W. H. \\"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m16:43:47.563795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f28c1c7d-abf8-47e9-b750-e65286ed5e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e726a9310>]}
[0m16:43:47.565006 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file db_project_dataset.airports ..................... [[31mERROR[0m in 2.57s]
[0m16:43:47.566646 [debug] [Thread-1 (]: Finished running node seed.flights_project.airports
[0m16:43:47.570825 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:47.571758 [debug] [MainThread]: Connection 'seed.flights_project.airports' was properly closed.
[0m16:43:47.572811 [info ] [MainThread]: 
[0m16:43:47.574182 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.57 seconds (3.57s).
[0m16:43:47.576013 [debug] [MainThread]: Command end result
[0m16:43:47.601619 [info ] [MainThread]: 
[0m16:43:47.603028 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:43:47.604084 [info ] [MainThread]: 
[0m16:43:47.605282 [error] [MainThread]:   Runtime Error in seed airports (seeds/airports.csv)
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3375; errors: 1; max bad: 0; error percent: 0
  Error while reading data, error message: Data between close quote character (") and field separator.; line_number: 1253 byte_offset_to_start_of_line: 89937 column_index: 1 column_name: "airport" column_type: STRING value: "W. H. \\"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m16:43:47.606691 [info ] [MainThread]: 
[0m16:43:47.608295 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:43:47.610872 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 6.482304, "process_user_time": 6.543891, "process_kernel_time": 0.677297, "process_mem_max_rss": "260328", "process_in_blocks": "80", "command_success": false, "process_out_blocks": "0"}
[0m16:43:47.612173 [debug] [MainThread]: Command `dbt seed` failed at 16:43:47.611917 after 6.48 seconds
[0m16:43:47.613398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e5410cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e727af5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e727aeae0>]}
[0m16:43:47.614465 [debug] [MainThread]: Flushing usage events
[0m16:45:29.628000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688e9db050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688e9d5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688e9d6c30>]}


============================== 16:45:29.637001 | 4e8a8c7c-cb6c-40d9-aae3-fc9135133b23 ==============================
[0m16:45:29.637001 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:45:29.638504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:45:31.029345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e8a8c7c-cb6c-40d9-aae3-fc9135133b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688e9924e0>]}
[0m16:45:31.235915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e8a8c7c-cb6c-40d9-aae3-fc9135133b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f686b7b4fe0>]}
[0m16:45:31.237304 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:45:31.278501 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:45:31.310794 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:45:31.312173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4e8a8c7c-cb6c-40d9-aae3-fc9135133b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f686b2d1730>]}
[0m16:45:34.958119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e8a8c7c-cb6c-40d9-aae3-fc9135133b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6869fc02f0>]}
[0m16:45:34.992026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e8a8c7c-cb6c-40d9-aae3-fc9135133b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6869fb5a30>]}
[0m16:45:34.993349 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:45:34.994433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e8a8c7c-cb6c-40d9-aae3-fc9135133b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f686aff58b0>]}
[0m16:45:34.997735 [info ] [MainThread]: 
[0m16:45:34.999789 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:45:35.003019 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:45:35.004549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:35.387602 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:45:35.389106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:45:35.731564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e8a8c7c-cb6c-40d9-aae3-fc9135133b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f686b242630>]}
[0m16:45:35.733235 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:45:35.734297 [info ] [MainThread]: 
[0m16:45:35.745236 [debug] [Thread-1 (]: Began running node seed.flights_project.airports
[0m16:45:35.746463 [info ] [Thread-1 (]: 1 of 1 START seed file db_project_dataset.airports ............................. [RUN]
[0m16:45:35.748167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now seed.flights_project.airports)
[0m16:45:35.749172 [debug] [Thread-1 (]: Began compiling node seed.flights_project.airports
[0m16:45:35.750359 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (compile): 16:45:35.749914 => 16:45:35.749920
[0m16:45:35.751526 [debug] [Thread-1 (]: Began executing node seed.flights_project.airports
[0m16:45:35.915919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:38.178706 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
LOAD TABLE
[0m16:45:38.180569 [debug] [Thread-1 (]: BigQuery adapter: Runtime Error
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3375; errors: 1; max bad: 0; error percent: 0
  Error while reading data, error message: Data between close quote character (") and field separator.; line_number: 1253 byte_offset_to_start_of_line: 89937 column_index: 1 column_name: "airport" column_type: STRING value: "W. H. \\"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m16:45:38.182148 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (execute): 16:45:35.752344 => 16:45:38.181657
[0m16:45:38.189050 [debug] [Thread-1 (]: Runtime Error in seed airports (seeds/airports.csv)
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3375; errors: 1; max bad: 0; error percent: 0
  Error while reading data, error message: Data between close quote character (") and field separator.; line_number: 1253 byte_offset_to_start_of_line: 89937 column_index: 1 column_name: "airport" column_type: STRING value: "W. H. \\"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m16:45:38.190446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e8a8c7c-cb6c-40d9-aae3-fc9135133b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68694bf620>]}
[0m16:45:38.191933 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file db_project_dataset.airports ..................... [[31mERROR[0m in 2.44s]
[0m16:45:38.193891 [debug] [Thread-1 (]: Finished running node seed.flights_project.airports
[0m16:45:38.198233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:38.199255 [debug] [MainThread]: Connection 'seed.flights_project.airports' was properly closed.
[0m16:45:38.200353 [info ] [MainThread]: 
[0m16:45:38.201982 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m16:45:38.204289 [debug] [MainThread]: Command end result
[0m16:45:38.244139 [info ] [MainThread]: 
[0m16:45:38.245326 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:45:38.246521 [info ] [MainThread]: 
[0m16:45:38.247785 [error] [MainThread]:   Runtime Error in seed airports (seeds/airports.csv)
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3375; errors: 1; max bad: 0; error percent: 0
  Error while reading data, error message: Data between close quote character (") and field separator.; line_number: 1253 byte_offset_to_start_of_line: 89937 column_index: 1 column_name: "airport" column_type: STRING value: "W. H. \\"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m16:45:38.249342 [info ] [MainThread]: 
[0m16:45:38.251087 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:45:38.254241 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 8.813454, "process_user_time": 8.3038, "process_kernel_time": 0.691983, "process_mem_max_rss": "272380", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:45:38.255430 [debug] [MainThread]: Command `dbt seed` failed at 16:45:38.255184 after 8.81 seconds
[0m16:45:38.256575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688e9db050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f686b242630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688e993b60>]}
[0m16:45:38.257930 [debug] [MainThread]: Flushing usage events
[0m16:46:34.657736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc45135dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc43bbe3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc43544e30>]}


============================== 16:46:34.666641 | ed436a2b-b52b-4fba-86df-83fd44d44ae1 ==============================
[0m16:46:34.666641 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:46:34.668136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models core_flights', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:46:36.039432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed436a2b-b52b-4fba-86df-83fd44d44ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc248d2e70>]}
[0m16:46:36.230019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed436a2b-b52b-4fba-86df-83fd44d44ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc247012b0>]}
[0m16:46:36.231493 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:46:36.269428 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:46:37.198171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:46:37.198997 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:46:37.207889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed436a2b-b52b-4fba-86df-83fd44d44ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc249d1d00>]}
[0m16:46:37.238876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed436a2b-b52b-4fba-86df-83fd44d44ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1fed8bc0>]}
[0m16:46:37.240262 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:46:37.241868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed436a2b-b52b-4fba-86df-83fd44d44ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1fc49e20>]}
[0m16:46:37.244733 [info ] [MainThread]: 
[0m16:46:37.247251 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:46:37.251644 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:46:37.253122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:37.687568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:46:37.689125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:38.012756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed436a2b-b52b-4fba-86df-83fd44d44ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc478ba5a0>]}
[0m16:46:38.015240 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:46:38.016576 [info ] [MainThread]: 
[0m16:46:38.030754 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m16:46:38.032443 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m16:46:38.034303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m16:46:38.035669 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m16:46:38.050051 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m16:46:38.065181 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 16:46:38.036699 => 16:46:38.064542
[0m16:46:38.066830 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m16:46:38.156865 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m16:46:38.168592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:38.287043 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    dep_airport.airport,
    dep_airport.city,
    dep_airport.state,
    dep_airport.country,
    flight_data.dest,
    arr_airport.airport,
    arr_airport.city,
    arr_airport.state,
    arr_airport.country,
from flight_data
inner join airports_data as dep_airport
on flight_data.origin = dep_airport.iata
inner join airports_data as arr_airport
on flight_data.dest = arr_airport.iata
    );
  
[0m16:46:38.703587 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:bb97a94d-f4e1-4e0f-bf34-0447835da959&page=queryresults
[0m16:46:38.705610 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    dep_airport.airport,
    dep_airport.city,
    dep_airport.state,
    dep_airport.country,
    flight_data.dest,
    arr_airport.airport,
    arr_airport.city,
    arr_airport.state,
    arr_airport.country,
from flight_data
inner join airports_data as dep_airport
on flight_data.origin = dep_airport.iata
inner join airports_data as arr_airport
on flight_data.dest = arr_airport.iata
    );
  
[0m16:46:38.707249 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2; reason: notFound, message: Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2

Location: europe-central2
Job ID: bb97a94d-f4e1-4e0f-bf34-0447835da959

[0m16:46:38.709001 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 16:46:38.068221 => 16:46:38.708469
[0m16:46:38.717532 [debug] [Thread-1 (]: Runtime Error in model core_flights (models/core/core_flights.sql)
  404 Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2; reason: notFound, message: Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2
  
  Location: europe-central2
  Job ID: bb97a94d-f4e1-4e0f-bf34-0447835da959
  
[0m16:46:38.718762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed436a2b-b52b-4fba-86df-83fd44d44ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1fc87350>]}
[0m16:46:38.720261 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.core_flights .......... [[31mERROR[0m in 0.69s]
[0m16:46:38.722047 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m16:46:38.727637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:46:38.729189 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m16:46:38.730488 [info ] [MainThread]: 
[0m16:46:38.733200 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.48 seconds (1.48s).
[0m16:46:38.736244 [debug] [MainThread]: Command end result
[0m16:46:38.767347 [info ] [MainThread]: 
[0m16:46:38.769102 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:46:38.770832 [info ] [MainThread]: 
[0m16:46:38.772660 [error] [MainThread]:   Runtime Error in model core_flights (models/core/core_flights.sql)
  404 Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2; reason: notFound, message: Not found: Table db-project-456518:db_project_dataset.airports was not found in location europe-central2
  
  Location: europe-central2
  Job ID: bb97a94d-f4e1-4e0f-bf34-0447835da959
  
[0m16:46:38.774177 [info ] [MainThread]: 
[0m16:46:38.775662 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:46:38.778033 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.234969, "process_user_time": 5.820957, "process_kernel_time": 0.626872, "process_mem_max_rss": "254208", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:46:38.779387 [debug] [MainThread]: Command `dbt run` failed at 16:46:38.779063 after 4.24 seconds
[0m16:46:38.781095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4364b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1fe51460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc247012b0>]}
[0m16:46:38.782466 [debug] [MainThread]: Flushing usage events
[0m16:47:40.465085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea6ddf3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea6cd4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea6c8e4e0>]}


============================== 16:47:40.473651 | 6e40d04b-e6ee-4e16-b35b-b0ea74bc5d71 ==============================
[0m16:47:40.473651 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:47:40.474891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m16:47:42.166689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e40d04b-e6ee-4e16-b35b-b0ea74bc5d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e838516a0>]}
[0m16:47:42.514623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e40d04b-e6ee-4e16-b35b-b0ea74bc5d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e83a4b470>]}
[0m16:47:42.516430 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:47:42.567359 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:47:42.608959 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:47:42.610293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e40d04b-e6ee-4e16-b35b-b0ea74bc5d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e83591460>]}
[0m16:47:46.827311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e40d04b-e6ee-4e16-b35b-b0ea74bc5d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e82295820>]}
[0m16:47:46.890720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e40d04b-e6ee-4e16-b35b-b0ea74bc5d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8366a2a0>]}
[0m16:47:46.896838 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:47:46.899453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e40d04b-e6ee-4e16-b35b-b0ea74bc5d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e822c52b0>]}
[0m16:47:46.906009 [info ] [MainThread]: 
[0m16:47:46.913997 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:47:46.923283 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:47:46.925415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:47.290830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:47:47.292074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:47:47.613789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e40d04b-e6ee-4e16-b35b-b0ea74bc5d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e822c52b0>]}
[0m16:47:47.616080 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:47:47.617342 [info ] [MainThread]: 
[0m16:47:47.629172 [debug] [Thread-1 (]: Began running node seed.flights_project.airports
[0m16:47:47.630426 [info ] [Thread-1 (]: 1 of 1 START seed file db_project_dataset.airports ............................. [RUN]
[0m16:47:47.632191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now seed.flights_project.airports)
[0m16:47:47.633305 [debug] [Thread-1 (]: Began compiling node seed.flights_project.airports
[0m16:47:47.634517 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (compile): 16:47:47.634145 => 16:47:47.634152
[0m16:47:47.635579 [debug] [Thread-1 (]: Began executing node seed.flights_project.airports
[0m16:47:47.800583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:50.385565 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
LOAD TABLE
[0m16:47:50.387733 [debug] [Thread-1 (]: BigQuery adapter: Runtime Error
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3375; errors: 1; max bad: 0; error percent: 0
  Error while reading data, error message: Data between close quote character (") and field separator.; line_number: 1253 byte_offset_to_start_of_line: 89937 column_index: 1 column_name: "airport" column_type: STRING value: "W. H. \\"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m16:47:50.390123 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (execute): 16:47:47.636407 => 16:47:50.389407
[0m16:47:50.402077 [debug] [Thread-1 (]: Runtime Error in seed airports (seeds/airports.csv)
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3375; errors: 1; max bad: 0; error percent: 0
  Error while reading data, error message: Data between close quote character (") and field separator.; line_number: 1253 byte_offset_to_start_of_line: 89937 column_index: 1 column_name: "airport" column_type: STRING value: "W. H. \\"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m16:47:50.404579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e40d04b-e6ee-4e16-b35b-b0ea74bc5d71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e82097b30>]}
[0m16:47:50.406736 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file db_project_dataset.airports ..................... [[31mERROR[0m in 2.77s]
[0m16:47:50.411567 [debug] [Thread-1 (]: Finished running node seed.flights_project.airports
[0m16:47:50.417674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:50.419387 [debug] [MainThread]: Connection 'seed.flights_project.airports' was properly closed.
[0m16:47:50.421167 [info ] [MainThread]: 
[0m16:47:50.429011 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.51 seconds (3.51s).
[0m16:47:50.431308 [debug] [MainThread]: Command end result
[0m16:47:50.483071 [info ] [MainThread]: 
[0m16:47:50.485159 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:47:50.486857 [info ] [MainThread]: 
[0m16:47:50.489032 [error] [MainThread]:   Runtime Error in seed airports (seeds/airports.csv)
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 3375; errors: 1; max bad: 0; error percent: 0
  Error while reading data, error message: Data between close quote character (") and field separator.; line_number: 1253 byte_offset_to_start_of_line: 89937 column_index: 1 column_name: "airport" column_type: STRING value: "W. H. \\"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m16:47:50.491324 [info ] [MainThread]: 
[0m16:47:50.501114 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:47:50.504389 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 10.222936, "process_user_time": 10.305422, "process_kernel_time": 0.748382, "process_mem_max_rss": "270168", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:47:50.506211 [debug] [MainThread]: Command `dbt seed` failed at 16:47:50.505734 after 10.23 seconds
[0m16:47:50.508200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea7e29760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eab30f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e836fd5b0>]}
[0m16:47:50.511507 [debug] [MainThread]: Flushing usage events
[0m16:49:52.864043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc105d680b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc105c432c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc105c5d9d0>]}


============================== 16:49:52.878522 | 06ce1801-bdda-47e5-924d-33f8e5451b5a ==============================
[0m16:49:52.878522 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:49:52.880871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m16:49:55.520181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06ce1801-bdda-47e5-924d-33f8e5451b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e27e39e0>]}
[0m16:49:55.726174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06ce1801-bdda-47e5-924d-33f8e5451b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e2dd8080>]}
[0m16:49:55.727580 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:49:55.769822 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:49:55.803021 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:49:55.804368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '06ce1801-bdda-47e5-924d-33f8e5451b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e22f5250>]}
[0m16:50:00.257931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06ce1801-bdda-47e5-924d-33f8e5451b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e1029670>]}
[0m16:50:00.312724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06ce1801-bdda-47e5-924d-33f8e5451b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e11baa80>]}
[0m16:50:00.314768 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:50:00.318667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06ce1801-bdda-47e5-924d-33f8e5451b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e24b6f30>]}
[0m16:50:00.323377 [info ] [MainThread]: 
[0m16:50:00.326104 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:50:00.329703 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:50:00.332761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:00.810214 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:50:00.811794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:01.209194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06ce1801-bdda-47e5-924d-33f8e5451b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e24c0800>]}
[0m16:50:01.213512 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:50:01.221422 [info ] [MainThread]: 
[0m16:50:01.440680 [debug] [Thread-1 (]: Began running node seed.flights_project.airports
[0m16:50:01.874987 [info ] [Thread-1 (]: 1 of 1 START seed file db_project_dataset.airports ............................. [RUN]
[0m16:50:01.878473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now seed.flights_project.airports)
[0m16:50:01.880649 [debug] [Thread-1 (]: Began compiling node seed.flights_project.airports
[0m16:50:01.884666 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (compile): 16:50:01.883785 => 16:50:01.883802
[0m16:50:01.886380 [debug] [Thread-1 (]: Began executing node seed.flights_project.airports
[0m16:50:02.170938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:05.511373 [debug] [Thread-1 (]: On seed.flights_project.airports: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.flights_project.airports"} */

    alter table `db-project-456518`.`db_project_dataset`.`airports` set OPTIONS()
  
[0m16:50:05.770270 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:b1db81fe-0b11-40a7-8dac-e32f13d7d978&page=queryresults
[0m16:50:05.986755 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.flights_project.airports"
[0m16:50:06.071370 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (execute): 16:50:01.897659 => 16:50:06.070447
[0m16:50:06.074070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ce1801-bdda-47e5-924d-33f8e5451b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e05fb470>]}
[0m16:50:06.075598 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file db_project_dataset.airports ......................... [[32mINSERT 3376[0m in 4.20s]
[0m16:50:06.078284 [debug] [Thread-1 (]: Finished running node seed.flights_project.airports
[0m16:50:06.086372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:06.087603 [debug] [MainThread]: Connection 'seed.flights_project.airports' was properly closed.
[0m16:50:06.088777 [info ] [MainThread]: 
[0m16:50:06.090120 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.76 seconds (5.76s).
[0m16:50:06.095484 [debug] [MainThread]: Command end result
[0m16:50:06.137740 [info ] [MainThread]: 
[0m16:50:06.139821 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:50:06.141817 [info ] [MainThread]: 
[0m16:50:06.147744 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:50:06.150975 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 13.46952, "process_user_time": 11.432645, "process_kernel_time": 1.013838, "process_mem_max_rss": "273020", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:50:06.152680 [debug] [MainThread]: Command `dbt seed` succeeded at 16:50:06.152288 after 13.47 seconds
[0m16:50:06.154363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e2475c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc105e19be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc105e18830>]}
[0m16:50:06.156541 [debug] [MainThread]: Flushing usage events
[0m16:52:15.180925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8e7f3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8eb9da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8e578c80>]}


============================== 16:52:15.194512 | 5294a394-11e5-40aa-bf0d-4a4d6b46abf2 ==============================
[0m16:52:15.194512 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:52:15.195838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models core_flights', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:52:17.407318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5294a394-11e5-40aa-bf0d-4a4d6b46abf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b1395b0>]}
[0m16:52:17.603130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5294a394-11e5-40aa-bf0d-4a4d6b46abf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b0d7740>]}
[0m16:52:17.604554 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:52:17.654521 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:52:18.599660 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:52:18.600524 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:52:18.609503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5294a394-11e5-40aa-bf0d-4a4d6b46abf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6adc3710>]}
[0m16:52:18.644833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5294a394-11e5-40aa-bf0d-4a4d6b46abf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6af750d0>]}
[0m16:52:18.646480 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:52:18.648025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5294a394-11e5-40aa-bf0d-4a4d6b46abf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8e5769f0>]}
[0m16:52:18.651836 [info ] [MainThread]: 
[0m16:52:18.654088 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:52:18.656832 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:52:18.657842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:19.621997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:52:19.623804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:19.957502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5294a394-11e5-40aa-bf0d-4a4d6b46abf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b113260>]}
[0m16:52:19.960754 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:52:19.964686 [info ] [MainThread]: 
[0m16:52:20.471535 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m16:52:20.475187 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m16:52:20.488205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m16:52:20.491334 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m16:52:20.541249 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m16:52:20.564013 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 16:52:20.512217 => 16:52:20.563239
[0m16:52:20.565575 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m16:52:20.699189 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m16:52:20.715502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:21.047343 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    dep_airport.airport,
    dep_airport.city,
    dep_airport.state,
    dep_airport.country,
    flight_data.dest,
    arr_airport.airport,
    arr_airport.city,
    arr_airport.state,
    arr_airport.country,
from flight_data
inner join airports_data as dep_airport
on flight_data.origin = dep_airport.iata
inner join airports_data as arr_airport
on flight_data.dest = arr_airport.iata
    );
  
[0m16:52:22.077481 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:5eef3928-85dd-465b-8103-1af9e30b69a5&page=queryresults
[0m16:52:22.225533 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name dest not found inside flight_data at [45:16]; reason: invalidQuery, location: query, message: Name dest not found inside flight_data at [45:16]')
[0m16:52:23.242937 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:79592745-2310-4c82-aac6-580f658e9332&page=queryresults
[0m16:52:23.357905 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:79592745-2310-4c82-aac6-580f658e9332&page=queryresults
[0m16:52:23.363052 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 16:52:20.568053 => 16:52:23.361912
[0m16:52:23.393071 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  Name dest not found inside flight_data at [45:16]
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m16:52:23.395067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5294a394-11e5-40aa-bf0d-4a4d6b46abf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6ad324b0>]}
[0m16:52:23.397560 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.core_flights .......... [[31mERROR[0m in 2.91s]
[0m16:52:23.405639 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m16:52:23.411552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:23.412775 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m16:52:23.413914 [info ] [MainThread]: 
[0m16:52:23.415459 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.76 seconds (4.76s).
[0m16:52:23.423695 [debug] [MainThread]: Command end result
[0m16:52:23.528569 [info ] [MainThread]: 
[0m16:52:23.532544 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:52:23.538122 [info ] [MainThread]: 
[0m16:52:23.541896 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  Name dest not found inside flight_data at [45:16]
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m16:52:23.545086 [info ] [MainThread]: 
[0m16:52:23.550158 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:52:23.555652 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.532283, "process_user_time": 7.901645, "process_kernel_time": 0.769787, "process_mem_max_rss": "252812", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:52:23.557678 [debug] [MainThread]: Command `dbt run` failed at 16:52:23.557170 after 8.53 seconds
[0m16:52:23.559497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8f28eb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b08a840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6afd22d0>]}
[0m16:52:23.561509 [debug] [MainThread]: Flushing usage events
[0m16:53:16.744485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3302344230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33033ba840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3302302720>]}


============================== 16:53:16.772762 | 7d58b488-c838-49c0-8253-926526876429 ==============================
[0m16:53:16.772762 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:53:16.783925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models core_flights', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:53:19.290430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d58b488-c838-49c0-8253-926526876429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32df54b170>]}
[0m16:53:19.530661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d58b488-c838-49c0-8253-926526876429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32df3afef0>]}
[0m16:53:19.532381 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:53:19.571886 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:53:20.809834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:53:20.810981 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/core/core_flights.sql
[0m16:53:21.304532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d58b488-c838-49c0-8253-926526876429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32deb19190>]}
[0m16:53:21.347529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d58b488-c838-49c0-8253-926526876429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ded304a0>]}
[0m16:53:21.349082 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:53:21.350993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d58b488-c838-49c0-8253-926526876429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32dec49be0>]}
[0m16:53:21.353908 [info ] [MainThread]: 
[0m16:53:21.355783 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:53:21.358213 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:53:21.359449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:21.736759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:53:21.738182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:53:22.048629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d58b488-c838-49c0-8253-926526876429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32deeca7e0>]}
[0m16:53:22.051192 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:53:22.052535 [info ] [MainThread]: 
[0m16:53:22.071150 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m16:53:22.073678 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m16:53:22.077363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m16:53:22.079279 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m16:53:22.104107 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m16:53:22.122004 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 16:53:22.081206 => 16:53:22.120889
[0m16:53:22.123764 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m16:53:22.382666 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m16:53:22.408963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:53:22.534852 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    dep_airport.airport,
    dep_airport.city,
    dep_airport.state,
    dep_airport.country,
    flight_data.destination,
    arr_airport.airport,
    arr_airport.city,
    arr_airport.state,
    arr_airport.country,
    flight_data.carrier_code,
    flight_data.carrier_desc
from flight_data
inner join airports_data as dep_airport
on flight_data.origin = dep_airport.iata
inner join airports_data as arr_airport
on flight_data.dest = arr_airport.iata
    );
  
[0m16:53:23.953816 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:6178932f-4e6d-4045-a246-cc825f6bee96&page=queryresults
[0m16:53:24.077475 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name dest not found inside flight_data at [47:16]; reason: invalidQuery, location: query, message: Name dest not found inside flight_data at [47:16]')
[0m16:53:24.536974 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c32c5b6b-cba0-42b3-a93f-ef044b33c6e5&page=queryresults
[0m16:53:24.771334 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c32c5b6b-cba0-42b3-a93f-ef044b33c6e5&page=queryresults
[0m16:53:24.773356 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 16:53:22.124966 => 16:53:24.772753
[0m16:53:24.784943 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  Name dest not found inside flight_data at [47:16]
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m16:53:24.786318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d58b488-c838-49c0-8253-926526876429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32dec0c560>]}
[0m16:53:24.787646 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.core_flights .......... [[31mERROR[0m in 2.71s]
[0m16:53:24.789147 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m16:53:24.793468 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:24.794438 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m16:53:24.795425 [info ] [MainThread]: 
[0m16:53:24.796487 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.44 seconds (3.44s).
[0m16:53:24.798396 [debug] [MainThread]: Command end result
[0m16:53:24.825039 [info ] [MainThread]: 
[0m16:53:24.826491 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:53:24.827639 [info ] [MainThread]: 
[0m16:53:24.829138 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  Name dest not found inside flight_data at [47:16]
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m16:53:24.830259 [info ] [MainThread]: 
[0m16:53:24.831397 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:53:24.833500 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.194453, "process_user_time": 11.639703, "process_kernel_time": 1.073506, "process_mem_max_rss": "241828", "process_in_blocks": "14856", "command_success": false, "process_out_blocks": "0"}
[0m16:53:24.835358 [debug] [MainThread]: Command `dbt run` failed at 16:53:24.834828 after 9.20 seconds
[0m16:53:24.836634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3302344230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3302302ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32deaae030>]}
[0m16:53:24.837922 [debug] [MainThread]: Flushing usage events
[0m16:53:56.424802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab059a5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab05fce270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab059a4bf0>]}


============================== 16:53:56.434814 | ac677628-5722-4b5b-a6ce-70f3c15c8fd4 ==============================
[0m16:53:56.434814 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:53:56.436279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models core_flights', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:53:57.914270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac677628-5722-4b5b-a6ce-70f3c15c8fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab059a48f0>]}
[0m16:53:58.119223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac677628-5722-4b5b-a6ce-70f3c15c8fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae262fad0>]}
[0m16:53:58.120799 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:53:58.164410 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:53:59.280582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:53:59.281807 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/core/core_flights.sql
[0m16:53:59.702195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac677628-5722-4b5b-a6ce-70f3c15c8fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae2094c20>]}
[0m16:53:59.736557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac677628-5722-4b5b-a6ce-70f3c15c8fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae23982c0>]}
[0m16:53:59.738486 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:53:59.740261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac677628-5722-4b5b-a6ce-70f3c15c8fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae201a600>]}
[0m16:53:59.743503 [info ] [MainThread]: 
[0m16:53:59.746044 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:53:59.748955 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:53:59.750830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:00.433801 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:54:00.435366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:00.757713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac677628-5722-4b5b-a6ce-70f3c15c8fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae2473920>]}
[0m16:54:00.759995 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:54:00.761308 [info ] [MainThread]: 
[0m16:54:00.772964 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m16:54:00.774734 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m16:54:00.776992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m16:54:00.778229 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m16:54:00.791258 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m16:54:00.803122 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 16:54:00.779036 => 16:54:00.802367
[0m16:54:00.804353 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m16:54:00.875455 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m16:54:00.890239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:00.933636 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    dep_airport.airport,
    dep_airport.city,
    dep_airport.state,
    dep_airport.country,
    flight_data.destination,
    arr_airport.airport,
    arr_airport.city,
    arr_airport.state,
    arr_airport.country,
    flight_data.carrier_code,
    flight_data.carrier_desc
from flight_data
inner join airports_data as dep_airport
on flight_data.origin = dep_airport.iata
inner join airports_data as arr_airport
on flight_data.destination = arr_airport.iata
    );
  
[0m16:54:01.557463 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c6c9c605-735e-4fd9-b67d-686ea4ce45fa&page=queryresults
[0m16:54:01.706374 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE has columns with duplicate name airport at [15:1]; reason: invalidQuery, location: query, message: CREATE TABLE has columns with duplicate name airport at [15:1]')
[0m16:54:02.951846 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:0cc8f967-ce7d-40f8-95c4-c6f2112f0585&page=queryresults
[0m16:54:03.071447 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:0cc8f967-ce7d-40f8-95c4-c6f2112f0585&page=queryresults
[0m16:54:03.073499 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 16:54:00.805260 => 16:54:03.072873
[0m16:54:03.082904 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  CREATE TABLE has columns with duplicate name airport at [15:1]
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m16:54:03.084273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac677628-5722-4b5b-a6ce-70f3c15c8fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae24ba4e0>]}
[0m16:54:03.085601 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.core_flights .......... [[31mERROR[0m in 2.31s]
[0m16:54:03.087414 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m16:54:03.092884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:03.094212 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m16:54:03.095499 [info ] [MainThread]: 
[0m16:54:03.096902 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.35 seconds (3.35s).
[0m16:54:03.098953 [debug] [MainThread]: Command end result
[0m16:54:03.129519 [info ] [MainThread]: 
[0m16:54:03.130701 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:54:03.132364 [info ] [MainThread]: 
[0m16:54:03.134416 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  CREATE TABLE has columns with duplicate name airport at [15:1]
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m16:54:03.136275 [info ] [MainThread]: 
[0m16:54:03.137627 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:54:03.140146 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.8213134, "process_user_time": 6.478055, "process_kernel_time": 0.723131, "process_mem_max_rss": "259496", "process_in_blocks": "760", "command_success": false, "process_out_blocks": "0"}
[0m16:54:03.141535 [debug] [MainThread]: Command `dbt run` failed at 16:54:03.141274 after 6.82 seconds
[0m16:54:03.142772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab09f77200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae24ba4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab093f1100>]}
[0m16:54:03.143962 [debug] [MainThread]: Flushing usage events
[0m16:54:58.363582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0587b3bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0587d5b830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0587b394c0>]}


============================== 16:54:58.378247 | 97ab7780-32b4-4932-90dd-8ae5dcaf7f59 ==============================
[0m16:54:58.378247 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:54:58.380348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models core_flights', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:55:00.173792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97ab7780-32b4-4932-90dd-8ae5dcaf7f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05686ff6b0>]}
[0m16:55:00.402737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97ab7780-32b4-4932-90dd-8ae5dcaf7f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0568d4c500>]}
[0m16:55:00.404155 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:55:00.450878 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:55:01.367646 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:55:01.369238 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/core/core_flights.sql
[0m16:55:01.836319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97ab7780-32b4-4932-90dd-8ae5dcaf7f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0568482f00>]}
[0m16:55:01.884332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97ab7780-32b4-4932-90dd-8ae5dcaf7f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0568538740>]}
[0m16:55:01.886422 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:55:01.888061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97ab7780-32b4-4932-90dd-8ae5dcaf7f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05681878f0>]}
[0m16:55:01.891776 [info ] [MainThread]: 
[0m16:55:01.895327 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:55:01.899285 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:55:01.900871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:02.367329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:55:02.368930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:02.726104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97ab7780-32b4-4932-90dd-8ae5dcaf7f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05681660c0>]}
[0m16:55:02.728432 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:55:02.731146 [info ] [MainThread]: 
[0m16:55:02.747281 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m16:55:02.748609 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m16:55:02.750371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m16:55:02.751581 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m16:55:02.767151 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m16:55:02.784304 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 16:55:02.752780 => 16:55:02.783767
[0m16:55:02.785484 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m16:55:02.905716 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m16:55:02.919763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:02.968118 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    dep_airport.arr_airport,
    dep_airport.arr_city,
    dep_airport.arr_state,
    dep_airport.arr_country,
    flight_data.destination,
    arr_airport.arr_airport,
    arr_airport.arr_city,
    arr_airport.arr_state,
    arr_airport.arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc
from flight_data
inner join airports_data as dep_airport
on flight_data.origin = dep_airport.iata
inner join airports_data as arr_airport
on flight_data.destination = arr_airport.iata
    );
  
[0m16:55:03.590517 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:1ffe68ec-6656-4f3a-a73a-4b2c69e59488&page=queryresults
[0m16:55:03.708711 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name arr_airport not found inside dep_airport at [32:17]; reason: invalidQuery, location: query, message: Name arr_airport not found inside dep_airport at [32:17]')
[0m16:55:04.938210 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:403022e0-f12d-4749-b585-5ee0ec9f79dc&page=queryresults
[0m16:55:05.054055 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:403022e0-f12d-4749-b585-5ee0ec9f79dc&page=queryresults
[0m16:55:05.056346 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 16:55:02.786877 => 16:55:05.055682
[0m16:55:05.065181 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  Name arr_airport not found inside dep_airport at [32:17]
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m16:55:05.066403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97ab7780-32b4-4932-90dd-8ae5dcaf7f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0568596270>]}
[0m16:55:05.067681 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.core_flights .......... [[31mERROR[0m in 2.32s]
[0m16:55:05.069311 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m16:55:05.073659 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:05.074633 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m16:55:05.075586 [info ] [MainThread]: 
[0m16:55:05.076675 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.18 seconds (3.18s).
[0m16:55:05.078943 [debug] [MainThread]: Command end result
[0m16:55:05.108406 [info ] [MainThread]: 
[0m16:55:05.109759 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:55:05.111757 [info ] [MainThread]: 
[0m16:55:05.112941 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  Name arr_airport not found inside dep_airport at [32:17]
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m16:55:05.114329 [info ] [MainThread]: 
[0m16:55:05.116034 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:55:05.118320 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.8658, "process_user_time": 7.16501, "process_kernel_time": 0.840587, "process_mem_max_rss": "257992", "process_in_blocks": "1944", "command_success": false, "process_out_blocks": "0"}
[0m16:55:05.119508 [debug] [MainThread]: Command `dbt run` failed at 16:55:05.119272 after 6.87 seconds
[0m16:55:05.120630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0587d5b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0587d5b830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f058b80c3e0>]}
[0m16:55:05.121649 [debug] [MainThread]: Flushing usage events
[0m16:57:25.925652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fcc96b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fcc83d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fcc877830>]}


============================== 16:57:25.941280 | 29fbd271-b8ed-4fce-b2bc-e801a95d2b03 ==============================
[0m16:57:25.941280 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:57:25.942826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models core_flights', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:57:27.539252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29fbd271-b8ed-4fce-b2bc-e801a95d2b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fad6ccce0>]}
[0m16:57:27.770694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29fbd271-b8ed-4fce-b2bc-e801a95d2b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8faf21dc70>]}
[0m16:57:27.772105 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:57:27.818637 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:57:28.736546 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:57:28.737711 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/core/core_flights.sql
[0m16:57:29.141719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29fbd271-b8ed-4fce-b2bc-e801a95d2b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fac87d220>]}
[0m16:57:29.201652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29fbd271-b8ed-4fce-b2bc-e801a95d2b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8facb30d70>]}
[0m16:57:29.203706 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:57:29.206172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29fbd271-b8ed-4fce-b2bc-e801a95d2b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fac9161b0>]}
[0m16:57:29.210719 [info ] [MainThread]: 
[0m16:57:29.216812 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:57:29.220238 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:57:29.222092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:29.641368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:57:29.682492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:57:30.073810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29fbd271-b8ed-4fce-b2bc-e801a95d2b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8facb32120>]}
[0m16:57:30.076412 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:57:30.077809 [info ] [MainThread]: 
[0m16:57:30.088396 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m16:57:30.089662 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m16:57:30.091336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m16:57:30.092359 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m16:57:30.103649 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m16:57:30.114301 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 16:57:30.093109 => 16:57:30.113752
[0m16:57:30.115447 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m16:57:30.192289 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m16:57:30.201917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:30.244189 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_airport,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m16:57:30.924860 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:2c0617a8-d439-40c1-ad2a-a97e539d55a4&page=queryresults
[0m16:57:31.086909 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE has columns with duplicate name dep_airport at [15:1]; reason: invalidQuery, location: query, message: CREATE TABLE has columns with duplicate name dep_airport at [15:1]')
[0m16:57:31.867631 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:ad01a8d0-2a4b-4d55-948f-9fdd88e68a48&page=queryresults
[0m16:57:32.009001 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:ad01a8d0-2a4b-4d55-948f-9fdd88e68a48&page=queryresults
[0m16:57:32.012522 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 16:57:30.116210 => 16:57:32.010728
[0m16:57:32.031426 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  CREATE TABLE has columns with duplicate name dep_airport at [15:1]
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m16:57:32.033672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29fbd271-b8ed-4fce-b2bc-e801a95d2b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fac865220>]}
[0m16:57:32.035873 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.core_flights .......... [[31mERROR[0m in 1.94s]
[0m16:57:32.038610 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m16:57:32.046947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:57:32.050879 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m16:57:32.052876 [info ] [MainThread]: 
[0m16:57:32.055342 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m16:57:32.061457 [debug] [MainThread]: Command end result
[0m16:57:32.119677 [info ] [MainThread]: 
[0m16:57:32.122030 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:57:32.123942 [info ] [MainThread]: 
[0m16:57:32.128152 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  CREATE TABLE has columns with duplicate name dep_airport at [15:1]
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m16:57:32.133582 [info ] [MainThread]: 
[0m16:57:32.135738 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:57:32.139275 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.3726435, "process_user_time": 7.40134, "process_kernel_time": 0.826852, "process_mem_max_rss": "260620", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:57:32.141741 [debug] [MainThread]: Command `dbt run` failed at 16:57:32.140944 after 6.38 seconds
[0m16:57:32.144527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fcc7d23c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8facbd2420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8facd27c50>]}
[0m16:57:32.152840 [debug] [MainThread]: Flushing usage events
[0m16:58:02.968594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f742c9f8fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f742d0ece60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f742c9fcc50>]}


============================== 16:58:02.977889 | 49889678-9d93-4401-b94d-f5ac535a21a1 ==============================
[0m16:58:02.977889 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:58:02.979761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models core_flights', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:58:04.674676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49889678-9d93-4401-b94d-f5ac535a21a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f740975b4a0>]}
[0m16:58:04.913896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49889678-9d93-4401-b94d-f5ac535a21a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7409d8e9f0>]}
[0m16:58:04.915630 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:58:04.957360 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:58:05.945178 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:58:05.946278 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/core/core_flights.sql
[0m16:58:06.326577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49889678-9d93-4401-b94d-f5ac535a21a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74093914c0>]}
[0m16:58:06.358585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49889678-9d93-4401-b94d-f5ac535a21a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74093e8710>]}
[0m16:58:06.360076 [info ] [MainThread]: Found 2 models, 1 seed, 1 source, 0 exposures, 0 metrics, 570 macros, 0 groups, 0 semantic models
[0m16:58:06.361358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49889678-9d93-4401-b94d-f5ac535a21a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74091838f0>]}
[0m16:58:06.364244 [info ] [MainThread]: 
[0m16:58:06.366791 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:58:06.370406 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:58:06.372862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:06.923863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:58:06.925350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:58:07.244930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49889678-9d93-4401-b94d-f5ac535a21a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74090fd010>]}
[0m16:58:07.246986 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:58:07.248412 [info ] [MainThread]: 
[0m16:58:07.260406 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m16:58:07.261855 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m16:58:07.263337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m16:58:07.264543 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m16:58:07.276533 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m16:58:07.288063 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 16:58:07.265298 => 16:58:07.287476
[0m16:58:07.289068 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m16:58:07.411669 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m16:58:07.419601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:07.464598 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m16:58:08.170242 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:6fbbcdb8-482e-47c5-a624-16cb97f674b9&page=queryresults
[0m16:58:08.647721 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid timestamp: '1988-09-16 19:55'; reason: invalidQuery, location: query, message: Invalid timestamp: '1988-09-16 19:55'; reason: invalidQuery, location: query, message: Invalid timestamp: '1988-11-12 19:48'; reason: invalidQuery, location: query, message: Invalid timestamp: '1992-09-02 19:53'; reason: invalidQuery, location: query, message: Invalid timestamp: '1990-06-28 14:12'; reason: invalidQuery, location: query, message: Invalid timestamp: '1991-01-03 10:21'; reason: invalidQuery, location: query, message: Invalid timestamp: '1988-06-18 19:52'; reason: invalidQuery, location: query, message: Invalid timestamp: '1987-10-21 19:45'; reason: invalidQuery, location: query, message: Invalid timestamp: '1990-04-02 14:12'; reason: invalidQuery, location: query, message: Invalid timestamp: '1988-01-08 92:1.'; reason: invalidQuery, location: query, message: Invalid timestamp: '1992-06-22 90:6.'; reason: invalidQuery, location: query, message: Invalid timestamp: '1987-10-07 19:37'; reason: invalidQuery, location: query, message: Invalid timestamp: '1987-11-25 19:37'; reason: invalidQuery, location: query, message: Invalid timestamp: '1990-10-31 16:05'; reason: invalidQuery, location: query, message: Invalid timestamp: '1990-12-02 16:05'; reason: invalidQuery, location: query, message: Invalid timestamp: '1991-12-17 90:4.'; reason: invalidQuery, location: query, message: Invalid timestamp: '1992-08-24 19:30'; reason: invalidQuery, location: query, message: Invalid timestamp: '1991-05-23 21:07'; reason: invalidQuery, location: query, message: Invalid timestamp: '1989-01-21 19:45'; reason: invalidQuery, location: query, message: Invalid timestamp: '1990-12-31 16:05'; reason: invalidQuery, location: query, message: Invalid timestamp: '1988-05-02 19:52'; reason: invalidQuery, location: query, message: Invalid timestamp: '1991-01-04 10:20'; reason: invalidQuery, location: query, message: Invalid timestamp: '1992-02-27 17:20'")
[0m16:58:09.354500 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:61893623-db26-47ee-ad32-17d016731f51&page=queryresults
[0m16:58:10.039169 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:61893623-db26-47ee-ad32-17d016731f51&page=queryresults
[0m16:58:10.041231 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 16:58:07.289814 => 16:58:10.040665
[0m16:58:10.052354 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  Invalid timestamp: '1988-11-21 19:48'
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m16:58:10.053677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49889678-9d93-4401-b94d-f5ac535a21a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7409239a60>]}
[0m16:58:10.055075 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.core_flights .......... [[31mERROR[0m in 2.79s]
[0m16:58:10.056577 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m16:58:10.060761 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:58:10.061817 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m16:58:10.062786 [info ] [MainThread]: 
[0m16:58:10.063842 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.70 seconds (3.70s).
[0m16:58:10.066323 [debug] [MainThread]: Command end result
[0m16:58:10.096938 [info ] [MainThread]: 
[0m16:58:10.099117 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:58:10.100374 [info ] [MainThread]: 
[0m16:58:10.101439 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  Invalid timestamp: '1988-11-21 19:48'
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m16:58:10.102649 [info ] [MainThread]: 
[0m16:58:10.103810 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:58:10.105672 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.266441, "process_user_time": 7.82847, "process_kernel_time": 0.858339, "process_mem_max_rss": "262424", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:58:10.107181 [debug] [MainThread]: Command `dbt run` failed at 16:58:10.106842 after 7.27 seconds
[0m16:58:10.108416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f742c9b68d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74094fc470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74091838f0>]}
[0m16:58:10.109590 [debug] [MainThread]: Flushing usage events
[0m16:58:53.863423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738e6f8e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738f6d1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738e6f9490>]}


============================== 16:58:53.876331 | 299094d6-92bd-414c-9808-075d07b68add ==============================
[0m16:58:53.876331 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:58:53.877798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:58:54.109864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '299094d6-92bd-414c-9808-075d07b68add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738e5fd7f0>]}
[0m16:58:54.711413 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jfa4v4zs'
[0m16:58:54.712678 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:58:56.386453 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:58:56.389035 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:58:56.481100 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:58:56.494710 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:59:01.208374 [info ] [MainThread]: Installed from version 1.3.0
[0m16:59:01.209392 [info ] [MainThread]: Up to date!
[0m16:59:01.210627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '299094d6-92bd-414c-9808-075d07b68add', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738e5f2ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738e5f3770>]}
[0m16:59:01.212471 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 7.484122, "process_user_time": 4.44555, "process_kernel_time": 0.508062, "process_mem_max_rss": "112016", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m16:59:01.213555 [debug] [MainThread]: Command `dbt deps` succeeded at 16:59:01.213298 after 7.49 seconds
[0m16:59:01.214998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738edfc8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738e6b67e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738e6b7c80>]}
[0m16:59:01.217714 [debug] [MainThread]: Flushing usage events
[0m16:59:06.458978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cea59cda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cea59c080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cec7395e0>]}


============================== 16:59:06.467946 | 696df9b7-5822-4310-876c-407f2db22ca7 ==============================
[0m16:59:06.467946 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:59:06.469497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_flights', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:59:08.181088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '696df9b7-5822-4310-876c-407f2db22ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ceba709b0>]}
[0m16:59:08.395639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '696df9b7-5822-4310-876c-407f2db22ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cea648e60>]}
[0m16:59:08.397476 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:59:08.440615 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:59:09.729577 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m16:59:09.730585 [debug] [MainThread]: Partial parsing: added file: flights_project://macros/flag_flight_delay_status.sql
[0m16:59:09.731454 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/core/core_flights.sql
[0m16:59:09.732390 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m16:59:10.255558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '696df9b7-5822-4310-876c-407f2db22ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cc6ca9be0>]}
[0m16:59:10.298591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '696df9b7-5822-4310-876c-407f2db22ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cc6f94230>]}
[0m16:59:10.300405 [info ] [MainThread]: Found 1 seed, 2 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m16:59:10.301894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '696df9b7-5822-4310-876c-407f2db22ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cc6c0fe90>]}
[0m16:59:10.304827 [info ] [MainThread]: 
[0m16:59:10.306821 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:59:10.310286 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:59:10.312788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:10.731033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:59:10.732922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:59:11.083316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '696df9b7-5822-4310-876c-407f2db22ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cc6c0f050>]}
[0m16:59:11.090515 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:59:11.099583 [info ] [MainThread]: 
[0m16:59:11.130740 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m16:59:11.132888 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m16:59:11.135595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.stg_flights)
[0m16:59:11.137127 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m16:59:11.162126 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m16:59:11.168956 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (compile): 16:59:11.138644 => 16:59:11.168243
[0m16:59:11.170038 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m16:59:11.230328 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m16:59:11.237891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:11.289772 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    cast( concat(cast(FlightDate as string), ' ', DepTimeFormatted) as timestamp) as dep_time,
    cast( concat(cast(FlightDate as string), ' ', ArrTimeFormatted) as timestamp) as arr_time,
    FlightNum as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc
    
    case
        when dep_delay > 0 and arr_delay > 0 then 'ddad'
        when dep_delay > 0 then 'dd'
        when arr_delay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m16:59:11.731616 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:5871718c-a8bf-4086-9de0-d10647d7f234&page=queryresults
[0m16:59:11.732984 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got keyword CASE at [25:5]; reason: invalidQuery, location: query, message: Syntax error: Expected end of input but got keyword CASE at [25:5]')
[0m16:59:12.232093 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:5c74ecc4-1432-442e-bb5b-256405bffe8b&page=queryresults
[0m16:59:12.234471 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:5c74ecc4-1432-442e-bb5b-256405bffe8b&page=queryresults
[0m16:59:12.238497 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (execute): 16:59:11.170737 => 16:59:12.237519
[0m16:59:12.259199 [debug] [Thread-1 (]: Database Error in model stg_flights (models/stg_flights.sql)
  Syntax error: Expected end of input but got keyword CASE at [25:5]
  compiled Code at target/run/flights_project/models/stg_flights.sql
[0m16:59:12.262672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '696df9b7-5822-4310-876c-407f2db22ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cc5b12570>]}
[0m16:59:12.267327 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model db_project_dataset.stg_flights ............ [[31mERROR[0m in 1.13s]
[0m16:59:12.270032 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m16:59:12.275564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:12.279356 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m16:59:12.282555 [info ] [MainThread]: 
[0m16:59:12.284590 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.98 seconds (1.98s).
[0m16:59:12.286990 [debug] [MainThread]: Command end result
[0m16:59:12.337850 [info ] [MainThread]: 
[0m16:59:12.339964 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:59:12.341828 [info ] [MainThread]: 
[0m16:59:12.346071 [error] [MainThread]:   Database Error in model stg_flights (models/stg_flights.sql)
  Syntax error: Expected end of input but got keyword CASE at [25:5]
  compiled Code at target/run/flights_project/models/stg_flights.sql
[0m16:59:12.350721 [info ] [MainThread]: 
[0m16:59:12.353046 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:59:12.356378 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.006463, "process_user_time": 7.304019, "process_kernel_time": 0.733416, "process_mem_max_rss": "260656", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:59:12.359101 [debug] [MainThread]: Command `dbt run` failed at 16:59:12.357542 after 6.01 seconds
[0m16:59:12.362708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cea7e0ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cee079130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cc6c80ce0>]}
[0m16:59:12.366395 [debug] [MainThread]: Flushing usage events
[0m16:59:21.915504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c219bb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c23dcd2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c219bb230>]}


============================== 16:59:21.924980 | 291e8876-dcef-4d36-86e2-447203797cb5 ==============================
[0m16:59:21.924980 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:59:21.926528 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:59:22.141023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '291e8876-dcef-4d36-86e2-447203797cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c219fcb30>]}
[0m16:59:22.647146 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fti_11zl'
[0m16:59:22.648115 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:59:22.730483 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:59:22.732392 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:59:22.841415 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:59:22.850072 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:59:26.827738 [info ] [MainThread]: Installed from version 1.3.0
[0m16:59:26.828951 [info ] [MainThread]: Up to date!
[0m16:59:26.830392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '291e8876-dcef-4d36-86e2-447203797cb5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c219070b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c218b3440>]}
[0m16:59:26.832210 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 5.0220056, "process_user_time": 4.485079, "process_kernel_time": 0.454435, "process_mem_max_rss": "111728", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m16:59:26.833525 [debug] [MainThread]: Command `dbt deps` succeeded at 16:59:26.833235 after 5.02 seconds
[0m16:59:26.834495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c25fcf1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c22a70bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c21a61ac0>]}
[0m16:59:26.835454 [debug] [MainThread]: Flushing usage events
[0m16:59:33.070731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadf5e71490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadf611f830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadf61a6720>]}


============================== 16:59:33.080039 | 3a878aba-4b16-4e60-9e42-749b9024965f ==============================
[0m16:59:33.080039 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:59:33.081330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_flights', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:59:35.117073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a878aba-4b16-4e60-9e42-749b9024965f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd2b3f500>]}
[0m16:59:35.332025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a878aba-4b16-4e60-9e42-749b9024965f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd2c03740>]}
[0m16:59:35.333497 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m16:59:35.374851 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:59:36.648409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:59:36.649472 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:59:36.665581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a878aba-4b16-4e60-9e42-749b9024965f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd292a6c0>]}
[0m16:59:36.735010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a878aba-4b16-4e60-9e42-749b9024965f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd2848860>]}
[0m16:59:36.738639 [info ] [MainThread]: Found 1 seed, 2 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m16:59:36.741304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a878aba-4b16-4e60-9e42-749b9024965f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd29eec30>]}
[0m16:59:36.746301 [info ] [MainThread]: 
[0m16:59:36.756310 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:59:36.761997 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m16:59:36.764400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:37.250978 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m16:59:37.252636 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:59:37.539198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a878aba-4b16-4e60-9e42-749b9024965f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd2a162d0>]}
[0m16:59:37.541330 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:59:37.542324 [info ] [MainThread]: 
[0m16:59:37.556218 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m16:59:37.557796 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m16:59:37.559783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.stg_flights)
[0m16:59:37.561071 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m16:59:37.596040 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m16:59:37.605920 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (compile): 16:59:37.561912 => 16:59:37.605335
[0m16:59:37.606961 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m16:59:37.657354 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m16:59:37.666261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:37.712781 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    cast( concat(cast(FlightDate as string), ' ', DepTimeFormatted) as timestamp) as dep_time,
    cast( concat(cast(FlightDate as string), ' ', ArrTimeFormatted) as timestamp) as arr_time,
    FlightNum as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc
    
    case
        when dep_delay > 0 and arr_delay > 0 then 'ddad'
        when dep_delay > 0 then 'dd'
        when arr_delay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m16:59:38.252824 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:0845ad43-f718-454f-862e-73fef59ca96c&page=queryresults
[0m16:59:38.254667 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got keyword CASE at [25:5]; reason: invalidQuery, location: query, message: Syntax error: Expected end of input but got keyword CASE at [25:5]')
[0m16:59:39.210054 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:abbae7cd-3594-4819-ab0d-ec1fd48f1aca&page=queryresults
[0m16:59:39.212390 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:abbae7cd-3594-4819-ab0d-ec1fd48f1aca&page=queryresults
[0m16:59:39.214684 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (execute): 16:59:37.607615 => 16:59:39.213908
[0m16:59:39.230356 [debug] [Thread-1 (]: Database Error in model stg_flights (models/stg_flights.sql)
  Syntax error: Expected end of input but got keyword CASE at [25:5]
  compiled Code at target/run/flights_project/models/stg_flights.sql
[0m16:59:39.232141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a878aba-4b16-4e60-9e42-749b9024965f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd2e2c140>]}
[0m16:59:39.234496 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model db_project_dataset.stg_flights ............ [[31mERROR[0m in 1.67s]
[0m16:59:39.238011 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m16:59:39.243470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:39.244840 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m16:59:39.246008 [info ] [MainThread]: 
[0m16:59:39.247132 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m16:59:39.248793 [debug] [MainThread]: Command end result
[0m16:59:39.280119 [info ] [MainThread]: 
[0m16:59:39.281883 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:59:39.283579 [info ] [MainThread]: 
[0m16:59:39.286125 [error] [MainThread]:   Database Error in model stg_flights (models/stg_flights.sql)
  Syntax error: Expected end of input but got keyword CASE at [25:5]
  compiled Code at target/run/flights_project/models/stg_flights.sql
[0m16:59:39.288258 [info ] [MainThread]: 
[0m16:59:39.289970 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:59:39.292166 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.363078, "process_user_time": 7.951277, "process_kernel_time": 0.813198, "process_mem_max_rss": "253140", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:59:39.293801 [debug] [MainThread]: Command `dbt run` failed at 16:59:39.293250 after 6.36 seconds
[0m16:59:39.295486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadf5f7d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadf5f7dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd28f2a80>]}
[0m16:59:39.296949 [debug] [MainThread]: Flushing usage events
[0m17:00:41.491238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0da20d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0fb31520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0f8bf530>]}


============================== 17:00:41.501566 | fdb5dc81-a97b-42d4-98d2-a48423a14955 ==============================
[0m17:00:41.501566 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:00:41.503232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:00:41.719989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdb5dc81-a97b-42d4-98d2-a48423a14955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0da863c0>]}
[0m17:00:42.131364 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kk2pf2uf'
[0m17:00:42.132935 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:00:42.203590 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:00:42.207053 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:00:42.315189 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:00:42.323762 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:00:46.882315 [info ] [MainThread]: Installed from version 1.3.0
[0m17:00:46.883482 [info ] [MainThread]: Up to date!
[0m17:00:46.884514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fdb5dc81-a97b-42d4-98d2-a48423a14955', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0d7c0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0d7c0440>]}
[0m17:00:46.886051 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 5.5167227, "process_user_time": 4.63785, "process_kernel_time": 0.457813, "process_mem_max_rss": "111920", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m17:00:46.886944 [debug] [MainThread]: Command `dbt deps` succeeded at 17:00:46.886713 after 5.52 seconds
[0m17:00:46.887760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee11feb1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0d8ade20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0f8bf530>]}
[0m17:00:46.888653 [debug] [MainThread]: Flushing usage events
[0m17:00:52.988130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e691d31d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e6a18da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e6954d100>]}


============================== 17:00:52.997113 | e167567d-c5ee-4bfe-8f34-c71c6d4c1966 ==============================
[0m17:00:52.997113 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:00:52.998547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models stg_flights', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:00:54.463798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e167567d-c5ee-4bfe-8f34-c71c6d4c1966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e468529f0>]}
[0m17:00:54.768467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e167567d-c5ee-4bfe-8f34-c71c6d4c1966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e45d032c0>]}
[0m17:00:54.770369 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:00:54.818148 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:00:56.002190 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:00:56.003488 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m17:00:56.552413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e167567d-c5ee-4bfe-8f34-c71c6d4c1966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e4592da30>]}
[0m17:00:56.584372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e167567d-c5ee-4bfe-8f34-c71c6d4c1966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e45bb8e60>]}
[0m17:00:56.585858 [info ] [MainThread]: Found 1 seed, 2 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:00:56.587407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e167567d-c5ee-4bfe-8f34-c71c6d4c1966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e459dc1a0>]}
[0m17:00:56.591600 [info ] [MainThread]: 
[0m17:00:56.594295 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:00:56.596788 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:00:56.597922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:57.064772 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:00:57.066613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:57.390773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e167567d-c5ee-4bfe-8f34-c71c6d4c1966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e47675970>]}
[0m17:00:57.393345 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:00:57.394985 [info ] [MainThread]: 
[0m17:00:57.409541 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m17:00:57.411364 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m17:00:57.413288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.stg_flights)
[0m17:00:57.414663 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m17:00:57.433778 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m17:00:57.443713 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (compile): 17:00:57.416212 => 17:00:57.443019
[0m17:00:57.444824 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m17:00:57.494082 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m17:00:57.506624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:57.551823 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    cast( concat(cast(FlightDate as string), ' ', DepTimeFormatted) as timestamp) as dep_time,
    cast( concat(cast(FlightDate as string), ' ', ArrTimeFormatted) as timestamp) as arr_time,
    FlightNum as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc,
    
    case
        when dep_delay > 0 and arr_delay > 0 then 'ddad'
        when dep_delay > 0 then 'dd'
        when arr_delay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m17:00:58.004062 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c8f75e3f-a743-4856-ac46-76d43dd18ed8&page=queryresults
[0m17:00:58.186924 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: dep_delay; Did you mean DepDelay? at [26:14]; reason: invalidQuery, location: query, message: Unrecognized name: dep_delay; Did you mean DepDelay? at [26:14]')
[0m17:00:58.729504 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:518fa834-0734-4b76-acdc-f4a13831e791&page=queryresults
[0m17:00:58.835887 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:518fa834-0734-4b76-acdc-f4a13831e791&page=queryresults
[0m17:00:58.838545 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (execute): 17:00:57.445763 => 17:00:58.837816
[0m17:00:58.849999 [debug] [Thread-1 (]: Database Error in model stg_flights (models/stg_flights.sql)
  Unrecognized name: dep_delay; Did you mean DepDelay? at [26:14]
  compiled Code at target/run/flights_project/models/stg_flights.sql
[0m17:00:58.851265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e167567d-c5ee-4bfe-8f34-c71c6d4c1966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e458f5130>]}
[0m17:00:58.852891 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model db_project_dataset.stg_flights ............ [[31mERROR[0m in 1.44s]
[0m17:00:58.854923 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m17:00:58.860587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:00:58.862056 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m17:00:58.863453 [info ] [MainThread]: 
[0m17:00:58.864901 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.27 seconds (2.27s).
[0m17:00:58.867043 [debug] [MainThread]: Command end result
[0m17:00:58.903074 [info ] [MainThread]: 
[0m17:00:58.904520 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:00:58.906021 [info ] [MainThread]: 
[0m17:00:58.908218 [error] [MainThread]:   Database Error in model stg_flights (models/stg_flights.sql)
  Unrecognized name: dep_delay; Did you mean DepDelay? at [26:14]
  compiled Code at target/run/flights_project/models/stg_flights.sql
[0m17:00:58.910624 [info ] [MainThread]: 
[0m17:00:58.912351 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:00:58.916531 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.035162, "process_user_time": 7.693341, "process_kernel_time": 0.707666, "process_mem_max_rss": "262408", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:00:58.918299 [debug] [MainThread]: Command `dbt run` failed at 17:00:58.917965 after 6.04 seconds
[0m17:00:58.919727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e69a02b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e459f9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e6d80f200>]}
[0m17:00:58.921108 [debug] [MainThread]: Flushing usage events
[0m17:02:20.764519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27aeb97fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27aebf6e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27aeb94ef0>]}


============================== 17:02:20.774041 | 689c692f-e419-4779-8fb6-f2f98566be51 ==============================
[0m17:02:20.774041 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:02:20.775595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:02:20.997213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '689c692f-e419-4779-8fb6-f2f98566be51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27aee1fe00>]}
[0m17:02:21.464110 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zfyhg7dh'
[0m17:02:21.465329 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:02:21.561667 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:02:21.564145 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:02:21.666017 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:02:21.686311 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:02:27.000546 [info ] [MainThread]: Installed from version 1.3.0
[0m17:02:27.001613 [info ] [MainThread]: Up to date!
[0m17:02:27.002801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '689c692f-e419-4779-8fb6-f2f98566be51', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27ae93c1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27ae93c0b0>]}
[0m17:02:27.004753 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 6.371576, "process_user_time": 4.86061, "process_kernel_time": 0.493964, "process_mem_max_rss": "111704", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m17:02:27.005961 [debug] [MainThread]: Command `dbt deps` succeeded at 17:02:27.005636 after 6.37 seconds
[0m17:02:27.006970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27b0cb0e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27aee1fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27aec431d0>]}
[0m17:02:27.007993 [debug] [MainThread]: Flushing usage events
[0m17:02:32.800116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729474e7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7294a74b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729474d190>]}


============================== 17:02:32.808384 | 46be10c9-20a0-43a4-9151-5f198192016b ==============================
[0m17:02:32.808384 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:02:32.809814 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_flights', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:02:34.180116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46be10c9-20a0-43a4-9151-5f198192016b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72945d9af0>]}
[0m17:02:34.373093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46be10c9-20a0-43a4-9151-5f198192016b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72734e7a70>]}
[0m17:02:34.374500 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:02:34.409815 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:02:35.341083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:02:35.342388 [debug] [MainThread]: Partial parsing: updated file: flights_project://macros/flag_flight_delay_status.sql
[0m17:02:35.736847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46be10c9-20a0-43a4-9151-5f198192016b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7270d9f2f0>]}
[0m17:02:35.767196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46be10c9-20a0-43a4-9151-5f198192016b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7271140590>]}
[0m17:02:35.768803 [info ] [MainThread]: Found 1 seed, 2 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:02:35.770195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46be10c9-20a0-43a4-9151-5f198192016b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7270ec24e0>]}
[0m17:02:35.773563 [info ] [MainThread]: 
[0m17:02:35.776013 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:02:35.779428 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:02:35.780879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:36.133099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:02:36.134794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:02:36.438215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46be10c9-20a0-43a4-9151-5f198192016b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72700c6090>]}
[0m17:02:36.440317 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:02:36.441685 [info ] [MainThread]: 
[0m17:02:36.452140 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m17:02:36.453447 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m17:02:36.455147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.stg_flights)
[0m17:02:36.456361 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m17:02:36.471238 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m17:02:36.481120 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (compile): 17:02:36.457139 => 17:02:36.480606
[0m17:02:36.482173 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m17:02:36.532210 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m17:02:36.542225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:36.584624 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    cast( concat(cast(FlightDate as string), ' ', DepTimeFormatted) as timestamp) as dep_time,
    cast( concat(cast(FlightDate as string), ' ', ArrTimeFormatted) as timestamp) as arr_time,
    FlightNum as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc,
    
    case
        when dep_delay > 0 and  > 0 then 'ddad'
        when dep_delay > 0 then 'dd'
        when dep_delay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m17:02:37.038713 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:d270b2bc-a0fe-4712-9e41-262d786ff4d6&page=queryresults
[0m17:02:37.040555 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ">" at [26:33]; reason: invalidQuery, location: query, message: Syntax error: Unexpected ">" at [26:33]')
[0m17:02:37.917028 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:45725240-a790-43b0-9dca-497cc0473e3a&page=queryresults
[0m17:02:37.919069 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:US:45725240-a790-43b0-9dca-497cc0473e3a&page=queryresults
[0m17:02:37.921152 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (execute): 17:02:36.482931 => 17:02:37.920541
[0m17:02:37.929565 [debug] [Thread-1 (]: Database Error in model stg_flights (models/stg_flights.sql)
  Syntax error: Unexpected ">" at [26:33]
  compiled Code at target/run/flights_project/models/stg_flights.sql
[0m17:02:37.930702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46be10c9-20a0-43a4-9151-5f198192016b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72715cc530>]}
[0m17:02:37.931977 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model db_project_dataset.stg_flights ............ [[31mERROR[0m in 1.48s]
[0m17:02:37.933500 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m17:02:37.937604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:02:37.938589 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m17:02:37.939544 [info ] [MainThread]: 
[0m17:02:37.940713 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m17:02:37.942395 [debug] [MainThread]: Command end result
[0m17:02:37.967349 [info ] [MainThread]: 
[0m17:02:37.968480 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:02:37.969471 [info ] [MainThread]: 
[0m17:02:37.970701 [error] [MainThread]:   Database Error in model stg_flights (models/stg_flights.sql)
  Syntax error: Unexpected ">" at [26:33]
  compiled Code at target/run/flights_project/models/stg_flights.sql
[0m17:02:37.972097 [info ] [MainThread]: 
[0m17:02:37.973700 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:02:37.975965 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.273562, "process_user_time": 7.17404, "process_kernel_time": 0.717404, "process_mem_max_rss": "261356", "process_in_blocks": "8", "command_success": false, "process_out_blocks": "0"}
[0m17:02:37.977235 [debug] [MainThread]: Command `dbt run` failed at 17:02:37.976986 after 5.28 seconds
[0m17:02:37.978297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7298d17200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7270dc8620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72712a4590>]}
[0m17:02:37.979367 [debug] [MainThread]: Flushing usage events
[0m17:04:37.468796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54bb862e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54bbae4c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54bb863920>]}


============================== 17:04:37.478092 | 5ccd9262-7428-4e59-9e1c-1359be44c2a9 ==============================
[0m17:04:37.478092 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:04:37.479550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m17:04:37.725160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ccd9262-7428-4e59-9e1c-1359be44c2a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54bb96bb00>]}
[0m17:04:38.147629 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-py60gjzs'
[0m17:04:38.148657 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:04:39.942827 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:04:39.944612 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:04:40.072209 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:04:40.081757 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:04:44.221239 [info ] [MainThread]: Installed from version 1.3.0
[0m17:04:44.222364 [info ] [MainThread]: Up to date!
[0m17:04:44.223503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5ccd9262-7428-4e59-9e1c-1359be44c2a9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54bb715a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54bb7171a0>]}
[0m17:04:44.225498 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 6.8769464, "process_user_time": 4.255585, "process_kernel_time": 0.412479, "process_mem_max_rss": "111820", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m17:04:44.226735 [debug] [MainThread]: Command `dbt deps` succeeded at 17:04:44.226444 after 6.88 seconds
[0m17:04:44.227842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54bfe331d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54bb81ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54bb81e810>]}
[0m17:04:44.228995 [debug] [MainThread]: Flushing usage events
[0m17:04:50.426460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae4880710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae4880740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae4f4e270>]}


============================== 17:04:50.434959 | 00505a9f-f1ff-4ed2-ae96-4bbe51b99d42 ==============================
[0m17:04:50.434959 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:04:50.436350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models stg_flights', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:04:52.501290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00505a9f-f1ff-4ed2-ae96-4bbe51b99d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac2b2bda0>]}
[0m17:04:52.841120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00505a9f-f1ff-4ed2-ae96-4bbe51b99d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac13c5ac0>]}
[0m17:04:52.842624 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:04:52.885014 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:04:54.209201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:04:54.210871 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m17:04:54.212234 [debug] [MainThread]: Partial parsing: updated file: flights_project://macros/flag_flight_delay_status.sql
[0m17:04:54.727889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00505a9f-f1ff-4ed2-ae96-4bbe51b99d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac0eb5640>]}
[0m17:04:54.765397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00505a9f-f1ff-4ed2-ae96-4bbe51b99d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac12644a0>]}
[0m17:04:54.767249 [info ] [MainThread]: Found 1 seed, 2 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:04:54.769146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00505a9f-f1ff-4ed2-ae96-4bbe51b99d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac0fe27b0>]}
[0m17:04:54.773413 [info ] [MainThread]: 
[0m17:04:54.779845 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:04:54.789791 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:04:54.791429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:55.225012 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:04:55.226501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:55.548060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00505a9f-f1ff-4ed2-ae96-4bbe51b99d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac0fe2600>]}
[0m17:04:55.549946 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:04:55.551250 [info ] [MainThread]: 
[0m17:04:55.562503 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m17:04:55.563830 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m17:04:55.565623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.stg_flights)
[0m17:04:55.566698 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m17:04:55.581476 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m17:04:55.591400 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (compile): 17:04:55.567495 => 17:04:55.590893
[0m17:04:55.592442 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m17:04:55.651745 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m17:04:55.664615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:55.731529 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    PARSE_TIMESTAMP('%Y-%m-%d %H:%M', CONCAT(CAST(FlightDate AS STRING), ' ', DepTimeFormatted)) AS dep_time,
    PARSE_TIMESTAMP('%Y-%m-%d %H:%M', CONCAT(CAST(FlightDate AS STRING), ' ', ArrTimeFormatted)) AS arr_time,
    FlightNum as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc,
    
    case
        when dep_delay > 0 and arr_delay > 0 then 'ddad'
        when dep_delay > 0 then 'dd'
        when arr_delay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m17:04:56.137019 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:6fd318d1-2b72-4d9b-b1e3-5782bc205bfa&page=queryresults
[0m17:04:56.276020 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: dep_delay; Did you mean DepDelay? at [26:14]; reason: invalidQuery, location: query, message: Unrecognized name: dep_delay; Did you mean DepDelay? at [26:14]')
[0m17:04:56.577874 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:2ce52999-90ca-4e4d-8cc5-c518ec5ee89c&page=queryresults
[0m17:04:56.711643 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:2ce52999-90ca-4e4d-8cc5-c518ec5ee89c&page=queryresults
[0m17:04:56.713682 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (execute): 17:04:55.593144 => 17:04:56.713058
[0m17:04:56.723246 [debug] [Thread-1 (]: Database Error in model stg_flights (models/stg_flights.sql)
  Unrecognized name: dep_delay; Did you mean DepDelay? at [26:14]
  compiled Code at target/run/flights_project/models/stg_flights.sql
[0m17:04:56.724424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00505a9f-f1ff-4ed2-ae96-4bbe51b99d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac0d98ef0>]}
[0m17:04:56.725741 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model db_project_dataset.stg_flights ............ [[31mERROR[0m in 1.16s]
[0m17:04:56.727228 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m17:04:56.731608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:04:56.732607 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m17:04:56.733837 [info ] [MainThread]: 
[0m17:04:56.734997 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.96 seconds (1.96s).
[0m17:04:56.736584 [debug] [MainThread]: Command end result
[0m17:04:56.762797 [info ] [MainThread]: 
[0m17:04:56.764070 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:04:56.765065 [info ] [MainThread]: 
[0m17:04:56.766047 [error] [MainThread]:   Database Error in model stg_flights (models/stg_flights.sql)
  Unrecognized name: dep_delay; Did you mean DepDelay? at [26:14]
  compiled Code at target/run/flights_project/models/stg_flights.sql
[0m17:04:56.767131 [info ] [MainThread]: 
[0m17:04:56.768494 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:04:56.770553 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.4383273, "process_user_time": 8.541316, "process_kernel_time": 0.817255, "process_mem_max_rss": "260552", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:04:56.771828 [debug] [MainThread]: Command `dbt run` failed at 17:04:56.771532 after 6.44 seconds
[0m17:04:56.773029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae4884cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac0f31310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae65e3c50>]}
[0m17:04:56.774141 [debug] [MainThread]: Flushing usage events
[0m17:05:09.958844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb139134e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1392419a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb139136030>]}


============================== 17:05:09.967846 | 4133eb1d-dec6-42ed-a38a-14aea644f993 ==============================
[0m17:05:09.967846 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:05:09.969311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:05:10.190012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4133eb1d-dec6-42ed-a38a-14aea644f993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1391347d0>]}
[0m17:05:10.617943 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-r2ukrrzb'
[0m17:05:10.618804 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:05:10.792425 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:05:10.795515 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:05:10.914517 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:05:10.929137 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:05:16.484004 [info ] [MainThread]: Installed from version 1.3.0
[0m17:05:16.485004 [info ] [MainThread]: Up to date!
[0m17:05:16.486083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4133eb1d-dec6-42ed-a38a-14aea644f993', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb13902df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb13902f740>]}
[0m17:05:16.490360 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 6.6525946, "process_user_time": 5.178168, "process_kernel_time": 0.512789, "process_mem_max_rss": "111952", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m17:05:16.491835 [debug] [MainThread]: Command `dbt deps` succeeded at 17:05:16.491477 after 6.65 seconds
[0m17:05:16.493005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb139ed3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1393e3c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb13902e780>]}
[0m17:05:16.494085 [debug] [MainThread]: Flushing usage events
[0m17:05:22.981020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4416b1e3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4416d802f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4416d85a30>]}


============================== 17:05:22.990298 | 67cf299e-db6b-4c24-99e1-6905197a6435 ==============================
[0m17:05:22.990298 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:05:22.991517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models stg_flights', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:05:24.864847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67cf299e-db6b-4c24-99e1-6905197a6435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fb9699a0>]}
[0m17:05:25.223734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67cf299e-db6b-4c24-99e1-6905197a6435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43f8239b80>]}
[0m17:05:25.225230 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:05:25.265190 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:05:26.517201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:05:26.518136 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:05:26.526664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67cf299e-db6b-4c24-99e1-6905197a6435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43f35b4a10>]}
[0m17:05:26.558643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67cf299e-db6b-4c24-99e1-6905197a6435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43f34dcdd0>]}
[0m17:05:26.560155 [info ] [MainThread]: Found 1 seed, 2 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:05:26.561424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67cf299e-db6b-4c24-99e1-6905197a6435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43f358b740>]}
[0m17:05:26.564024 [info ] [MainThread]: 
[0m17:05:26.566064 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:05:26.568643 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:05:26.569943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:27.024739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:05:27.026466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:05:27.351865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67cf299e-db6b-4c24-99e1-6905197a6435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43f358bd70>]}
[0m17:05:27.354406 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:05:27.357157 [info ] [MainThread]: 
[0m17:05:27.388588 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m17:05:27.390265 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m17:05:27.392688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.stg_flights)
[0m17:05:27.394231 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m17:05:27.477444 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m17:05:27.493664 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (compile): 17:05:27.395454 => 17:05:27.492532
[0m17:05:27.496090 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m17:05:27.594829 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m17:05:27.606302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:27.656040 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    PARSE_TIMESTAMP('%Y-%m-%d %H:%M', CONCAT(CAST(FlightDate AS STRING), ' ', DepTimeFormatted)) AS dep_time,
    PARSE_TIMESTAMP('%Y-%m-%d %H:%M', CONCAT(CAST(FlightDate AS STRING), ' ', ArrTimeFormatted)) AS arr_time,
    FlightNum as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc,
    
    case
        when dep_delay > 0 and arr_delay > 0 then 'ddad'
        when dep_delay > 0 then 'dd'
        when arr_delay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m17:05:28.060247 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:7b3ebab1-0d24-4f30-be3a-77ec0c5c0dd8&page=queryresults
[0m17:05:28.457401 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: dep_delay; Did you mean DepDelay? at [26:14]; reason: invalidQuery, location: query, message: Unrecognized name: dep_delay; Did you mean DepDelay? at [26:14]')
[0m17:05:29.509082 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:50698a88-06f8-4ac4-90cc-4f1abbc58426&page=queryresults
[0m17:05:29.650501 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:50698a88-06f8-4ac4-90cc-4f1abbc58426&page=queryresults
[0m17:05:29.652600 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (execute): 17:05:27.497703 => 17:05:29.652020
[0m17:05:29.662030 [debug] [Thread-1 (]: Database Error in model stg_flights (models/stg_flights.sql)
  Unrecognized name: dep_delay; Did you mean DepDelay? at [26:14]
  compiled Code at target/run/flights_project/models/stg_flights.sql
[0m17:05:29.663551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67cf299e-db6b-4c24-99e1-6905197a6435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43f328fa70>]}
[0m17:05:29.664951 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model db_project_dataset.stg_flights ............ [[31mERROR[0m in 2.27s]
[0m17:05:29.666744 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m17:05:29.670849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:05:29.671822 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m17:05:29.672802 [info ] [MainThread]: 
[0m17:05:29.673896 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.11 seconds (3.11s).
[0m17:05:29.675608 [debug] [MainThread]: Command end result
[0m17:05:29.702465 [info ] [MainThread]: 
[0m17:05:29.703606 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:05:29.704603 [info ] [MainThread]: 
[0m17:05:29.705673 [error] [MainThread]:   Database Error in model stg_flights (models/stg_flights.sql)
  Unrecognized name: dep_delay; Did you mean DepDelay? at [26:14]
  compiled Code at target/run/flights_project/models/stg_flights.sql
[0m17:05:29.706778 [info ] [MainThread]: 
[0m17:05:29.708334 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:05:29.710761 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.857787, "process_user_time": 8.277327, "process_kernel_time": 0.797814, "process_mem_max_rss": "256416", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:05:29.712263 [debug] [MainThread]: Command `dbt run` failed at 17:05:29.711902 after 6.86 seconds
[0m17:05:29.713412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4416e08380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43f326f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43f35b5b80>]}
[0m17:05:29.714380 [debug] [MainThread]: Flushing usage events
[0m17:06:44.360113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f571fee03b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5721c36930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f571fee0470>]}


============================== 17:06:44.371768 | c0d86295-5e5a-45f8-a4bc-b23edc5e02dd ==============================
[0m17:06:44.371768 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:06:44.373164 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m17:06:44.855625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0d86295-5e5a-45f8-a4bc-b23edc5e02dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f571fd95e80>]}
[0m17:06:45.216585 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xjr_g4bw'
[0m17:06:45.217739 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:06:45.328653 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:06:45.331168 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:06:45.457357 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:06:45.466212 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:06:50.167137 [info ] [MainThread]: Installed from version 1.3.0
[0m17:06:50.168201 [info ] [MainThread]: Up to date!
[0m17:06:50.169170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c0d86295-5e5a-45f8-a4bc-b23edc5e02dd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f571fd6f830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f571fd94d70>]}
[0m17:06:50.171570 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 5.988319, "process_user_time": 5.218606, "process_kernel_time": 0.357847, "process_mem_max_rss": "111880", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m17:06:50.173104 [debug] [MainThread]: Command `dbt deps` succeeded at 17:06:50.172680 after 5.99 seconds
[0m17:06:50.174371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5720a849e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f571ff28b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f571ff46210>]}
[0m17:06:50.176034 [debug] [MainThread]: Flushing usage events
[0m17:06:56.615433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db7d21880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db8abd1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db7f85a30>]}


============================== 17:06:56.625244 | af6f0c38-70a3-405b-9c39-52f69b82d2d4 ==============================
[0m17:06:56.625244 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:06:56.626817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_flights', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:07:04.275306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af6f0c38-70a3-405b-9c39-52f69b82d2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d99d295b0>]}
[0m17:07:04.541829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af6f0c38-70a3-405b-9c39-52f69b82d2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db7f8a1b0>]}
[0m17:07:04.543268 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:07:04.592079 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:07:06.186308 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:07:06.187495 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m17:07:06.608241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af6f0c38-70a3-405b-9c39-52f69b82d2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d9847d820>]}
[0m17:07:06.649390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af6f0c38-70a3-405b-9c39-52f69b82d2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d98708ad0>]}
[0m17:07:06.651155 [info ] [MainThread]: Found 1 seed, 2 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:07:06.652780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af6f0c38-70a3-405b-9c39-52f69b82d2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d983b8290>]}
[0m17:07:06.656619 [info ] [MainThread]: 
[0m17:07:06.659154 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:07:06.663089 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:07:06.664684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:07.014974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:07:07.017618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:07.340472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af6f0c38-70a3-405b-9c39-52f69b82d2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d983ba990>]}
[0m17:07:07.342771 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:07:07.357271 [info ] [MainThread]: 
[0m17:07:07.375557 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m17:07:07.377148 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m17:07:07.379853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.stg_flights)
[0m17:07:07.381137 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m17:07:07.417832 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m17:07:07.428893 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (compile): 17:07:07.386348 => 17:07:07.427867
[0m17:07:07.431449 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m17:07:07.543583 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m17:07:07.559524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:07.655072 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    PARSE_TIMESTAMP('%Y-%m-%d %H:%M', CONCAT(CAST(FlightDate AS STRING), ' ', DepTimeFormatted)) AS dep_time,
    PARSE_TIMESTAMP('%Y-%m-%d %H:%M', CONCAT(CAST(FlightDate AS STRING), ' ', ArrTimeFormatted)) AS arr_time,
    FlightNum as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m17:07:08.026094 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:1e556f4b-140e-448e-ad47-1bcea7b4974a&page=queryresults
[0m17:07:08.221400 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (execute): 17:07:07.435301 => 17:07:08.220948
[0m17:07:08.223300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af6f0c38-70a3-405b-9c39-52f69b82d2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d9870bda0>]}
[0m17:07:08.224889 [info ] [Thread-1 (]: 1 of 1 OK created sql view model db_project_dataset.stg_flights ................ [[32mCREATE VIEW (0 processed)[0m in 0.84s]
[0m17:07:08.226758 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m17:07:08.230639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:08.231800 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m17:07:08.232970 [info ] [MainThread]: 
[0m17:07:08.234216 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.57 seconds (1.57s).
[0m17:07:08.236199 [debug] [MainThread]: Command end result
[0m17:07:08.262946 [info ] [MainThread]: 
[0m17:07:08.264345 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:07:08.265662 [info ] [MainThread]: 
[0m17:07:08.267411 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:07:08.270052 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.77872, "process_user_time": 13.78058, "process_kernel_time": 1.336025, "process_mem_max_rss": "257836", "process_in_blocks": "16", "process_out_blocks": "0"}
[0m17:07:08.272238 [debug] [MainThread]: Command `dbt run` succeeded at 17:07:08.271605 after 11.78 seconds
[0m17:07:08.274042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db8056720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d986757f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db7fcfe30>]}
[0m17:07:08.276123 [debug] [MainThread]: Flushing usage events
[0m17:07:16.034167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2f8e4fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2f8e4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2f8e5010>]}


============================== 17:07:16.045652 | f50f13aa-dded-467e-b855-8cb6db5a7118 ==============================
[0m17:07:16.045652 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:07:16.049177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models core_flights', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:07:17.809980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f50f13aa-dded-467e-b855-8cb6db5a7118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d10b96840>]}
[0m17:07:18.014097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f50f13aa-dded-467e-b855-8cb6db5a7118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d10734830>]}
[0m17:07:18.015627 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:07:18.057489 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:07:19.419245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:07:19.420122 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:07:19.429723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f50f13aa-dded-467e-b855-8cb6db5a7118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d103420c0>]}
[0m17:07:19.461158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f50f13aa-dded-467e-b855-8cb6db5a7118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d102e08f0>]}
[0m17:07:19.463072 [info ] [MainThread]: Found 1 seed, 2 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:07:19.464936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f50f13aa-dded-467e-b855-8cb6db5a7118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d0bf7a5d0>]}
[0m17:07:19.467798 [info ] [MainThread]: 
[0m17:07:19.469941 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:07:19.472440 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:07:19.473600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:19.884164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:07:19.885956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:20.232430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f50f13aa-dded-467e-b855-8cb6db5a7118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d1057b9e0>]}
[0m17:07:20.238995 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:07:20.240548 [info ] [MainThread]: 
[0m17:07:20.260898 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m17:07:20.269510 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m17:07:20.272526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m17:07:20.274366 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m17:07:20.304716 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m17:07:20.325711 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 17:07:20.276410 => 17:07:20.324709
[0m17:07:20.327743 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m17:07:20.494474 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m17:07:20.509478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:20.575664 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m17:07:21.301454 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c580e4fe-297c-4c9d-9309-64de44be4202&page=queryresults
[0m17:07:21.937933 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Failed to parse input string "1992-02-24 90:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-02-24 90:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-09-15 "; reason: invalidQuery, location: query, message: Failed to parse input string "1992-02-18 90:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-03-13 90:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-07-12 90:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-12 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-01-31 90:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-19 90:4."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-20 90:2."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-05-19 91:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-03-22 "; reason: invalidQuery, location: query, message: Failed to parse input string "1989-08-20 64:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-02-16 71:2."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-25 80:2."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-08-19 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-09-27 90:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-06-17 34:.0"; reason: invalidQuery, location: query, message: Failed to parse input string "1992-01-29 90:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-08-09 75:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-09-21 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-12-14 64:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-11-10 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-01-01 61:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-02-11 90:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-01-20 "; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-17 90:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-04-28 84:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-08-20 80:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-07-05 63:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-06-20 26:.0"; reason: invalidQuery, location: query, message: Failed to parse input string "1987-10-02 64:1."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-10 "; reason: invalidQuery, location: query, message: Failed to parse input string "1992-10-10 90:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-05-04 72:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-07-29 90:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-05-24 80:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-09-03 "; reason: invalidQuery, location: query, message: Failed to parse input string "1992-07-22 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-10-22 90:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-06-28 65:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-01-30 71:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-06-29 64:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-09-24 82:4."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-10-30 71:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-07-26 75:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-04-22 85:4."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-10-26 "; reason: invalidQuery, location: query, message: Failed to parse input string "1988-07-22 63:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-11-02 64:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-04-26 61:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-03-13 "; reason: invalidQuery, location: query, message: Failed to parse input string "1989-11-28 63:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-01-16 63:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-02-11 85:4."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-06-04 64:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-03-09 "; reason: invalidQuery, location: query, message: Failed to parse input string "1989-06-30 65:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-10-29 85:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-09-23 64:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-01-24 61:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-02-17 62:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-08-15 71:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-16 90:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-12-08 "; reason: invalidQuery, location: query, message: Failed to parse input string "1988-07-02 62:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-02-14 63:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-02-04 85:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-05-17 63:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-02-19 62:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-12-13 71:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-12-31 71:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-04-10 71:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-10-11 65:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1987-12-27 "; reason: invalidQuery, location: query, message: Failed to parse input string "1990-07-26 64:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-02-10 62:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-02 90:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-10-06 71:4."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-12-28 72:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-04-27 71:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-09-04 "; reason: invalidQuery, location: query, message: Failed to parse input string "1990-11-15 70:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-03-20 61:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-10-10 71:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-21 90:2."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-11-06 63:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-06-21 90:4."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-08-26 62:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-05-28 72:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-07-17 64:4."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-05-16 65:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-12-27 63:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-06-05 85:2."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-10-11 90:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-07-07 62:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-04-27 85:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1987-10-29 64:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-12-12 65:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-02-27 62:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-08-23 63:8."')
[0m17:07:23.157192 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:09993472-040a-4b55-9e4e-82714eb32faf&page=queryresults
[0m17:07:23.526213 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:09993472-040a-4b55-9e4e-82714eb32faf&page=queryresults
[0m17:07:23.528966 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 17:07:20.331057 => 17:07:23.527751
[0m17:07:23.537197 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  Failed to parse input string "1991-12-09 90:4."
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m17:07:23.538487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f50f13aa-dded-467e-b855-8cb6db5a7118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d10134ef0>]}
[0m17:07:23.539833 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.core_flights .......... [[31mERROR[0m in 3.27s]
[0m17:07:23.541450 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m17:07:23.546525 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:23.547928 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m17:07:23.549007 [info ] [MainThread]: 
[0m17:07:23.549996 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.08 seconds (4.08s).
[0m17:07:23.551425 [debug] [MainThread]: Command end result
[0m17:07:23.579676 [info ] [MainThread]: 
[0m17:07:23.581850 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:07:23.583140 [info ] [MainThread]: 
[0m17:07:23.584226 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  Failed to parse input string "1991-12-09 90:4."
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m17:07:23.585467 [info ] [MainThread]: 
[0m17:07:23.586643 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:07:23.588617 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.722349, "process_user_time": 8.260402, "process_kernel_time": 0.785745, "process_mem_max_rss": "253000", "process_in_blocks": "144", "command_success": false, "process_out_blocks": "0"}
[0m17:07:23.590146 [debug] [MainThread]: Command `dbt run` failed at 17:07:23.589757 after 7.72 seconds
[0m17:07:23.591556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2f993260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d30488740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d1022ee10>]}
[0m17:07:23.592741 [debug] [MainThread]: Flushing usage events
[0m17:09:29.819588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e144c9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e168996a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e144c9040>]}


============================== 17:09:29.828081 | 605272bf-b436-4333-b334-1f3404095169 ==============================
[0m17:09:29.828081 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:09:29.829323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:09:30.031327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '605272bf-b436-4333-b334-1f3404095169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1437e4b0>]}
[0m17:09:30.375212 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-uaa95wpg'
[0m17:09:30.376206 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:09:30.490782 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:09:30.492581 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:09:30.603255 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:09:30.612770 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:09:35.246594 [info ] [MainThread]: Installed from version 1.3.0
[0m17:09:35.247962 [info ] [MainThread]: Up to date!
[0m17:09:35.249939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '605272bf-b436-4333-b334-1f3404095169', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1437ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1474f950>]}
[0m17:09:35.253106 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 5.5334115, "process_user_time": 3.88278, "process_kernel_time": 0.328542, "process_mem_max_rss": "112020", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m17:09:35.256519 [debug] [MainThread]: Command `dbt deps` succeeded at 17:09:35.256017 after 5.54 seconds
[0m17:09:35.257904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1470ccb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e14af09b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e14486510>]}
[0m17:09:35.258852 [debug] [MainThread]: Flushing usage events
[0m17:09:41.486873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd45d106420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd45d10b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd45d106810>]}


============================== 17:09:41.495103 | 69466946-82ac-465f-9e6a-f8f65c91369d ==============================
[0m17:09:41.495103 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:09:41.496721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models stg_flights', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:09:43.605194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69466946-82ac-465f-9e6a-f8f65c91369d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd439c93680>]}
[0m17:09:44.067003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69466946-82ac-465f-9e6a-f8f65c91369d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd45e620860>]}
[0m17:09:44.069222 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:09:44.112115 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:09:45.538221 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:09:45.539383 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m17:09:45.944814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69466946-82ac-465f-9e6a-f8f65c91369d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd439865a90>]}
[0m17:09:45.988290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69466946-82ac-465f-9e6a-f8f65c91369d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd439af05f0>]}
[0m17:09:45.990123 [info ] [MainThread]: Found 1 seed, 2 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:09:45.991793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69466946-82ac-465f-9e6a-f8f65c91369d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4397abbc0>]}
[0m17:09:45.995902 [info ] [MainThread]: 
[0m17:09:45.998592 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:09:46.001884 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:09:46.003278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:46.482400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:09:46.484079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:09:46.831230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69466946-82ac-465f-9e6a-f8f65c91369d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4397abf80>]}
[0m17:09:46.852496 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:09:46.867038 [info ] [MainThread]: 
[0m17:09:46.894935 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m17:09:46.904012 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m17:09:46.907328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.stg_flights)
[0m17:09:46.909631 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m17:09:46.945646 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m17:09:46.967262 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (compile): 17:09:46.910697 => 17:09:46.966191
[0m17:09:46.970117 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m17:09:47.066186 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m17:09:47.076370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:47.119559 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    CONCAT(CAST(FlightDate AS STRING), ' ', DepTimeFormatted) AS dep_time,
    CONCAT(CAST(FlightDate AS STRING), ' ', ArrTimeFormatted) AS arr_time,
    FlightNum as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m17:09:47.490875 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:9bd200f1-b143-4ebd-b5d3-558dedd4f199&page=queryresults
[0m17:09:47.667013 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (execute): 17:09:46.971296 => 17:09:47.666559
[0m17:09:47.669060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69466946-82ac-465f-9e6a-f8f65c91369d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd439af12b0>]}
[0m17:09:47.670652 [info ] [Thread-1 (]: 1 of 1 OK created sql view model db_project_dataset.stg_flights ................ [[32mCREATE VIEW (0 processed)[0m in 0.76s]
[0m17:09:47.672317 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m17:09:47.676243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:47.677456 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m17:09:47.678849 [info ] [MainThread]: 
[0m17:09:47.680627 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m17:09:47.684196 [debug] [MainThread]: Command end result
[0m17:09:47.723393 [info ] [MainThread]: 
[0m17:09:47.725352 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:09:47.727345 [info ] [MainThread]: 
[0m17:09:47.729274 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:09:47.732041 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.3426337, "process_user_time": 8.441458, "process_kernel_time": 0.908005, "process_mem_max_rss": "260024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:09:47.733931 [debug] [MainThread]: Command `dbt run` succeeded at 17:09:47.733519 after 6.34 seconds
[0m17:09:47.735288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd45f539160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd43985fc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd43989a9f0>]}
[0m17:09:47.736589 [debug] [MainThread]: Flushing usage events
[0m17:09:54.438507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f1ab6780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f1c03020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f1ab6ff0>]}


============================== 17:09:54.451735 | c794e50e-09a3-4fc7-871a-c59e44233a55 ==============================
[0m17:09:54.451735 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:09:54.453205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models core_flights', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:09:56.737286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c794e50e-09a3-4fc7-871a-c59e44233a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ce656ae0>]}
[0m17:09:57.112271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c794e50e-09a3-4fc7-871a-c59e44233a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9cee8cfb0>]}
[0m17:09:57.115322 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:09:57.193136 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:09:58.382909 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:09:58.383806 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:09:58.393440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c794e50e-09a3-4fc7-871a-c59e44233a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ce43d8b0>]}
[0m17:09:58.424371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c794e50e-09a3-4fc7-871a-c59e44233a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ce4f81a0>]}
[0m17:09:58.426327 [info ] [MainThread]: Found 1 seed, 2 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:09:58.428643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c794e50e-09a3-4fc7-871a-c59e44233a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ce271d60>]}
[0m17:09:58.432683 [info ] [MainThread]: 
[0m17:09:58.435169 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:09:58.438823 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:09:58.440357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:58.903014 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:09:58.904254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:09:59.238067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c794e50e-09a3-4fc7-871a-c59e44233a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ce9e0b90>]}
[0m17:09:59.240932 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:09:59.242545 [info ] [MainThread]: 
[0m17:09:59.908546 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m17:09:59.910632 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m17:09:59.912447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m17:09:59.913484 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m17:09:59.929032 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m17:09:59.940617 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 17:09:59.914182 => 17:09:59.940066
[0m17:09:59.942098 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m17:10:00.018016 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m17:10:00.794027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:00.857595 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m17:10:01.516428 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:4935efa9-c4e9-4290-a4a2-7480710e8492&page=queryresults
[0m17:10:04.570228 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 17:09:59.943128 => 17:10:04.569578
[0m17:10:04.572876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c794e50e-09a3-4fc7-871a-c59e44233a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ce5c99a0>]}
[0m17:10:04.576055 [info ] [Thread-1 (]: 1 of 1 OK created sql table model db_project_dataset.core_flights .............. [[32mCREATE TABLE (27.0m rows, 2.6 GiB processed)[0m in 4.66s]
[0m17:10:04.578628 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m17:10:04.584262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:04.585665 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m17:10:04.587045 [info ] [MainThread]: 
[0m17:10:04.588337 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.15 seconds (6.15s).
[0m17:10:04.591300 [debug] [MainThread]: Command end result
[0m17:10:04.632770 [info ] [MainThread]: 
[0m17:10:04.634878 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:10:04.636508 [info ] [MainThread]: 
[0m17:10:04.637836 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:10:04.640989 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.329141, "process_user_time": 8.278624, "process_kernel_time": 0.863022, "process_mem_max_rss": "253624", "process_in_blocks": "1040", "process_out_blocks": "0"}
[0m17:10:04.645029 [debug] [MainThread]: Command `dbt run` succeeded at 17:10:04.644582 after 10.33 seconds
[0m17:10:04.646715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ce49d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ce6e8bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f1afdaf0>]}
[0m17:10:04.648642 [debug] [MainThread]: Flushing usage events
[0m17:20:51.374084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ba2301ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ba2307800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ba2303aa0>]}


============================== 17:20:51.383943 | 54e13c57-e365-49c0-ba10-7f1b179ce2c5 ==============================
[0m17:20:51.383943 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:20:51.385336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models fact_departures_by_airport_year', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:20:51.419773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1bfc00560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1c0af51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1c19b7cb0>]}


============================== 17:20:51.428591 | 6b10733c-3bef-41ac-afbb-41d22b839ab2 ==============================
[0m17:20:51.428591 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:20:51.430175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models core_flights', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:20:55.150011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54e13c57-e365-49c0-ba10-7f1b179ce2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b7f2d7c20>]}
[0m17:20:55.171153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b10733c-3bef-41ac-afbb-41d22b839ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a07aa480>]}
[0m17:20:55.432794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54e13c57-e365-49c0-ba10-7f1b179ce2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b7f761a60>]}
[0m17:20:55.435053 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:20:55.461057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b10733c-3bef-41ac-afbb-41d22b839ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1c02e21b0>]}
[0m17:20:55.462673 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:20:55.482069 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:20:55.512307 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:20:56.294846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:20:56.296120 [debug] [MainThread]: Partial parsing: added file: flights_project://models/marts/fact_departures_by_airport_year.sql
[0m17:20:56.351295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:20:56.353195 [debug] [MainThread]: Partial parsing: added file: flights_project://models/marts/fact_departures_by_airport_year.sql
[0m17:20:56.850480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54e13c57-e365-49c0-ba10-7f1b179ce2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b7edd92b0>]}
[0m17:20:56.899845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54e13c57-e365-49c0-ba10-7f1b179ce2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b7ecc4230>]}
[0m17:20:56.901968 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:20:56.903822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54e13c57-e365-49c0-ba10-7f1b179ce2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b7ea42000>]}
[0m17:20:56.907050 [info ] [MainThread]: 
[0m17:20:56.909311 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:20:56.912099 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:20:56.913360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:56.938075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b10733c-3bef-41ac-afbb-41d22b839ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a03e9580>]}
[0m17:20:56.976655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b10733c-3bef-41ac-afbb-41d22b839ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a058ef90>]}
[0m17:20:56.978707 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:20:56.980197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b10733c-3bef-41ac-afbb-41d22b839ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a05622d0>]}
[0m17:20:56.984852 [info ] [MainThread]: 
[0m17:20:56.988194 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:20:56.992573 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:20:56.994074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:57.378308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:20:57.379452 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:20:57.482308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:20:57.484776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:20:57.741495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54e13c57-e365-49c0-ba10-7f1b179ce2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b7ea42030>]}
[0m17:20:57.744924 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:20:57.747146 [info ] [MainThread]: 
[0m17:20:57.770015 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m17:20:57.771786 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m17:20:57.774688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.fact_departures_by_airport_year)
[0m17:20:57.776055 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m17:20:57.796863 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m17:20:57.819736 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (compile): 17:20:57.777088 => 17:20:57.818533
[0m17:20:57.822143 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m17:20:57.849558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b10733c-3bef-41ac-afbb-41d22b839ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a09058e0>]}
[0m17:20:57.854269 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:20:57.856879 [info ] [MainThread]: 
[0m17:20:57.882642 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m17:20:57.887201 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m17:20:57.890458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m17:20:57.892312 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m17:20:57.913406 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m17:20:57.927681 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 17:20:57.893533 => 17:20:57.926471
[0m17:20:57.930376 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m17:20:57.978091 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m17:20:58.003104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:58.025182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:58.096585 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    EXTRACT(YEAR FROM dep_time) AS flight_year,
    count(*) as num_departures
from flights_data
group by origin, flight_year
    );
  
[0m17:20:58.484364 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m17:20:58.497655 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m17:20:58.573489 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:cfe6c016-5437-417d-94c6-6c6ce236245f&page=queryresults
[0m17:20:58.746576 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM STRING\n  Signature: EXTRACT(DATE_TIME_PART FROM DATE)\n    Argument 1: Unable to coerce type STRING to expected type DATE\n  Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])\n    Argument 1: Unable to coerce type STRING to expected type TIMESTAMP\n  Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)\n    Argument 1: Unable to coerce type STRING to expected type DATETIME\n  Signature: EXTRACT(DATE_TIME_PART FROM TIME)\n    Argument 1: Unable to coerce type STRING to expected type TIME\n  Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)\n    Argument 1: Unable to coerce type STRING to expected type INTERVAL at [22:5]; reason: invalidQuery, location: query, message: No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM STRING\n  Signature: EXTRACT(DATE_TIME_PART FROM DATE)\n    Argument 1: Unable to coerce type STRING to expected type DATE\n  Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])\n    Argument 1: Unable to coerce type STRING to expected type TIMESTAMP\n  Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)\n    Argument 1: Unable to coerce type STRING to expected type DATETIME\n  Signature: EXTRACT(DATE_TIME_PART FROM TIME)\n    Argument 1: Unable to coerce type STRING to expected type TIME\n  Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)\n    Argument 1: Unable to coerce type STRING to expected type INTERVAL at [22:5]')
[0m17:20:59.078330 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:131fe5da-d525-43d9-ab58-c068115489f4&page=queryresults
[0m17:20:59.632614 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:4424eeb9-59f4-4c42-aff6-7788129ee6b9&page=queryresults
[0m17:20:59.812844 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:4424eeb9-59f4-4c42-aff6-7788129ee6b9&page=queryresults
[0m17:20:59.815600 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (execute): 17:20:57.823870 => 17:20:59.814491
[0m17:20:59.829814 [debug] [Thread-1 (]: Database Error in model fact_departures_by_airport_year (models/marts/fact_departures_by_airport_year.sql)
  No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM STRING
    Signature: EXTRACT(DATE_TIME_PART FROM DATE)
      Argument 1: Unable to coerce type STRING to expected type DATE
    Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])
      Argument 1: Unable to coerce type STRING to expected type TIMESTAMP
    Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)
      Argument 1: Unable to coerce type STRING to expected type DATETIME
    Signature: EXTRACT(DATE_TIME_PART FROM TIME)
      Argument 1: Unable to coerce type STRING to expected type TIME
    Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)
      Argument 1: Unable to coerce type STRING to expected type INTERVAL at [22:5]
  compiled Code at target/run/flights_project/models/marts/fact_departures_by_airport_year.sql
[0m17:20:59.831613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54e13c57-e365-49c0-ba10-7f1b179ce2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b7eb1be30>]}
[0m17:20:59.835749 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.fact_departures_by_airport_year  [[31mERROR[0m in 2.06s]
[0m17:20:59.837771 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m17:20:59.842234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:59.843449 [debug] [MainThread]: Connection 'model.flights_project.fact_departures_by_airport_year' was properly closed.
[0m17:20:59.844444 [info ] [MainThread]: 
[0m17:20:59.845535 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.94 seconds (2.94s).
[0m17:20:59.847686 [debug] [MainThread]: Command end result
[0m17:20:59.884699 [info ] [MainThread]: 
[0m17:20:59.886530 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:20:59.887949 [info ] [MainThread]: 
[0m17:20:59.889338 [error] [MainThread]:   Database Error in model fact_departures_by_airport_year (models/marts/fact_departures_by_airport_year.sql)
  No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM STRING
    Signature: EXTRACT(DATE_TIME_PART FROM DATE)
      Argument 1: Unable to coerce type STRING to expected type DATE
    Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])
      Argument 1: Unable to coerce type STRING to expected type TIMESTAMP
    Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)
      Argument 1: Unable to coerce type STRING to expected type DATETIME
    Signature: EXTRACT(DATE_TIME_PART FROM TIME)
      Argument 1: Unable to coerce type STRING to expected type TIME
    Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)
      Argument 1: Unable to coerce type STRING to expected type INTERVAL at [22:5]
  compiled Code at target/run/flights_project/models/marts/fact_departures_by_airport_year.sql
[0m17:20:59.890774 [info ] [MainThread]: 
[0m17:20:59.892010 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:20:59.894433 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.633548, "process_user_time": 10.599586, "process_kernel_time": 0.785576, "process_mem_max_rss": "257772", "process_in_blocks": "400", "command_success": false, "process_out_blocks": "0"}
[0m17:20:59.896135 [debug] [MainThread]: Command `dbt run` failed at 17:20:59.895714 after 8.64 seconds
[0m17:20:59.897708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ba68cb200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b7edd8bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b7f64d670>]}
[0m17:20:59.899989 [debug] [MainThread]: Flushing usage events
[0m17:21:02.170124 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 17:20:57.931560 => 17:21:02.169670
[0m17:21:02.171782 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b10733c-3bef-41ac-afbb-41d22b839ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a058eb70>]}
[0m17:21:02.173143 [info ] [Thread-1 (]: 1 of 1 OK created sql table model db_project_dataset.core_flights .............. [[32mCREATE TABLE (27.0m rows, 2.6 GiB processed)[0m in 4.28s]
[0m17:21:02.174938 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m17:21:02.179381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:02.181293 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m17:21:02.182376 [info ] [MainThread]: 
[0m17:21:02.183619 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.20 seconds (5.20s).
[0m17:21:02.185449 [debug] [MainThread]: Command end result
[0m17:21:02.225890 [info ] [MainThread]: 
[0m17:21:02.227712 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:21:02.232691 [info ] [MainThread]: 
[0m17:21:02.234640 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:21:02.237503 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.939325, "process_user_time": 10.417612, "process_kernel_time": 0.970655, "process_mem_max_rss": "257596", "process_in_blocks": "208", "process_out_blocks": "0"}
[0m17:21:02.239345 [debug] [MainThread]: Command `dbt run` succeeded at 17:21:02.238897 after 10.94 seconds
[0m17:21:02.240631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1c0af51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a083faa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a39ee000>]}
[0m17:21:02.241662 [debug] [MainThread]: Flushing usage events
[0m17:21:49.363563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e6c49ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e6c48b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e6c49490>]}


============================== 17:21:49.379053 | 9b8103aa-61c5-4be5-ab8a-f58227f9cee6 ==============================
[0m17:21:49.379053 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:21:49.380573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_departures_by_airport_year', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:21:54.567727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b8103aa-61c5-4be5-ab8a-f58227f9cee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c38c7b60>]}
[0m17:21:55.035331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b8103aa-61c5-4be5-ab8a-f58227f9cee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c3549dc0>]}
[0m17:21:55.037015 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:21:55.074379 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:21:56.316541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:21:56.317536 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:21:56.331523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b8103aa-61c5-4be5-ab8a-f58227f9cee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c357a450>]}
[0m17:21:56.367110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b8103aa-61c5-4be5-ab8a-f58227f9cee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c3624800>]}
[0m17:21:56.368562 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:21:56.369789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b8103aa-61c5-4be5-ab8a-f58227f9cee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c33aeba0>]}
[0m17:21:56.372446 [info ] [MainThread]: 
[0m17:21:56.374572 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:21:56.377614 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:21:56.378977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:56.901938 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:21:56.903039 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:57.261603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b8103aa-61c5-4be5-ab8a-f58227f9cee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c34abec0>]}
[0m17:21:57.263650 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:21:57.264897 [info ] [MainThread]: 
[0m17:21:57.276528 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m17:21:57.277918 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m17:21:57.279622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.fact_departures_by_airport_year)
[0m17:21:57.281259 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m17:21:57.295674 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m17:21:57.307979 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (compile): 17:21:57.282485 => 17:21:57.307271
[0m17:21:57.309818 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m17:21:57.410551 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m17:21:57.426470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:57.495740 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    EXTRACT(YEAR FROM dep_time) AS flight_year,
    count(*) as num_departures
from flights_data
group by origin, flight_year
    );
  
[0m17:21:57.897975 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:23fcf038-afdc-45d2-a0e3-f0e72d5a6624&page=queryresults
[0m17:21:58.036511 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM STRING\n  Signature: EXTRACT(DATE_TIME_PART FROM DATE)\n    Argument 1: Unable to coerce type STRING to expected type DATE\n  Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])\n    Argument 1: Unable to coerce type STRING to expected type TIMESTAMP\n  Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)\n    Argument 1: Unable to coerce type STRING to expected type DATETIME\n  Signature: EXTRACT(DATE_TIME_PART FROM TIME)\n    Argument 1: Unable to coerce type STRING to expected type TIME\n  Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)\n    Argument 1: Unable to coerce type STRING to expected type INTERVAL at [22:5]; reason: invalidQuery, location: query, message: No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM STRING\n  Signature: EXTRACT(DATE_TIME_PART FROM DATE)\n    Argument 1: Unable to coerce type STRING to expected type DATE\n  Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])\n    Argument 1: Unable to coerce type STRING to expected type TIMESTAMP\n  Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)\n    Argument 1: Unable to coerce type STRING to expected type DATETIME\n  Signature: EXTRACT(DATE_TIME_PART FROM TIME)\n    Argument 1: Unable to coerce type STRING to expected type TIME\n  Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)\n    Argument 1: Unable to coerce type STRING to expected type INTERVAL at [22:5]')
[0m17:21:59.084694 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:87120f91-9070-4006-b85c-3f692e5953da&page=queryresults
[0m17:21:59.225909 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:87120f91-9070-4006-b85c-3f692e5953da&page=queryresults
[0m17:21:59.230663 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (execute): 17:21:57.311018 => 17:21:59.229494
[0m17:21:59.240178 [debug] [Thread-1 (]: Database Error in model fact_departures_by_airport_year (models/marts/fact_departures_by_airport_year.sql)
  No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM STRING
    Signature: EXTRACT(DATE_TIME_PART FROM DATE)
      Argument 1: Unable to coerce type STRING to expected type DATE
    Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])
      Argument 1: Unable to coerce type STRING to expected type TIMESTAMP
    Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)
      Argument 1: Unable to coerce type STRING to expected type DATETIME
    Signature: EXTRACT(DATE_TIME_PART FROM TIME)
      Argument 1: Unable to coerce type STRING to expected type TIME
    Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)
      Argument 1: Unable to coerce type STRING to expected type INTERVAL at [22:5]
  compiled Code at target/run/flights_project/models/marts/fact_departures_by_airport_year.sql
[0m17:21:59.241595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b8103aa-61c5-4be5-ab8a-f58227f9cee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c347d730>]}
[0m17:21:59.242949 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.fact_departures_by_airport_year  [[31mERROR[0m in 1.96s]
[0m17:21:59.244628 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m17:21:59.252108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:59.253222 [debug] [MainThread]: Connection 'model.flights_project.fact_departures_by_airport_year' was properly closed.
[0m17:21:59.254222 [info ] [MainThread]: 
[0m17:21:59.255466 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m17:21:59.259219 [debug] [MainThread]: Command end result
[0m17:21:59.306287 [info ] [MainThread]: 
[0m17:21:59.308141 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:21:59.309956 [info ] [MainThread]: 
[0m17:21:59.312535 [error] [MainThread]:   Database Error in model fact_departures_by_airport_year (models/marts/fact_departures_by_airport_year.sql)
  No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM STRING
    Signature: EXTRACT(DATE_TIME_PART FROM DATE)
      Argument 1: Unable to coerce type STRING to expected type DATE
    Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])
      Argument 1: Unable to coerce type STRING to expected type TIMESTAMP
    Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)
      Argument 1: Unable to coerce type STRING to expected type DATETIME
    Signature: EXTRACT(DATE_TIME_PART FROM TIME)
      Argument 1: Unable to coerce type STRING to expected type TIME
    Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)
      Argument 1: Unable to coerce type STRING to expected type INTERVAL at [22:5]
  compiled Code at target/run/flights_project/models/marts/fact_departures_by_airport_year.sql
[0m17:21:59.318756 [info ] [MainThread]: 
[0m17:21:59.320790 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:21:59.324175 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.213258, "process_user_time": 12.747184, "process_kernel_time": 1.270222, "process_mem_max_rss": "257220", "process_in_blocks": "432", "command_success": false, "process_out_blocks": "0"}
[0m17:21:59.326306 [debug] [MainThread]: Command `dbt run` failed at 17:21:59.325609 after 10.22 seconds
[0m17:21:59.328924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e6f724b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e6c49490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ca6cd790>]}
[0m17:21:59.333659 [debug] [MainThread]: Flushing usage events
[0m17:22:49.395275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cfed24e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cfed1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cfed1070>]}


============================== 17:22:49.404053 | fbc2fbd0-84d6-4203-b943-7a1cc364a227 ==============================
[0m17:22:49.404053 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:22:49.405491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models fact_departures_by_airport_year', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:22:50.741333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbc2fbd0-84d6-4203-b943-7a1cc364a227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cfe8f380>]}
[0m17:22:50.931320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbc2fbd0-84d6-4203-b943-7a1cc364a227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b3a3f950>]}
[0m17:22:50.932804 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:22:50.973504 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:22:51.790736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:22:51.791777 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/marts/fact_departures_by_airport_year.sql
[0m17:22:52.146572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbc2fbd0-84d6-4203-b943-7a1cc364a227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b05188f0>]}
[0m17:22:52.184267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbc2fbd0-84d6-4203-b943-7a1cc364a227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b08c8cb0>]}
[0m17:22:52.185981 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:22:52.187492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbc2fbd0-84d6-4203-b943-7a1cc364a227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b04f83b0>]}
[0m17:22:52.190663 [info ] [MainThread]: 
[0m17:22:52.192451 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:22:52.195330 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:22:52.196422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:52.582622 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:22:52.584040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:22:52.885214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbc2fbd0-84d6-4203-b943-7a1cc364a227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b066f0e0>]}
[0m17:22:52.887237 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:22:52.888418 [info ] [MainThread]: 
[0m17:22:52.899198 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m17:22:52.900482 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m17:22:52.902071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.fact_departures_by_airport_year)
[0m17:22:52.903057 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m17:22:52.914207 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m17:22:52.926317 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (compile): 17:22:52.903758 => 17:22:52.925799
[0m17:22:52.927435 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m17:22:52.995017 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m17:22:53.007871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:53.050857 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    EXTRACT(YEAR FROM CAST(dep_time AS TIMESTAMP)) AS flight_year,
    count(*) as num_departures
from flights_data
group by origin, flight_year
    );
  
[0m17:22:53.495609 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:b7ad021e-8b34-42e4-b5bb-cede7f86c8f6&page=queryresults
[0m17:22:53.906848 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid timestamp: '1989-11-05 15:10'; reason: invalidQuery, location: query, message: Invalid timestamp: '1989-11-05 15:10'; reason: invalidQuery, location: query, message: Invalid timestamp: '1992-12-22 16:31'")
[0m17:22:54.775093 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e106ccc3-d23c-4d78-b629-f6658cc1ce1f&page=queryresults
[0m17:22:55.198530 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:e106ccc3-d23c-4d78-b629-f6658cc1ce1f&page=queryresults
[0m17:22:55.200690 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (execute): 17:22:52.928085 => 17:22:55.200035
[0m17:22:55.213387 [debug] [Thread-1 (]: Database Error in model fact_departures_by_airport_year (models/marts/fact_departures_by_airport_year.sql)
  Invalid timestamp: '1989-10-14 19:50'
  compiled Code at target/run/flights_project/models/marts/fact_departures_by_airport_year.sql
[0m17:22:55.215337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbc2fbd0-84d6-4203-b943-7a1cc364a227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b0670fe0>]}
[0m17:22:55.216875 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.fact_departures_by_airport_year  [[31mERROR[0m in 2.31s]
[0m17:22:55.218917 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m17:22:55.225482 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:55.226906 [debug] [MainThread]: Connection 'model.flights_project.fact_departures_by_airport_year' was properly closed.
[0m17:22:55.228012 [info ] [MainThread]: 
[0m17:22:55.229303 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.04 seconds (3.04s).
[0m17:22:55.231251 [debug] [MainThread]: Command end result
[0m17:22:55.258671 [info ] [MainThread]: 
[0m17:22:55.260105 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:22:55.261520 [info ] [MainThread]: 
[0m17:22:55.263177 [error] [MainThread]:   Database Error in model fact_departures_by_airport_year (models/marts/fact_departures_by_airport_year.sql)
  Invalid timestamp: '1989-10-14 19:50'
  compiled Code at target/run/flights_project/models/marts/fact_departures_by_airport_year.sql
[0m17:22:55.264851 [info ] [MainThread]: 
[0m17:22:55.266090 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:22:55.268585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.972994, "process_user_time": 6.591654, "process_kernel_time": 0.61108, "process_mem_max_rss": "261860", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:22:55.270312 [debug] [MainThread]: Command `dbt run` failed at 17:22:55.269976 after 5.97 seconds
[0m17:22:55.271829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d0cd4380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d00eef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cfed3380>]}
[0m17:22:55.273144 [debug] [MainThread]: Flushing usage events
[0m17:23:59.598034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6985b9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6985bbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6985b8a40>]}


============================== 17:23:59.607450 | f288d012-c0b6-4b35-bae4-9b7194f86c52 ==============================
[0m17:23:59.607450 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:23:59.609768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models fact_departures_by_airport_year', 'send_anonymous_usage_stats': 'True'}
[0m17:24:01.512044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f288d012-c0b6-4b35-bae4-9b7194f86c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe675303a10>]}
[0m17:24:01.955022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f288d012-c0b6-4b35-bae4-9b7194f86c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe67567f620>]}
[0m17:24:01.961873 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:24:02.020895 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:24:03.325718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:24:03.328138 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/marts/fact_departures_by_airport_year.sql
[0m17:24:03.869637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f288d012-c0b6-4b35-bae4-9b7194f86c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe674ca9790>]}
[0m17:24:03.922014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f288d012-c0b6-4b35-bae4-9b7194f86c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe674f8c770>]}
[0m17:24:03.923625 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:24:03.925119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f288d012-c0b6-4b35-bae4-9b7194f86c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe674bc7830>]}
[0m17:24:03.928886 [info ] [MainThread]: 
[0m17:24:03.931444 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:24:03.935263 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:24:03.938547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:04.475979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:24:04.529297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:04.897031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f288d012-c0b6-4b35-bae4-9b7194f86c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe674bc4590>]}
[0m17:24:04.899288 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:24:04.900892 [info ] [MainThread]: 
[0m17:24:04.911816 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m17:24:04.913119 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.fact_departures_by_airport_year . [RUN]
[0m17:24:04.914828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.fact_departures_by_airport_year)
[0m17:24:04.915917 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m17:24:04.928222 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m17:24:04.939591 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (compile): 17:24:04.916723 => 17:24:04.938812
[0m17:24:04.940821 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m17:24:05.004467 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m17:24:05.017674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:05.064895 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
  OPTIONS()
  as with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)

select 
    origin as airport_code,
    EXTRACT(YEAR FROM TRY_CAST(dep_time AS TIMESTAMP)) AS flight_year,  -- Try to cast dep_time to TIMESTAMP
    count(*) as num_departures
from flights_data
where TRY_CAST(dep_time AS TIMESTAMP) IS NOT NULL  -- Filter out rows where dep_time is not a valid timestamp
group by origin, flight_year;


[0m17:24:05.392571 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:5549c860-00eb-4197-9bca-9e1cad5a148c&page=queryresults
[0m17:24:05.518757 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Function not found: TRY_CAST at [16:7]; reason: invalidQuery, location: query, message: Function not found: TRY_CAST at [16:7]')
[0m17:24:05.706040 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c2ccc0d0-e969-43eb-83ee-d017e3d44b53&page=queryresults
[0m17:24:05.814661 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c2ccc0d0-e969-43eb-83ee-d017e3d44b53&page=queryresults
[0m17:24:05.819719 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (execute): 17:24:04.941551 => 17:24:05.818389
[0m17:24:05.830089 [debug] [Thread-1 (]: Database Error in model fact_departures_by_airport_year (models/marts/fact_departures_by_airport_year.sql)
  Function not found: TRY_CAST at [16:7]
  compiled Code at target/run/flights_project/models/marts/fact_departures_by_airport_year.sql
[0m17:24:05.832441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f288d012-c0b6-4b35-bae4-9b7194f86c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe674f8f5f0>]}
[0m17:24:05.835844 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model db_project_dataset.fact_departures_by_airport_year  [[31mERROR[0m in 0.92s]
[0m17:24:05.839400 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m17:24:05.846486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:05.857167 [debug] [MainThread]: Connection 'model.flights_project.fact_departures_by_airport_year' was properly closed.
[0m17:24:05.858685 [info ] [MainThread]: 
[0m17:24:05.859772 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.93 seconds (1.93s).
[0m17:24:05.863120 [debug] [MainThread]: Command end result
[0m17:24:05.911636 [info ] [MainThread]: 
[0m17:24:05.915259 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:24:05.922755 [info ] [MainThread]: 
[0m17:24:05.925316 [error] [MainThread]:   Database Error in model fact_departures_by_airport_year (models/marts/fact_departures_by_airport_year.sql)
  Function not found: TRY_CAST at [16:7]
  compiled Code at target/run/flights_project/models/marts/fact_departures_by_airport_year.sql
[0m17:24:05.927917 [info ] [MainThread]: 
[0m17:24:05.929884 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:24:05.935333 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.443678, "process_user_time": 9.020599, "process_kernel_time": 0.806477, "process_mem_max_rss": "261932", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:24:05.938716 [debug] [MainThread]: Command `dbt run` failed at 17:24:05.937903 after 6.45 seconds
[0m17:24:05.941060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe69cb83200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6985be1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe674c039e0>]}
[0m17:24:05.942923 [debug] [MainThread]: Flushing usage events
[0m17:25:27.767710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe18881c7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe18881c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe188a3c770>]}


============================== 17:25:27.776404 | a2123085-295c-4d06-9a0c-bc36dca53733 ==============================
[0m17:25:27.776404 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:25:27.777847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:25:27.966455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2123085-295c-4d06-9a0c-bc36dca53733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1886d2c90>]}
[0m17:25:28.371557 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-x1xe8ehs'
[0m17:25:28.372572 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:25:28.613036 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:25:28.615176 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:25:28.716327 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:25:28.725758 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:25:32.493930 [info ] [MainThread]: Installed from version 1.3.0
[0m17:25:32.494941 [info ] [MainThread]: Up to date!
[0m17:25:32.495915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a2123085-295c-4d06-9a0c-bc36dca53733', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1888c4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1888c4da0>]}
[0m17:25:32.497534 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.831253, "process_user_time": 3.693803, "process_kernel_time": 0.244893, "process_mem_max_rss": "112024", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m17:25:32.498479 [debug] [MainThread]: Command `dbt deps` succeeded at 17:25:32.498261 after 4.83 seconds
[0m17:25:32.499270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe18881c7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe188a3c770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1885bc1a0>]}
[0m17:25:32.500139 [debug] [MainThread]: Flushing usage events
[0m17:25:37.097506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a197f06b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a1b5c8620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a1a3949e0>]}


============================== 17:25:37.106336 | a1aa6b8a-ef3a-48ce-b466-c9146ba6c5ec ==============================
[0m17:25:37.106336 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:25:37.107840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_flights', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:25:38.410458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1aa6b8a-ef3a-48ce-b466-c9146ba6c5ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f63a5f10>]}
[0m17:25:38.622706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1aa6b8a-ef3a-48ce-b466-c9146ba6c5ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fd385760>]}
[0m17:25:38.624104 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:25:38.664853 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:25:39.711497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:25:39.713262 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/marts/fact_departures_by_airport_year.sql
[0m17:25:39.714527 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m17:25:40.130119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1aa6b8a-ef3a-48ce-b466-c9146ba6c5ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f5eb9c40>]}
[0m17:25:40.166070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1aa6b8a-ef3a-48ce-b466-c9146ba6c5ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f61d8740>]}
[0m17:25:40.167426 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:25:40.168859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1aa6b8a-ef3a-48ce-b466-c9146ba6c5ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f5df4e90>]}
[0m17:25:40.171915 [info ] [MainThread]: 
[0m17:25:40.174385 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:25:40.177351 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:25:40.178514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:40.577270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:25:40.579125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:40.904544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1aa6b8a-ef3a-48ce-b466-c9146ba6c5ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f5df5010>]}
[0m17:25:40.906977 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:25:40.908634 [info ] [MainThread]: 
[0m17:25:40.919288 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m17:25:40.920591 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m17:25:40.922280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.stg_flights)
[0m17:25:40.923269 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m17:25:40.937604 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m17:25:40.950123 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (compile): 17:25:40.924194 => 17:25:40.949582
[0m17:25:40.951058 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m17:25:40.994405 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m17:25:41.006916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:41.045571 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    PARSE_TIMESTAMP('%Y-%m-%d %H:%M', CONCAT(CAST(FlightDate AS STRING), ' ', DepTimeFormatted)) AS dep_time,
    PARSE_TIMESTAMP('%Y-%m-%d %H:%M', CONCAT(CAST(FlightDate AS STRING), ' ', ArrTimeFormatted)) AS arr_time,
    FlightNum as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m17:25:41.421081 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:2bdf3949-5596-4c91-84a4-b054e5de2e53&page=queryresults
[0m17:25:41.596887 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (execute): 17:25:40.951673 => 17:25:41.596521
[0m17:25:41.598450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1aa6b8a-ef3a-48ce-b466-c9146ba6c5ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f602bfb0>]}
[0m17:25:41.599684 [info ] [Thread-1 (]: 1 of 1 OK created sql view model db_project_dataset.stg_flights ................ [[32mCREATE VIEW (0 processed)[0m in 0.68s]
[0m17:25:41.601139 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m17:25:41.604619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:41.605634 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m17:25:41.606623 [info ] [MainThread]: 
[0m17:25:41.607870 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m17:25:41.609395 [debug] [MainThread]: Command end result
[0m17:25:41.633152 [info ] [MainThread]: 
[0m17:25:41.634591 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:25:41.635757 [info ] [MainThread]: 
[0m17:25:41.636946 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:25:41.638955 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.6365137, "process_user_time": 5.999399, "process_kernel_time": 0.743727, "process_mem_max_rss": "259632", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:25:41.640535 [debug] [MainThread]: Command `dbt run` succeeded at 17:25:41.640277 after 4.64 seconds
[0m17:25:41.641631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a1a5629c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a19854740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f5e4be60>]}
[0m17:25:41.642916 [debug] [MainThread]: Flushing usage events
[0m17:25:47.332779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dd3cd4e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dd3cd47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dd3cd79e0>]}


============================== 17:25:47.341386 | b1fd67c4-b53d-4190-98e8-19e18f4d3210 ==============================
[0m17:25:47.341386 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:25:47.342847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:25:48.653776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1fd67c4-b53d-4190-98e8-19e18f4d3210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db4d2cbc0>]}
[0m17:25:48.846885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1fd67c4-b53d-4190-98e8-19e18f4d3210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db4b69b80>]}
[0m17:25:48.848461 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:25:48.888574 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:25:49.811346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:25:49.812182 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:25:49.821366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1fd67c4-b53d-4190-98e8-19e18f4d3210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db47c64b0>]}
[0m17:25:49.854093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1fd67c4-b53d-4190-98e8-19e18f4d3210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db46ac7d0>]}
[0m17:25:49.855428 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:25:49.856658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1fd67c4-b53d-4190-98e8-19e18f4d3210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db46267e0>]}
[0m17:25:49.859574 [info ] [MainThread]: 
[0m17:25:49.861573 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:25:49.864091 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:25:49.865491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:50.282756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:25:50.284372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:50.573668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1fd67c4-b53d-4190-98e8-19e18f4d3210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db516aa80>]}
[0m17:25:50.576046 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:25:50.577589 [info ] [MainThread]: 
[0m17:25:50.588033 [debug] [Thread-1 (]: Began running node seed.flights_project.airports
[0m17:25:50.589265 [info ] [Thread-1 (]: 1 of 1 START seed file db_project_dataset.airports ............................. [RUN]
[0m17:25:50.590894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now seed.flights_project.airports)
[0m17:25:50.591929 [debug] [Thread-1 (]: Began compiling node seed.flights_project.airports
[0m17:25:50.593026 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (compile): 17:25:50.592660 => 17:25:50.592667
[0m17:25:50.594148 [debug] [Thread-1 (]: Began executing node seed.flights_project.airports
[0m17:25:50.726103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:54.233815 [debug] [Thread-1 (]: On seed.flights_project.airports: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.flights_project.airports"} */

    alter table `db-project-456518`.`db_project_dataset`.`airports` set OPTIONS()
  
[0m17:25:54.362044 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:df410881-1657-463a-bb43-039b75b73909&page=queryresults
[0m17:25:54.540399 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.flights_project.airports"
[0m17:25:54.573459 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (execute): 17:25:50.594871 => 17:25:54.572935
[0m17:25:54.575116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1fd67c4-b53d-4190-98e8-19e18f4d3210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db48277a0>]}
[0m17:25:54.576369 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file db_project_dataset.airports ......................... [[32mINSERT 3376[0m in 3.98s]
[0m17:25:54.578222 [debug] [Thread-1 (]: Finished running node seed.flights_project.airports
[0m17:25:54.582210 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:54.583292 [debug] [MainThread]: Connection 'seed.flights_project.airports' was properly closed.
[0m17:25:54.584400 [info ] [MainThread]: 
[0m17:25:54.585533 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 4.72 seconds (4.72s).
[0m17:25:54.587136 [debug] [MainThread]: Command end result
[0m17:25:54.612904 [info ] [MainThread]: 
[0m17:25:54.614218 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:25:54.615509 [info ] [MainThread]: 
[0m17:25:54.616918 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:25:54.619117 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 7.388494, "process_user_time": 5.630888, "process_kernel_time": 0.546206, "process_mem_max_rss": "262216", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:25:54.620440 [debug] [MainThread]: Command `dbt seed` succeeded at 17:25:54.620132 after 7.39 seconds
[0m17:25:54.621612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dd43dd760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db490d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db445f6e0>]}
[0m17:25:54.622828 [debug] [MainThread]: Flushing usage events
[0m17:26:00.240119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4310c0b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4311b8230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4310c19d0>]}


============================== 17:26:00.248846 | bfe1bde8-200a-4359-b2b1-5d3a607b267c ==============================
[0m17:26:00.248846 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:26:00.250166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models core_flights', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:26:01.619460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfe1bde8-200a-4359-b2b1-5d3a607b267c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc40e031520>]}
[0m17:26:01.817404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfe1bde8-200a-4359-b2b1-5d3a607b267c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc43107efc0>]}
[0m17:26:01.818785 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:26:01.858982 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:26:02.779425 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:26:02.780240 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:26:02.789097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfe1bde8-200a-4359-b2b1-5d3a607b267c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc40da595e0>]}
[0m17:26:02.823798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfe1bde8-200a-4359-b2b1-5d3a607b267c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc40dab0050>]}
[0m17:26:02.825147 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:26:02.826460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfe1bde8-200a-4359-b2b1-5d3a607b267c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc40dc4b4a0>]}
[0m17:26:02.829061 [info ] [MainThread]: 
[0m17:26:02.831127 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:26:02.833244 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:26:02.834226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:03.244429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:26:03.246051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:26:03.566285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfe1bde8-200a-4359-b2b1-5d3a607b267c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc40dc4b4a0>]}
[0m17:26:03.568885 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:26:03.570388 [info ] [MainThread]: 
[0m17:26:03.602373 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m17:26:03.604434 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m17:26:03.606856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m17:26:03.608506 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m17:26:03.632831 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m17:26:03.641795 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 17:26:03.609559 => 17:26:03.640880
[0m17:26:03.642920 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m17:26:03.670829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:04.040961 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m17:26:04.053020 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m17:26:04.561796 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:25e65d3a-d990-46dd-a89d-4ffbd2720971&page=queryresults
[0m17:26:05.293459 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Failed to parse input string "1992-10-24 90:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-10-24 90:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-07-21 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-07-28 90:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-01-11 74:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-12-11 90:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-11-02 90:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-10-12 65:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-07-19 90:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-11-06 90:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-03-14 "; reason: invalidQuery, location: query, message: Failed to parse input string "1992-10-19 90:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-09-29 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-11-14 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-09-22 90:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-10-28 90:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-09-10 12:1."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-01-25 "; reason: invalidQuery, location: query, message: Failed to parse input string "1990-08-13 23:1."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-01-10 71:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-05-08 28:.0"; reason: invalidQuery, location: query, message: Failed to parse input string "1988-07-30 29:.0"; reason: invalidQuery, location: query, message: Failed to parse input string "1992-07-13 75:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-06-06 65:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-07-03 "; reason: invalidQuery, location: query, message: Failed to parse input string "1987-11-13 65:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-05-28 85:2."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-12-26 71:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-03-05 "; reason: invalidQuery, location: query, message: Failed to parse input string "1990-09-09 64:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-06-30 63:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-31 90:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-02-05 71:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-04-22 "; reason: invalidQuery, location: query, message: Failed to parse input string "1991-12-06 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-07-15 62:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-04-23 "; reason: invalidQuery, location: query, message: Failed to parse input string "1992-06-20 73:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-08-30 62:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-07-20 71:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-04-10 62:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-12-02 64:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-10-27 71:4."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-05-15 65:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-11-30 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-05-29 65:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-05-07 80:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-10-04 64:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-06-16 85:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-05-05 63:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-08-18 64:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-05-04 03:.0"; reason: invalidQuery, location: query, message: Failed to parse input string "1987-10-18 64:2."; reason: invalidQuery, location: query, message: Failed to parse input string "1987-12-28 95:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-05-15 63:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-04-17 72:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-08-01 64:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-01-23 62:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-06-05 71:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-06-19 71:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-10-09 80:4."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-04-19 62:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-05-03 61:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-12-18 71:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-10-03 90:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-12-30 63:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-01-24 63:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-09-14 61:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-11-16 "; reason: invalidQuery, location: query, message: Failed to parse input string "1992-08-29 75:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-06-23 71:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-05-26 70:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-12-22 20:.0"; reason: invalidQuery, location: query, message: Failed to parse input string "1990-11-24 62:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-02-26 61:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-04-25 71:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-03-21 61:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-12-24 63:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-18 90:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1987-12-12 65:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-02-03 61:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-11-14 71:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1987-12-22 64:2."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-11-23 63:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-07-19 20:.0"; reason: invalidQuery, location: query, message: Failed to parse input string "1989-06-24 65:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-11-10 75:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1987-10-28 64:4."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-05-14 65:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-01-17 71:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-02-09 75:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1987-11-11 24:00"; reason: invalidQuery, location: query, message: Failed to parse input string "1991-06-17 72:0."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-03-25 71:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1990-11-05 71:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-05-18 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-01-29 63:2."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-01-12 80:1."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-09-24 63:4."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-09-29 75:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1988-01-15 61:8."')
[0m17:26:06.217614 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:de89dfa1-6434-4c46-aed4-0a1caf8b2c37&page=queryresults
[0m17:26:06.707050 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:de89dfa1-6434-4c46-aed4-0a1caf8b2c37&page=queryresults
[0m17:26:06.709291 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 17:26:03.643669 => 17:26:06.708597
[0m17:26:06.720540 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  Failed to parse input string "1991-08-09 90:2."
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m17:26:06.721989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfe1bde8-200a-4359-b2b1-5d3a607b267c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc40dc11d60>]}
[0m17:26:06.723656 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.core_flights .......... [[31mERROR[0m in 3.12s]
[0m17:26:06.725568 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m17:26:06.730251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:26:06.731451 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m17:26:06.732509 [info ] [MainThread]: 
[0m17:26:06.733706 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.90 seconds (3.90s).
[0m17:26:06.735484 [debug] [MainThread]: Command end result
[0m17:26:06.760818 [info ] [MainThread]: 
[0m17:26:06.762038 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:26:06.763012 [info ] [MainThread]: 
[0m17:26:06.764011 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  Failed to parse input string "1991-08-09 90:2."
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m17:26:06.765051 [info ] [MainThread]: 
[0m17:26:06.766186 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:26:06.768567 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.623964, "process_user_time": 5.633407, "process_kernel_time": 0.63475, "process_mem_max_rss": "256752", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:26:06.770070 [debug] [MainThread]: Command `dbt run` failed at 17:26:06.769814 after 6.63 seconds
[0m17:26:06.771162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc43107ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc40db0f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4311cb560>]}
[0m17:26:06.772407 [debug] [MainThread]: Flushing usage events
[0m17:29:11.129891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b2aafd7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b2aafca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b2aafd010>]}


============================== 17:29:11.139521 | b25117a1-8d82-463f-8de7-513a6d6da6d8 ==============================
[0m17:29:11.139521 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:29:11.141077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models fact_departures_by_airport_year', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:29:12.610705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b25117a1-8d82-463f-8de7-513a6d6da6d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b2a9864e0>]}
[0m17:29:12.876859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b25117a1-8d82-463f-8de7-513a6d6da6d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b2adf30b0>]}
[0m17:29:12.878503 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:29:12.914983 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:29:13.879452 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:29:13.880512 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:29:13.890652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b25117a1-8d82-463f-8de7-513a6d6da6d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b075baae0>]}
[0m17:29:13.922889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b25117a1-8d82-463f-8de7-513a6d6da6d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b074d8230>]}
[0m17:29:13.924519 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:29:13.926164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b25117a1-8d82-463f-8de7-513a6d6da6d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b072569f0>]}
[0m17:29:13.928985 [info ] [MainThread]: 
[0m17:29:13.930992 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:29:13.933466 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:29:13.934762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:14.416893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:29:14.418648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:29:14.716395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b25117a1-8d82-463f-8de7-513a6d6da6d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0753df10>]}
[0m17:29:14.718737 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:29:14.720247 [info ] [MainThread]: 
[0m17:29:14.731330 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m17:29:14.732610 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m17:29:14.734374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.fact_departures_by_airport_year)
[0m17:29:14.735440 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m17:29:14.747602 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m17:29:14.760648 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (compile): 17:29:14.736205 => 17:29:14.759922
[0m17:29:14.761710 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m17:29:14.826868 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m17:29:14.839720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:14.884941 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    EXTRACT(YEAR FROM dep_time) AS flight_year,
    count(*) as num_departures
from flights_data
group by origin, flight_year
    );
  
[0m17:29:15.300739 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:11ec8852-f50a-4480-b8e6-eb0241fb3a7a&page=queryresults
[0m17:29:15.449322 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM STRING\n  Signature: EXTRACT(DATE_TIME_PART FROM DATE)\n    Argument 1: Unable to coerce type STRING to expected type DATE\n  Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])\n    Argument 1: Unable to coerce type STRING to expected type TIMESTAMP\n  Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)\n    Argument 1: Unable to coerce type STRING to expected type DATETIME\n  Signature: EXTRACT(DATE_TIME_PART FROM TIME)\n    Argument 1: Unable to coerce type STRING to expected type TIME\n  Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)\n    Argument 1: Unable to coerce type STRING to expected type INTERVAL at [22:5]; reason: invalidQuery, location: query, message: No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM STRING\n  Signature: EXTRACT(DATE_TIME_PART FROM DATE)\n    Argument 1: Unable to coerce type STRING to expected type DATE\n  Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])\n    Argument 1: Unable to coerce type STRING to expected type TIMESTAMP\n  Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)\n    Argument 1: Unable to coerce type STRING to expected type DATETIME\n  Signature: EXTRACT(DATE_TIME_PART FROM TIME)\n    Argument 1: Unable to coerce type STRING to expected type TIME\n  Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)\n    Argument 1: Unable to coerce type STRING to expected type INTERVAL at [22:5]')
[0m17:29:15.869069 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:57f194f3-185f-4ab3-b73c-e01f863b113c&page=queryresults
[0m17:29:15.991420 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:57f194f3-185f-4ab3-b73c-e01f863b113c&page=queryresults
[0m17:29:15.993593 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (execute): 17:29:14.762433 => 17:29:15.992947
[0m17:29:16.002984 [debug] [Thread-1 (]: Database Error in model fact_departures_by_airport_year (models/marts/fact_departures_by_airport_year.sql)
  No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM STRING
    Signature: EXTRACT(DATE_TIME_PART FROM DATE)
      Argument 1: Unable to coerce type STRING to expected type DATE
    Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])
      Argument 1: Unable to coerce type STRING to expected type TIMESTAMP
    Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)
      Argument 1: Unable to coerce type STRING to expected type DATETIME
    Signature: EXTRACT(DATE_TIME_PART FROM TIME)
      Argument 1: Unable to coerce type STRING to expected type TIME
    Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)
      Argument 1: Unable to coerce type STRING to expected type INTERVAL at [22:5]
  compiled Code at target/run/flights_project/models/marts/fact_departures_by_airport_year.sql
[0m17:29:16.004212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b25117a1-8d82-463f-8de7-513a6d6da6d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0728fe60>]}
[0m17:29:16.005481 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.fact_departures_by_airport_year  [[31mERROR[0m in 1.27s]
[0m17:29:16.006988 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m17:29:16.011011 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:29:16.011967 [debug] [MainThread]: Connection 'model.flights_project.fact_departures_by_airport_year' was properly closed.
[0m17:29:16.012902 [info ] [MainThread]: 
[0m17:29:16.014009 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m17:29:16.015702 [debug] [MainThread]: Command end result
[0m17:29:16.039754 [info ] [MainThread]: 
[0m17:29:16.041058 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:29:16.042137 [info ] [MainThread]: 
[0m17:29:16.043373 [error] [MainThread]:   Database Error in model fact_departures_by_airport_year (models/marts/fact_departures_by_airport_year.sql)
  No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM STRING
    Signature: EXTRACT(DATE_TIME_PART FROM DATE)
      Argument 1: Unable to coerce type STRING to expected type DATE
    Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])
      Argument 1: Unable to coerce type STRING to expected type TIMESTAMP
    Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)
      Argument 1: Unable to coerce type STRING to expected type DATETIME
    Signature: EXTRACT(DATE_TIME_PART FROM TIME)
      Argument 1: Unable to coerce type STRING to expected type TIME
    Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)
      Argument 1: Unable to coerce type STRING to expected type INTERVAL at [22:5]
  compiled Code at target/run/flights_project/models/marts/fact_departures_by_airport_year.sql
[0m17:29:16.044607 [info ] [MainThread]: 
[0m17:29:16.045934 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:29:16.048360 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.0381656, "process_user_time": 5.74006, "process_kernel_time": 0.510005, "process_mem_max_rss": "254468", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:29:16.050032 [debug] [MainThread]: Command `dbt run` failed at 17:29:16.049592 after 5.04 seconds
[0m17:29:16.051766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b2aafd0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b075f5be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b2e54bda0>]}
[0m17:29:16.053338 [debug] [MainThread]: Flushing usage events
[0m17:31:12.765529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0de6e29b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0de714c3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0de6e28980>]}


============================== 17:31:12.775000 | b436b87b-889b-4961-8521-62d0a76f924f ==============================
[0m17:31:12.775000 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:31:12.776523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models core_flights', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:31:14.176939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b436b87b-889b-4961-8521-62d0a76f924f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dc81acda0>]}
[0m17:31:14.365570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b436b87b-889b-4961-8521-62d0a76f924f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0de714dbe0>]}
[0m17:31:14.366956 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:31:14.407485 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:31:15.313783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:31:15.314585 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:31:15.323061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b436b87b-889b-4961-8521-62d0a76f924f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0de6de75c0>]}
[0m17:31:15.354546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b436b87b-889b-4961-8521-62d0a76f924f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dc38148f0>]}
[0m17:31:15.356111 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:31:15.357280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b436b87b-889b-4961-8521-62d0a76f924f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dc35965a0>]}
[0m17:31:15.359714 [info ] [MainThread]: 
[0m17:31:15.361537 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:31:15.363916 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:31:15.364998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:15.838431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:31:15.840064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:31:16.171701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b436b87b-889b-4961-8521-62d0a76f924f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0de6e28380>]}
[0m17:31:16.174050 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:31:16.175491 [info ] [MainThread]: 
[0m17:31:16.185862 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m17:31:16.187065 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m17:31:16.188723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m17:31:16.189818 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m17:31:16.201483 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m17:31:16.213070 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 17:31:16.190564 => 17:31:16.212355
[0m17:31:16.214243 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m17:31:16.237512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:16.580452 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m17:31:16.594378 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m17:31:17.191952 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:6dea19e8-e71e-4b7e-9bb0-427a21ee51a8&page=queryresults
[0m17:31:17.612257 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Failed to parse input string "1992-12-23 90:2."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-23 90:2."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-06 91:1."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-12-04 90:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-10-03 90:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-09-05 90:6."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-06-02 90:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-10-13 90:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-11-08 90:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-02-07 90:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-11-14 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-11-19 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-09-29 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-10-25 "; reason: invalidQuery, location: query, message: Failed to parse input string "1992-09-24 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-12-06 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-07-16 90:8."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-08-28 90:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-03-26 91:1."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-10-15 90:9."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-10-06 "; reason: invalidQuery, location: query, message: Failed to parse input string "1991-08-20 93:3."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-11-05 93:7."; reason: invalidQuery, location: query, message: Failed to parse input string "1992-09-22 90:5."; reason: invalidQuery, location: query, message: Failed to parse input string "1991-11-08 91:1."; reason: invalidQuery, location: query, message: Failed to parse input string "1989-03-14 "')
[0m17:31:18.211334 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:55ba0656-23ca-404a-a182-7e841b61a636&page=queryresults
[0m17:31:18.892135 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:55ba0656-23ca-404a-a182-7e841b61a636&page=queryresults
[0m17:31:18.895481 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 17:31:16.214984 => 17:31:18.894477
[0m17:31:18.909038 [debug] [Thread-1 (]: Database Error in model core_flights (models/core/core_flights.sql)
  Failed to parse input string "1992-01-13 "
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m17:31:18.912738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b436b87b-889b-4961-8521-62d0a76f924f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dc35d29f0>]}
[0m17:31:18.914869 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model db_project_dataset.core_flights .......... [[31mERROR[0m in 2.72s]
[0m17:31:18.917240 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m17:31:18.924255 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:18.926305 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m17:31:18.927637 [info ] [MainThread]: 
[0m17:31:18.929103 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.57 seconds (3.57s).
[0m17:31:18.931507 [debug] [MainThread]: Command end result
[0m17:31:18.965685 [info ] [MainThread]: 
[0m17:31:18.967501 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:31:18.969720 [info ] [MainThread]: 
[0m17:31:18.973091 [error] [MainThread]:   Database Error in model core_flights (models/core/core_flights.sql)
  Failed to parse input string "1992-01-13 "
  compiled Code at target/run/flights_project/models/core/core_flights.sql
[0m17:31:18.976188 [info ] [MainThread]: 
[0m17:31:18.978354 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:31:18.980657 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.31511, "process_user_time": 5.552238, "process_kernel_time": 0.672694, "process_mem_max_rss": "257356", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:31:18.983033 [debug] [MainThread]: Command `dbt run` failed at 17:31:18.982569 after 6.32 seconds
[0m17:31:18.984794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0de6de7b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0de7450c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dc35d29f0>]}
[0m17:31:18.986556 [debug] [MainThread]: Flushing usage events
[0m17:40:21.935381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b48f8f560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b4a030fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b49282f00>]}


============================== 17:40:21.945782 | 6737720d-e239-4e45-b7f7-571e4ea8dfad ==============================
[0m17:40:21.945782 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:40:21.947150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:40:22.152469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6737720d-e239-4e45-b7f7-571e4ea8dfad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b48e425d0>]}
[0m17:40:22.628261 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wiz8p863'
[0m17:40:22.629373 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:40:25.859352 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:40:25.861717 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:40:25.963519 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:40:25.974179 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:40:30.621442 [info ] [MainThread]: Installed from version 1.3.0
[0m17:40:30.622689 [info ] [MainThread]: Up to date!
[0m17:40:30.624208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6737720d-e239-4e45-b7f7-571e4ea8dfad', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b48e6fcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b48e8bbc0>]}
[0m17:40:30.626909 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 8.809817, "process_user_time": 5.257687, "process_kernel_time": 0.411383, "process_mem_max_rss": "111664", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m17:40:30.628492 [debug] [MainThread]: Command `dbt deps` succeeded at 17:40:30.628059 after 8.81 seconds
[0m17:40:30.629943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b49282f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b48f90b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b48e6fcb0>]}
[0m17:40:30.631332 [debug] [MainThread]: Flushing usage events
[0m17:40:35.960440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4504bb21e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45030b8260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4502fc0680>]}


============================== 17:40:35.969450 | 52eb16ef-dc16-4ece-ba8e-0dc9521069cc ==============================
[0m17:40:35.969450 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:40:35.970691 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models stg_flights', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:40:37.393592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52eb16ef-dc16-4ece-ba8e-0dc9521069cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e6a36930>]}
[0m17:40:37.621702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52eb16ef-dc16-4ece-ba8e-0dc9521069cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4502f7b2c0>]}
[0m17:40:37.623173 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:40:37.666371 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:40:38.723079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:40:38.724158 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/stg_flights.sql
[0m17:40:38.725065 [debug] [MainThread]: Partial parsing: updated file: flights_project://models/marts/fact_departures_by_airport_year.sql
[0m17:40:39.245103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52eb16ef-dc16-4ece-ba8e-0dc9521069cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44df684cb0>]}
[0m17:40:39.290284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52eb16ef-dc16-4ece-ba8e-0dc9521069cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44df99c7d0>]}
[0m17:40:39.292203 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:40:39.293972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52eb16ef-dc16-4ece-ba8e-0dc9521069cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44df5d3b60>]}
[0m17:40:39.299493 [info ] [MainThread]: 
[0m17:40:39.303112 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:40:39.306122 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:40:39.307275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:39.756433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:40:39.757610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:40.165486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52eb16ef-dc16-4ece-ba8e-0dc9521069cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44df99ea50>]}
[0m17:40:40.168071 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:40:40.169739 [info ] [MainThread]: 
[0m17:40:40.188018 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m17:40:40.189993 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m17:40:40.192545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.stg_flights)
[0m17:40:40.193790 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m17:40:40.217635 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m17:40:40.230691 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (compile): 17:40:40.194545 => 17:40:40.229938
[0m17:40:40.232602 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m17:40:40.311746 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m17:40:40.321140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:40.366095 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    CONCAT(CAST(FlightDate AS STRING), ' ', DepTimeFormatted) AS dep_time,
    CONCAT(CAST(FlightDate AS STRING), ' ', ArrTimeFormatted) AS arr_time,
    FlightNum as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m17:40:41.095797 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:4faf251c-de12-4d87-aa4b-9dd1a104d14a&page=queryresults
[0m17:40:41.843731 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (execute): 17:40:40.234048 => 17:40:41.843197
[0m17:40:41.845482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52eb16ef-dc16-4ece-ba8e-0dc9521069cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44df99e8d0>]}
[0m17:40:41.846798 [info ] [Thread-1 (]: 1 of 1 OK created sql view model db_project_dataset.stg_flights ................ [[32mCREATE VIEW (0 processed)[0m in 1.65s]
[0m17:40:41.848418 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m17:40:41.851593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:41.852463 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m17:40:41.853245 [info ] [MainThread]: 
[0m17:40:41.854084 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.55 seconds (2.55s).
[0m17:40:41.855394 [debug] [MainThread]: Command end result
[0m17:40:41.880713 [info ] [MainThread]: 
[0m17:40:41.882217 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:40:41.883352 [info ] [MainThread]: 
[0m17:40:41.884596 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:40:41.886936 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0290728, "process_user_time": 7.489914, "process_kernel_time": 0.595788, "process_mem_max_rss": "258492", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:40:41.888749 [debug] [MainThread]: Command `dbt run` succeeded at 17:40:41.888314 after 6.03 seconds
[0m17:40:41.890205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4503de4e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4503979640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44df71e660>]}
[0m17:40:41.891232 [debug] [MainThread]: Flushing usage events
[0m17:40:50.148824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f181d1b7fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f181f8d5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f181d1b5160>]}


============================== 17:40:50.163672 | 45bb5d1a-983d-42a9-9bbb-c06c0cf7e6cd ==============================
[0m17:40:50.163672 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:40:50.171386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:40:52.771636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45bb5d1a-983d-42a9-9bbb-c06c0cf7e6cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f9d33740>]}
[0m17:40:53.072889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45bb5d1a-983d-42a9-9bbb-c06c0cf7e6cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f9cfb2f0>]}
[0m17:40:53.074727 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:40:53.131235 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:40:54.504642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:40:54.505725 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:40:54.520697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45bb5d1a-983d-42a9-9bbb-c06c0cf7e6cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f9cbcd40>]}
[0m17:40:54.558870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45bb5d1a-983d-42a9-9bbb-c06c0cf7e6cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f9b946b0>]}
[0m17:40:54.560522 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:40:54.562983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45bb5d1a-983d-42a9-9bbb-c06c0cf7e6cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17fa526fc0>]}
[0m17:40:54.568204 [info ] [MainThread]: 
[0m17:40:54.570972 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:40:54.574298 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:40:54.575814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:55.451136 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:40:55.453407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:55.886883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45bb5d1a-983d-42a9-9bbb-c06c0cf7e6cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17fa53f3e0>]}
[0m17:40:55.889477 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:40:55.890813 [info ] [MainThread]: 
[0m17:40:55.903847 [debug] [Thread-1 (]: Began running node seed.flights_project.airports
[0m17:40:55.905108 [info ] [Thread-1 (]: 1 of 1 START seed file db_project_dataset.airports ............................. [RUN]
[0m17:40:55.907451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now seed.flights_project.airports)
[0m17:40:55.908894 [debug] [Thread-1 (]: Began compiling node seed.flights_project.airports
[0m17:40:55.910348 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (compile): 17:40:55.909838 => 17:40:55.909847
[0m17:40:55.912158 [debug] [Thread-1 (]: Began executing node seed.flights_project.airports
[0m17:40:56.092302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:59.619294 [debug] [Thread-1 (]: On seed.flights_project.airports: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.flights_project.airports"} */

    alter table `db-project-456518`.`db_project_dataset`.`airports` set OPTIONS()
  
[0m17:40:59.800653 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:44300b44-854e-4da6-944e-8c4595ec2b01&page=queryresults
[0m17:41:00.029209 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.flights_project.airports"
[0m17:41:00.069278 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (execute): 17:40:55.913389 => 17:41:00.068858
[0m17:41:00.070938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45bb5d1a-983d-42a9-9bbb-c06c0cf7e6cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f99e9400>]}
[0m17:41:00.072298 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file db_project_dataset.airports ......................... [[32mINSERT 3376[0m in 4.16s]
[0m17:41:00.074849 [debug] [Thread-1 (]: Finished running node seed.flights_project.airports
[0m17:41:00.078743 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:00.079852 [debug] [MainThread]: Connection 'seed.flights_project.airports' was properly closed.
[0m17:41:00.080843 [info ] [MainThread]: 
[0m17:41:00.081823 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.51 seconds (5.51s).
[0m17:41:00.083288 [debug] [MainThread]: Command end result
[0m17:41:00.112966 [info ] [MainThread]: 
[0m17:41:00.114709 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:41:00.116232 [info ] [MainThread]: 
[0m17:41:00.118210 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:41:00.120577 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 10.119638, "process_user_time": 8.719998, "process_kernel_time": 0.864341, "process_mem_max_rss": "264152", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:41:00.122064 [debug] [MainThread]: Command `dbt seed` succeeded at 17:41:00.121690 after 10.12 seconds
[0m17:41:00.123243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182177f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f181d219ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f9ae7350>]}
[0m17:41:00.124560 [debug] [MainThread]: Flushing usage events
[0m17:41:06.717465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c77486120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c777acd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c77484fe0>]}


============================== 17:41:06.730113 | e16a50c6-feaa-4ffa-a61f-3d85f8bac5ff ==============================
[0m17:41:06.730113 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:41:06.731772 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models core_flights', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:41:08.541902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e16a50c6-feaa-4ffa-a61f-3d85f8bac5ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c53f41160>]}
[0m17:41:08.755776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e16a50c6-feaa-4ffa-a61f-3d85f8bac5ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c58819d30>]}
[0m17:41:08.757355 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:41:08.795923 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:41:09.867303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:41:09.868310 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:41:09.880244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e16a50c6-feaa-4ffa-a61f-3d85f8bac5ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c53d5ab10>]}
[0m17:41:09.924729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e16a50c6-feaa-4ffa-a61f-3d85f8bac5ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c53de07d0>]}
[0m17:41:09.927207 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:41:09.929151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e16a50c6-feaa-4ffa-a61f-3d85f8bac5ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c774437a0>]}
[0m17:41:09.933199 [info ] [MainThread]: 
[0m17:41:09.935965 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:41:09.939285 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:41:09.940667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:10.381904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:41:10.383627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:41:10.783167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e16a50c6-feaa-4ffa-a61f-3d85f8bac5ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c53c5be30>]}
[0m17:41:10.785032 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:41:10.786325 [info ] [MainThread]: 
[0m17:41:10.799537 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m17:41:10.800821 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m17:41:10.802545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m17:41:10.803539 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m17:41:10.817562 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m17:41:10.831949 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 17:41:10.804399 => 17:41:10.831424
[0m17:41:10.833081 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m17:41:10.862852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:41:11.295155 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m17:41:11.306432 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m17:41:11.699041 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:38ff6ba8-7dbe-4178-8e20-d30cd3f2db6b&page=queryresults
[0m17:41:15.057179 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 17:41:10.834161 => 17:41:15.056382
[0m17:41:15.058712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e16a50c6-feaa-4ffa-a61f-3d85f8bac5ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c53c31550>]}
[0m17:41:15.059919 [info ] [Thread-1 (]: 1 of 1 OK created sql table model db_project_dataset.core_flights .............. [[32mCREATE TABLE (27.0m rows, 2.6 GiB processed)[0m in 4.26s]
[0m17:41:15.061456 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m17:41:15.064681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:15.065689 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m17:41:15.066609 [info ] [MainThread]: 
[0m17:41:15.067749 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.13 seconds (5.13s).
[0m17:41:15.069378 [debug] [MainThread]: Command end result
[0m17:41:15.095351 [info ] [MainThread]: 
[0m17:41:15.096746 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:41:15.097833 [info ] [MainThread]: 
[0m17:41:15.099004 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:41:15.101196 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.501723, "process_user_time": 7.183541, "process_kernel_time": 0.758824, "process_mem_max_rss": "253644", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:41:15.102901 [debug] [MainThread]: Command `dbt run` succeeded at 17:41:15.102572 after 8.50 seconds
[0m17:41:15.104025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c777644d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c77580080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c58288ad0>]}
[0m17:41:15.105058 [debug] [MainThread]: Flushing usage events
[0m17:42:21.172294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6bca73860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6bf1d5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6bd13d8e0>]}


============================== 17:42:21.182594 | b9b4b246-1b26-4b85-8286-c77bccb40578 ==============================
[0m17:42:21.182594 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:42:21.184416 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models fact_departures_by_airport_year', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:42:23.077976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9b4b246-1b26-4b85-8286-c77bccb40578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6a055cc80>]}
[0m17:42:23.408951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9b4b246-1b26-4b85-8286-c77bccb40578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6a0533cb0>]}
[0m17:42:23.410952 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:42:23.466366 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:42:24.614018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:42:24.615208 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:42:24.626580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9b4b246-1b26-4b85-8286-c77bccb40578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6993dbce0>]}
[0m17:42:24.671910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9b4b246-1b26-4b85-8286-c77bccb40578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6994904d0>]}
[0m17:42:24.673566 [info ] [MainThread]: Found 1 seed, 3 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:42:24.675573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9b4b246-1b26-4b85-8286-c77bccb40578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd699803620>]}
[0m17:42:24.679547 [info ] [MainThread]: 
[0m17:42:24.683968 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:42:24.688115 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:42:24.689780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:25.265728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:42:25.267583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:42:25.589525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9b4b246-1b26-4b85-8286-c77bccb40578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd69965e7b0>]}
[0m17:42:25.592149 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:42:25.593647 [info ] [MainThread]: 
[0m17:42:25.609958 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m17:42:25.611555 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m17:42:25.613640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.fact_departures_by_airport_year)
[0m17:42:25.615050 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m17:42:25.628594 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m17:42:25.641655 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (compile): 17:42:25.615918 => 17:42:25.640932
[0m17:42:25.642929 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m17:42:25.741243 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m17:42:25.753181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:25.799040 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    count(*) as num_departures
from flights_data
group by origin
    );
  
[0m17:42:26.185571 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:0708acbe-7905-4c2e-969b-8e5d53391435&page=queryresults
[0m17:42:27.770479 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (execute): 17:42:25.643965 => 17:42:27.769917
[0m17:42:27.772402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9b4b246-1b26-4b85-8286-c77bccb40578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6992e4620>]}
[0m17:42:27.773724 [info ] [Thread-1 (]: 1 of 1 OK created sql table model db_project_dataset.fact_departures_by_airport_year  [[32mCREATE TABLE (262.0 rows, 128.7 MiB processed)[0m in 2.16s]
[0m17:42:27.775326 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m17:42:27.779182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:42:27.780314 [debug] [MainThread]: Connection 'model.flights_project.fact_departures_by_airport_year' was properly closed.
[0m17:42:27.781328 [info ] [MainThread]: 
[0m17:42:27.782561 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.10 seconds (3.10s).
[0m17:42:27.784263 [debug] [MainThread]: Command end result
[0m17:42:27.818275 [info ] [MainThread]: 
[0m17:42:27.819476 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:42:27.820725 [info ] [MainThread]: 
[0m17:42:27.822742 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:42:27.826020 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.770243, "process_user_time": 8.250456, "process_kernel_time": 0.802964, "process_mem_max_rss": "256564", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:42:27.828147 [debug] [MainThread]: Command `dbt run` succeeded at 17:42:27.827709 after 6.77 seconds
[0m17:42:27.829922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6bcbbf8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd699408080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6c0504fe0>]}
[0m17:42:27.831736 [debug] [MainThread]: Flushing usage events
[0m17:44:27.081656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc98f26c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc9b13140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc98f2480>]}


============================== 17:44:27.099560 | f203269f-f3a5-43cc-b8b1-532796a4ffb6 ==============================
[0m17:44:27.099560 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:44:27.101251 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:44:27.775729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f203269f-f3a5-43cc-b8b1-532796a4ffb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc97a64b0>]}
[0m17:44:28.209792 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ahfm09lz'
[0m17:44:28.210909 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:44:28.501701 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:44:28.503825 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:44:28.594412 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:44:28.602764 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:44:33.354515 [info ] [MainThread]: Installed from version 1.3.0
[0m17:44:33.356569 [info ] [MainThread]: Up to date!
[0m17:44:33.358388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f203269f-f3a5-43cc-b8b1-532796a4ffb6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc9f75ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cca6cdd00>]}
[0m17:44:33.361701 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 6.4655547, "process_user_time": 6.443722, "process_kernel_time": 0.46412, "process_mem_max_rss": "111696", "process_in_blocks": "152", "process_out_blocks": "176"}
[0m17:44:33.363887 [debug] [MainThread]: Command `dbt deps` succeeded at 17:44:33.363364 after 6.47 seconds
[0m17:44:33.365665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc9b74ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc97fb050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ccabafaa0>]}
[0m17:44:33.367460 [debug] [MainThread]: Flushing usage events
[0m17:44:39.990932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d8e6c4f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d8edf9d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d904807a0>]}


============================== 17:44:40.000375 | 14241f9d-8f44-425d-84f5-22880072ac74 ==============================
[0m17:44:40.000375 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:44:40.002031 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models stg_flights', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:44:41.431853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14241f9d-8f44-425d-84f5-22880072ac74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d8fbe0b90>]}
[0m17:44:41.639106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14241f9d-8f44-425d-84f5-22880072ac74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d7354faa0>]}
[0m17:44:41.641693 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:44:41.686330 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:44:42.629561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:44:42.630553 [debug] [MainThread]: Partial parsing: added file: flights_project://models/marts/fact_delays_by_flight_num.sql
[0m17:44:43.021102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14241f9d-8f44-425d-84f5-22880072ac74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d6b1f6e40>]}
[0m17:44:43.063848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14241f9d-8f44-425d-84f5-22880072ac74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d6b0a4590>]}
[0m17:44:43.065582 [info ] [MainThread]: Found 1 seed, 4 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:44:43.067001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14241f9d-8f44-425d-84f5-22880072ac74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d6aef4d70>]}
[0m17:44:43.070426 [info ] [MainThread]: 
[0m17:44:43.073005 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:44:43.076416 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:44:43.078078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:43.473868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:44:43.475453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:44:43.762155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14241f9d-8f44-425d-84f5-22880072ac74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d6ae8e240>]}
[0m17:44:43.764544 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:44:43.765982 [info ] [MainThread]: 
[0m17:44:43.777860 [debug] [Thread-1 (]: Began running node model.flights_project.stg_flights
[0m17:44:43.779119 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.stg_flights ..................... [RUN]
[0m17:44:43.780639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.stg_flights)
[0m17:44:43.781744 [debug] [Thread-1 (]: Began compiling node model.flights_project.stg_flights
[0m17:44:43.824498 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.stg_flights"
[0m17:44:43.834757 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (compile): 17:44:43.782555 => 17:44:43.834242
[0m17:44:43.835822 [debug] [Thread-1 (]: Began executing node model.flights_project.stg_flights
[0m17:44:43.884864 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.stg_flights"
[0m17:44:43.897084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:43.938059 [debug] [Thread-1 (]: On model.flights_project.stg_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.stg_flights"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`stg_flights`
  OPTIONS()
  as 

with raw_data as (
    select * from `db-project-456518`.`db_project_dataset`.`flights_data`
)
select
    to_hex(md5(cast(coalesce(cast(FlightDate as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(FlightNum as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Origin as string), '_dbt_utils_surrogate_key_null_') as string))) AS id,
    cast(FlightDate as date) as flight_date,
    CONCAT(CAST(FlightDate AS STRING), ' ', DepTimeFormatted) AS dep_time,
    CONCAT(CAST(FlightDate AS STRING), ' ', ArrTimeFormatted) AS arr_time,
    FlightNum as flight_num,
    cast(ActualElapsedTime as integer) as actual_elapsed_time,
    cast(DepDelay as integer) as dep_delay,
    cast(ArrDelay as integer) as arr_delay,
    Origin as origin,
    Dest as destination,
    CarrierCode as carrier_code,
    CarrierDescription as carrier_desc,
    
    case
        when DepDelay > 0 and ArrDelay > 0 then 'ddad'
        when DepDelay > 0 then 'dd'
        when ArrDelay > 0 then 'ad'
        else 'nd'
    end
 as delay_status
from raw_data
where DepTimeFormatted is not null
    and ArrTimeFormatted is not null;


[0m17:44:44.322804 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:c78686e7-127f-49b3-8c6c-d94fde43c78b&page=queryresults
[0m17:44:44.505350 [debug] [Thread-1 (]: Timing info for model.flights_project.stg_flights (execute): 17:44:43.836518 => 17:44:44.505013
[0m17:44:44.506897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14241f9d-8f44-425d-84f5-22880072ac74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d8f338bc0>]}
[0m17:44:44.508166 [info ] [Thread-1 (]: 1 of 1 OK created sql view model db_project_dataset.stg_flights ................ [[32mCREATE VIEW (0 processed)[0m in 0.73s]
[0m17:44:44.509744 [debug] [Thread-1 (]: Finished running node model.flights_project.stg_flights
[0m17:44:44.513820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:44.514870 [debug] [MainThread]: Connection 'model.flights_project.stg_flights' was properly closed.
[0m17:44:44.515950 [info ] [MainThread]: 
[0m17:44:44.517240 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.44 seconds (1.44s).
[0m17:44:44.519137 [debug] [MainThread]: Command end result
[0m17:44:44.548636 [info ] [MainThread]: 
[0m17:44:44.550108 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:44:44.551665 [info ] [MainThread]: 
[0m17:44:44.553050 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:44:44.555021 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.66146, "process_user_time": 7.899664, "process_kernel_time": 0.711771, "process_mem_max_rss": "259592", "process_in_blocks": "2952", "process_out_blocks": "0"}
[0m17:44:44.556472 [debug] [MainThread]: Command `dbt run` succeeded at 17:44:44.556060 after 4.66 seconds
[0m17:44:44.557910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d8e9120c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d6b51dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d92d03200>]}
[0m17:44:44.559190 [debug] [MainThread]: Flushing usage events
[0m17:44:50.019379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d47ef9d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d480032c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d48b74c20>]}


============================== 17:44:50.028719 | 01ed9148-45ad-457f-9372-7176bf8874bd ==============================
[0m17:44:50.028719 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:44:50.029979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m17:45:00.932502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01ed9148-45ad-457f-9372-7176bf8874bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d47ef82c0>]}
[0m17:45:01.153336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01ed9148-45ad-457f-9372-7176bf8874bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d290f3530>]}
[0m17:45:01.154807 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:45:01.197568 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:45:02.448414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:02.449224 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:02.458882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01ed9148-45ad-457f-9372-7176bf8874bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d286fffb0>]}
[0m17:45:02.502611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01ed9148-45ad-457f-9372-7176bf8874bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d288d4680>]}
[0m17:45:02.504618 [info ] [MainThread]: Found 1 seed, 4 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:45:02.506606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01ed9148-45ad-457f-9372-7176bf8874bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2935aea0>]}
[0m17:45:02.512017 [info ] [MainThread]: 
[0m17:45:02.514612 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:45:02.517601 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:45:02.518904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:02.998838 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:45:03.000323 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:03.348162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01ed9148-45ad-457f-9372-7176bf8874bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d28d2af90>]}
[0m17:45:03.350560 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:03.353543 [info ] [MainThread]: 
[0m17:45:03.366679 [debug] [Thread-1 (]: Began running node seed.flights_project.airports
[0m17:45:03.368079 [info ] [Thread-1 (]: 1 of 1 START seed file db_project_dataset.airports ............................. [RUN]
[0m17:45:03.369751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now seed.flights_project.airports)
[0m17:45:03.370930 [debug] [Thread-1 (]: Began compiling node seed.flights_project.airports
[0m17:45:03.372241 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (compile): 17:45:03.371777 => 17:45:03.371785
[0m17:45:03.373301 [debug] [Thread-1 (]: Began executing node seed.flights_project.airports
[0m17:45:03.545120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:06.975580 [debug] [Thread-1 (]: On seed.flights_project.airports: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "seed.flights_project.airports"} */

    alter table `db-project-456518`.`db_project_dataset`.`airports` set OPTIONS()
  
[0m17:45:07.123695 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:ea106354-46d3-4032-bfdc-2eeea948f237&page=queryresults
[0m17:45:07.579474 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.flights_project.airports"
[0m17:45:07.609282 [debug] [Thread-1 (]: Timing info for seed.flights_project.airports (execute): 17:45:03.374075 => 17:45:07.608919
[0m17:45:07.610942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01ed9148-45ad-457f-9372-7176bf8874bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d28a38950>]}
[0m17:45:07.612166 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file db_project_dataset.airports ......................... [[32mINSERT 3376[0m in 4.24s]
[0m17:45:07.614641 [debug] [Thread-1 (]: Finished running node seed.flights_project.airports
[0m17:45:07.618515 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:07.619426 [debug] [MainThread]: Connection 'seed.flights_project.airports' was properly closed.
[0m17:45:07.620312 [info ] [MainThread]: 
[0m17:45:07.621532 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.11 seconds (5.11s).
[0m17:45:07.623015 [debug] [MainThread]: Command end result
[0m17:45:07.654400 [info ] [MainThread]: 
[0m17:45:07.655920 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:45:07.657131 [info ] [MainThread]: 
[0m17:45:07.659110 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:45:07.666249 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 17.759521, "process_user_time": 14.434587, "process_kernel_time": 1.874042, "process_mem_max_rss": "258208", "process_in_blocks": "736", "process_out_blocks": "0"}
[0m17:45:07.667812 [debug] [MainThread]: Command `dbt seed` succeeded at 17:45:07.667333 after 17.76 seconds
[0m17:45:07.669153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d47ef9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4806d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2a31db80>]}
[0m17:45:07.670326 [debug] [MainThread]: Flushing usage events
[0m17:45:13.618281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea258b24e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea25f17830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea269c5a00>]}


============================== 17:45:13.627730 | d09fda38-10e8-4c08-b7a6-3cc17f1d9e12 ==============================
[0m17:45:13.627730 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:45:13.629211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models core_flights', 'send_anonymous_usage_stats': 'True'}
[0m17:45:15.244236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd09fda38-10e8-4c08-b7a6-3cc17f1d9e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea027bd220>]}
[0m17:45:15.459232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd09fda38-10e8-4c08-b7a6-3cc17f1d9e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea26dc83e0>]}
[0m17:45:15.460880 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:45:15.498367 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:45:16.356531 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:16.357344 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:16.366183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd09fda38-10e8-4c08-b7a6-3cc17f1d9e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea0213ffb0>]}
[0m17:45:16.398671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd09fda38-10e8-4c08-b7a6-3cc17f1d9e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea02304830>]}
[0m17:45:16.400271 [info ] [MainThread]: Found 1 seed, 4 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:45:16.401902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd09fda38-10e8-4c08-b7a6-3cc17f1d9e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea02086b40>]}
[0m17:45:16.404686 [info ] [MainThread]: 
[0m17:45:16.407144 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:45:16.409826 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:45:16.411095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:16.871695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:45:16.873710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:17.163812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd09fda38-10e8-4c08-b7a6-3cc17f1d9e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea024a3170>]}
[0m17:45:17.165673 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:17.166817 [info ] [MainThread]: 
[0m17:45:17.178336 [debug] [Thread-1 (]: Began running node model.flights_project.core_flights
[0m17:45:17.179613 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.core_flights ................... [RUN]
[0m17:45:17.181435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.core_flights)
[0m17:45:17.182588 [debug] [Thread-1 (]: Began compiling node model.flights_project.core_flights
[0m17:45:17.195712 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.core_flights"
[0m17:45:17.209591 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (compile): 17:45:17.183410 => 17:45:17.209016
[0m17:45:17.210788 [debug] [Thread-1 (]: Began executing node model.flights_project.core_flights
[0m17:45:17.235212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:17.580548 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.core_flights"
[0m17:45:17.595712 [debug] [Thread-1 (]: On model.flights_project.core_flights: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.core_flights"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`core_flights`
      
    
    

    OPTIONS()
    as (
      

with flight_data as (
    select * from `db-project-456518`.`db_project_dataset`.`stg_flights`
),
airports_data as (
    select * from `db-project-456518`.`db_project_dataset`.`airports`
)

select 
    flight_data.id,
    flight_data.flight_date,
    flight_data.dep_time,
    flight_data.arr_time,
    flight_data.flight_num,
    flight_data.actual_elapsed_time,
    flight_data.dep_delay,
    flight_data.arr_delay,
    flight_data.origin,
    departure_airport.airport as dep_airport,
    departure_airport.city as dep_city,
    departure_airport.state as dep_state,
    departure_airport.country as dep_country,
    flight_data.destination,
    arrival_airport.airport as arr_airport,
    arrival_airport.city as arr_city,
    arrival_airport.state as arr_state,
    arrival_airport.country as arr_country,
    flight_data.carrier_code,
    flight_data.carrier_desc,
    flight_data.delay_status
from flight_data
inner join airports_data as departure_airport
on flight_data.origin = departure_airport.iata
inner join airports_data as arrival_airport
on flight_data.destination = arrival_airport.iata
    );
  
[0m17:45:18.034939 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:ab83ab39-f4c8-44d6-8193-58fc8a017fbe&page=queryresults
[0m17:45:21.139438 [debug] [Thread-1 (]: Timing info for model.flights_project.core_flights (execute): 17:45:17.211514 => 17:45:21.139092
[0m17:45:21.141108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd09fda38-10e8-4c08-b7a6-3cc17f1d9e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea021590a0>]}
[0m17:45:21.142411 [info ] [Thread-1 (]: 1 of 1 OK created sql table model db_project_dataset.core_flights .............. [[32mCREATE TABLE (27.0m rows, 2.6 GiB processed)[0m in 3.96s]
[0m17:45:21.143982 [debug] [Thread-1 (]: Finished running node model.flights_project.core_flights
[0m17:45:21.147520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:21.148536 [debug] [MainThread]: Connection 'model.flights_project.core_flights' was properly closed.
[0m17:45:21.149569 [info ] [MainThread]: 
[0m17:45:21.150771 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.74 seconds (4.74s).
[0m17:45:21.152372 [debug] [MainThread]: Command end result
[0m17:45:21.178186 [info ] [MainThread]: 
[0m17:45:21.179334 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:45:21.180491 [info ] [MainThread]: 
[0m17:45:21.181982 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:45:21.184111 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.6744328, "process_user_time": 6.045754, "process_kernel_time": 0.56427, "process_mem_max_rss": "253676", "process_in_blocks": "7744", "process_out_blocks": "0"}
[0m17:45:21.185629 [debug] [MainThread]: Command `dbt run` succeeded at 17:45:21.185333 after 7.68 seconds
[0m17:45:21.186923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea258f6360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea024cade0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea293d9760>]}
[0m17:45:21.188400 [debug] [MainThread]: Flushing usage events
[0m17:45:26.888275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96256f5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96256f4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96256f4ad0>]}


============================== 17:45:26.897638 | c081c390-a2fb-4fb3-a718-594c7d8426f8 ==============================
[0m17:45:26.897638 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:45:26.899263 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --models fact_departures_by_airport_year', 'send_anonymous_usage_stats': 'True'}
[0m17:45:31.548540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c081c390-a2fb-4fb3-a718-594c7d8426f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9602276d80>]}
[0m17:45:31.781207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c081c390-a2fb-4fb3-a718-594c7d8426f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9602a829c0>]}
[0m17:45:31.784091 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:45:31.842485 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:45:33.421031 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:33.422875 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:33.460953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c081c390-a2fb-4fb3-a718-594c7d8426f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960204f440>]}
[0m17:45:33.529733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c081c390-a2fb-4fb3-a718-594c7d8426f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96020d4c20>]}
[0m17:45:33.531756 [info ] [MainThread]: Found 1 seed, 4 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:45:33.534790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c081c390-a2fb-4fb3-a718-594c7d8426f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9601e5eb70>]}
[0m17:45:33.539959 [info ] [MainThread]: 
[0m17:45:33.543668 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:45:33.547874 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:45:33.550154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:34.327504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:45:34.329004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:34.651947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c081c390-a2fb-4fb3-a718-594c7d8426f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9601e5eb10>]}
[0m17:45:34.653764 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:34.654908 [info ] [MainThread]: 
[0m17:45:34.669044 [debug] [Thread-1 (]: Began running node model.flights_project.fact_departures_by_airport_year
[0m17:45:34.670587 [info ] [Thread-1 (]: 1 of 1 START sql table model db_project_dataset.fact_departures_by_airport_year  [RUN]
[0m17:45:34.673069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.fact_departures_by_airport_year)
[0m17:45:34.675385 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_departures_by_airport_year
[0m17:45:34.695154 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_departures_by_airport_year"
[0m17:45:34.707754 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (compile): 17:45:34.676339 => 17:45:34.706772
[0m17:45:34.709187 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_departures_by_airport_year
[0m17:45:34.755899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:35.224793 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_departures_by_airport_year"
[0m17:45:35.241733 [debug] [Thread-1 (]: On model.flights_project.fact_departures_by_airport_year: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_departures_by_airport_year"} */

  
    

    create or replace table `db-project-456518`.`db_project_dataset`.`fact_departures_by_airport_year`
      
    
    

    OPTIONS()
    as (
      

with flights_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
)  

select 
    origin as airport_code,
    count(*) as num_departures
from flights_data
group by origin
    );
  
[0m17:45:35.439274 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:a948f1bb-c1bd-46ec-9557-7f0d0557bbb5&page=queryresults
[0m17:45:37.093221 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_departures_by_airport_year (execute): 17:45:34.710075 => 17:45:37.092417
[0m17:45:37.103800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c081c390-a2fb-4fb3-a718-594c7d8426f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9601f2d610>]}
[0m17:45:37.112399 [info ] [Thread-1 (]: 1 of 1 OK created sql table model db_project_dataset.fact_departures_by_airport_year  [[32mCREATE TABLE (262.0 rows, 128.7 MiB processed)[0m in 2.43s]
[0m17:45:37.114560 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_departures_by_airport_year
[0m17:45:37.120509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:37.130278 [debug] [MainThread]: Connection 'model.flights_project.fact_departures_by_airport_year' was properly closed.
[0m17:45:37.136277 [info ] [MainThread]: 
[0m17:45:37.142616 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.59 seconds (3.59s).
[0m17:45:37.149600 [debug] [MainThread]: Command end result
[0m17:45:37.213061 [info ] [MainThread]: 
[0m17:45:37.214960 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:45:37.217289 [info ] [MainThread]: 
[0m17:45:37.218512 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:45:37.220588 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.441768, "process_user_time": 9.63899, "process_kernel_time": 1.119038, "process_mem_max_rss": "256880", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:45:37.222238 [debug] [MainThread]: Command `dbt run` succeeded at 17:45:37.221783 after 10.44 seconds
[0m17:45:37.223797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9625d766c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96257fcb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96021819d0>]}
[0m17:45:37.225555 [debug] [MainThread]: Flushing usage events
[0m17:45:46.244670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed09fe1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed09fe0080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed09fe1760>]}


============================== 17:45:46.253939 | 6dd87cd5-a04b-4af0-8d3f-61950c628c6a ==============================
[0m17:45:46.253939 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:45:46.255402 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models fact_delays_by_flight_num', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:45:48.814321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dd87cd5-a04b-4af0-8d3f-61950c628c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece70abb90>]}
[0m17:45:49.145504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dd87cd5-a04b-4af0-8d3f-61950c628c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed0b4fc9b0>]}
[0m17:45:49.147951 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:45:49.191727 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:45:50.325224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:50.326087 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:50.336204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dd87cd5-a04b-4af0-8d3f-61950c628c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece69fa780>]}
[0m17:45:50.374176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dd87cd5-a04b-4af0-8d3f-61950c628c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece68e47d0>]}
[0m17:45:50.375280 [info ] [MainThread]: Found 1 seed, 4 models, 1 source, 0 exposures, 0 metrics, 571 macros, 0 groups, 0 semantic models
[0m17:45:50.376220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dd87cd5-a04b-4af0-8d3f-61950c628c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece67d2c30>]}
[0m17:45:50.378728 [info ] [MainThread]: 
[0m17:45:50.380551 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:45:50.382736 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_db-project-456518'
[0m17:45:50.383681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:50.862876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db-project-456518, now list_db-project-456518_db_project_dataset)
[0m17:45:50.865059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:51.175414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dd87cd5-a04b-4af0-8d3f-61950c628c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece7d12060>]}
[0m17:45:51.178518 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:51.181008 [info ] [MainThread]: 
[0m17:45:51.198673 [debug] [Thread-1 (]: Began running node model.flights_project.fact_delays_by_flight_num
[0m17:45:51.200348 [info ] [Thread-1 (]: 1 of 1 START sql view model db_project_dataset.fact_delays_by_flight_num ....... [RUN]
[0m17:45:51.214572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db-project-456518_db_project_dataset, now model.flights_project.fact_delays_by_flight_num)
[0m17:45:51.216042 [debug] [Thread-1 (]: Began compiling node model.flights_project.fact_delays_by_flight_num
[0m17:45:51.230536 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_project.fact_delays_by_flight_num"
[0m17:45:51.246792 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_delays_by_flight_num (compile): 17:45:51.217219 => 17:45:51.245771
[0m17:45:51.248078 [debug] [Thread-1 (]: Began executing node model.flights_project.fact_delays_by_flight_num
[0m17:45:51.306876 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_project.fact_delays_by_flight_num"
[0m17:45:51.317848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:51.373787 [debug] [Thread-1 (]: On model.flights_project.fact_delays_by_flight_num: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "my_profile", "target_name": "dev", "node_id": "model.flights_project.fact_delays_by_flight_num"} */


  create or replace view `db-project-456518`.`db_project_dataset`.`fact_delays_by_flight_num`
  OPTIONS()
  as with flight_data as (
    select *
    from `db-project-456518`.`db_project_dataset`.`core_flights`
    where arr_delay > 0 or dep_delay > 0
)

select 
    flight_num,
    count(*) as total_flights_with_delays,
    sum(dep_delay) as total_dep_delay,
    sum(arr_delay) as total_arr_delay,
    avg(dep_delay) as avg_dep_delay,
    avg(arr_delay) as avg_arr_delay,
    min(dep_delay) as min_dep_delay,
    min(arr_delay) as min_arr_delay,
    max(dep_delay) as max_dep_delay,
    max(arr_delay) as max_arr_delay
from flight_data
group by flight_num;


[0m17:45:51.775206 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=db-project-456518&j=bq:europe-central2:54058722-c0d8-43ed-8908-82c6acc27840&page=queryresults
[0m17:45:51.940837 [debug] [Thread-1 (]: Timing info for model.flights_project.fact_delays_by_flight_num (execute): 17:45:51.248917 => 17:45:51.940343
[0m17:45:51.943215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dd87cd5-a04b-4af0-8d3f-61950c628c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece6935100>]}
[0m17:45:51.945112 [info ] [Thread-1 (]: 1 of 1 OK created sql view model db_project_dataset.fact_delays_by_flight_num .. [[32mCREATE VIEW (0 processed)[0m in 0.73s]
[0m17:45:51.947053 [debug] [Thread-1 (]: Finished running node model.flights_project.fact_delays_by_flight_num
[0m17:45:51.951195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:51.952437 [debug] [MainThread]: Connection 'model.flights_project.fact_delays_by_flight_num' was properly closed.
[0m17:45:51.953618 [info ] [MainThread]: 
[0m17:45:51.954944 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.57 seconds (1.57s).
[0m17:45:51.956737 [debug] [MainThread]: Command end result
[0m17:45:51.989510 [info ] [MainThread]: 
[0m17:45:51.991373 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:45:51.992930 [info ] [MainThread]: 
[0m17:45:51.994901 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:45:52.000003 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.8643336, "process_user_time": 7.913031, "process_kernel_time": 0.678544, "process_mem_max_rss": "247940", "process_in_blocks": "608", "process_out_blocks": "0"}
[0m17:45:52.001680 [debug] [MainThread]: Command `dbt run` succeeded at 17:45:52.001235 after 5.87 seconds
[0m17:45:52.003259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed0a7e6780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed0e5df200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece69f9f10>]}
[0m17:45:52.004554 [debug] [MainThread]: Flushing usage events
